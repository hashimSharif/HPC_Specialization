<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>LLVM OpenMP* Runtime Library: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LLVM OpenMP* Runtime Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">LLVM OpenMP* Runtime Library Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The ITT API is used to annotate a user's program with additional information that can be used by correctness and performance tools. The user inserts calls in their program. Those calls generate information that is collected at runtime, and used by Intel(R) Threading Tools.</p>
<h1><a class="anchor" id="API"></a>
Concepts</h1>
<p>The following general concepts are used throughout the API.</p>
<h2><a class="anchor" id="Unicode"></a>
Support</h2>
<p>Many API functions take character string arguments. On Windows, there are two versions of each such function. The function name is suffixed by W if Unicode support is enabled, and by A otherwise. Any API function that takes a character string argument adheres to this convention.</p>
<h2><a class="anchor" id="Conditional"></a>
Compilation</h2>
<p>Many users prefer having an option to modify ITT API code when linking it inside their runtimes. ITT API header file provides a mechanism to replace ITT API function names inside your code with empty strings. To do this, define the macros INTEL_NO_ITTNOTIFY_API during compilation and remove the static library from the linker script.</p>
<h2><a class="anchor" id="Domains"></a>
Domains</h2>
<p>[see domains] Domains provide a way to separate notification for different modules or libraries in a program. Domains are specified by dotted character strings, e.g. TBB.Internal.Control.</p>
<p>A mechanism (to be specified) is provided to enable and disable domains. By default, all domains are enabled. </p>
<h2><a class="anchor" id="Named"></a>
Entities and Instances</h2>
<p>Named entities (frames, regions, tasks, and markers) communicate information about the program to the analysis tools. A named entity often refers to a section of program code, or to some set of logical concepts that the programmer wants to group together.</p>
<p>Named entities relate to the programmer's static view of the program. When the program actually executes, many instances of a given named entity may be created.</p>
<p>The API annotations denote instances of named entities. The actual named entities are displayed using the analysis tools. In other words, the named entities come into existence when instances are created.</p>
<p>Instances of named entities may have instance identifiers (IDs). Some API calls use instance identifiers to create relationships between different instances of named entities. Other API calls associate data with instances of named entities.</p>
<p>Some named entities must always have instance IDs. In particular, regions and frames always have IDs. Task and markers need IDs only if the ID is needed in another API call (such as adding a relation or metadata).</p>
<p>The lifetime of instance IDs is distinct from the lifetime of instances. This allows various relationships to be specified separate from the actual execution of instances. This flexibility comes at the expense of extra API calls.</p>
<p>The same ID may not be reused for different instances, unless a previous [ref] __itt_id_destroy call for that ID has been issued. </p>


<h2><a class="anchor" id="Analysis"></a>
* Code Workflow </h2>
<p> 

1) The interface to the intel runtime for invoking a parallel region is the routine <a href="./group__PARALLEL.html#gac2b7cc2fa78dde5381bcf00cfc48d124"> __kmpc_fork_call </a> </br> </br>
2) <a href="./group__PARALLEL.html#gac2b7cc2fa78dde5381bcf00cfc48d124"> __kmpc_fork_call </a> in turn invokes <a href = "./kmp_8h.html#afa300d153a7fea1038d2cdc72db06498" >  __kmp_fork_call </a> to create the parallel region dynamically </br> </br>
3) <a href = "./kmp_8h.html#afa300d153a7fea1038d2cdc72db06498"> __kmp_fork_call </a> in its first invocation, creates a thread pool (default size; specified by OMP_NUM_THREADS). In further invocations it leverages the existing thread pool </br> </br>

4) Particularly N - 1 instances of <a href = "./z__Linux__util_8c.html#a100bbf4669165114bff15c8fd381af02"> __kmp_launch_worker </a> is invoked to create the thread pool if already does not exist. One thread is reserved for the openMP master thread. The master sets up the worker threads, monitor threads and distributes work among the worker threads. the master thread has an Thread ID 0 </br></br> 

5) <a href = "./kmp_8h.html#ac88c1daa6b7e9e9b51a3a1510dca73ca"> __kmp_launch_thread </a> in turn calls the <a href= "./kmp__runtime_8c.html#aea1108b093169cef205a6766bdfa5a40">  __kmp_fork_barrier </a> method. This function waits for the master thread to signal the workers, once the internal control variables (including the worksharing data) is propagated to the workers. The signalling and the ICV propagation is also done in the <a href= "./kmp__runtime_8c.html#aea1108b093169cef205a6766bdfa5a40"> __kmp_fork_barrier </a> method in a switch for the master thread (threadID == 0). It must be noted that threads go to wait state with call to <a href= "./z__Linux__util_8c.html#a2a0487d25d42b2af4af0571afcd405e8"> __kmp_suspend_template </a> which in turn calls <b> pthread_cond_wait </b> while the master thread signals the corresponding condition variable with the call to <a href= "./z__Linux__util_8c.html#ab156558ea905954294188d1395cb2848"> kmp_resume_template </a> which in turn calls <b> pthread_cond_signal </b>. It is worth mentioning that the calls to <a href = "./z__Linux__util_8c.html#ab156558ea905954294188d1395cb2848"> __kmp_resume_template </a> and <a href = "./z__Linux__util_8c.html#a2a0487d25d42b2af4af0571afcd405e8" > __kmp_suspend_template </a> are made indirectly through "release" and "wait" methods of "kmp_flag_64" </br> </br>
6) Once threads have been signalled to proceed at the <a href= "./kmp__runtime_8c.html#aea1108b093169cef205a6766bdfa5a40">  __kmp_fork_barrier </a>, the parallel region code is executed by the call to <a href="./kmp__runtime_8c.html#ac3c18dacc189c300ca06e4ab033fc211"> _kmp_invoke_task_func </a> that in turn calls <a href = "./z__Linux__util_8c.html#a8b9eeb09f657cfedf1710611f8f778e6"> _kmp_invoke_microtask </a> </br> </br>
7) As the parallel region code is executed, each thread waits for the implied global barrier at the end of each openMP parallel region (synchronization). The barrier is executed by the <a href="/kmp__barrier_8cpp.html#a5e8f7c63d5e652f73e8998922edf14a4"> __kmp_join_barrier </a> routine. Specifically the master thread does a <b>pthread_cond_wait </b> for each worker thread in a loop while each thread notifies the master of reaching the barrier with the call to <b> pthread_cond_signal </b> </br> </br> 
8) It is important to note that the code in launch_thread including calls to "kmp_fork_barrier", "kmp_invoke_task_func" and "kmp_join_barrier" are executed in a loop. Once a thread pool is done with the parallel region, it waits at the fork barrier to be signalled by the master with a new parallel task. </br> </br>



</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Aug 17 2016 17:14:12 for LLVM OpenMP* Runtime Library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
