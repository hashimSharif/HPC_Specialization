\hypertarget{z__Windows__NT__util_8c}{\section{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c File Reference}
\label{z__Windows__NT__util_8c}\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
}
{\ttfamily \#include \char`\"{}kmp.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-itt.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-i18n.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-io.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-wait\-\_\-release.\-h\char`\"{}}\\*
{\ttfamily \#include $<$ntstatus.\-h$>$}\\*
{\ttfamily \#include $<$ntsecapi.\-h$>$}\\*
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structCLIENT__ID}{C\-L\-I\-E\-N\-T\-\_\-\-I\-D}
\item 
struct \hyperlink{structVM__COUNTERS}{V\-M\-\_\-\-C\-O\-U\-N\-T\-E\-R\-S}
\item 
struct \hyperlink{structSYSTEM__THREAD}{S\-Y\-S\-T\-E\-M\-\_\-\-T\-H\-R\-E\-A\-D}
\item 
struct \hyperlink{structSYSTEM__PROCESS__INFORMATION}{S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{z__Windows__NT__util_8c_aba1590ff86288c886c47dc8a27b30467}{C\-H\-E\-C\-K}(cond)
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef \\*
\hyperlink{structSYSTEM__PROCESS__INFORMATION}{S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N} $\ast$ \hyperlink{z__Windows__NT__util_8c_a28ef81f3202a077b177206e3c281cd69}{P\-S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}
\item 
typedef N\-T\-S\-T\-A\-T\-U\-S(N\-T\-A\-P\-I $\ast$ \hyperlink{z__Windows__NT__util_8c_ab6d20c9c11e9f3b63182538e9daf74b8}{Nt\-Query\-System\-Information\-\_\-t} )(\hyperlink{z__Windows__NT__util_8c_a65d6978d431075eba5186dd01b459c3b}{S\-Y\-S\-T\-E\-M\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N\-\_\-\-C\-L\-A\-S\-S}, P\-V\-O\-I\-D, U\-L\-O\-N\-G, P\-U\-L\-O\-N\-G)
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{z__Windows__NT__util_8c_a65d6978d431075eba5186dd01b459c3b}{S\-Y\-S\-T\-E\-M\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N\-\_\-\-C\-L\-A\-S\-S} \{ \hyperlink{z__Windows__NT__util_8c_a65d6978d431075eba5186dd01b459c3ba824a4231749a2817cdfd82dd410df574}{System\-Process\-Information} = 5
 \}
\item 
enum \hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4}{T\-H\-R\-E\-A\-D\-\_\-\-S\-T\-A\-T\-E} \{ \\*
\hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a2d6d054ff7158f2680b3b1bf5c5425d2}{State\-Initialized}, 
\hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a748d0575995f4abcff92ed05ccb40db6}{State\-Ready}, 
\hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a7deba990be536e1161bb5f6bf2a01f03}{State\-Running}, 
\hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a0e20ed48c239cebc6ba46d68fcdef0d2}{State\-Standby}, 
\\*
\hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4ad0bd8f85f6fd9a464492ec82f96bbee8}{State\-Terminated}, 
\hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4acf79cf6f88992b873b5ccf65f0f031b2}{State\-Wait}, 
\hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a00fa3ce26bb232d61aacb5f65582ee19}{State\-Transition}, 
\hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4ac829f931a3be9d35768aeb589773eb44}{State\-Unknown}
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{z__Windows__NT__util_8c_acb417c66dfd0b02a8ea556c894e2080a}{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T} (offsetof(\hyperlink{structSYSTEM__THREAD}{S\-Y\-S\-T\-E\-M\-\_\-\-T\-H\-R\-E\-A\-D}, Kernel\-Time)==0)
\item 
\hyperlink{z__Windows__NT__util_8c_a0ac104cc17a3c6cd6701c0cd0f775e90}{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T} (offsetof(\hyperlink{structSYSTEM__THREAD}{S\-Y\-S\-T\-E\-M\-\_\-\-T\-H\-R\-E\-A\-D}, Start\-Address)==32)
\item 
\hyperlink{z__Windows__NT__util_8c_a297ad7389469a4297af97860596a9b41}{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T} (offsetof(\hyperlink{structSYSTEM__THREAD}{S\-Y\-S\-T\-E\-M\-\_\-\-T\-H\-R\-E\-A\-D}, State)==68)
\item 
\hyperlink{z__Windows__NT__util_8c_a12e0308899cde047a90129da31cf8a43}{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T} (offsetof(\hyperlink{structSYSTEM__PROCESS__INFORMATION}{S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, Next\-Entry\-Offset)==0)
\item 
\hyperlink{z__Windows__NT__util_8c_a882c5f03945356afb2750e8815c755f2}{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T} (offsetof(\hyperlink{structSYSTEM__PROCESS__INFORMATION}{S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, Create\-Time)==32)
\item 
\hyperlink{z__Windows__NT__util_8c_add82169d09e4c07e471eca7542028953}{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T} (offsetof(\hyperlink{structSYSTEM__PROCESS__INFORMATION}{S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, Image\-Name)==56)
\item 
\hyperlink{z__Windows__NT__util_8c_a9fc910c3e3d8ce79bd0153c60c34fa4b}{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T} (offsetof(\hyperlink{structSYSTEM__PROCESS__INFORMATION}{S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, Process\-Id)==80)
\item 
\hyperlink{z__Windows__NT__util_8c_ad41491d808f9ce5a46c8cb040c261706}{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T} (offsetof(\hyperlink{structSYSTEM__PROCESS__INFORMATION}{S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, Handle\-Count)==96)
\item 
\hyperlink{z__Windows__NT__util_8c_adc0f11989762c8e24e79b2f47edf6049}{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T} (offsetof(\hyperlink{structSYSTEM__PROCESS__INFORMATION}{S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, V\-M\-Counters)==112)
\item 
\hyperlink{z__Windows__NT__util_8c_a4ec300514e2495e897980f5e54035dfc}{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T} (offsetof(\hyperlink{structSYSTEM__PROCESS__INFORMATION}{S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, I\-O\-Counters)==208)
\item 
\hyperlink{z__Windows__NT__util_8c_afb6711dd3535c23c0edb4aed69af28ab}{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T} (offsetof(\hyperlink{structSYSTEM__PROCESS__INFORMATION}{S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, Threads)==256)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_ab93aa5404f492750afbd37bbe0b3be52}{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-init} (kmp\-\_\-win32\-\_\-mutex\-\_\-t $\ast$mx)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_ae833489959d71b97acfff87a40c867b4}{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-destroy} (kmp\-\_\-win32\-\_\-mutex\-\_\-t $\ast$mx)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a1b3aab743814b71e420faff607d941d1}{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-lock} (kmp\-\_\-win32\-\_\-mutex\-\_\-t $\ast$mx)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a05597f57992f97794d11b4a470191906}{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-unlock} (kmp\-\_\-win32\-\_\-mutex\-\_\-t $\ast$mx)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a0beefaf8138ff385bc98236faa982534}{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-init} (kmp\-\_\-win32\-\_\-cond\-\_\-t $\ast$cv)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a6e9b71a81067d95a68dfab6d1372172d}{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-destroy} (kmp\-\_\-win32\-\_\-cond\-\_\-t $\ast$cv)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a5b519eb6a30d9c2449e5798b899bb007}{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-wait} (kmp\-\_\-win32\-\_\-cond\-\_\-t $\ast$cv, kmp\-\_\-win32\-\_\-mutex\-\_\-t $\ast$mx, \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} need\-\_\-decrease\-\_\-load)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a3a517cc114680dc78a99c3aeb4b64924}{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-broadcast} (kmp\-\_\-win32\-\_\-cond\-\_\-t $\ast$cv)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a6ae31d8afd60c4195a36fa2badbcb2ae}{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-signal} (kmp\-\_\-win32\-\_\-cond\-\_\-t $\ast$cv)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a2e5848b9f3322bf665ddc53ac090b69b}{\-\_\-\-\_\-kmp\-\_\-enable} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} new\-\_\-state)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a6662ea431f75e592a8202c1af0637aff}{\-\_\-\-\_\-kmp\-\_\-disable} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} $\ast$old\-\_\-state)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a4b300606c79ebf03aaee1fdc9b9c141d}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a3cbd436ba7abef35400b2939a597025e}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a8da648a8950059fa34eeca0f54b437a6}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
{\footnotesize template$<$class C $>$ }\\static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a2a0487d25d42b2af4af0571afcd405e8}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} th\-\_\-gtid, C $\ast$flag)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_aba3964e854aa376fc15165064cf5eff7}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} th\-\_\-gtid, \hyperlink{classkmp__flag__32}{kmp\-\_\-flag\-\_\-32} $\ast$flag)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_aa691a7515df09e540efa307af193ebcf}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} th\-\_\-gtid, \hyperlink{classkmp__flag__64}{kmp\-\_\-flag\-\_\-64} $\ast$flag)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a984c4dfb0b0c1966f7f2839107b6bd80}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} th\-\_\-gtid, \hyperlink{classkmp__flag__oncore}{kmp\-\_\-flag\-\_\-oncore} $\ast$flag)
\item 
{\footnotesize template$<$class C $>$ }\\static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_ab156558ea905954294188d1395cb2848}{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-template} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} target\-\_\-gtid, C $\ast$flag)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_acfe9e02a35d4e38951a53bd689ca2141}{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-32} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} target\-\_\-gtid, \hyperlink{classkmp__flag__32}{kmp\-\_\-flag\-\_\-32} $\ast$flag)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a6d3052650a7678516a888600044b6d63}{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-64} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} target\-\_\-gtid, \hyperlink{classkmp__flag__64}{kmp\-\_\-flag\-\_\-64} $\ast$flag)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_ace5ec17d5fee86980dead25d07a595d9}{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} target\-\_\-gtid, \hyperlink{classkmp__flag__oncore}{kmp\-\_\-flag\-\_\-oncore} $\ast$flag)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a699f282bc4bbcf04222893192f568e91}{\-\_\-\-\_\-kmp\-\_\-yield} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} cond)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_ae3492f3ab3c30ed2c204dc10e93c8471}{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-set\-\_\-specific} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} gtid)
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Windows__NT__util_8c_a81e40765e4057689a8d5fa27b62ed76e}{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-get\-\_\-specific} ()
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Windows__NT__util_8c_ab057268fc36c87b493138b5a107ad3e1}{\-\_\-\-\_\-kmp\-\_\-set\-\_\-system\-\_\-affinity} (kmp\-\_\-affin\-\_\-mask\-\_\-t const $\ast$\hyperlink{ittnotify__static_8h_aa2c7de905e06240a7170f2a0da3a5abf}{mask}, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} abort\-\_\-on\-\_\-error)
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Windows__NT__util_8c_a48da78b5eda0063ee78eb8914a6b1673}{\-\_\-\-\_\-kmp\-\_\-get\-\_\-system\-\_\-affinity} (kmp\-\_\-affin\-\_\-mask\-\_\-t $\ast$\hyperlink{ittnotify__static_8h_aa2c7de905e06240a7170f2a0da3a5abf}{mask}, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} abort\-\_\-on\-\_\-error)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a35e932e829e2d66d9b34662b9917256d}{\-\_\-\-\_\-kmp\-\_\-affinity\-\_\-bind\-\_\-thread} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} proc)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a2c419693b7848059f9e5d99ce318c6cf}{\-\_\-\-\_\-kmp\-\_\-affinity\-\_\-determine\-\_\-capable} (const char $\ast$env\-\_\-var)
\item 
double \hyperlink{z__Windows__NT__util_8c_a59bfe9c94177c19907c3f28bf3daf4a3}{\-\_\-\-\_\-kmp\-\_\-read\-\_\-cpu\-\_\-time} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Windows__NT__util_8c_ab8f6d039c9b836fa9a1ec3b3987817a7}{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-info} (struct \hyperlink{structkmp__sys__info}{kmp\-\_\-sys\-\_\-info} $\ast$info)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_ad0680d5e6d1872f505775e7bf61c91f6}{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_ab5834eff1e783726ba2a6a32133617cc}{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a9c1e0ffcb1e7c87e5429269dc6c6c0bf}{\-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} gtid)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_aabfba67685e1a77399b30e235ef64c43}{\-\_\-\-\_\-kmp\-\_\-clear\-\_\-system\-\_\-time} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a62b59839eaf67757384be830989a54ba}{\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-system\-\_\-tick} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_aa8475a433d18b95fcfaf4543146e2607}{\-\_\-\-\_\-kmp\-\_\-elapsed} (double $\ast$t)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_ae03839bc0108d7b046aeab29b3700fe0}{\-\_\-\-\_\-kmp\-\_\-elapsed\-\_\-tick} (double $\ast$t)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a1f49d8ebe9ab3485ce41c35d80d202d5}{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time} (double $\ast$delta)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$\-\_\-\-\_\-stdcall \hyperlink{z__Windows__NT__util_8c_a8391d11849c8dcf778d4b52df820622f}{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$arg)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$\-\_\-\-\_\-stdcall \hyperlink{z__Windows__NT__util_8c_ae8e9572b3f3b44e352cd7d7891b693bb}{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$arg)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_aa0827020920859540910bfb0f89e2584}{\-\_\-\-\_\-kmp\-\_\-create\-\_\-worker} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} gtid, \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, size\-\_\-t stack\-\_\-size)
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Windows__NT__util_8c_a46d2a4060b866eb1cfbb6f011fd6383c}{\-\_\-\-\_\-kmp\-\_\-still\-\_\-running} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a54a5fa38300ab3405a01195544ae4609}{\-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Windows__NT__util_8c_ad4d0392f67428e1609f99892f0ba65cc}{\-\_\-\-\_\-kmp\-\_\-is\-\_\-thread\-\_\-alive} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, D\-W\-O\-R\-D $\ast$exit\-\_\-val)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_af0505501baee87e21f7dbb2993891051}{\-\_\-\-\_\-kmp\-\_\-exit\-\_\-thread} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} exit\-\_\-status)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_aad3fc7c38b06f31fd4806da45cc3ea28}{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-common} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a6f1cbadac27343041f6bb97e0ab76c69}{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_af9e43e476cd1e6220df32409d2025761}{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-worker} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a397d2a9aa5fd59cab056b8aed69fef29}{\-\_\-\-\_\-kmp\-\_\-thread\-\_\-sleep} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} millis)
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Windows__NT__util_8c_a5676bfae90caed2d037a605382449d2c}{\-\_\-\-\_\-kmp\-\_\-is\-\_\-address\-\_\-mapped} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$\hyperlink{ittnotify__static_8h_a7e21c61c16fffcc27199a9d66ff39ab8}{addr})
\item 
kmp\-\_\-uint64 \hyperlink{z__Windows__NT__util_8c_afd7ef3df9b68039c9fb47ede46df4cf4}{\-\_\-\-\_\-kmp\-\_\-hardware\-\_\-timestamp} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Windows__NT__util_8c_a0603ae87485cdde7a3a054e585f324fd}{\-\_\-\-\_\-kmp\-\_\-free\-\_\-handle} (kmp\-\_\-thread\-\_\-t t\-Handle)
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Windows__NT__util_8c_a3944571fba6209a59491ca17998bfc5f}{\-\_\-\-\_\-kmp\-\_\-get\-\_\-load\-\_\-balance} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} max)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{z__Windows__NT__util_8c_ab6d20c9c11e9f3b63182538e9daf74b8}{Nt\-Query\-System\-Information\-\_\-t} \hyperlink{z__Windows__NT__util_8c_a57d2507b348b6039546c1ac06885c249}{Nt\-Query\-System\-Information} = N\-U\-L\-L
\item 
H\-M\-O\-D\-U\-L\-E \hyperlink{z__Windows__NT__util_8c_a8a496cb7a3d14a50bfd397fe68f8a6af}{ntdll} = N\-U\-L\-L
\item 
static H\-A\-N\-D\-L\-E \hyperlink{z__Windows__NT__util_8c_a9603a8d81356b569383be9f81d491a94}{\-\_\-\-\_\-kmp\-\_\-monitor\-\_\-ev}
\item 
static kmp\-\_\-int64 \hyperlink{z__Windows__NT__util_8c_afd6cc2ba15915e1f3ff7182c4714b89b}{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-time}
\item 
double \hyperlink{z__Windows__NT__util_8c_a7d804e92be16ffc1446125dbe0b744d1}{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-tick}
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Windows__NT__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\-\_\-\-\_\-kmp\-\_\-init\-\_\-runtime} = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{F\-A\-L\-S\-E}
\item 
C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-S\-E\-C\-T\-I\-O\-N \hyperlink{z__Windows__NT__util_8c_a2bc5381853ed1ae280d4d481b393f249}{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-section}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{z__Windows__NT__util_8c_aba1590ff86288c886c47dc8a27b30467}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!C\-H\-E\-C\-K@{C\-H\-E\-C\-K}}
\index{C\-H\-E\-C\-K@{C\-H\-E\-C\-K}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{C\-H\-E\-C\-K}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\-H\-E\-C\-K(
\begin{DoxyParamCaption}
\item[{}]{cond}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_aba1590ff86288c886c47dc8a27b30467}
{\bfseries Value\-:}
\begin{DoxyCode}
\{                                       \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{\(\backslash\)}
\hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{            KMP\_DEBUG\_ASSERT}( cond );           \(\backslash\)
            if ( ! ( cond ) ) \{                 \(\backslash\)
                running\_threads = -1;           \(\backslash\)
                goto finish;                    \(\backslash\)
            \}                                   \(\backslash\)
        \}
\end{DoxyCode}


Referenced by \-\_\-\-\_\-kmp\-\_\-get\-\_\-load\-\_\-balance().



\subsection{Typedef Documentation}
\hypertarget{z__Windows__NT__util_8c_ab6d20c9c11e9f3b63182538e9daf74b8}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!Nt\-Query\-System\-Information\-\_\-t@{Nt\-Query\-System\-Information\-\_\-t}}
\index{Nt\-Query\-System\-Information\-\_\-t@{Nt\-Query\-System\-Information\-\_\-t}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{Nt\-Query\-System\-Information\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef N\-T\-S\-T\-A\-T\-U\-S(N\-T\-A\-P\-I $\ast$ Nt\-Query\-System\-Information\-\_\-t)({\bf S\-Y\-S\-T\-E\-M\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N\-\_\-\-C\-L\-A\-S\-S}, P\-V\-O\-I\-D, U\-L\-O\-N\-G, P\-U\-L\-O\-N\-G)}}\label{z__Windows__NT__util_8c_ab6d20c9c11e9f3b63182538e9daf74b8}


Definition at line 123 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.

\hypertarget{z__Windows__NT__util_8c_a28ef81f3202a077b177206e3c281cd69}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!P\-S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N@{P\-S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}}
\index{P\-S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N@{P\-S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{P\-S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}$\ast$ {\bf P\-S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}}}\label{z__Windows__NT__util_8c_a28ef81f3202a077b177206e3c281cd69}


Definition at line 104 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



\subsection{Enumeration Type Documentation}
\hypertarget{z__Windows__NT__util_8c_a65d6978d431075eba5186dd01b459c3b}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!S\-Y\-S\-T\-E\-M\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N\-\_\-\-C\-L\-A\-S\-S@{S\-Y\-S\-T\-E\-M\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N\-\_\-\-C\-L\-A\-S\-S}}
\index{S\-Y\-S\-T\-E\-M\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N\-\_\-\-C\-L\-A\-S\-S@{S\-Y\-S\-T\-E\-M\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N\-\_\-\-C\-L\-A\-S\-S}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{S\-Y\-S\-T\-E\-M\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N\-\_\-\-C\-L\-A\-S\-S}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf S\-Y\-S\-T\-E\-M\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N\-\_\-\-C\-L\-A\-S\-S}}}\label{z__Windows__NT__util_8c_a65d6978d431075eba5186dd01b459c3b}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{System\-Process\-Information@{System\-Process\-Information}!z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!System\-Process\-Information@{System\-Process\-Information}}\item[{\em 
\hypertarget{z__Windows__NT__util_8c_a65d6978d431075eba5186dd01b459c3ba824a4231749a2817cdfd82dd410df574}{System\-Process\-Information}\label{z__Windows__NT__util_8c_a65d6978d431075eba5186dd01b459c3ba824a4231749a2817cdfd82dd410df574}
}]\end{description}
\end{Desc}


Definition at line 29 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.


\begin{DoxyCode}
29                               \{
30     \hyperlink{z__Windows__NT__util_8c_a65d6978d431075eba5186dd01b459c3ba824a4231749a2817cdfd82dd410df574}{SystemProcessInformation} = 5
31 \}; \textcolor{comment}{// SYSTEM\_INFORMATION\_CLASS}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!T\-H\-R\-E\-A\-D\-\_\-\-S\-T\-A\-T\-E@{T\-H\-R\-E\-A\-D\-\_\-\-S\-T\-A\-T\-E}}
\index{T\-H\-R\-E\-A\-D\-\_\-\-S\-T\-A\-T\-E@{T\-H\-R\-E\-A\-D\-\_\-\-S\-T\-A\-T\-E}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{T\-H\-R\-E\-A\-D\-\_\-\-S\-T\-A\-T\-E}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf T\-H\-R\-E\-A\-D\-\_\-\-S\-T\-A\-T\-E}}}\label{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{State\-Initialized@{State\-Initialized}!z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!State\-Initialized@{State\-Initialized}}\item[{\em 
\hypertarget{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a2d6d054ff7158f2680b3b1bf5c5425d2}{State\-Initialized}\label{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a2d6d054ff7158f2680b3b1bf5c5425d2}
}]\index{State\-Ready@{State\-Ready}!z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!State\-Ready@{State\-Ready}}\item[{\em 
\hypertarget{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a748d0575995f4abcff92ed05ccb40db6}{State\-Ready}\label{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a748d0575995f4abcff92ed05ccb40db6}
}]\index{State\-Running@{State\-Running}!z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!State\-Running@{State\-Running}}\item[{\em 
\hypertarget{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a7deba990be536e1161bb5f6bf2a01f03}{State\-Running}\label{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a7deba990be536e1161bb5f6bf2a01f03}
}]\index{State\-Standby@{State\-Standby}!z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!State\-Standby@{State\-Standby}}\item[{\em 
\hypertarget{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a0e20ed48c239cebc6ba46d68fcdef0d2}{State\-Standby}\label{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a0e20ed48c239cebc6ba46d68fcdef0d2}
}]\index{State\-Terminated@{State\-Terminated}!z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!State\-Terminated@{State\-Terminated}}\item[{\em 
\hypertarget{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4ad0bd8f85f6fd9a464492ec82f96bbee8}{State\-Terminated}\label{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4ad0bd8f85f6fd9a464492ec82f96bbee8}
}]\index{State\-Wait@{State\-Wait}!z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!State\-Wait@{State\-Wait}}\item[{\em 
\hypertarget{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4acf79cf6f88992b873b5ccf65f0f031b2}{State\-Wait}\label{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4acf79cf6f88992b873b5ccf65f0f031b2}
}]\index{State\-Transition@{State\-Transition}!z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!State\-Transition@{State\-Transition}}\item[{\em 
\hypertarget{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a00fa3ce26bb232d61aacb5f65582ee19}{State\-Transition}\label{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a00fa3ce26bb232d61aacb5f65582ee19}
}]\index{State\-Unknown@{State\-Unknown}!z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!State\-Unknown@{State\-Unknown}}\item[{\em 
\hypertarget{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4ac829f931a3be9d35768aeb589773eb44}{State\-Unknown}\label{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4ac829f931a3be9d35768aeb589773eb44}
}]\end{description}
\end{Desc}


Definition at line 38 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.


\begin{DoxyCode}
38                   \{
39     \hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a2d6d054ff7158f2680b3b1bf5c5425d2}{StateInitialized},
40     \hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a748d0575995f4abcff92ed05ccb40db6}{StateReady},
41     \hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a7deba990be536e1161bb5f6bf2a01f03}{StateRunning},
42     \hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a0e20ed48c239cebc6ba46d68fcdef0d2}{StateStandby},
43     \hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4ad0bd8f85f6fd9a464492ec82f96bbee8}{StateTerminated},
44     \hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4acf79cf6f88992b873b5ccf65f0f031b2}{StateWait},
45     \hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a00fa3ce26bb232d61aacb5f65582ee19}{StateTransition},
46     \hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4ac829f931a3be9d35768aeb589773eb44}{StateUnknown}
47 \}; \textcolor{comment}{// enum THREAD\_STATE}
\end{DoxyCode}


\subsection{Function Documentation}
\hypertarget{z__Windows__NT__util_8c_a35e932e829e2d66d9b34662b9917256d}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-affinity\-\_\-bind\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-affinity\-\_\-bind\-\_\-thread}}
\index{\-\_\-\-\_\-kmp\-\_\-affinity\-\_\-bind\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-affinity\-\_\-bind\-\_\-thread}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-affinity\-\_\-bind\-\_\-thread}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-affinity\-\_\-bind\-\_\-thread (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{proc}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a35e932e829e2d66d9b34662b9917256d}


Definition at line 708 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.


\begin{DoxyCode}
709 \{
710 
711 \textcolor{preprocessor}{#if KMP\_GROUP\_AFFINITY}
712 \textcolor{preprocessor}{}
713     \textcolor{keywordflow}{if} (\_\_kmp\_num\_proc\_groups > 1) \{
714         \textcolor{comment}{//}
715         \textcolor{comment}{// Form the GROUP\_AFFINITY struct directly, rather than filling}
716         \textcolor{comment}{// out a bit vector and calling \_\_kmp\_set\_system\_affinity().}
717         \textcolor{comment}{//}
718         GROUP\_AFFINITY ga;
719         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}((proc >= 0) && (proc < (\_\_kmp\_num\_proc\_groups
720            * CHAR\_BIT * \textcolor{keyword}{sizeof}(DWORD\_PTR))));
721         ga.Group = proc / (CHAR\_BIT * \textcolor{keyword}{sizeof}(DWORD\_PTR));
722         ga.Mask = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} long)1 << (proc % (CHAR\_BIT * \textcolor{keyword}{sizeof}(DWORD\_PTR)));
723         ga.Reserved[0] = ga.Reserved[1] = ga.Reserved[2] = 0;
724 
725         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(\_\_kmp\_SetThreadGroupAffinity != NULL);
726         \textcolor{keywordflow}{if} (\_\_kmp\_SetThreadGroupAffinity(GetCurrentThread(), &ga, NULL) == 0) \{
727             DWORD error = GetLastError();
728             \textcolor{keywordflow}{if} (\_\_kmp\_affinity\_verbose) \{ \textcolor{comment}{// AC: continue silently if not verbose}
729                 \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
730                     \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060af43a3e02113c5b36d94c603bad0cd807}{kmp\_ms\_warning},
731                     \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantSetThreadAffMask ),
732                     \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( error ),
733                     \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
734                 );
735             \}
736         \}
737     \}
738     \textcolor{keywordflow}{else}
739 
740 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_GROUP\_AFFINITY */}\textcolor{preprocessor}{}
741 \textcolor{preprocessor}{}
742     \{
743         kmp\_affin\_mask\_t \hyperlink{ittnotify__static_8h_aa2c7de905e06240a7170f2a0da3a5abf}{mask};
744         KMP\_CPU\_ZERO(&mask);
745         KMP\_CPU\_SET(proc, &mask);
746         \hyperlink{z__Windows__NT__util_8c_ab057268fc36c87b493138b5a107ad3e1}{\_\_kmp\_set\_system\_affinity}(&mask, \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
747     \}
748 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a2c419693b7848059f9e5d99ce318c6cf}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-affinity\-\_\-determine\-\_\-capable@{\-\_\-\-\_\-kmp\-\_\-affinity\-\_\-determine\-\_\-capable}}
\index{\-\_\-\-\_\-kmp\-\_\-affinity\-\_\-determine\-\_\-capable@{\-\_\-\-\_\-kmp\-\_\-affinity\-\_\-determine\-\_\-capable}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-affinity\-\_\-determine\-\_\-capable}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-affinity\-\_\-determine\-\_\-capable (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{env\-\_\-var}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a2c419693b7848059f9e5d99ce318c6cf}


Definition at line 751 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-env\-\_\-initialize().


\begin{DoxyCode}
752 \{
753     \textcolor{comment}{//}
754     \textcolor{comment}{// All versions of Windows* OS (since Win '95) support SetThreadAffinityMask().}
755     \textcolor{comment}{//}
756 
757 \textcolor{preprocessor}{#if KMP\_GROUP\_AFFINITY}
758 \textcolor{preprocessor}{}    KMP\_AFFINITY\_ENABLE(\_\_kmp\_num\_proc\_groups*\textcolor{keyword}{sizeof}(kmp\_affin\_mask\_t));
759 \textcolor{preprocessor}{#else}
760 \textcolor{preprocessor}{}    KMP\_AFFINITY\_ENABLE(\textcolor{keyword}{sizeof}(kmp\_affin\_mask\_t));
761 \textcolor{preprocessor}{#endif}
762 \textcolor{preprocessor}{}
763     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (
764         \textcolor{stringliteral}{"\_\_kmp\_affinity\_determine\_capable: "}
765             \textcolor{stringliteral}{"Windows* OS affinity interface functional (mask size = %"} KMP\_SIZE\_T\_SPEC \textcolor{stringliteral}{").\(\backslash\)n"},
766         \_\_kmp\_affin\_mask\_size
767     ) );
768 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_aabfba67685e1a77399b30e235ef64c43}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-clear\-\_\-system\-\_\-time@{\-\_\-\-\_\-kmp\-\_\-clear\-\_\-system\-\_\-time}}
\index{\-\_\-\-\_\-kmp\-\_\-clear\-\_\-system\-\_\-time@{\-\_\-\-\_\-kmp\-\_\-clear\-\_\-system\-\_\-time}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-clear\-\_\-system\-\_\-time}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-clear\-\_\-system\-\_\-time (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_aabfba67685e1a77399b30e235ef64c43}


Definition at line 1081 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.


\begin{DoxyCode}
1082 \{
1083     BOOL \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1084     LARGE\_INTEGER time;
1085     status = QueryPerformanceCounter( & time );
1086     \hyperlink{z__Windows__NT__util_8c_afd6cc2ba15915e1f3ff7182c4714b89b}{\_\_kmp\_win32\_time} = (kmp\_int64) time.QuadPart;
1087 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a54a5fa38300ab3405a01195544ae4609}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor@{\-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor}}
\index{\-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor@{\-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a54a5fa38300ab3405a01195544ae4609}


Definition at line 1407 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-allocate\-\_\-thread().


\begin{DoxyCode}
1408 \{
1409     kmp\_thread\_t        handle;
1410     DWORD               idThread;
1411     \textcolor{keywordtype}{int}                 ideal, new\_ideal;
1412 
1413     \textcolor{keywordflow}{if}( \hyperlink{kmp_8h_a3b56e2e90e1539c0b794e4137724bc1c}{\_\_kmp\_dflt\_blocktime} == \hyperlink{kmp_8h_a1ca6c6ce04115f143dc5df627de57958}{KMP\_MAX\_BLOCKTIME} ) \{
1414         \textcolor{comment}{// We don't need monitor thread in case of MAX\_BLOCKTIME}
1415         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_create\_monitor: skipping monitor thread because of MAX blocktime\(\backslash\)n"} )
       );
1416         th->th.th\_info.ds.ds\_tid  = 0; \textcolor{comment}{// this makes reap\_monitor no-op}
1417         th->th.th\_info.ds.ds\_gtid = 0;
1418         \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( \hyperlink{kmp_8h_a7837f92b7bc9827769108bb115d180e8}{\_\_kmp\_init\_monitor}, 2 ); \textcolor{comment}{// Signal to stop waiting for monitor
       creation}
1419         \textcolor{keywordflow}{return};
1420     \}
1421     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_create\_monitor: try to create monitor\(\backslash\)n"} ) );
1422 
1423     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1424 
1425     \hyperlink{z__Windows__NT__util_8c_a9603a8d81356b569383be9f81d491a94}{\_\_kmp\_monitor\_ev} = CreateEvent( NULL, \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, NULL );
1426     \textcolor{keywordflow}{if} ( \hyperlink{z__Windows__NT__util_8c_a9603a8d81356b569383be9f81d491a94}{\_\_kmp\_monitor\_ev} == NULL ) \{
1427         DWORD error = GetLastError();
1428         \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1429             \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
1430             \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantCreateEvent ),
1431             \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( error ),
1432             \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1433         );
1434     \}; \textcolor{comment}{// if}
1435 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1436 \textcolor{preprocessor}{}    \_\_kmp\_itt\_system\_object\_created( \hyperlink{z__Windows__NT__util_8c_a9603a8d81356b569383be9f81d491a94}{\_\_kmp\_monitor\_ev}, \textcolor{stringliteral}{"Event"} );
1437 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1438 \textcolor{preprocessor}{}
1439     th->th.th\_info.ds.ds\_tid  = \hyperlink{kmp_8h_a5eb958603bc237a3484be5bd2b0de39a}{KMP\_GTID\_MONITOR};
1440     th->th.th\_info.ds.ds\_gtid = \hyperlink{kmp_8h_a5eb958603bc237a3484be5bd2b0de39a}{KMP\_GTID\_MONITOR};
1441 
1442     \textcolor{comment}{// FIXME - on Windows* OS, if \_\_kmp\_monitor\_stksize = 0, figure out how}
1443     \textcolor{comment}{// to automatically expand stacksize based on CreateThread error code.}
1444     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} == 0 ) \{
1445         \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} = \hyperlink{kmp_8h_ad9e61183792948e75cf30b7d1f08299a}{KMP\_DEFAULT\_MONITOR\_STKSIZE}
      ;
1446     \}
1447     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} < \hyperlink{kmp_8h_ac11734b715f1e9aec17fc0eda9cba87c}{\_\_kmp\_sys\_min\_stksize} ) \{
1448         \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} = \hyperlink{kmp_8h_ac11734b715f1e9aec17fc0eda9cba87c}{\_\_kmp\_sys\_min\_stksize};
1449     \}
1450 
1451     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_create\_monitor: requested stacksize = %d bytes\(\backslash\)n"},
1452                    (\textcolor{keywordtype}{int}) \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} ) );
1453 
1454     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_time.dt.t\_value, 0 );
1455 
1456     handle = CreateThread( NULL, (SIZE\_T) \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize},
1457                            (LPTHREAD\_START\_ROUTINE) \hyperlink{z__Windows__NT__util_8c_ae8e9572b3f3b44e352cd7d7891b693bb}{\_\_kmp\_launch\_monitor},
1458                            (LPVOID) th, STACK\_SIZE\_PARAM\_IS\_A\_RESERVATION, &idThread );
1459     \textcolor{keywordflow}{if} (handle == 0) \{
1460         DWORD error = GetLastError();
1461         \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1462             \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
1463             \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantCreateThread ),
1464             \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( error ),
1465             \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1466         );
1467     \}
1468     \textcolor{keywordflow}{else}
1469         th->th.th\_info.ds.ds\_thread = handle;
1470 
1471     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1472 
1473     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_create\_monitor: monitor created %p\(\backslash\)n"},
1474                    (\textcolor{keywordtype}{void} *) th->th.th\_info.ds.ds\_thread ) );
1475 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_aa0827020920859540910bfb0f89e2584}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-create\-\_\-worker@{\-\_\-\-\_\-kmp\-\_\-create\-\_\-worker}}
\index{\-\_\-\-\_\-kmp\-\_\-create\-\_\-worker@{\-\_\-\-\_\-kmp\-\_\-create\-\_\-worker}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-create\-\_\-worker}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-create\-\_\-worker (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{gtid, }
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{size\-\_\-t}]{stack\-\_\-size}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_aa0827020920859540910bfb0f89e2584}


Definition at line 1315 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-allocate\-\_\-thread(), and \-\_\-\-\_\-kmp\-\_\-register\-\_\-root().


\begin{DoxyCode}
1316 \{
1317     kmp\_thread\_t   handle;
1318     DWORD          idThread;
1319 
1320     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_create\_worker: try to create thread (%d)\(\backslash\)n"}, gtid ) );
1321 
1322     th->th.th\_info.ds.ds\_gtid = gtid;
1323 
1324     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a1ad5b094aa539d78ab4155b10b0ced21}{KMP\_UBER\_GTID}(gtid) ) \{
1325         \textcolor{keywordtype}{int}     stack\_data;
1326 
1327         \textcolor{comment}{/* TODO: GetCurrentThread() returns a pseudo-handle that is unsuitable for other threads to use.}
1328 \textcolor{comment}{           Is it appropriate to just use GetCurrentThread?  When should we close this handle?  When}
1329 \textcolor{comment}{           unregistering the root?}
1330 \textcolor{comment}{        */}
1331         \{
1332             BOOL rc;
1333             rc = DuplicateHandle(
1334                                  GetCurrentProcess(),
1335                                  GetCurrentThread(),
1336                                  GetCurrentProcess(),
1337                                  &th->th.th\_info.ds.ds\_thread,
1338                                  0,
1339                                  \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE},
1340                                  DUPLICATE\_SAME\_ACCESS
1341                                  );
1342             \hyperlink{kmp__debug_8h_a5323a368e8ba273b17c46906dd9ec78c}{KMP\_ASSERT}( rc );
1343             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{" \_\_kmp\_create\_worker: ROOT Handle duplicated, th = %p, handle = %"} 
      \hyperlink{kmp__os_8h_a716dd0090b3c62cb5a8203b27846585e}{KMP\_UINTPTR\_SPEC} \textcolor{stringliteral}{"\(\backslash\)n"},
1344                            (LPVOID)th,
1345                            th->th.th\_info.ds.ds\_thread ) );
1346             th->th.th\_info.ds.ds\_thread\_id = GetCurrentThreadId();
1347         \}
1348         \textcolor{keywordflow}{if} ( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(\hyperlink{kmp_8h_ae8d713bc264db1f092c97ca94f3b82bc}{\_\_kmp\_gtid\_mode}) < 2 ) \{ \textcolor{comment}{// check stack only if it is used to get
       gtid}
1349             \textcolor{comment}{/* we will dynamically update the stack range if gtid\_mode == 1 */}
1350             \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(th->th.th\_info.ds.ds\_stackbase, &stack\_data);
1351             \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(th->th.th\_info.ds.ds\_stacksize, 0);
1352             \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(th->th.th\_info.ds.ds\_stackgrow, \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
1353             \hyperlink{kmp_8h_a21152135e5447d443b8f803bb6437639}{\_\_kmp\_check\_stack\_overlap}( th );
1354         \}
1355     \}
1356     \textcolor{keywordflow}{else} \{
1357         \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1358 
1359         \textcolor{comment}{/* Set stack size for this thread now. */}
1360         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_create\_worker: stack\_size = %"} KMP\_SIZE\_T\_SPEC
1361                         \textcolor{stringliteral}{" bytes\(\backslash\)n"}, stack\_size ) );
1362 
1363         stack\_size += gtid * \hyperlink{kmp_8h_ac841e4743aeceae5d3667bc8511ba1c4}{\_\_kmp\_stkoffset};
1364 
1365         \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(th->th.th\_info.ds.ds\_stacksize, stack\_size);
1366         \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(th->th.th\_info.ds.ds\_stackgrow, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1367 
1368         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_create\_worker: (before) stack\_size = %"}
1369                         KMP\_SIZE\_T\_SPEC
1370                         \textcolor{stringliteral}{" bytes, &\_\_kmp\_launch\_worker = %p, th = %p, "}
1371                         \textcolor{stringliteral}{"&idThread = %p\(\backslash\)n"},
1372                         (SIZE\_T) stack\_size,
1373                         (LPTHREAD\_START\_ROUTINE) & \hyperlink{z__Windows__NT__util_8c_a8391d11849c8dcf778d4b52df820622f}{\_\_kmp\_launch\_worker},
1374                         (LPVOID) th, &idThread ) );
1375 
1376         handle = CreateThread( NULL, (SIZE\_T) stack\_size,
1377                                (LPTHREAD\_START\_ROUTINE) \_\_kmp\_launch\_worker,
1378                                (LPVOID) th, STACK\_SIZE\_PARAM\_IS\_A\_RESERVATION, &idThread );
1379 
1380         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_create\_worker: (after) stack\_size = %"}
1381                         KMP\_SIZE\_T\_SPEC
1382                         \textcolor{stringliteral}{" bytes, &\_\_kmp\_launch\_worker = %p, th = %p, "}
1383                         \textcolor{stringliteral}{"idThread = %u, handle = %"} \hyperlink{kmp__os_8h_a716dd0090b3c62cb5a8203b27846585e}{KMP\_UINTPTR\_SPEC} \textcolor{stringliteral}{"\(\backslash\)n"},
1384                         (SIZE\_T) stack\_size,
1385                         (LPTHREAD\_START\_ROUTINE) & \_\_kmp\_launch\_worker,
1386                         (LPVOID) th, idThread, handle ) );
1387 
1388         \textcolor{keywordflow}{if} ( handle == 0 ) \{
1389             DWORD error = GetLastError();
1390             \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(\hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal}, \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantCreateThread ), 
      \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( error ), \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null});
1391         \} \textcolor{keywordflow}{else} \{
1392             th->th.th\_info.ds.ds\_thread = handle;
1393         \}
1394 
1395         \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1396     \}
1397 
1398     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_create\_worker: done creating thread (%d)\(\backslash\)n"}, gtid ) );
1399 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a6662ea431f75e592a8202c1af0637aff}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-disable@{\-\_\-\-\_\-kmp\-\_\-disable}}
\index{\-\_\-\-\_\-kmp\-\_\-disable@{\-\_\-\-\_\-kmp\-\_\-disable}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-disable}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-disable (
\begin{DoxyParamCaption}
\item[{{\bf int} $\ast$}]{old\-\_\-state}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a6662ea431f75e592a8202c1af0637aff}


Definition at line 299 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.


\begin{DoxyCode}
300 \{
301     *old\_state = 0;
302 
303     \textcolor{keywordflow}{if} (\hyperlink{z__Windows__NT__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime})
304         EnterCriticalSection( & \hyperlink{z__Windows__NT__util_8c_a2bc5381853ed1ae280d4d481b393f249}{\_\_kmp\_win32\_section} );
305 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_aa8475a433d18b95fcfaf4543146e2607}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-elapsed@{\-\_\-\-\_\-kmp\-\_\-elapsed}}
\index{\-\_\-\-\_\-kmp\-\_\-elapsed@{\-\_\-\-\_\-kmp\-\_\-elapsed}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-elapsed}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-elapsed (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{t}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_aa8475a433d18b95fcfaf4543146e2607}


Definition at line 1116 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-get\-\_\-load\-\_\-balance(), and F\-T\-N\-\_\-\-G\-E\-T\-\_\-\-W\-T\-I\-M\-E().


\begin{DoxyCode}
1117 \{
1118     BOOL \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1119     LARGE\_INTEGER now;
1120     status = QueryPerformanceCounter( & now );
1121     *t = ((double) now.QuadPart) * \hyperlink{z__Windows__NT__util_8c_a7d804e92be16ffc1446125dbe0b744d1}{\_\_kmp\_win32\_tick};
1122 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_ae03839bc0108d7b046aeab29b3700fe0}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-elapsed\-\_\-tick@{\-\_\-\-\_\-kmp\-\_\-elapsed\-\_\-tick}}
\index{\-\_\-\-\_\-kmp\-\_\-elapsed\-\_\-tick@{\-\_\-\-\_\-kmp\-\_\-elapsed\-\_\-tick}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-elapsed\-\_\-tick}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-elapsed\-\_\-tick (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{t}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_ae03839bc0108d7b046aeab29b3700fe0}


Definition at line 1127 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by F\-T\-N\-\_\-\-G\-E\-T\-\_\-\-W\-T\-I\-C\-K().


\begin{DoxyCode}
1128 \{
1129     *t = \hyperlink{z__Windows__NT__util_8c_a7d804e92be16ffc1446125dbe0b744d1}{\_\_kmp\_win32\_tick};
1130 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a2e5848b9f3322bf665ddc53ac090b69b}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-enable@{\-\_\-\-\_\-kmp\-\_\-enable}}
\index{\-\_\-\-\_\-kmp\-\_\-enable@{\-\_\-\-\_\-kmp\-\_\-enable}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-enable}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-enable (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{new\-\_\-state}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a2e5848b9f3322bf665ddc53ac090b69b}


Definition at line 292 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.


\begin{DoxyCode}
293 \{
294     \textcolor{keywordflow}{if} (\hyperlink{z__Windows__NT__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime})
295         LeaveCriticalSection( & \hyperlink{z__Windows__NT__util_8c_a2bc5381853ed1ae280d4d481b393f249}{\_\_kmp\_win32\_section} );
296 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_af0505501baee87e21f7dbb2993891051}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-exit\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-exit\-\_\-thread}}
\index{\-\_\-\-\_\-kmp\-\_\-exit\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-exit\-\_\-thread}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-exit\-\_\-thread}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-exit\-\_\-thread (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{exit\-\_\-status}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_af0505501baee87e21f7dbb2993891051}


Definition at line 1505 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.


\begin{DoxyCode}
1507   \{
1508     ExitThread( exit\_status );
1509 \} \textcolor{comment}{// \_\_kmp\_exit\_thread}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a0603ae87485cdde7a3a054e585f324fd}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-free\-\_\-handle@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-handle}}
\index{\-\_\-\-\_\-kmp\-\_\-free\-\_\-handle@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-handle}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-free\-\_\-handle}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-free\-\_\-handle (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-thread\-\_\-t}]{t\-Handle}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a0603ae87485cdde7a3a054e585f324fd}


Definition at line 1792 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-reap\-\_\-common(), \-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor(), \-\_\-\-\_\-kmp\-\_\-reset\-\_\-root(), \-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread(), and \-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-destroy().


\begin{DoxyCode}
1793 \{
1794 \textcolor{comment}{/* called with parameter type HANDLE also, thus suppose kmp\_thread\_t defined as HANDLE */}
1795     BOOL rc;
1796     rc = CloseHandle( tHandle );
1797     \textcolor{keywordflow}{if} ( !rc ) \{
1798         DWORD error = GetLastError();
1799         \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1800             \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
1801             \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantCloseHandle ),
1802             \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( error ),
1803             \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1804         );
1805     \}
1806 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a3944571fba6209a59491ca17998bfc5f}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-get\-\_\-load\-\_\-balance@{\-\_\-\-\_\-kmp\-\_\-get\-\_\-load\-\_\-balance}}
\index{\-\_\-\-\_\-kmp\-\_\-get\-\_\-load\-\_\-balance@{\-\_\-\-\_\-kmp\-\_\-get\-\_\-load\-\_\-balance}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-get\-\_\-load\-\_\-balance}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-get\-\_\-load\-\_\-balance (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{max}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a3944571fba6209a59491ca17998bfc5f}


Definition at line 1809 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.


\begin{DoxyCode}
1809                                   \{
1810 
1811     \textcolor{keyword}{static} ULONG glb\_buff\_size = 100 * 1024;
1812 
1813     \textcolor{keyword}{static} \textcolor{keywordtype}{int}     glb\_running\_threads  = 0;  \textcolor{comment}{/* Saved count of the running threads for the thread balance
       algortihm */}
1814     \textcolor{keyword}{static} \textcolor{keywordtype}{double}  glb\_call\_time        = 0;  \textcolor{comment}{/* Thread balance algorithm call time */}
1815 
1816     \textcolor{keywordtype}{int} running\_threads = 0;              \textcolor{comment}{// Number of running threads in the system.}
1817     NTSTATUS  \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status}        = 0;
1818     ULONG     buff\_size     = 0;
1819     ULONG     info\_size     = 0;
1820     \textcolor{keywordtype}{void} *    buffer        = NULL;
1821     \hyperlink{structSYSTEM__PROCESS__INFORMATION}{PSYSTEM\_PROCESS\_INFORMATION} spi = NULL;
1822     \textcolor{keywordtype}{int} first\_time          = 1;
1823 
1824     \textcolor{keywordtype}{double} call\_time = 0.0; \textcolor{comment}{//start, finish;}
1825 
1826     \hyperlink{z__Windows__NT__util_8c_aa8475a433d18b95fcfaf4543146e2607}{\_\_kmp\_elapsed}( & call\_time );
1827 
1828     \textcolor{keywordflow}{if} ( glb\_call\_time &&
1829             ( call\_time - glb\_call\_time < \_\_kmp\_load\_balance\_interval ) ) \{
1830         running\_threads = glb\_running\_threads;
1831         \textcolor{keywordflow}{goto} finish;
1832     \}
1833     glb\_call\_time = call\_time;
1834 
1835     \textcolor{comment}{// Do not spend time on running algorithm if we have a permanent error.}
1836     \textcolor{keywordflow}{if} ( \hyperlink{z__Windows__NT__util_8c_a57d2507b348b6039546c1ac06885c249}{NtQuerySystemInformation} == NULL ) \{
1837         running\_threads = -1;
1838         \textcolor{keywordflow}{goto} finish;
1839     \}; \textcolor{comment}{// if}
1840 
1841     \textcolor{keywordflow}{if} ( max <= 0 ) \{
1842         max = INT\_MAX;
1843     \}; \textcolor{comment}{// if}
1844 
1845     \textcolor{keywordflow}{do} \{
1846 
1847         \textcolor{keywordflow}{if} ( first\_time ) \{
1848             buff\_size = glb\_buff\_size;
1849         \} \textcolor{keywordflow}{else} \{
1850             buff\_size = 2 * buff\_size;
1851         \}
1852 
1853         buffer = \hyperlink{kmp_8h_a2a583866f3681a8c3f13222deec51af4}{KMP\_INTERNAL\_REALLOC}( buffer, buff\_size );
1854         \textcolor{keywordflow}{if} ( buffer == NULL ) \{
1855             running\_threads = -1;
1856             \textcolor{keywordflow}{goto} finish;
1857         \}; \textcolor{comment}{// if}
1858         status = \hyperlink{z__Windows__NT__util_8c_a57d2507b348b6039546c1ac06885c249}{NtQuerySystemInformation}( 
      \hyperlink{z__Windows__NT__util_8c_a65d6978d431075eba5186dd01b459c3ba824a4231749a2817cdfd82dd410df574}{SystemProcessInformation}, buffer, buff\_size, & info\_size );
1859         first\_time = 0;
1860 
1861     \} \textcolor{keywordflow}{while} ( status == STATUS\_INFO\_LENGTH\_MISMATCH );
1862     glb\_buff\_size = buff\_size;
1863 
1864 \textcolor{preprocessor}{    #define CHECK( cond )                       \(\backslash\)}
1865 \textcolor{preprocessor}{        \{                                       \(\backslash\)}
1866 \textcolor{preprocessor}{            KMP\_DEBUG\_ASSERT( cond );           \(\backslash\)}
1867 \textcolor{preprocessor}{            if ( ! ( cond ) ) \{                 \(\backslash\)}
1868 \textcolor{preprocessor}{                running\_threads = -1;           \(\backslash\)}
1869 \textcolor{preprocessor}{                goto finish;                    \(\backslash\)}
1870 \textcolor{preprocessor}{            \}                                   \(\backslash\)}
1871 \textcolor{preprocessor}{        \}}
1872 \textcolor{preprocessor}{}
1873     \hyperlink{z__Windows__NT__util_8c_aba1590ff86288c886c47dc8a27b30467}{CHECK}( buff\_size >= info\_size );
1874     spi = \hyperlink{z__Windows__NT__util_8c_a28ef81f3202a077b177206e3c281cd69}{PSYSTEM\_PROCESS\_INFORMATION}( buffer );
1875     \textcolor{keywordflow}{for} ( ; ; ) \{
1876         ptrdiff\_t offset = uintptr\_t( spi ) - uintptr\_t( buffer );
1877         \hyperlink{z__Windows__NT__util_8c_aba1590ff86288c886c47dc8a27b30467}{CHECK}( 0 <= offset && offset + \textcolor{keyword}{sizeof}( \hyperlink{structSYSTEM__PROCESS__INFORMATION}{SYSTEM\_PROCESS\_INFORMATION} ) 
      < info\_size );
1878         HANDLE pid = spi->\hyperlink{structSYSTEM__PROCESS__INFORMATION_a1c6313542629246fec2ba77d74f565df}{ProcessId};
1879         ULONG num = spi->\hyperlink{structSYSTEM__PROCESS__INFORMATION_a1c86fe94f67735d0688a533d32df3506}{NumberOfThreads};
1880         \hyperlink{z__Windows__NT__util_8c_aba1590ff86288c886c47dc8a27b30467}{CHECK}( num >= 1 );
1881         \textcolor{keywordtype}{size\_t} spi\_size = \textcolor{keyword}{sizeof}( \hyperlink{structSYSTEM__PROCESS__INFORMATION}{SYSTEM\_PROCESS\_INFORMATION} ) + \textcolor{keyword}{sizeof}( 
      \hyperlink{structSYSTEM__THREAD}{SYSTEM\_THREAD} ) * ( num - 1 );
1882         \hyperlink{z__Windows__NT__util_8c_aba1590ff86288c886c47dc8a27b30467}{CHECK}( offset + spi\_size < info\_size );          \textcolor{comment}{// Make sure process info record fits the
       buffer.}
1883         \textcolor{keywordflow}{if} ( spi->\hyperlink{structSYSTEM__PROCESS__INFORMATION_aa92576ae6698bea511915a7b14eafd7a}{NextEntryOffset} != 0 ) \{
1884             \hyperlink{z__Windows__NT__util_8c_aba1590ff86288c886c47dc8a27b30467}{CHECK}( spi\_size <= spi->NextEntryOffset );   \textcolor{comment}{// And do not overlap with the next record.}
1885         \}; \textcolor{comment}{// if}
1886         \textcolor{comment}{// pid == 0 corresponds to the System Idle Process. It always has running threads}
1887         \textcolor{comment}{// on all cores. So, we don't consider the running threads of this process.}
1888         \textcolor{keywordflow}{if} ( pid != 0 ) \{
1889             \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i} = 0; \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i} < num; ++ \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i} ) \{
1890                 \hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4}{THREAD\_STATE} state = spi->\hyperlink{structSYSTEM__PROCESS__INFORMATION_aac3fdc1ec643d605e0d072f9ac39fe5f}{Threads}[ \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i} ].\hyperlink{structSYSTEM__THREAD_ac2999f6615545dd16388e7d60280a456}{State};
1891                 \textcolor{comment}{// Count threads that have Ready or Running state.}
1892                 \textcolor{comment}{// !!! TODO: Why comment does not match the code???}
1893                 \textcolor{keywordflow}{if} ( state == \hyperlink{z__Windows__NT__util_8c_a39a3627827e25e3c5ab63a617bad3ad4a7deba990be536e1161bb5f6bf2a01f03}{StateRunning} ) \{
1894                     ++ running\_threads;
1895                     \textcolor{comment}{// Stop counting running threads if the number is already greater than}
1896                     \textcolor{comment}{// the number of available cores}
1897                     \textcolor{keywordflow}{if} ( running\_threads >= max ) \{
1898                         \textcolor{keywordflow}{goto} finish;
1899                     \}
1900                 \} \textcolor{comment}{// if}
1901             \}; \textcolor{comment}{// for i}
1902         \} \textcolor{comment}{// if}
1903         \textcolor{keywordflow}{if} ( spi->\hyperlink{structSYSTEM__PROCESS__INFORMATION_aa92576ae6698bea511915a7b14eafd7a}{NextEntryOffset} == 0 ) \{
1904             \textcolor{keywordflow}{break};
1905         \}; \textcolor{comment}{// if}
1906         spi = \hyperlink{z__Windows__NT__util_8c_a28ef81f3202a077b177206e3c281cd69}{PSYSTEM\_PROCESS\_INFORMATION}( uintptr\_t( spi ) + spi->
      \hyperlink{structSYSTEM__PROCESS__INFORMATION_aa92576ae6698bea511915a7b14eafd7a}{NextEntryOffset} );
1907     \}; \textcolor{comment}{// forever}
1908 
1909 \textcolor{preprocessor}{    #undef CHECK}
1910 \textcolor{preprocessor}{}
1911     finish: \textcolor{comment}{// Clean up and exit.}
1912 
1913         \textcolor{keywordflow}{if} ( buffer != NULL ) \{
1914             \hyperlink{kmp_8h_ac9035c424aa6f5daac89143f720e3848}{KMP\_INTERNAL\_FREE}( buffer );
1915         \}; \textcolor{comment}{// if}
1916 
1917         glb\_running\_threads = running\_threads;
1918 
1919         \textcolor{keywordflow}{return} running\_threads;
1920 
1921 \} \textcolor{comment}{//\_\_kmp\_get\_load\_balance()}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a48da78b5eda0063ee78eb8914a6b1673}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-get\-\_\-system\-\_\-affinity@{\-\_\-\-\_\-kmp\-\_\-get\-\_\-system\-\_\-affinity}}
\index{\-\_\-\-\_\-kmp\-\_\-get\-\_\-system\-\_\-affinity@{\-\_\-\-\_\-kmp\-\_\-get\-\_\-system\-\_\-affinity}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-get\-\_\-system\-\_\-affinity}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-get\-\_\-system\-\_\-affinity (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-affin\-\_\-mask\-\_\-t $\ast$}]{mask, }
\item[{{\bf int}}]{abort\-\_\-on\-\_\-error}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a48da78b5eda0063ee78eb8914a6b1673}


Definition at line 628 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.


\begin{DoxyCode}
629 \{
630 
631 \textcolor{preprocessor}{#if KMP\_GROUP\_AFFINITY}
632 \textcolor{preprocessor}{}
633     \textcolor{keywordflow}{if} (\_\_kmp\_num\_proc\_groups > 1) \{
634         KMP\_CPU\_ZERO(\hyperlink{ittnotify__static_8h_aa2c7de905e06240a7170f2a0da3a5abf}{mask});
635         GROUP\_AFFINITY ga;
636         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(\_\_kmp\_GetThreadGroupAffinity != NULL);
637 
638         \textcolor{keywordflow}{if} (\_\_kmp\_GetThreadGroupAffinity(GetCurrentThread(), &ga) == 0) \{
639             DWORD error = GetLastError();
640             \textcolor{keywordflow}{if} (abort\_on\_error) \{
641                 \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
642                     \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
643                     \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}(FunctionError, \textcolor{stringliteral}{"GetThreadGroupAffinity()"}),
644                     \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}(error),
645                     \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
646                 );
647             \}
648             \textcolor{keywordflow}{return} error;
649         \}
650 
651         \textcolor{keywordflow}{if} ((ga.Group < 0) || (ga.Group > \_\_kmp\_num\_proc\_groups)
652           || (ga.Mask == 0)) \{
653             \textcolor{keywordflow}{return} -1;
654         \}
655 
656         \hyperlink{ittnotify__static_8h_aa2c7de905e06240a7170f2a0da3a5abf}{mask}[ga.Group] = ga.Mask;
657     \}
658     \textcolor{keywordflow}{else}
659 
660 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_GROUP\_AFFINITY */}\textcolor{preprocessor}{}
661 \textcolor{preprocessor}{}
662     \{
663         kmp\_affin\_mask\_t newMask, sysMask, retval;
664 
665         \textcolor{keywordflow}{if} (!GetProcessAffinityMask(GetCurrentProcess(), &newMask, &sysMask)) \{
666             DWORD error = GetLastError();
667             \textcolor{keywordflow}{if} (abort\_on\_error) \{
668                 \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
669                     \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
670                     \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}(FunctionError, \textcolor{stringliteral}{"GetProcessAffinityMask()"}),
671                     \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}(error),
672                     \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
673                 );
674             \}
675             \textcolor{keywordflow}{return} error;
676         \}
677         retval = SetThreadAffinityMask(GetCurrentThread(), newMask);
678         \textcolor{keywordflow}{if} (! retval) \{
679             DWORD error = GetLastError();
680             \textcolor{keywordflow}{if} (abort\_on\_error) \{
681                 \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
682                     \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
683                     \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}(FunctionError, \textcolor{stringliteral}{"SetThreadAffinityMask()"}),
684                     \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}(error),
685                     \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
686                 );
687             \}
688             \textcolor{keywordflow}{return} error;
689         \}
690         newMask = SetThreadAffinityMask(GetCurrentThread(), retval);
691         \textcolor{keywordflow}{if} (! newMask) \{
692             DWORD error = GetLastError();
693             \textcolor{keywordflow}{if} (abort\_on\_error) \{
694                 \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
695                     \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
696                     \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}(FunctionError, \textcolor{stringliteral}{"SetThreadAffinityMask()"}),
697                     \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}(error),
698                     \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
699                 );
700             \}
701         \}
702         *\hyperlink{ittnotify__static_8h_aa2c7de905e06240a7170f2a0da3a5abf}{mask} = retval;
703     \}
704     \textcolor{keywordflow}{return} 0;
705 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a81e40765e4057689a8d5fa27b62ed76e}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-get\-\_\-specific@{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-get\-\_\-specific}}
\index{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-get\-\_\-specific@{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-get\-\_\-specific}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-get\-\_\-specific}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-gtid\-\_\-get\-\_\-specific (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a81e40765e4057689a8d5fa27b62ed76e}


Definition at line 518 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-get\-\_\-global\-\_\-thread\-\_\-id(), \-\_\-\-\_\-kmp\-\_\-get\-\_\-global\-\_\-thread\-\_\-id\-\_\-reg(), \-\_\-\-\_\-kmp\-\_\-internal\-\_\-end\-\_\-library(), \-\_\-\-\_\-kmp\-\_\-internal\-\_\-end\-\_\-thread(), \-\_\-\-\_\-kmp\-\_\-register\-\_\-root(), \-\_\-\-\_\-ompt\-\_\-thread\-\_\-assign\-\_\-wait\-\_\-id(), and ompt\-\_\-get\-\_\-thread().


\begin{DoxyCode}
519 \{
520     \textcolor{keywordtype}{int} gtid;
521     \textcolor{keywordflow}{if}( !\hyperlink{z__Windows__NT__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime} ) \{
522         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 50, (\textcolor{stringliteral}{"\_\_kmp\_get\_specific: runtime shutdown, returning KMP\_GTID\_SHUTDOWN\(\backslash\)n"} ) );
523         \textcolor{keywordflow}{return} \hyperlink{kmp_8h_a4f2fd385fbacda6b6de0ce54eb2dd028}{KMP\_GTID\_SHUTDOWN};
524     \}
525     gtid = (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int})(\hyperlink{kmp__os_8h_a43fe09095a192381a5e7c93d20a3a2f9}{kmp\_intptr\_t})TlsGetValue( 
      \hyperlink{kmp_8h_aae367e473107cb756f7f123b70d62efd}{\_\_kmp\_gtid\_threadprivate\_key} );
526     \textcolor{keywordflow}{if} ( gtid == 0 ) \{
527         gtid = \hyperlink{kmp_8h_afa6317d5d5bf13b0e47e5b8d2a04043d}{KMP\_GTID\_DNE};
528     \}
529     \textcolor{keywordflow}{else} \{
530         gtid--;
531     \}
532     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 50, (\textcolor{stringliteral}{"\_\_kmp\_gtid\_get\_specific: key:%d gtid:%d\(\backslash\)n"},
533                 \hyperlink{kmp_8h_aae367e473107cb756f7f123b70d62efd}{\_\_kmp\_gtid\_threadprivate\_key}, gtid ));
534     \textcolor{keywordflow}{return} gtid;
535 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_ae3492f3ab3c30ed2c204dc10e93c8471}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-set\-\_\-specific@{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-set\-\_\-specific}}
\index{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-set\-\_\-specific@{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-set\-\_\-specific}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-set\-\_\-specific}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-gtid\-\_\-set\-\_\-specific (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{gtid}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_ae3492f3ab3c30ed2c204dc10e93c8471}


Definition at line 508 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-internal\-\_\-end\-\_\-dest(), \-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor(), \-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker(), \-\_\-\-\_\-kmp\-\_\-register\-\_\-root(), and \-\_\-\-\_\-kmp\-\_\-unregister\-\_\-root\-\_\-current\-\_\-thread().


\begin{DoxyCode}
509 \{
510     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 50, (\textcolor{stringliteral}{"\_\_kmp\_gtid\_set\_specific: T#%d key:%d\(\backslash\)n"},
511                 gtid, \hyperlink{kmp_8h_aae367e473107cb756f7f123b70d62efd}{\_\_kmp\_gtid\_threadprivate\_key} ));
512     \hyperlink{kmp__debug_8h_a5323a368e8ba273b17c46906dd9ec78c}{KMP\_ASSERT}( \hyperlink{z__Windows__NT__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime} );
513     \textcolor{keywordflow}{if}( ! TlsSetValue( \hyperlink{kmp_8h_aae367e473107cb756f7f123b70d62efd}{\_\_kmp\_gtid\_threadprivate\_key}, (LPVOID)(gtid+1)) )
514         \hyperlink{kmp__i18n_8h_aaa06fec585285ef7883baea41bfd948f}{KMP\_FATAL}( TLSSetValueFailed );
515 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_afd7ef3df9b68039c9fb47ede46df4cf4}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-hardware\-\_\-timestamp@{\-\_\-\-\_\-kmp\-\_\-hardware\-\_\-timestamp}}
\index{\-\_\-\-\_\-kmp\-\_\-hardware\-\_\-timestamp@{\-\_\-\-\_\-kmp\-\_\-hardware\-\_\-timestamp}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-hardware\-\_\-timestamp}]{\setlength{\rightskip}{0pt plus 5cm}kmp\-\_\-uint64 \-\_\-\-\_\-kmp\-\_\-hardware\-\_\-timestamp (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_afd7ef3df9b68039c9fb47ede46df4cf4}


Definition at line 1782 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.


\begin{DoxyCode}
1783 \{
1784     kmp\_uint64 r = 0;
1785 
1786     QueryPerformanceCounter((LARGE\_INTEGER*) &r);
1787     \textcolor{keywordflow}{return} r;
1788 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a62b59839eaf67757384be830989a54ba}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-system\-\_\-tick@{\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-system\-\_\-tick}}
\index{\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-system\-\_\-tick@{\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-system\-\_\-tick}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-system\-\_\-tick}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-initialize\-\_\-system\-\_\-tick (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a62b59839eaf67757384be830989a54ba}


Definition at line 1090 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-register\-\_\-library\-\_\-startup(), and \-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize().


\begin{DoxyCode}
1091 \{
1092     \{
1093   BOOL \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1094   LARGE\_INTEGER freq;
1095 
1096   status = QueryPerformanceFrequency( & freq );
1097   \textcolor{keywordflow}{if} (! status) \{
1098         DWORD error = GetLastError();
1099         \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1100             \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
1101             \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( FunctionError, \textcolor{stringliteral}{"QueryPerformanceFrequency()"} ),
1102             \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( error ),
1103             \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1104         );
1105 
1106   \}
1107   \textcolor{keywordflow}{else} \{
1108       \hyperlink{z__Windows__NT__util_8c_a7d804e92be16ffc1446125dbe0b744d1}{\_\_kmp\_win32\_tick} = ((double) 1.0) / (double) freq.QuadPart;
1109   \}
1110     \}
1111 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a5676bfae90caed2d037a605382449d2c}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-is\-\_\-address\-\_\-mapped@{\-\_\-\-\_\-kmp\-\_\-is\-\_\-address\-\_\-mapped}}
\index{\-\_\-\-\_\-kmp\-\_\-is\-\_\-address\-\_\-mapped@{\-\_\-\-\_\-kmp\-\_\-is\-\_\-address\-\_\-mapped}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-is\-\_\-address\-\_\-mapped}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-is\-\_\-address\-\_\-mapped (
\begin{DoxyParamCaption}
\item[{{\bf void} $\ast$}]{addr}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a5676bfae90caed2d037a605382449d2c}


Definition at line 1767 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-register\-\_\-library\-\_\-startup().


\begin{DoxyCode}
1768 \{
1769     DWORD \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1770     MEMORY\_BASIC\_INFORMATION lpBuffer;
1771     SIZE\_T dwLength;
1772 
1773     dwLength = \textcolor{keyword}{sizeof}(MEMORY\_BASIC\_INFORMATION);
1774 
1775     status = VirtualQuery( \hyperlink{ittnotify__static_8h_a7e21c61c16fffcc27199a9d66ff39ab8}{addr}, &lpBuffer, dwLength );
1776 
1777     \textcolor{keywordflow}{return} !((( lpBuffer.State == MEM\_RESERVE) || ( lpBuffer.State == MEM\_FREE )) ||
1778        (( lpBuffer.Protect == PAGE\_NOACCESS ) || ( lpBuffer.Protect == PAGE\_EXECUTE )));
1779 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_ad4d0392f67428e1609f99892f0ba65cc}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-is\-\_\-thread\-\_\-alive@{\-\_\-\-\_\-kmp\-\_\-is\-\_\-thread\-\_\-alive}}
\index{\-\_\-\-\_\-kmp\-\_\-is\-\_\-thread\-\_\-alive@{\-\_\-\-\_\-kmp\-\_\-is\-\_\-thread\-\_\-alive}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-is\-\_\-thread\-\_\-alive}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-is\-\_\-thread\-\_\-alive (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{D\-W\-O\-R\-D $\ast$}]{exit\-\_\-val}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_ad4d0392f67428e1609f99892f0ba65cc}


Definition at line 1487 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-reap\-\_\-common(), and \-\_\-\-\_\-kmp\-\_\-wait\-\_\-to\-\_\-unref\-\_\-task\-\_\-teams().


\begin{DoxyCode}
1488 \{
1489     DWORD rc;
1490     rc = GetExitCodeThread( th->th.th\_info.ds.ds\_thread, exit\_val );
1491     \textcolor{keywordflow}{if} ( rc == 0 ) \{
1492         DWORD error = GetLastError();
1493         \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1494             \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
1495             \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( FunctionError, \textcolor{stringliteral}{"GetExitCodeThread()"} ),
1496             \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( error ),
1497             \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1498         );
1499     \}; \textcolor{comment}{// if}
1500     \textcolor{keywordflow}{return} ( *exit\_val == STILL\_ACTIVE );
1501 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_ae8e9572b3f3b44e352cd7d7891b693bb}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor@{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor}}
\index{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor@{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}$\ast$ \-\_\-\-\_\-stdcall \-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor (
\begin{DoxyParamCaption}
\item[{{\bf void} $\ast$}]{arg}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_ae8e9572b3f3b44e352cd7d7891b693bb}


Definition at line 1207 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor().


\begin{DoxyCode}
1208 \{
1209     DWORD        wait\_status;
1210     kmp\_thread\_t monitor;
1211     \textcolor{keywordtype}{int}          \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1212     \textcolor{keywordtype}{int}          interval;
1213     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *this\_thr = (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *) arg;
1214 
1215     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(\hyperlink{kmp_8h_a7837f92b7bc9827769108bb115d180e8}{\_\_kmp\_init\_monitor});
1216     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( \hyperlink{kmp_8h_a7837f92b7bc9827769108bb115d180e8}{\_\_kmp\_init\_monitor}, 2 );    \textcolor{comment}{// AC: Signal the library that monitor has
       started}
1217                                        \textcolor{comment}{// TODO: hide "2" in enum (like \{true,false,started\})}
1218     this\_thr -> th.th\_info.ds.ds\_thread\_id = GetCurrentThreadId();
1219     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( this\_thr -> th.th\_info.ds.ds\_alive, \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} );
1220 
1221     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1222     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_launch\_monitor: launched\(\backslash\)n"} ) );
1223 
1224     monitor = GetCurrentThread();
1225 
1226     \textcolor{comment}{/* set thread priority */}
1227     status = SetThreadPriority( monitor, THREAD\_PRIORITY\_HIGHEST );
1228     \textcolor{keywordflow}{if} (! status) \{
1229         DWORD error = GetLastError();
1230         \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1231             \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
1232             \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantSetThreadPriority ),
1233             \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( error ),
1234             \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1235         );
1236     \}
1237 
1238     \textcolor{comment}{/* register us as monitor */}
1239     \hyperlink{z__Windows__NT__util_8c_ae3492f3ab3c30ed2c204dc10e93c8471}{\_\_kmp\_gtid\_set\_specific}( \hyperlink{kmp_8h_a5eb958603bc237a3484be5bd2b0de39a}{KMP\_GTID\_MONITOR} );
1240 \textcolor{preprocessor}{#ifdef KMP\_TDATA\_GTID}
1241 \textcolor{preprocessor}{}\textcolor{preprocessor}{    #error "This define causes problems with LoadLibrary() + declspec(thread) " \(\backslash\)}
1242 \textcolor{preprocessor}{        "on Windows* OS.  See CQ50564, tests kmp\_load\_library*.c and this MSDN " \(\backslash\)}
1243 \textcolor{preprocessor}{        "reference: http://support.microsoft.com/kb/118816"}
1244 \textcolor{preprocessor}{}    \textcolor{comment}{//\_\_kmp\_gtid = KMP\_GTID\_MONITOR;}
1245 \textcolor{preprocessor}{#endif}
1246 \textcolor{preprocessor}{}
1247 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1248 \textcolor{preprocessor}{}    \_\_kmp\_itt\_thread\_ignore();    \textcolor{comment}{// Instruct Intel(R) Threading Tools to ignore monitor thread.}
1249 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1250 \textcolor{preprocessor}{}
1251     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1252 
1253     interval = ( 1000 / \hyperlink{kmp_8h_a1171057a79f5a42e26d0bd84f6cd707b}{\_\_kmp\_monitor\_wakeups} ); \textcolor{comment}{/* in milliseconds */}
1254 
1255     \textcolor{keywordflow}{while} (! \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(\hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_done)) \{
1256         \textcolor{comment}{/*  This thread monitors the state of the system */}
1257 
1258         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 15, ( \textcolor{stringliteral}{"\_\_kmp\_launch\_monitor: update\(\backslash\)n"} ) );
1259 
1260         wait\_status = WaitForSingleObject( \hyperlink{z__Windows__NT__util_8c_a9603a8d81356b569383be9f81d491a94}{\_\_kmp\_monitor\_ev}, interval );
1261 
1262         \textcolor{keywordflow}{if} (wait\_status == WAIT\_TIMEOUT) \{
1263             \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_time.dt.t\_value,
1264               \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}( \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_time.dt.t\_value ) + 1 );
1265         \}
1266 
1267         \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1268     \}
1269 
1270     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_launch\_monitor: finished\(\backslash\)n"} ) );
1271 
1272     status = SetThreadPriority( monitor, THREAD\_PRIORITY\_NORMAL );
1273     \textcolor{keywordflow}{if} (! status) \{
1274         DWORD error = GetLastError();
1275         \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1276             \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
1277             \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantSetThreadPriority ),
1278             \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( error ),
1279             \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1280         );
1281     \}
1282 
1283     \textcolor{keywordflow}{if} (\hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_abort != 0) \{
1284         \textcolor{comment}{/* now we need to terminate the worker threads   */}
1285         \textcolor{comment}{/* the value of t\_abort is the signal we caught */}
1286 
1287         \textcolor{keywordtype}{int} gtid;
1288 
1289         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_launch\_monitor: terminate sig=%d\(\backslash\)n"}, (
      \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_abort) ) );
1290 
1291         \textcolor{comment}{/* terminate the OpenMP worker threads */}
1292         \textcolor{comment}{/* TODO this is not valid for sibling threads!!}
1293 \textcolor{comment}{         * the uber master might not be 0 anymore.. */}
1294         \textcolor{keywordflow}{for} (gtid = 1; gtid < \hyperlink{kmp_8h_acae0af8cf6e8a8367b389986b372ab0a}{\_\_kmp\_threads\_capacity}; ++gtid)
1295             \hyperlink{z__Windows__NT__util_8c_a9c1e0ffcb1e7c87e5429269dc6c6c0bf}{\_\_kmp\_terminate\_thread}( gtid );
1296 
1297         \hyperlink{kmp_8h_afb0978e7a9bd0e5f91d089c4571e618f}{\_\_kmp\_cleanup}();
1298 
1299         Sleep( 0 );
1300 
1301         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_launch\_monitor: raise sig=%d\(\backslash\)n"}, (
      \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_abort) ) );
1302 
1303         \textcolor{keywordflow}{if} (\hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_abort > 0) \{
1304             \textcolor{keyword}{raise}( \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_abort );
1305         \}
1306     \}
1307 
1308     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( this\_thr -> th.th\_info.ds.ds\_alive, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE} );
1309 
1310     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();
1311     \textcolor{keywordflow}{return} arg;
1312 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a8391d11849c8dcf778d4b52df820622f}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker@{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker}}
\index{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker@{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}$\ast$ \-\_\-\-\_\-stdcall \-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker (
\begin{DoxyParamCaption}
\item[{{\bf void} $\ast$}]{arg}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a8391d11849c8dcf778d4b52df820622f}


Definition at line 1150 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-create\-\_\-worker().


\begin{DoxyCode}
1151 \{
1152     \textcolor{keyword}{volatile} \textcolor{keywordtype}{void} *stack\_data;
1153     \textcolor{keywordtype}{void} *exit\_val;
1154     \textcolor{keywordtype}{void} *padding = 0;
1155     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *this\_thr = (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *) arg;
1156     \textcolor{keywordtype}{int} gtid;
1157 
1158     gtid = this\_thr->th.th\_info.ds.ds\_gtid;
1159     \hyperlink{z__Windows__NT__util_8c_ae3492f3ab3c30ed2c204dc10e93c8471}{\_\_kmp\_gtid\_set\_specific}( gtid );
1160 \textcolor{preprocessor}{#ifdef KMP\_TDATA\_GTID}
1161 \textcolor{preprocessor}{}\textcolor{preprocessor}{    #error "This define causes problems with LoadLibrary() + declspec(thread) " \(\backslash\)}
1162 \textcolor{preprocessor}{        "on Windows* OS.  See CQ50564, tests kmp\_load\_library*.c and this MSDN " \(\backslash\)}
1163 \textcolor{preprocessor}{        "reference: http://support.microsoft.com/kb/118816"}
1164 \textcolor{preprocessor}{}    \textcolor{comment}{//\_\_kmp\_gtid = gtid;}
1165 \textcolor{preprocessor}{#endif}
1166 \textcolor{preprocessor}{}
1167 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1168 \textcolor{preprocessor}{}    \_\_kmp\_itt\_thread\_name( gtid );
1169 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1170 \textcolor{preprocessor}{}
1171     \_\_kmp\_affinity\_set\_init\_mask( gtid, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE} );
1172 
1173 \textcolor{preprocessor}{#if KMP\_ARCH\_X86 || KMP\_ARCH\_X86\_64}
1174 \textcolor{preprocessor}{}    \textcolor{comment}{//}
1175     \textcolor{comment}{// Set the FP control regs to be a copy of}
1176     \textcolor{comment}{// the parallel initialization thread's.}
1177     \textcolor{comment}{//}
1178     \_\_kmp\_clear\_x87\_fpu\_status\_word();
1179     \_\_kmp\_load\_x87\_fpu\_control\_word( &\_\_kmp\_init\_x87\_fpu\_control\_word );
1180     \_\_kmp\_load\_mxcsr( &\_\_kmp\_init\_mxcsr );
1181 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_ARCH\_X86 || KMP\_ARCH\_X86\_64 */}\textcolor{preprocessor}{}
1182 \textcolor{preprocessor}{}
1183     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ac841e4743aeceae5d3667bc8511ba1c4}{\_\_kmp\_stkoffset} > 0 && gtid > 0 ) \{
1184         padding = \hyperlink{kmp__safe__c__api_8h_a2280690d07037589e6ac2faf9e9a2b28}{KMP\_ALLOCA}( gtid * \hyperlink{kmp_8h_ac841e4743aeceae5d3667bc8511ba1c4}{\_\_kmp\_stkoffset} );
1185     \}
1186 
1187     \hyperlink{kmp__itt_8h_a321c5d523f392e432350caffc38aecee}{KMP\_FSYNC\_RELEASING}( &this\_thr -> th.th\_info.ds.ds\_alive );
1188     this\_thr -> th.th\_info.ds.ds\_thread\_id = GetCurrentThreadId();
1189     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( this\_thr -> th.th\_info.ds.ds\_alive, \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} );
1190 
1191     \textcolor{keywordflow}{if} ( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(\hyperlink{kmp_8h_ae8d713bc264db1f092c97ca94f3b82bc}{\_\_kmp\_gtid\_mode}) < 2 ) \{ \textcolor{comment}{// check stack only if it is used to get gtid}
1192         \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(this\_thr->th.th\_info.ds.ds\_stackbase, &stack\_data);
1193         \hyperlink{kmp__debug_8h_a5323a368e8ba273b17c46906dd9ec78c}{KMP\_ASSERT}( this\_thr -> th.th\_info.ds.ds\_stackgrow == \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE} );
1194         \hyperlink{kmp_8h_a21152135e5447d443b8f803bb6437639}{\_\_kmp\_check\_stack\_overlap}( this\_thr );
1195     \}
1196     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();
1197     exit\_val = \hyperlink{kmp_8h_ac88c1daa6b7e9e9b51a3a1510dca73ca}{\_\_kmp\_launch\_thread}( this\_thr );
1198     \hyperlink{kmp__itt_8h_a321c5d523f392e432350caffc38aecee}{KMP\_FSYNC\_RELEASING}( &this\_thr -> th.th\_info.ds.ds\_alive );
1199     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( this\_thr -> th.th\_info.ds.ds\_alive, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE} );
1200     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();
1201     \textcolor{keywordflow}{return} exit\_val;
1202 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a59bfe9c94177c19907c3f28bf3daf4a3}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-read\-\_\-cpu\-\_\-time@{\-\_\-\-\_\-kmp\-\_\-read\-\_\-cpu\-\_\-time}}
\index{\-\_\-\-\_\-kmp\-\_\-read\-\_\-cpu\-\_\-time@{\-\_\-\-\_\-kmp\-\_\-read\-\_\-cpu\-\_\-time}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-read\-\_\-cpu\-\_\-time}]{\setlength{\rightskip}{0pt plus 5cm}double \-\_\-\-\_\-kmp\-\_\-read\-\_\-cpu\-\_\-time (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a59bfe9c94177c19907c3f28bf3daf4a3}


Definition at line 771 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.


\begin{DoxyCode}
772 \{
773     FILETIME    CreationTime, ExitTime, KernelTime, UserTime;
774     \textcolor{keywordtype}{int}         \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
775     \textcolor{keywordtype}{double}      cpu\_time;
776 
777     cpu\_time = 0;
778 
779     status = GetProcessTimes( GetCurrentProcess(), &CreationTime,
780                               &ExitTime, &KernelTime, &UserTime );
781 
782     \textcolor{keywordflow}{if} (status) \{
783         \textcolor{keywordtype}{double}  sec = 0;
784 
785         sec += KernelTime.dwHighDateTime;
786         sec += UserTime.dwHighDateTime;
787 
788         \textcolor{comment}{/* Shift left by 32 bits */}
789         sec *= (double) (1 << 16) * (double) (1 << 16);
790 
791         sec += KernelTime.dwLowDateTime;
792         sec += UserTime.dwLowDateTime;
793 
794         cpu\_time += (sec * 100.0) / \hyperlink{kmp_8h_ac64cdddad1dbb1452f49fa91f5b10931}{KMP\_NSEC\_PER\_SEC};
795     \}
796 
797     \textcolor{keywordflow}{return} cpu\_time;
798 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_ab8f6d039c9b836fa9a1ec3b3987817a7}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-info@{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-info}}
\index{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-info@{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-info}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-info}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-info (
\begin{DoxyParamCaption}
\item[{struct {\bf kmp\-\_\-sys\-\_\-info} $\ast$}]{info}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_ab8f6d039c9b836fa9a1ec3b3987817a7}


Definition at line 801 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.


\begin{DoxyCode}
802 \{
803     info->\hyperlink{structkmp__sys__info_af2816624ab3d81d5955b91761aa533fa}{maxrss}  = 0;                   \textcolor{comment}{/* the maximum resident set size utilized (in kilobytes)    
       */}
804     info->\hyperlink{structkmp__sys__info_a02a36302bc462405fae7b4d7309a7370}{minflt}  = 0;                   \textcolor{comment}{/* the number of page faults serviced without any I/O       
       */}
805     info->\hyperlink{structkmp__sys__info_a2831ec7e3cd6546b2e04cfc9afe2c2cf}{majflt}  = 0;                   \textcolor{comment}{/* the number of page faults serviced that required I/O     
       */}
806     info->\hyperlink{structkmp__sys__info_aba9c0c66063cc7bdba0b84d87f90b25b}{nswap}   = 0;                   \textcolor{comment}{/* the number of times a process was "swapped" out of memory 
      */}
807     info->\hyperlink{structkmp__sys__info_a0ce85c6a66e6805ed1a8948e7f19d79f}{inblock} = 0;                   \textcolor{comment}{/* the number of times the file system had to perform input
        */}
808     info->\hyperlink{structkmp__sys__info_ab55bb38f87dbda622851940106f8a1c0}{oublock} = 0;                   \textcolor{comment}{/* the number of times the file system had to perform
       output */}
809     info->\hyperlink{structkmp__sys__info_a82b3d7c37a16144f173a69624ef27057}{nvcsw}   = 0;                   \textcolor{comment}{/* the number of times a context switch was voluntarily      
      */}
810     info->\hyperlink{structkmp__sys__info_ac7e30691b19415226d39bd4ed92af7a6}{nivcsw}  = 0;                   \textcolor{comment}{/* the number of times a context switch was forced          
       */}
811 
812     \textcolor{keywordflow}{return} 1;
813 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a1f49d8ebe9ab3485ce41c35d80d202d5}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time@{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time}}
\index{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time@{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{delta}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a1f49d8ebe9ab3485ce41c35d80d202d5}


Definition at line 1133 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-register\-\_\-library\-\_\-startup().


\begin{DoxyCode}
1134 \{
1135     \textcolor{keywordflow}{if} (delta != NULL) \{
1136         BOOL \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1137         LARGE\_INTEGER now;
1138 
1139         status = QueryPerformanceCounter( & now );
1140 
1141         *delta = ((double) (((kmp\_int64) now.QuadPart) - \hyperlink{z__Windows__NT__util_8c_afd6cc2ba15915e1f3ff7182c4714b89b}{\_\_kmp\_win32\_time}))
1142     * \hyperlink{z__Windows__NT__util_8c_a7d804e92be16ffc1446125dbe0b744d1}{\_\_kmp\_win32\_tick};
1143     \}
1144 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_aad3fc7c38b06f31fd4806da45cc3ea28}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-reap\-\_\-common@{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-common}}
\index{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-common@{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-common}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-common}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-reap\-\_\-common (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Windows__NT__util_8c_aad3fc7c38b06f31fd4806da45cc3ea28}


Definition at line 1515 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor(), and \-\_\-\-\_\-kmp\-\_\-reap\-\_\-worker().


\begin{DoxyCode}
1516 \{
1517     DWORD exit\_val;
1518 
1519     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1520 
1521     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_reap\_common: try to reap (%d)\(\backslash\)n"}, th->th.th\_info.ds.ds\_gtid ) );
1522 
1523     \textcolor{comment}{/*}
1524 \textcolor{comment}{        2006-10-19:}
1525 \textcolor{comment}{}
1526 \textcolor{comment}{        There are two opposite situations:}
1527 \textcolor{comment}{}
1528 \textcolor{comment}{            1. Windows* OS keep thread alive after it resets ds\_alive flag and exits from thread}
1529 \textcolor{comment}{               function. (For example, see C70770/Q394281 "unloading of dll based on OMP is very}
1530 \textcolor{comment}{               slow".)}
1531 \textcolor{comment}{            2. Windows* OS may kill thread before it resets ds\_alive flag.}
1532 \textcolor{comment}{}
1533 \textcolor{comment}{        Right solution seems to be waiting for *either* thread termination *or* ds\_alive resetting.}
1534 \textcolor{comment}{}
1535 \textcolor{comment}{    */}
1536 
1537     \{
1538         \textcolor{comment}{// TODO: This code is very similar to KMP\_WAIT\_YIELD. Need to generalize KMP\_WAIT\_YIELD to}
1539         \textcolor{comment}{// cover this usage also.}
1540         \textcolor{keywordtype}{void} * obj = NULL;
1541         \textcolor{keyword}{register} kmp\_uint32 spins;
1542 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1543 \textcolor{preprocessor}{}        \hyperlink{kmp__itt_8h_ae9ed9a1ec697c0049760eee81cf6521a}{KMP\_FSYNC\_SPIN\_INIT}( obj, (\textcolor{keywordtype}{void}*) & th->th.th\_info.ds.ds\_alive );
1544 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1545 \textcolor{preprocessor}{}        \hyperlink{kmp_8h_a98cb21bfd34ebd451007a151f135b31c}{KMP\_INIT\_YIELD}( spins );
1546         \textcolor{keywordflow}{do} \{
1547 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1548 \textcolor{preprocessor}{}            \hyperlink{kmp__itt_8h_aadbbcf10e55850897e6d495729925851}{KMP\_FSYNC\_SPIN\_PREPARE}( obj );
1549 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1550 \textcolor{preprocessor}{}            \hyperlink{z__Windows__NT__util_8c_ad4d0392f67428e1609f99892f0ba65cc}{\_\_kmp\_is\_thread\_alive}( th, &exit\_val );
1551             \hyperlink{kmp_8h_a9f0d88d1970adda4ad38d272e65d7844}{KMP\_YIELD}( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(\hyperlink{kmp_8h_a774ce85ac109df119feaca45ed4e69b1}{\_\_kmp\_nth}) > 
      \hyperlink{kmp_8h_adc73a89e0c77c9b0a3233f9fde48a5b2}{\_\_kmp\_avail\_proc} );
1552             \hyperlink{kmp_8h_a0b31ac108fea7d8034ea5145d74a7a77}{KMP\_YIELD\_SPIN}( spins );
1553         \} \textcolor{keywordflow}{while} ( exit\_val == STILL\_ACTIVE && \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}( th->th.th\_info.ds.ds\_alive ) );
1554 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1555 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( exit\_val == STILL\_ACTIVE ) \{
1556             \hyperlink{kmp__itt_8h_aa8cf149431c98cd5b625e389f637e29f}{KMP\_FSYNC\_CANCEL}( obj );
1557         \} \textcolor{keywordflow}{else} \{
1558             \hyperlink{kmp__itt_8h_a580841033d05175a7d1d36d91bdb9267}{KMP\_FSYNC\_SPIN\_ACQUIRED}( obj );
1559         \}; \textcolor{comment}{// if}
1560 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1561 \textcolor{preprocessor}{}    \}
1562 
1563     \hyperlink{z__Windows__NT__util_8c_a0603ae87485cdde7a3a054e585f324fd}{\_\_kmp\_free\_handle}( th->th.th\_info.ds.ds\_thread );
1564 
1565     \textcolor{comment}{/*}
1566 \textcolor{comment}{     * NOTE:  The ExitProcess(code) system call causes all threads to Terminate}
1567 \textcolor{comment}{     *        with a exit\_val = code.  Because of this we can not rely on}
1568 \textcolor{comment}{     *        exit\_val having any particular value.}
1569 \textcolor{comment}{     */}
1570     \textcolor{keywordflow}{if} ( exit\_val == STILL\_ACTIVE ) \{
1571         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 1, ( \textcolor{stringliteral}{"\_\_kmp\_reap\_common: thread still active.\(\backslash\)n"} ) );
1572     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (\textcolor{keywordtype}{void} *) exit\_val != (\textcolor{keywordtype}{void} *) th) \{
1573         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 1, ( \textcolor{stringliteral}{"\_\_kmp\_reap\_common: ExitProcess / TerminateThread used?\(\backslash\)n"} ) );
1574     \}; \textcolor{comment}{// if}
1575 
1576     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10,
1577         (
1578             \textcolor{stringliteral}{"\_\_kmp\_reap\_common: done reaping (%d), handle = %"} \hyperlink{kmp__os_8h_a716dd0090b3c62cb5a8203b27846585e}{KMP\_UINTPTR\_SPEC} \textcolor{stringliteral}{"\(\backslash\)n"},
1579             th->th.th\_info.ds.ds\_gtid,
1580             th->th.th\_info.ds.ds\_thread
1581         )
1582     );
1583 
1584     th->th.th\_info.ds.ds\_thread    = 0;
1585     th->th.th\_info.ds.ds\_tid       = \hyperlink{kmp_8h_afa6317d5d5bf13b0e47e5b8d2a04043d}{KMP\_GTID\_DNE};
1586     th->th.th\_info.ds.ds\_gtid      = \hyperlink{kmp_8h_afa6317d5d5bf13b0e47e5b8d2a04043d}{KMP\_GTID\_DNE};
1587     th->th.th\_info.ds.ds\_thread\_id = 0;
1588 
1589     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1590 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a6f1cbadac27343041f6bb97e0ab76c69}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor@{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor}}
\index{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor@{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a6f1cbadac27343041f6bb97e0ab76c69}


Definition at line 1593 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-internal\-\_\-end().


\begin{DoxyCode}
1594 \{
1595     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1596 
1597     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_reap\_monitor: try to reap %p\(\backslash\)n"},
1598                    (\textcolor{keywordtype}{void} *) th->th.th\_info.ds.ds\_thread ) );
1599 
1600     \textcolor{comment}{// If monitor has been created, its tid and gtid should be KMP\_GTID\_MONITOR.}
1601     \textcolor{comment}{// If both tid and gtid are 0, it means the monitor did not ever start.}
1602     \textcolor{comment}{// If both tid and gtid are KMP\_GTID\_DNE, the monitor has been shut down.}
1603     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( th->th.th\_info.ds.ds\_tid == th->th.th\_info.ds.ds\_gtid );
1604     \textcolor{keywordflow}{if} ( th->th.th\_info.ds.ds\_gtid != \hyperlink{kmp_8h_a5eb958603bc237a3484be5bd2b0de39a}{KMP\_GTID\_MONITOR} ) \{
1605         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_reap\_monitor: monitor did not start, returning\(\backslash\)n"}) );
1606         \textcolor{keywordflow}{return};
1607     \}; \textcolor{comment}{// if}
1608 
1609     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1610 
1611     status = SetEvent( \hyperlink{z__Windows__NT__util_8c_a9603a8d81356b569383be9f81d491a94}{\_\_kmp\_monitor\_ev} );
1612     \textcolor{keywordflow}{if} ( status == \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE} ) \{
1613         DWORD error = GetLastError();
1614         \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1615             \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
1616             \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantSetEvent ),
1617             \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( error ),
1618             \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1619         );
1620     \}
1621     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_reap\_monitor: reaping thread (%d)\(\backslash\)n"}, th->th.th\_info.ds.ds\_gtid ) );
1622     \hyperlink{z__Windows__NT__util_8c_aad3fc7c38b06f31fd4806da45cc3ea28}{\_\_kmp\_reap\_common}( th );
1623 
1624     \hyperlink{z__Windows__NT__util_8c_a0603ae87485cdde7a3a054e585f324fd}{\_\_kmp\_free\_handle}( \hyperlink{z__Windows__NT__util_8c_a9603a8d81356b569383be9f81d491a94}{\_\_kmp\_monitor\_ev} );
1625 
1626     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1627 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_af9e43e476cd1e6220df32409d2025761}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-reap\-\_\-worker@{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-worker}}
\index{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-worker@{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-worker}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-worker}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-reap\-\_\-worker (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_af9e43e476cd1e6220df32409d2025761}


Definition at line 1630 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-reap\-\_\-thread().


\begin{DoxyCode}
1631 \{
1632     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_reap\_worker: reaping thread (%d)\(\backslash\)n"}, th->th.th\_info.ds.ds\_gtid ) );
1633     \hyperlink{z__Windows__NT__util_8c_aad3fc7c38b06f31fd4806da45cc3ea28}{\_\_kmp\_reap\_common}( th );
1634 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_acfe9e02a35d4e38951a53bd689ca2141}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-resume\-\_\-32@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-32}}
\index{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-32@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-32}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-32}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-resume\-\_\-32 (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{target\-\_\-gtid, }
\item[{{\bf kmp\-\_\-flag\-\_\-32} $\ast$}]{flag}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_acfe9e02a35d4e38951a53bd689ca2141}


Definition at line 483 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-null\-\_\-resume\-\_\-wrapper(), and kmp\-\_\-flag\-\_\-32\-::resume().


\begin{DoxyCode}
483                                                          \{
484     \hyperlink{z__Windows__NT__util_8c_ab156558ea905954294188d1395cb2848}{\_\_kmp\_resume\_template}(target\_gtid, flag);
485 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a6d3052650a7678516a888600044b6d63}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-resume\-\_\-64@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-64}}
\index{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-64@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-64}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-64}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-resume\-\_\-64 (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{target\-\_\-gtid, }
\item[{{\bf kmp\-\_\-flag\-\_\-64} $\ast$}]{flag}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a6d3052650a7678516a888600044b6d63}


Definition at line 486 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-null\-\_\-resume\-\_\-wrapper(), and kmp\-\_\-flag\-\_\-64\-::resume().


\begin{DoxyCode}
486                                                          \{
487     \hyperlink{z__Windows__NT__util_8c_ab156558ea905954294188d1395cb2848}{\_\_kmp\_resume\_template}(target\_gtid, flag);
488 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_ace5ec17d5fee86980dead25d07a595d9}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore}}
\index{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{target\-\_\-gtid, }
\item[{{\bf kmp\-\_\-flag\-\_\-oncore} $\ast$}]{flag}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_ace5ec17d5fee86980dead25d07a595d9}


Definition at line 489 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-null\-\_\-resume\-\_\-wrapper(), and kmp\-\_\-flag\-\_\-oncore\-::resume().


\begin{DoxyCode}
489                                                                  \{
490     \hyperlink{z__Windows__NT__util_8c_ab156558ea905954294188d1395cb2848}{\_\_kmp\_resume\_template}(target\_gtid, flag);
491 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_ab156558ea905954294188d1395cb2848}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-resume\-\_\-template@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-template}}
\index{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-template@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-template}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-template}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class C $>$ static {\bf void} \-\_\-\-\_\-kmp\-\_\-resume\-\_\-template (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{target\-\_\-gtid, }
\item[{C $\ast$}]{flag}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{z__Windows__NT__util_8c_ab156558ea905954294188d1395cb2848}


Definition at line 436 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-resume\-\_\-32(), \-\_\-\-\_\-kmp\-\_\-resume\-\_\-64(), and \-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore().


\begin{DoxyCode}
437 \{
438     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *th = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[target\_gtid];
439     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
440 
441 \textcolor{preprocessor}{#ifdef KMP\_DEBUG}
442 \textcolor{preprocessor}{}    \textcolor{keywordtype}{int} gtid = \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(\hyperlink{kmp_8h_a3f91f5b94048484e40c6caeb66c60f27}{\_\_kmp\_init\_gtid}) ? \hyperlink{kmp_8h_ad9b4e1a8a911f57a29a75f7536e5200c}{\_\_kmp\_get\_gtid}() : -1;
443 \textcolor{preprocessor}{#endif}
444 \textcolor{preprocessor}{}
445     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 30, ( \textcolor{stringliteral}{"\_\_kmp\_resume\_template: T#%d wants to wakeup T#%d enter\(\backslash\)n"}, gtid, target\_gtid )
       );
446 
447     \hyperlink{z__Windows__NT__util_8c_a3cbd436ba7abef35400b2939a597025e}{\_\_kmp\_suspend\_initialize\_thread}( th );
448     \hyperlink{z__Windows__NT__util_8c_a1b3aab743814b71e420faff607d941d1}{\_\_kmp\_win32\_mutex\_lock}( &th->th.th\_suspend\_mx );
449 
450     \textcolor{keywordflow}{if} (!flag) \{ \textcolor{comment}{// coming from \_\_kmp\_null\_resume\_wrapper}
451         flag = (C *)th->th.th\_sleep\_loc;
452     \}
453 
454     \textcolor{comment}{// First, check if the flag is null or its type has changed. If so, someone else woke it up.}
455     \textcolor{keywordflow}{if} (!flag || flag->get\_type() != flag->get\_ptr\_type()) \{ \textcolor{comment}{// get\_ptr\_type simply shows what flag was
       cast to}
456         \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 5, ( \textcolor{stringliteral}{"\_\_kmp\_resume\_template: T#%d exiting, thread T#%d already awake: flag's
       loc(%p)\(\backslash\)n"},
457                        gtid, target\_gtid, NULL ) );
458         \hyperlink{z__Windows__NT__util_8c_a05597f57992f97794d11b4a470191906}{\_\_kmp\_win32\_mutex\_unlock}( &th->th.th\_suspend\_mx );
459         \textcolor{keywordflow}{return};
460     \}
461     \textcolor{keywordflow}{else} \{
462         \textcolor{keyword}{typename} C::flag\_t old\_spin = flag->unset\_sleeping();
463         \textcolor{keywordflow}{if} ( !flag->is\_sleeping\_val(old\_spin) ) \{
464             \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 5, ( \textcolor{stringliteral}{"\_\_kmp\_resume\_template: T#%d exiting, thread T#%d already awake: flag's
       loc(%p): "}
465                            \textcolor{stringliteral}{"%u => %u\(\backslash\)n"},
466                            gtid, target\_gtid, flag->get(), old\_spin, *(flag->get()) ) );
467             \hyperlink{z__Windows__NT__util_8c_a05597f57992f97794d11b4a470191906}{\_\_kmp\_win32\_mutex\_unlock}( &th->th.th\_suspend\_mx );
468             \textcolor{keywordflow}{return};
469         \}
470     \}
471     \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(th->th.th\_sleep\_loc, NULL);
472 
473     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 5, ( \textcolor{stringliteral}{"\_\_kmp\_resume\_template: T#%d about to wakeup T#%d, reset sleep bit for flag's
       loc(%p)\(\backslash\)n"},
474                    gtid, target\_gtid, flag->get() ) );
475 
476     \hyperlink{z__Windows__NT__util_8c_a6ae31d8afd60c4195a36fa2badbcb2ae}{\_\_kmp\_win32\_cond\_signal}(  &th->th.th\_suspend\_cv );
477     \hyperlink{z__Windows__NT__util_8c_a05597f57992f97794d11b4a470191906}{\_\_kmp\_win32\_mutex\_unlock}( &th->th.th\_suspend\_mx );
478 
479     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 30, ( \textcolor{stringliteral}{"\_\_kmp\_resume\_template: T#%d exiting after signaling wake up for T#%d\(\backslash\)n"},
480                     gtid, target\_gtid ) );
481 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_ab5834eff1e783726ba2a6a32133617cc}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy@{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy}}
\index{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy@{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_ab5834eff1e783726ba2a6a32133617cc}


Definition at line 1025 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-cleanup().


\begin{DoxyCode}
1026 \{
1027     \textcolor{keywordflow}{if} ( ! \hyperlink{z__Windows__NT__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime} ) \{
1028         \textcolor{keywordflow}{return};
1029     \}
1030 
1031 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1032 \textcolor{preprocessor}{}    \_\_kmp\_itt\_destroy();
1033 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1034 \textcolor{preprocessor}{}
1035     \textcolor{comment}{/* we can't DeleteCriticalsection( & \_\_kmp\_win32\_section ); */}
1036     \textcolor{comment}{/* due to the KX\_TRACE() commands */}
1037     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 40, (\textcolor{stringliteral}{"\_\_kmp\_runtime\_destroy\(\backslash\)n"} ));
1038 
1039     \textcolor{keywordflow}{if}( \hyperlink{kmp_8h_aae367e473107cb756f7f123b70d62efd}{\_\_kmp\_gtid\_threadprivate\_key} ) \{
1040         TlsFree( \hyperlink{kmp_8h_aae367e473107cb756f7f123b70d62efd}{\_\_kmp\_gtid\_threadprivate\_key} );
1041         \hyperlink{kmp_8h_aae367e473107cb756f7f123b70d62efd}{\_\_kmp\_gtid\_threadprivate\_key} = 0;
1042     \}
1043 
1044     \_\_kmp\_affinity\_uninitialize();
1045     DeleteCriticalSection( & \hyperlink{z__Windows__NT__util_8c_a2bc5381853ed1ae280d4d481b393f249}{\_\_kmp\_win32\_section} );
1046 
1047     \hyperlink{z__Windows__NT__util_8c_a8a496cb7a3d14a50bfd397fe68f8a6af}{ntdll} = NULL;
1048     \hyperlink{z__Windows__NT__util_8c_a57d2507b348b6039546c1ac06885c249}{NtQuerySystemInformation} = NULL;
1049 
1050 \textcolor{preprocessor}{#if KMP\_ARCH\_X86\_64}
1051 \textcolor{preprocessor}{}    kernel32 = NULL;
1052     \_\_kmp\_GetActiveProcessorCount = NULL;
1053     \_\_kmp\_GetActiveProcessorGroupCount = NULL;
1054     \_\_kmp\_GetThreadGroupAffinity = NULL;
1055     \_\_kmp\_SetThreadGroupAffinity = NULL;
1056 \textcolor{preprocessor}{#endif // KMP\_ARCH\_X86\_64}
1057 \textcolor{preprocessor}{}
1058     \hyperlink{z__Windows__NT__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime} = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1059 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_ad0680d5e6d1872f505775e7bf61c91f6}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize@{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize}}
\index{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize@{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_ad0680d5e6d1872f505775e7bf61c91f6}


Definition at line 820 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-do\-\_\-serial\-\_\-initialize().


\begin{DoxyCode}
821 \{
822     SYSTEM\_INFO info;
823     \hyperlink{structkmp__str__buf}{kmp\_str\_buf\_t} path;
824     UINT path\_size;
825 
826     \textcolor{keywordflow}{if} ( \hyperlink{z__Windows__NT__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime} ) \{
827         \textcolor{keywordflow}{return};
828     \};
829 
830 \textcolor{preprocessor}{#if KMP\_DYNAMIC\_LIB}
831 \textcolor{preprocessor}{}    \textcolor{comment}{/* Pin dynamic library for the lifetime of application */}
832     \{
833         \textcolor{comment}{// First, turn off error message boxes}
834         UINT err\_mode = SetErrorMode (SEM\_FAILCRITICALERRORS);
835         HMODULE \hyperlink{ittnotify__static_8h_a9de23e959c2bd79e141842a0025bfef1}{h};
836         BOOL ret = GetModuleHandleEx( GET\_MODULE\_HANDLE\_EX\_FLAG\_FROM\_ADDRESS
837                                      |GET\_MODULE\_HANDLE\_EX\_FLAG\_PIN,
838                                      (LPCTSTR)&\hyperlink{kmp_8h_adc4261d970464abd5acafefe3a030132}{\_\_kmp\_serial\_initialize}, &h);
839         \hyperlink{kmp__debug_8h_ab81e8322a86a57d50324bc58aea7fd20}{KMP\_DEBUG\_ASSERT2}(h && ret, \textcolor{stringliteral}{"OpenMP RTL cannot find itself loaded"});
840         SetErrorMode (err\_mode);   \textcolor{comment}{// Restore error mode}
841         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_runtime\_initialize: dynamic library pinned\(\backslash\)n"}) );
842     \}
843 \textcolor{preprocessor}{#endif}
844 \textcolor{preprocessor}{}
845     InitializeCriticalSection( & \hyperlink{z__Windows__NT__util_8c_a2bc5381853ed1ae280d4d481b393f249}{\_\_kmp\_win32\_section} );
846 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
847 \textcolor{preprocessor}{}    \_\_kmp\_itt\_system\_object\_created( & \hyperlink{z__Windows__NT__util_8c_a2bc5381853ed1ae280d4d481b393f249}{\_\_kmp\_win32\_section}, \textcolor{stringliteral}{"Critical Section"} );
848 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
849 \textcolor{preprocessor}{}    \hyperlink{z__Windows__NT__util_8c_a62b59839eaf67757384be830989a54ba}{\_\_kmp\_initialize\_system\_tick}();
850 
851 \textcolor{preprocessor}{    #if (KMP\_ARCH\_X86 || KMP\_ARCH\_X86\_64)}
852 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( ! \hyperlink{kmp_8h_a9f43d4488c8be0593700cc5b778726b9}{\_\_kmp\_cpuinfo}.\hyperlink{structkmp__cpuinfo_a340553795a3c12f5f72d3333027dc1ef}{initialized} ) \{
853             \_\_kmp\_query\_cpuid( & \hyperlink{kmp_8h_a9f43d4488c8be0593700cc5b778726b9}{\_\_kmp\_cpuinfo} );
854         \}; \textcolor{comment}{// if}
855 \textcolor{preprocessor}{    #endif }\textcolor{comment}{/* KMP\_ARCH\_X86 || KMP\_ARCH\_X86\_64 */}\textcolor{preprocessor}{}
856 \textcolor{preprocessor}{}
857     \textcolor{comment}{/* Set up minimum number of threads to switch to TLS gtid */}
858 \textcolor{preprocessor}{    #if KMP\_OS\_WINDOWS && ! defined KMP\_DYNAMIC\_LIB}
859 \textcolor{preprocessor}{}        \textcolor{comment}{// Windows* OS, static library.}
860         \textcolor{comment}{/*}
861 \textcolor{comment}{            New thread may use stack space previously used by another thread, currently terminated.}
862 \textcolor{comment}{            On Windows* OS, in case of static linking, we do not know the moment of thread termination,}
863 \textcolor{comment}{            and our structures (\_\_kmp\_threads and \_\_kmp\_root arrays) are still keep info about dead}
864 \textcolor{comment}{            threads. This leads to problem in \_\_kmp\_get\_global\_thread\_id() function: it wrongly}
865 \textcolor{comment}{            finds gtid (by searching through stack addresses of all known threads) for unregistered}
866 \textcolor{comment}{            foreign tread.}
867 \textcolor{comment}{}
868 \textcolor{comment}{            Setting \_\_kmp\_tls\_gtid\_min to 0 workarounds this problem: \_\_kmp\_get\_global\_thread\_id()}
869 \textcolor{comment}{            does not search through stacks, but get gtid from TLS immediately.}
870 \textcolor{comment}{}
871 \textcolor{comment}{            --ln}
872 \textcolor{comment}{        */}
873         \hyperlink{kmp_8h_afce1a0df7f7512062fd0494459776dae}{\_\_kmp\_tls\_gtid\_min} = 0;
874 \textcolor{preprocessor}{    #else}
875 \textcolor{preprocessor}{}        \hyperlink{kmp_8h_afce1a0df7f7512062fd0494459776dae}{\_\_kmp\_tls\_gtid\_min} = \hyperlink{kmp_8h_a8d7fad5225acf607ab14d49bd853d1f6}{KMP\_TLS\_GTID\_MIN};
876 \textcolor{preprocessor}{    #endif}
877 \textcolor{preprocessor}{}
878     \textcolor{comment}{/* for the static library */}
879     \textcolor{keywordflow}{if} ( !\hyperlink{kmp_8h_aae367e473107cb756f7f123b70d62efd}{\_\_kmp\_gtid\_threadprivate\_key} ) \{
880         \hyperlink{kmp_8h_aae367e473107cb756f7f123b70d62efd}{\_\_kmp\_gtid\_threadprivate\_key} = TlsAlloc();
881         \textcolor{keywordflow}{if}( \hyperlink{kmp_8h_aae367e473107cb756f7f123b70d62efd}{\_\_kmp\_gtid\_threadprivate\_key} == TLS\_OUT\_OF\_INDEXES ) \{
882             \hyperlink{kmp__i18n_8h_aaa06fec585285ef7883baea41bfd948f}{KMP\_FATAL}( TLSOutOfIndexes );
883         \}
884     \}
885 
886 
887     \textcolor{comment}{//}
888     \textcolor{comment}{// Load ntdll.dll.}
889     \textcolor{comment}{//}
890     \textcolor{comment}{/*}
891 \textcolor{comment}{        Simple}
892 \textcolor{comment}{            GetModuleHandle( "ntdll.dl" )}
893 \textcolor{comment}{        is not suitable due to security issue (see}
894 \textcolor{comment}{        http://www.microsoft.com/technet/security/advisory/2269637.mspx). We have to specify full}
895 \textcolor{comment}{        path to the library.}
896 \textcolor{comment}{    */}
897     \hyperlink{kmp__str_8h_adc2dc512433519833eefb364af257250}{\_\_kmp\_str\_buf\_init}( & path );
898     path\_size = GetSystemDirectory( path.\hyperlink{structkmp__str__buf_ac87d13b209cb66e1747bf327dddad2bf}{str}, path.\hyperlink{structkmp__str__buf_ac6d2fa14f64844ce2113b7d3d3b8d82a}{size} );
899     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( path\_size > 0 );
900     \textcolor{keywordflow}{if} ( path\_size >= path.\hyperlink{structkmp__str__buf_ac6d2fa14f64844ce2113b7d3d3b8d82a}{size} ) \{
901         \textcolor{comment}{//}
902         \textcolor{comment}{// Buffer is too short.  Expand the buffer and try again.}
903         \textcolor{comment}{//}
904         \hyperlink{kmp__str_8c_a0f0c848a0f1eb9354dcd0ffce444c875}{\_\_kmp\_str\_buf\_reserve}( & path, path\_size );
905         path\_size = GetSystemDirectory( path.\hyperlink{structkmp__str__buf_ac87d13b209cb66e1747bf327dddad2bf}{str}, path.\hyperlink{structkmp__str__buf_ac6d2fa14f64844ce2113b7d3d3b8d82a}{size} );
906         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( path\_size > 0 );
907     \}; \textcolor{comment}{// if}
908     \textcolor{keywordflow}{if} ( path\_size > 0 && path\_size < path.\hyperlink{structkmp__str__buf_ac6d2fa14f64844ce2113b7d3d3b8d82a}{size} ) \{
909         \textcolor{comment}{//}
910         \textcolor{comment}{// Now we have system directory name in the buffer.}
911         \textcolor{comment}{// Append backslash and name of dll to form full path,}
912         \textcolor{comment}{//}
913         path.\hyperlink{structkmp__str__buf_aac402122dd4496ecde0715de265d96b0}{used} = path\_size;
914         \hyperlink{kmp__str_8c_af8b966bd492c7bb30a7554d7eeb8fa09}{\_\_kmp\_str\_buf\_print}( & path, \textcolor{stringliteral}{"\(\backslash\)\(\backslash\)%s"}, \textcolor{stringliteral}{"ntdll.dll"} );
915 
916         \textcolor{comment}{//}
917         \textcolor{comment}{// Now load ntdll using full path.}
918         \textcolor{comment}{//}
919         \hyperlink{z__Windows__NT__util_8c_a8a496cb7a3d14a50bfd397fe68f8a6af}{ntdll} = GetModuleHandle( path.\hyperlink{structkmp__str__buf_ac87d13b209cb66e1747bf327dddad2bf}{str} );
920     \}
921 
922     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{z__Windows__NT__util_8c_a8a496cb7a3d14a50bfd397fe68f8a6af}{ntdll} != NULL );
923     \textcolor{keywordflow}{if} ( \hyperlink{z__Windows__NT__util_8c_a8a496cb7a3d14a50bfd397fe68f8a6af}{ntdll} != NULL ) \{
924         \hyperlink{z__Windows__NT__util_8c_a57d2507b348b6039546c1ac06885c249}{NtQuerySystemInformation} = (
      \hyperlink{z__Windows__NT__util_8c_ab6d20c9c11e9f3b63182538e9daf74b8}{NtQuerySystemInformation\_t}) GetProcAddress( \hyperlink{z__Windows__NT__util_8c_a8a496cb7a3d14a50bfd397fe68f8a6af}{ntdll}, \textcolor{stringliteral}{"NtQuerySystemInformation
      "} );
925     \}
926     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{z__Windows__NT__util_8c_a57d2507b348b6039546c1ac06885c249}{NtQuerySystemInformation} != NULL );
927 
928 \textcolor{preprocessor}{#if KMP\_GROUP\_AFFINITY}
929 \textcolor{preprocessor}{}    \textcolor{comment}{//}
930     \textcolor{comment}{// Load kernel32.dll.}
931     \textcolor{comment}{// Same caveat - must use full system path name.}
932     \textcolor{comment}{//}
933     \textcolor{keywordflow}{if} ( path\_size > 0 && path\_size < path.\hyperlink{structkmp__str__buf_ac6d2fa14f64844ce2113b7d3d3b8d82a}{size} ) \{
934         \textcolor{comment}{//}
935         \textcolor{comment}{// Truncate the buffer back to just the system path length,}
936         \textcolor{comment}{// discarding "\(\backslash\)\(\backslash\)ntdll.dll", and replacing it with "kernel32.dll".}
937         \textcolor{comment}{//}
938         path.\hyperlink{structkmp__str__buf_aac402122dd4496ecde0715de265d96b0}{used} = path\_size;
939         \hyperlink{kmp__str_8c_af8b966bd492c7bb30a7554d7eeb8fa09}{\_\_kmp\_str\_buf\_print}( & path, \textcolor{stringliteral}{"\(\backslash\)\(\backslash\)%s"}, \textcolor{stringliteral}{"kernel32.dll"} );
940 
941         \textcolor{comment}{//}
942         \textcolor{comment}{// Load kernel32.dll using full path.}
943         \textcolor{comment}{//}
944         kernel32 = GetModuleHandle( path.\hyperlink{structkmp__str__buf_ac87d13b209cb66e1747bf327dddad2bf}{str} );
945         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_runtime\_initialize: kernel32.dll = %s\(\backslash\)n"}, path.
      \hyperlink{structkmp__str__buf_ac87d13b209cb66e1747bf327dddad2bf}{str} ) );
946 
947         \textcolor{comment}{//}
948         \textcolor{comment}{// Load the function pointers to kernel32.dll routines}
949         \textcolor{comment}{// that may or may not exist on this system.}
950         \textcolor{comment}{//}
951         \textcolor{keywordflow}{if} ( kernel32 != NULL ) \{
952             \_\_kmp\_GetActiveProcessorCount = (kmp\_GetActiveProcessorCount\_t) GetProcAddress( kernel32, \textcolor{stringliteral}{"
      GetActiveProcessorCount"} );
953             \_\_kmp\_GetActiveProcessorGroupCount = (kmp\_GetActiveProcessorGroupCount\_t) GetProcAddress( 
      kernel32, \textcolor{stringliteral}{"GetActiveProcessorGroupCount"} );
954             \_\_kmp\_GetThreadGroupAffinity = (kmp\_GetThreadGroupAffinity\_t) GetProcAddress( kernel32, \textcolor{stringliteral}{"
      GetThreadGroupAffinity"} );
955             \_\_kmp\_SetThreadGroupAffinity = (kmp\_SetThreadGroupAffinity\_t) GetProcAddress( kernel32, \textcolor{stringliteral}{"
      SetThreadGroupAffinity"} );
956 
957             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_runtime\_initialize: \_\_kmp\_GetActiveProcessorCount = %p\(\backslash\)n"}, 
      \_\_kmp\_GetActiveProcessorCount ) );
958             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_runtime\_initialize: \_\_kmp\_GetActiveProcessorGroupCount = %p\(\backslash\)n"}, 
      \_\_kmp\_GetActiveProcessorGroupCount ) );
959             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_runtime\_initialize:\_\_kmp\_GetThreadGroupAffinity = %p\(\backslash\)n"}, 
      \_\_kmp\_GetThreadGroupAffinity ) );
960             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_runtime\_initialize: \_\_kmp\_SetThreadGroupAffinity = %p\(\backslash\)n"}, 
      \_\_kmp\_SetThreadGroupAffinity ) );
961             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_runtime\_initialize: sizeof(kmp\_affin\_mask\_t) = %d\(\backslash\)n"}, \textcolor{keyword}{sizeof}(
      kmp\_affin\_mask\_t) ) );
962 
963             \textcolor{comment}{//}
964             \textcolor{comment}{// See if group affinity is supported on this system.}
965             \textcolor{comment}{// If so, calculate the #groups and #procs.}
966             \textcolor{comment}{//}
967             \textcolor{comment}{// Group affinity was introduced with Windows* 7 OS and}
968             \textcolor{comment}{// Windows* Server 2008 R2 OS.}
969             \textcolor{comment}{//}
970             \textcolor{keywordflow}{if} ( ( \_\_kmp\_GetActiveProcessorCount != NULL )
971               && ( \_\_kmp\_GetActiveProcessorGroupCount != NULL )
972               && ( \_\_kmp\_GetThreadGroupAffinity != NULL )
973               && ( \_\_kmp\_SetThreadGroupAffinity != NULL )
974               && ( ( \_\_kmp\_num\_proc\_groups
975               = \_\_kmp\_GetActiveProcessorGroupCount() ) > 1 ) ) \{
976                 \textcolor{comment}{//}
977                 \textcolor{comment}{// Calculate the total number of active OS procs.}
978                 \textcolor{comment}{//}
979                 \textcolor{keywordtype}{int} \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i};
980 
981                 \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_runtime\_initialize: %d processor groups detected\(\backslash\)n"}, 
      \_\_kmp\_num\_proc\_groups ) );
982 
983                 \hyperlink{kmp_8h_a3469a7dffedccf219ec6b8a0e4ec8ed2}{\_\_kmp\_xproc} = 0;
984 
985                 \textcolor{keywordflow}{for} ( i = 0; i < \_\_kmp\_num\_proc\_groups; i++ ) \{
986                     DWORD \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} = \_\_kmp\_GetActiveProcessorCount( i );
987                     \hyperlink{kmp_8h_a3469a7dffedccf219ec6b8a0e4ec8ed2}{\_\_kmp\_xproc} += \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size};
988                     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_runtime\_initialize: proc group %d size = %d\(\backslash\)n"}, i, size )
       );
989                 \}
990                 \}
991             \textcolor{keywordflow}{else} \{
992                 \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_runtime\_initialize: %d processor groups detected\(\backslash\)n"}, 
      \_\_kmp\_num\_proc\_groups ) );
993             \}
994         \}
995     \}
996     \textcolor{keywordflow}{if} ( \_\_kmp\_num\_proc\_groups <= 1 ) \{
997         GetSystemInfo( & info );
998         \hyperlink{kmp_8h_a3469a7dffedccf219ec6b8a0e4ec8ed2}{\_\_kmp\_xproc} = info.dwNumberOfProcessors;
999     \}
1000 \textcolor{preprocessor}{#else}
1001 \textcolor{preprocessor}{}    GetSystemInfo( & info );
1002     \hyperlink{kmp_8h_a3469a7dffedccf219ec6b8a0e4ec8ed2}{\_\_kmp\_xproc} = info.dwNumberOfProcessors;
1003 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_GROUP\_AFFINITY */}\textcolor{preprocessor}{}
1004 \textcolor{preprocessor}{}
1005     \textcolor{comment}{//}
1006     \textcolor{comment}{// If the OS said there were 0 procs, take a guess and use a value of 2.}
1007     \textcolor{comment}{// This is done for Linux* OS, also.  Do we need error / warning?}
1008     \textcolor{comment}{//}
1009     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a3469a7dffedccf219ec6b8a0e4ec8ed2}{\_\_kmp\_xproc} <= 0 ) \{
1010         \hyperlink{kmp_8h_a3469a7dffedccf219ec6b8a0e4ec8ed2}{\_\_kmp\_xproc} = 2;
1011     \}
1012 
1013     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 5, (\textcolor{stringliteral}{"\_\_kmp\_runtime\_initialize: total processors = %d\(\backslash\)n"}, 
      \hyperlink{kmp_8h_a3469a7dffedccf219ec6b8a0e4ec8ed2}{\_\_kmp\_xproc}) );
1014 
1015     \hyperlink{kmp__str_8c_a683399047568b106a23ef86647b9b586}{\_\_kmp\_str\_buf\_free}( & path );
1016 
1017 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1018 \textcolor{preprocessor}{}    \_\_kmp\_itt\_initialize();
1019 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1020 \textcolor{preprocessor}{}
1021     \hyperlink{z__Windows__NT__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime} = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1022 \} \textcolor{comment}{// \_\_kmp\_runtime\_initialize}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_ab057268fc36c87b493138b5a107ad3e1}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-set\-\_\-system\-\_\-affinity@{\-\_\-\-\_\-kmp\-\_\-set\-\_\-system\-\_\-affinity}}
\index{\-\_\-\-\_\-kmp\-\_\-set\-\_\-system\-\_\-affinity@{\-\_\-\-\_\-kmp\-\_\-set\-\_\-system\-\_\-affinity}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-set\-\_\-system\-\_\-affinity}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-set\-\_\-system\-\_\-affinity (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-affin\-\_\-mask\-\_\-t const $\ast$}]{mask, }
\item[{{\bf int}}]{abort\-\_\-on\-\_\-error}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_ab057268fc36c87b493138b5a107ad3e1}


Definition at line 566 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-affinity\-\_\-bind\-\_\-thread(), and \-\_\-\-\_\-kmp\-\_\-allocate\-\_\-team().


\begin{DoxyCode}
567 \{
568 
569 \textcolor{preprocessor}{#if KMP\_GROUP\_AFFINITY}
570 \textcolor{preprocessor}{}
571     \textcolor{keywordflow}{if} (\_\_kmp\_num\_proc\_groups > 1) \{
572         \textcolor{comment}{//}
573         \textcolor{comment}{// Check for a valid mask.}
574         \textcolor{comment}{//}
575         GROUP\_AFFINITY ga;
576         \textcolor{keywordtype}{int} group = \_\_kmp\_get\_proc\_group( \hyperlink{ittnotify__static_8h_aa2c7de905e06240a7170f2a0da3a5abf}{mask} );
577         \textcolor{keywordflow}{if} (group < 0) \{
578             \textcolor{keywordflow}{if} (abort\_on\_error) \{
579                 \hyperlink{kmp__i18n_8h_aaa06fec585285ef7883baea41bfd948f}{KMP\_FATAL}(AffinityInvalidMask, \textcolor{stringliteral}{"kmp\_set\_affinity"});
580             \}
581             \textcolor{keywordflow}{return} -1;
582         \}
583 
584         \textcolor{comment}{//}
585         \textcolor{comment}{// Transform the bit vector into a GROUP\_AFFINITY struct}
586         \textcolor{comment}{// and make the system call to set affinity.}
587         \textcolor{comment}{//}
588         ga.Group = group;
589         ga.Mask = \hyperlink{ittnotify__static_8h_aa2c7de905e06240a7170f2a0da3a5abf}{mask}[group];
590         ga.Reserved[0] = ga.Reserved[1] = ga.Reserved[2] = 0;
591 
592         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(\_\_kmp\_SetThreadGroupAffinity != NULL);
593         \textcolor{keywordflow}{if} (\_\_kmp\_SetThreadGroupAffinity(GetCurrentThread(), &ga, NULL) == 0) \{
594             DWORD error = GetLastError();
595             \textcolor{keywordflow}{if} (abort\_on\_error) \{
596                 \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
597                     \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
598                     \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantSetThreadAffMask ),
599                     \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( error ),
600                     \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
601                 );
602             \}
603             \textcolor{keywordflow}{return} error;
604         \}
605     \}
606     \textcolor{keywordflow}{else}
607 
608 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_GROUP\_AFFINITY */}\textcolor{preprocessor}{}
609 \textcolor{preprocessor}{}
610     \{
611         \textcolor{keywordflow}{if} (!SetThreadAffinityMask( GetCurrentThread(), *\hyperlink{ittnotify__static_8h_aa2c7de905e06240a7170f2a0da3a5abf}{mask} )) \{
612             DWORD error = GetLastError();
613             \textcolor{keywordflow}{if} (abort\_on\_error) \{
614                 \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
615                     \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
616                     \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantSetThreadAffMask ),
617                     \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( error ),
618                     \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
619                 );
620             \}
621             \textcolor{keywordflow}{return} error;
622         \}
623     \}
624     \textcolor{keywordflow}{return} 0;
625 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a46d2a4060b866eb1cfbb6f011fd6383c}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-still\-\_\-running@{\-\_\-\-\_\-kmp\-\_\-still\-\_\-running}}
\index{\-\_\-\-\_\-kmp\-\_\-still\-\_\-running@{\-\_\-\-\_\-kmp\-\_\-still\-\_\-running}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-still\-\_\-running}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-still\-\_\-running (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a46d2a4060b866eb1cfbb6f011fd6383c}


Definition at line 1402 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.


\begin{DoxyCode}
1402                                     \{
1403     \textcolor{keywordflow}{return} (WAIT\_TIMEOUT == WaitForSingleObject( th->th.th\_info.ds.ds\_thread, 0));
1404 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_aba3964e854aa376fc15165064cf5eff7}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32 (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{th\-\_\-gtid, }
\item[{{\bf kmp\-\_\-flag\-\_\-32} $\ast$}]{flag}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_aba3964e854aa376fc15165064cf5eff7}


Definition at line 421 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by kmp\-\_\-flag\-\_\-32\-::suspend().


\begin{DoxyCode}
421                                                       \{
422     \hyperlink{z__Windows__NT__util_8c_a2a0487d25d42b2af4af0571afcd405e8}{\_\_kmp\_suspend\_template}(th\_gtid, flag);
423 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_aa691a7515df09e540efa307af193ebcf}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64 (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{th\-\_\-gtid, }
\item[{{\bf kmp\-\_\-flag\-\_\-64} $\ast$}]{flag}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_aa691a7515df09e540efa307af193ebcf}


Definition at line 424 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by kmp\-\_\-flag\-\_\-64\-::suspend().


\begin{DoxyCode}
424                                                       \{
425     \hyperlink{z__Windows__NT__util_8c_a2a0487d25d42b2af4af0571afcd405e8}{\_\_kmp\_suspend\_template}(th\_gtid, flag);
426 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a4b300606c79ebf03aaee1fdc9b9c141d}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a4b300606c79ebf03aaee1fdc9b9c141d}


Definition at line 308 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-parallel\-\_\-initialize().


\begin{DoxyCode}
309 \{
310     \textcolor{comment}{/* do nothing */}
311 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a3cbd436ba7abef35400b2939a597025e}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Windows__NT__util_8c_a3cbd436ba7abef35400b2939a597025e}


Definition at line 314 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-resume\-\_\-template(), and \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template().


\begin{DoxyCode}
315 \{
316     \textcolor{keywordflow}{if} ( ! \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}( th->th.th\_suspend\_init ) ) \{
317       \textcolor{comment}{/* this means we haven't initialized the suspension pthread objects for this thread}
318 \textcolor{comment}{         in this instance of the process */}
319         \hyperlink{z__Windows__NT__util_8c_a0beefaf8138ff385bc98236faa982534}{\_\_kmp\_win32\_cond\_init}(  &th->th.th\_suspend\_cv );
320         \hyperlink{z__Windows__NT__util_8c_ab93aa5404f492750afbd37bbe0b3be52}{\_\_kmp\_win32\_mutex\_init}( &th->th.th\_suspend\_mx );
321         \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( th->th.th\_suspend\_init, \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} );
322     \}
323 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a984c4dfb0b0c1966f7f2839107b6bd80}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{th\-\_\-gtid, }
\item[{{\bf kmp\-\_\-flag\-\_\-oncore} $\ast$}]{flag}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a984c4dfb0b0c1966f7f2839107b6bd80}


Definition at line 427 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by kmp\-\_\-flag\-\_\-oncore\-::suspend().


\begin{DoxyCode}
427                                                               \{
428     \hyperlink{z__Windows__NT__util_8c_a2a0487d25d42b2af4af0571afcd405e8}{\_\_kmp\_suspend\_template}(th\_gtid, flag);
429 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a2a0487d25d42b2af4af0571afcd405e8}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class C $>$ static {\bf void} \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{th\-\_\-gtid, }
\item[{C $\ast$}]{flag}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{z__Windows__NT__util_8c_a2a0487d25d42b2af4af0571afcd405e8}


Definition at line 341 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32(), \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64(), and \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore().


\begin{DoxyCode}
342 \{
343     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *th = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[th\_gtid];
344     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
345     \textcolor{keyword}{typename} C::flag\_t old\_spin;
346 
347     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 30, (\textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d enter for flag's loc(%p)\(\backslash\)n"}, th\_gtid, flag->get() 
      ) );
348 
349     \hyperlink{z__Windows__NT__util_8c_a3cbd436ba7abef35400b2939a597025e}{\_\_kmp\_suspend\_initialize\_thread}( th );
350     \hyperlink{z__Windows__NT__util_8c_a1b3aab743814b71e420faff607d941d1}{\_\_kmp\_win32\_mutex\_lock}( &th->th.th\_suspend\_mx );
351 
352     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d setting sleep bit for flag's loc(%p)\(\backslash\)n"},
353                     th\_gtid, flag->get() ) );
354 
355     \textcolor{comment}{/* TODO: shouldn't this use release semantics to ensure that \_\_kmp\_suspend\_initialize\_thread}
356 \textcolor{comment}{       gets called first?}
357 \textcolor{comment}{    */}
358     old\_spin = flag->set\_sleeping();
359 
360     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 5, ( \textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d set sleep bit for flag's loc(%p)==%d\(\backslash\)n"},
361                    th\_gtid, flag->get(), *(flag->get()) ) );
362 
363     \textcolor{keywordflow}{if} ( flag->done\_check\_val(old\_spin) ) \{
364         old\_spin = flag->unset\_sleeping();
365         \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 5, ( \textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d false alarm, reset sleep bit for flag's
       loc(%p)\(\backslash\)n"},
366                        th\_gtid, flag->get()) );
367     \} \textcolor{keywordflow}{else} \{
368 \textcolor{preprocessor}{#ifdef DEBUG\_SUSPEND}
369 \textcolor{preprocessor}{}        \_\_kmp\_suspend\_count++;
370 \textcolor{preprocessor}{#endif}
371 \textcolor{preprocessor}{}        \textcolor{comment}{/* Encapsulate in a loop as the documentation states that this may}
372 \textcolor{comment}{         * "with low probability" return when the condition variable has}
373 \textcolor{comment}{         * not been signaled or broadcast}
374 \textcolor{comment}{         */}
375         \textcolor{keywordtype}{int} deactivated = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
376         \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(th->th.th\_sleep\_loc, (\textcolor{keywordtype}{void} *)flag);
377         \textcolor{keywordflow}{while} ( flag->is\_sleeping() ) \{
378             \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 15, (\textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d about to perform kmp\_win32\_cond\_wait()\(\backslash\)n"},
379                      th\_gtid ) );
380             \textcolor{comment}{// Mark the thread as no longer active (only in the first iteration of the loop).}
381             \textcolor{keywordflow}{if} ( ! deactivated ) \{
382                 th->th.th\_active = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
383                 \textcolor{keywordflow}{if} ( th->th.th\_active\_in\_pool ) \{
384                     th->th.th\_active\_in\_pool = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
385                     \hyperlink{kmp__os_8h_a5b23523b95ee4b2307a8f344cbbe8050}{KMP\_TEST\_THEN\_DEC32}(
386                       (kmp\_int32 *) &\hyperlink{kmp_8h_adeeafca09cd1560dcc9bc78ee1df217d}{\_\_kmp\_thread\_pool\_active\_nth} );
387                     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(
      \hyperlink{kmp_8h_adeeafca09cd1560dcc9bc78ee1df217d}{\_\_kmp\_thread\_pool\_active\_nth}) >= 0 );
388                 \}
389                 deactivated = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
390 
391                 \hyperlink{z__Windows__NT__util_8c_a5b519eb6a30d9c2449e5798b899bb007}{\_\_kmp\_win32\_cond\_wait}( &th->th.th\_suspend\_cv, &th->th.th\_suspend\_mx, 0
      , 0 );
392             \}
393             \textcolor{keywordflow}{else} \{
394                 \hyperlink{z__Windows__NT__util_8c_a5b519eb6a30d9c2449e5798b899bb007}{\_\_kmp\_win32\_cond\_wait}( &th->th.th\_suspend\_cv, &th->th.th\_suspend\_mx, 0
      , 0 );
395             \}
396 
397 \textcolor{preprocessor}{#ifdef KMP\_DEBUG}
398 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if}( flag->is\_sleeping() ) \{
399                 \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 100, (\textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d spurious wakeup\(\backslash\)n"}, th\_gtid ));
400             \}
401 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_DEBUG */}\textcolor{preprocessor}{}
402 \textcolor{preprocessor}{}
403         \} \textcolor{comment}{// while}
404 
405         \textcolor{comment}{// Mark the thread as active again (if it was previous marked as inactive)}
406         \textcolor{keywordflow}{if} ( deactivated ) \{
407             th->th.th\_active = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
408             \textcolor{keywordflow}{if} ( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(th->th.th\_in\_pool) ) \{
409                 \hyperlink{kmp__os_8h_a201982f51ff23ad84ae6781ad4265e3a}{KMP\_TEST\_THEN\_INC32}(
410                   (kmp\_int32 *) &\hyperlink{kmp_8h_adeeafca09cd1560dcc9bc78ee1df217d}{\_\_kmp\_thread\_pool\_active\_nth} );
411                 th->th.th\_active\_in\_pool = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
412             \}
413         \}
414     \}
415 
416     \hyperlink{z__Windows__NT__util_8c_a05597f57992f97794d11b4a470191906}{\_\_kmp\_win32\_mutex\_unlock}( &th->th.th\_suspend\_mx );
417 
418     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 30, (\textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d exit\(\backslash\)n"}, th\_gtid ) );
419 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a8da648a8950059fa34eeca0f54b437a6}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a8da648a8950059fa34eeca0f54b437a6}


Definition at line 326 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-reap\-\_\-thread().


\begin{DoxyCode}
327 \{
328     \textcolor{keywordflow}{if} ( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}( th->th.th\_suspend\_init ) ) \{
329       \textcolor{comment}{/* this means we have initialize the suspension pthread objects for this thread}
330 \textcolor{comment}{         in this instance of the process */}
331       \hyperlink{z__Windows__NT__util_8c_a6e9b71a81067d95a68dfab6d1372172d}{\_\_kmp\_win32\_cond\_destroy}( & th->th.th\_suspend\_cv );
332       \hyperlink{z__Windows__NT__util_8c_ae833489959d71b97acfff87a40c867b4}{\_\_kmp\_win32\_mutex\_destroy}( & th->th.th\_suspend\_mx );
333       \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( th->th.th\_suspend\_init, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE} );
334     \}
335 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a9c1e0ffcb1e7c87e5429269dc6c6c0bf}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread}}
\index{\-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{gtid}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a9c1e0ffcb1e7c87e5429269dc6c6c0bf}


Definition at line 1063 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor().


\begin{DoxyCode}
1064 \{
1065     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}  *th = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
1066 
1067     \textcolor{keywordflow}{if}( !th ) \textcolor{keywordflow}{return};
1068 
1069     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_terminate\_thread: kill (%d)\(\backslash\)n"}, gtid ) );
1070 
1071     \textcolor{keywordflow}{if} (TerminateThread( th->th.th\_info.ds.ds\_thread, (DWORD) -1) == \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}) \{
1072         \textcolor{comment}{/* It's OK, the thread may have exited already */}
1073     \}
1074     \hyperlink{z__Windows__NT__util_8c_a0603ae87485cdde7a3a054e585f324fd}{\_\_kmp\_free\_handle}( th->th.th\_info.ds.ds\_thread );
1075 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a397d2a9aa5fd59cab056b8aed69fef29}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-thread\-\_\-sleep@{\-\_\-\-\_\-kmp\-\_\-thread\-\_\-sleep}}
\index{\-\_\-\-\_\-kmp\-\_\-thread\-\_\-sleep@{\-\_\-\-\_\-kmp\-\_\-thread\-\_\-sleep}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-thread\-\_\-sleep}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-thread\-\_\-sleep (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{millis}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a397d2a9aa5fd59cab056b8aed69fef29}


Definition at line 1749 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-msg().


\begin{DoxyCode}
1750 \{
1751     DWORD \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1752 
1753     status = SleepEx( (DWORD) millis, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE} );
1754     \textcolor{keywordflow}{if} ( status ) \{
1755         DWORD error = GetLastError();
1756         \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1757             \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
1758             \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( FunctionError, \textcolor{stringliteral}{"SleepEx()"} ),
1759             \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( error ),
1760             \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1761         );
1762     \}
1763 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a3a517cc114680dc78a99c3aeb4b64924}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-broadcast@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-broadcast}}
\index{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-broadcast@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-broadcast}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-broadcast}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-broadcast (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-win32\-\_\-cond\-\_\-t $\ast$}]{cv}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a3a517cc114680dc78a99c3aeb4b64924}


Definition at line 265 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-signal().


\begin{DoxyCode}
266 \{
267     \hyperlink{z__Windows__NT__util_8c_a1b3aab743814b71e420faff607d941d1}{\_\_kmp\_win32\_mutex\_lock}( &cv->waiters\_count\_lock\_ );
268 
269     \textcolor{keywordflow}{if}( cv->waiters\_count\_ > 0 ) \{
270         SetEvent( cv->event\_ );
271         \textcolor{comment}{/* Release all the threads in this generation. */}
272 
273         cv->release\_count\_ = cv->waiters\_count\_;
274 
275         \textcolor{comment}{/* Start a new generation. */}
276         cv->wait\_generation\_count\_++;
277     \}
278 
279     \hyperlink{z__Windows__NT__util_8c_a05597f57992f97794d11b4a470191906}{\_\_kmp\_win32\_mutex\_unlock}( &cv->waiters\_count\_lock\_ );
280 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a6e9b71a81067d95a68dfab6d1372172d}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-destroy@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-destroy}}
\index{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-destroy@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-destroy}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-destroy}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-destroy (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-win32\-\_\-cond\-\_\-t $\ast$}]{cv}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a6e9b71a81067d95a68dfab6d1372172d}


Definition at line 198 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread().


\begin{DoxyCode}
199 \{
200     \hyperlink{z__Windows__NT__util_8c_ae833489959d71b97acfff87a40c867b4}{\_\_kmp\_win32\_mutex\_destroy}( & cv->waiters\_count\_lock\_ );
201     \hyperlink{z__Windows__NT__util_8c_a0603ae87485cdde7a3a054e585f324fd}{\_\_kmp\_free\_handle}( cv->event\_ );
202     memset( cv, \textcolor{charliteral}{'\(\backslash\)0'}, \textcolor{keyword}{sizeof}( *cv ) );
203 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a0beefaf8138ff385bc98236faa982534}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-init@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-init}}
\index{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-init@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-init}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-init (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-win32\-\_\-cond\-\_\-t $\ast$}]{cv}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a0beefaf8138ff385bc98236faa982534}


Definition at line 178 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread().


\begin{DoxyCode}
179 \{
180     cv->waiters\_count\_         = 0;
181     cv->wait\_generation\_count\_ = 0;
182     cv->release\_count\_         = 0;
183 
184     \textcolor{comment}{/* Initialize the critical section */}
185     \hyperlink{z__Windows__NT__util_8c_ab93aa5404f492750afbd37bbe0b3be52}{\_\_kmp\_win32\_mutex\_init}( & cv->waiters\_count\_lock\_ );
186 
187     \textcolor{comment}{/* Create a manual-reset event. */}
188     cv->event\_ = CreateEvent( NULL,     \textcolor{comment}{// no security}
189                               \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE},     \textcolor{comment}{// manual-reset}
190                               \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE},    \textcolor{comment}{// non-signaled initially}
191                               NULL );   \textcolor{comment}{// unnamed}
192 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
193 \textcolor{preprocessor}{}    \_\_kmp\_itt\_system\_object\_created( cv->event\_, \textcolor{stringliteral}{"Event"} );
194 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
195 \textcolor{preprocessor}{}\}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a6ae31d8afd60c4195a36fa2badbcb2ae}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-signal@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-signal}}
\index{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-signal@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-signal}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-signal}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-signal (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-win32\-\_\-cond\-\_\-t $\ast$}]{cv}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a6ae31d8afd60c4195a36fa2badbcb2ae}


Definition at line 283 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-resume\-\_\-template().


\begin{DoxyCode}
284 \{
285     \hyperlink{z__Windows__NT__util_8c_a3a517cc114680dc78a99c3aeb4b64924}{\_\_kmp\_win32\_cond\_broadcast}( cv );
286 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a5b519eb6a30d9c2449e5798b899bb007}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-wait@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-wait}}
\index{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-wait@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-wait}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-wait}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-wait (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-win32\-\_\-cond\-\_\-t $\ast$}]{cv, }
\item[{kmp\-\_\-win32\-\_\-mutex\-\_\-t $\ast$}]{mx, }
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{{\bf int}}]{need\-\_\-decrease\-\_\-load}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a5b519eb6a30d9c2449e5798b899bb007}


Definition at line 209 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template().


\begin{DoxyCode}
210 \{
211     \textcolor{keywordtype}{int} my\_generation;
212     \textcolor{keywordtype}{int} last\_waiter;
213 
214     \textcolor{comment}{/* Avoid race conditions */}
215     \hyperlink{z__Windows__NT__util_8c_a1b3aab743814b71e420faff607d941d1}{\_\_kmp\_win32\_mutex\_lock}( &cv->waiters\_count\_lock\_ );
216 
217     \textcolor{comment}{/* Increment count of waiters */}
218     cv->waiters\_count\_++;
219 
220     \textcolor{comment}{/* Store current generation in our activation record. */}
221     my\_generation = cv->wait\_generation\_count\_;
222 
223     \hyperlink{z__Windows__NT__util_8c_a05597f57992f97794d11b4a470191906}{\_\_kmp\_win32\_mutex\_unlock}( &cv->waiters\_count\_lock\_ );
224     \hyperlink{z__Windows__NT__util_8c_a05597f57992f97794d11b4a470191906}{\_\_kmp\_win32\_mutex\_unlock}( mx );
225 
226     \textcolor{keywordflow}{for} (;;) \{
227         \textcolor{keywordtype}{int} wait\_done;
228 
229         \textcolor{comment}{/* Wait until the event is signaled */}
230         WaitForSingleObject( cv->event\_, INFINITE );
231 
232         \hyperlink{z__Windows__NT__util_8c_a1b3aab743814b71e420faff607d941d1}{\_\_kmp\_win32\_mutex\_lock}( &cv->waiters\_count\_lock\_ );
233 
234         \textcolor{comment}{/* Exit the loop when the <cv->event\_> is signaled and}
235 \textcolor{comment}{         * there are still waiting threads from this <wait\_generation>}
236 \textcolor{comment}{         * that haven't been released from this wait yet.              */}
237         wait\_done = ( cv->release\_count\_ > 0 ) &&
238                     ( cv->wait\_generation\_count\_ != my\_generation );
239 
240         \hyperlink{z__Windows__NT__util_8c_a05597f57992f97794d11b4a470191906}{\_\_kmp\_win32\_mutex\_unlock}( &cv->waiters\_count\_lock\_);
241 
242         \textcolor{comment}{/* there used to be a semicolon after the if statement,}
243 \textcolor{comment}{         * it looked like a bug, so i removed it */}
244         \textcolor{keywordflow}{if}( wait\_done )
245             \textcolor{keywordflow}{break};
246     \}
247 
248     \hyperlink{z__Windows__NT__util_8c_a1b3aab743814b71e420faff607d941d1}{\_\_kmp\_win32\_mutex\_lock}( mx );
249     \hyperlink{z__Windows__NT__util_8c_a1b3aab743814b71e420faff607d941d1}{\_\_kmp\_win32\_mutex\_lock}( &cv->waiters\_count\_lock\_ );
250 
251     cv->waiters\_count\_--;
252     cv->release\_count\_--;
253 
254     last\_waiter =  ( cv->release\_count\_ == 0 );
255 
256     \hyperlink{z__Windows__NT__util_8c_a05597f57992f97794d11b4a470191906}{\_\_kmp\_win32\_mutex\_unlock}( &cv->waiters\_count\_lock\_ );
257 
258     \textcolor{keywordflow}{if}( last\_waiter ) \{
259         \textcolor{comment}{/* We're the last waiter to be notified, so reset the manual event. */}
260         ResetEvent( cv->event\_ );
261     \}
262 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_ae833489959d71b97acfff87a40c867b4}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-destroy@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-destroy}}
\index{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-destroy@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-destroy}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-destroy}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-destroy (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-win32\-\_\-mutex\-\_\-t $\ast$}]{mx}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_ae833489959d71b97acfff87a40c867b4}


Definition at line 160 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread(), and \-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-destroy().


\begin{DoxyCode}
161 \{
162     DeleteCriticalSection( & mx->cs );
163 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_ab93aa5404f492750afbd37bbe0b3be52}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-init@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-init}}
\index{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-init@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-init}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-init (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-win32\-\_\-mutex\-\_\-t $\ast$}]{mx}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_ab93aa5404f492750afbd37bbe0b3be52}


Definition at line 151 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread(), and \-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-init().


\begin{DoxyCode}
152 \{
153     InitializeCriticalSection( & mx->cs );
154 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
155 \textcolor{preprocessor}{}    \_\_kmp\_itt\_system\_object\_created( & mx->cs, \textcolor{stringliteral}{"Critical Section"} );
156 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
157 \textcolor{preprocessor}{}\}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a1b3aab743814b71e420faff607d941d1}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-lock@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-lock}}
\index{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-lock@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-lock}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-lock}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-lock (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-win32\-\_\-mutex\-\_\-t $\ast$}]{mx}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a1b3aab743814b71e420faff607d941d1}


Definition at line 166 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-resume\-\_\-template(), \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template(), \-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-broadcast(), and \-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-wait().


\begin{DoxyCode}
167 \{
168     EnterCriticalSection( & mx->cs );
169 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a05597f57992f97794d11b4a470191906}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-unlock@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-unlock}}
\index{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-unlock@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-unlock}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-unlock}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-win32\-\_\-mutex\-\_\-unlock (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-win32\-\_\-mutex\-\_\-t $\ast$}]{mx}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a05597f57992f97794d11b4a470191906}


Definition at line 172 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-resume\-\_\-template(), \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template(), \-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-broadcast(), and \-\_\-\-\_\-kmp\-\_\-win32\-\_\-cond\-\_\-wait().


\begin{DoxyCode}
173 \{
174     LeaveCriticalSection( & mx->cs );
175 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_a699f282bc4bbcf04222893192f568e91}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-yield@{\-\_\-\-\_\-kmp\-\_\-yield}}
\index{\-\_\-\-\_\-kmp\-\_\-yield@{\-\_\-\-\_\-kmp\-\_\-yield}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-yield}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-yield (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{cond}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a699f282bc4bbcf04222893192f568e91}


Definition at line 498 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmpc\-\_\-flush().


\begin{DoxyCode}
499 \{
500     \textcolor{keywordflow}{if} (cond)
501         Sleep(0);
502 \}
\end{DoxyCode}
\hypertarget{z__Windows__NT__util_8c_acb417c66dfd0b02a8ea556c894e2080a}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}}
\index{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}]{\setlength{\rightskip}{0pt plus 5cm}K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T (
\begin{DoxyParamCaption}
\item[{offsetof({\bf S\-Y\-S\-T\-E\-M\-\_\-\-T\-H\-R\-E\-A\-D}, Kernel\-Time)}]{ = {\ttfamily =0}}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_acb417c66dfd0b02a8ea556c894e2080a}
\hypertarget{z__Windows__NT__util_8c_a0ac104cc17a3c6cd6701c0cd0f775e90}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}}
\index{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}]{\setlength{\rightskip}{0pt plus 5cm}K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T (
\begin{DoxyParamCaption}
\item[{offsetof({\bf S\-Y\-S\-T\-E\-M\-\_\-\-T\-H\-R\-E\-A\-D}, Start\-Address)}]{ = {\ttfamily =32}}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a0ac104cc17a3c6cd6701c0cd0f775e90}
\hypertarget{z__Windows__NT__util_8c_a297ad7389469a4297af97860596a9b41}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}}
\index{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}]{\setlength{\rightskip}{0pt plus 5cm}K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T (
\begin{DoxyParamCaption}
\item[{offsetof({\bf S\-Y\-S\-T\-E\-M\-\_\-\-T\-H\-R\-E\-A\-D}, State)}]{ = {\ttfamily =68}}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a297ad7389469a4297af97860596a9b41}
\hypertarget{z__Windows__NT__util_8c_a12e0308899cde047a90129da31cf8a43}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}}
\index{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}]{\setlength{\rightskip}{0pt plus 5cm}K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T (
\begin{DoxyParamCaption}
\item[{offsetof({\bf S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, Next\-Entry\-Offset)}]{ = {\ttfamily =0}}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a12e0308899cde047a90129da31cf8a43}
\hypertarget{z__Windows__NT__util_8c_a882c5f03945356afb2750e8815c755f2}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}}
\index{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}]{\setlength{\rightskip}{0pt plus 5cm}K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T (
\begin{DoxyParamCaption}
\item[{offsetof({\bf S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, Create\-Time)}]{ = {\ttfamily =32}}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a882c5f03945356afb2750e8815c755f2}
\hypertarget{z__Windows__NT__util_8c_add82169d09e4c07e471eca7542028953}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}}
\index{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}]{\setlength{\rightskip}{0pt plus 5cm}K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T (
\begin{DoxyParamCaption}
\item[{offsetof({\bf S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, Image\-Name)}]{ = {\ttfamily =56}}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_add82169d09e4c07e471eca7542028953}
\hypertarget{z__Windows__NT__util_8c_a9fc910c3e3d8ce79bd0153c60c34fa4b}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}}
\index{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}]{\setlength{\rightskip}{0pt plus 5cm}K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T (
\begin{DoxyParamCaption}
\item[{offsetof({\bf S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, Process\-Id)}]{ = {\ttfamily =80}}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a9fc910c3e3d8ce79bd0153c60c34fa4b}
\hypertarget{z__Windows__NT__util_8c_ad41491d808f9ce5a46c8cb040c261706}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}}
\index{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}]{\setlength{\rightskip}{0pt plus 5cm}K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T (
\begin{DoxyParamCaption}
\item[{offsetof({\bf S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, Handle\-Count)}]{ = {\ttfamily =96}}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_ad41491d808f9ce5a46c8cb040c261706}
\hypertarget{z__Windows__NT__util_8c_adc0f11989762c8e24e79b2f47edf6049}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}}
\index{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}]{\setlength{\rightskip}{0pt plus 5cm}K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T (
\begin{DoxyParamCaption}
\item[{offsetof({\bf S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, V\-M\-Counters)}]{ = {\ttfamily =112}}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_adc0f11989762c8e24e79b2f47edf6049}
\hypertarget{z__Windows__NT__util_8c_a4ec300514e2495e897980f5e54035dfc}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}}
\index{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}]{\setlength{\rightskip}{0pt plus 5cm}K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T (
\begin{DoxyParamCaption}
\item[{offsetof({\bf S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, I\-O\-Counters)}]{ = {\ttfamily =208}}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_a4ec300514e2495e897980f5e54035dfc}
\hypertarget{z__Windows__NT__util_8c_afb6711dd3535c23c0edb4aed69af28ab}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}}
\index{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T@{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T}]{\setlength{\rightskip}{0pt plus 5cm}K\-M\-P\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-S\-S\-E\-R\-T (
\begin{DoxyParamCaption}
\item[{offsetof({\bf S\-Y\-S\-T\-E\-M\-\_\-\-P\-R\-O\-C\-E\-S\-S\-\_\-\-I\-N\-F\-O\-R\-M\-A\-T\-I\-O\-N}, Threads)}]{ = {\ttfamily =256}}
\end{DoxyParamCaption}
)}}\label{z__Windows__NT__util_8c_afb6711dd3535c23c0edb4aed69af28ab}


\subsection{Variable Documentation}
\hypertarget{z__Windows__NT__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-init\-\_\-runtime@{\-\_\-\-\_\-kmp\-\_\-init\-\_\-runtime}}
\index{\-\_\-\-\_\-kmp\-\_\-init\-\_\-runtime@{\-\_\-\-\_\-kmp\-\_\-init\-\_\-runtime}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-init\-\_\-runtime}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-init\-\_\-runtime = {\bf F\-A\-L\-S\-E}}}\label{z__Windows__NT__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}


Definition at line 147 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.

\hypertarget{z__Windows__NT__util_8c_a9603a8d81356b569383be9f81d491a94}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-monitor\-\_\-ev@{\-\_\-\-\_\-kmp\-\_\-monitor\-\_\-ev}}
\index{\-\_\-\-\_\-kmp\-\_\-monitor\-\_\-ev@{\-\_\-\-\_\-kmp\-\_\-monitor\-\_\-ev}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-monitor\-\_\-ev}]{\setlength{\rightskip}{0pt plus 5cm}H\-A\-N\-D\-L\-E \-\_\-\-\_\-kmp\-\_\-monitor\-\_\-ev\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Windows__NT__util_8c_a9603a8d81356b569383be9f81d491a94}


Definition at line 143 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.

\hypertarget{z__Windows__NT__util_8c_a2bc5381853ed1ae280d4d481b393f249}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-win32\-\_\-section@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-section}}
\index{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-section@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-section}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-section}]{\setlength{\rightskip}{0pt plus 5cm}C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-S\-E\-C\-T\-I\-O\-N \-\_\-\-\_\-kmp\-\_\-win32\-\_\-section}}\label{z__Windows__NT__util_8c_a2bc5381853ed1ae280d4d481b393f249}


Definition at line 148 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.

\hypertarget{z__Windows__NT__util_8c_a7d804e92be16ffc1446125dbe0b744d1}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-win32\-\_\-tick@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-tick}}
\index{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-tick@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-tick}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-tick}]{\setlength{\rightskip}{0pt plus 5cm}double \-\_\-\-\_\-kmp\-\_\-win32\-\_\-tick}}\label{z__Windows__NT__util_8c_a7d804e92be16ffc1446125dbe0b744d1}


Definition at line 145 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-elapsed(), \-\_\-\-\_\-kmp\-\_\-elapsed\-\_\-tick(), and \-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time().

\hypertarget{z__Windows__NT__util_8c_afd6cc2ba15915e1f3ff7182c4714b89b}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-win32\-\_\-time@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-time}}
\index{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-time@{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-time}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-win32\-\_\-time}]{\setlength{\rightskip}{0pt plus 5cm}kmp\-\_\-int64 \-\_\-\-\_\-kmp\-\_\-win32\-\_\-time\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Windows__NT__util_8c_afd6cc2ba15915e1f3ff7182c4714b89b}


Definition at line 144 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time().

\hypertarget{z__Windows__NT__util_8c_a8a496cb7a3d14a50bfd397fe68f8a6af}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!ntdll@{ntdll}}
\index{ntdll@{ntdll}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{ntdll}]{\setlength{\rightskip}{0pt plus 5cm}H\-M\-O\-D\-U\-L\-E ntdll = N\-U\-L\-L}}\label{z__Windows__NT__util_8c_a8a496cb7a3d14a50bfd397fe68f8a6af}


Definition at line 126 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.

\hypertarget{z__Windows__NT__util_8c_a57d2507b348b6039546c1ac06885c249}{\index{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}!Nt\-Query\-System\-Information@{Nt\-Query\-System\-Information}}
\index{Nt\-Query\-System\-Information@{Nt\-Query\-System\-Information}!z_Windows_NT_util.c@{z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c}}
\subsubsection[{Nt\-Query\-System\-Information}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Nt\-Query\-System\-Information\-\_\-t} Nt\-Query\-System\-Information = N\-U\-L\-L}}\label{z__Windows__NT__util_8c_a57d2507b348b6039546c1ac06885c249}


Definition at line 124 of file z\-\_\-\-Windows\-\_\-\-N\-T\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-get\-\_\-load\-\_\-balance().

