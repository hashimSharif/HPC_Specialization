\hypertarget{kmp__tasking_8c}{\section{kmp\-\_\-tasking.\-c File Reference}
\label{kmp__tasking_8c}\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}}
}
{\ttfamily \#include \char`\"{}kmp.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-i18n.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-itt.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-wait\-\_\-release.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-stats.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a98d61b65441709c36e312a5687bee6ac}{\-\_\-\-\_\-kmp\-\_\-enable\-\_\-tasking} (\hyperlink{kmp_8h_a1570ef2f4a50702c1be60039e4f5e605}{kmp\-\_\-task\-\_\-team\-\_\-t} $\ast$task\-\_\-team, \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$this\-\_\-thr)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_aed22cf1086a01e5f909f2388f4799f24}{\-\_\-\-\_\-kmp\-\_\-alloc\-\_\-task\-\_\-deque} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$thread, \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\-\_\-thread\-\_\-data\-\_\-t} $\ast$thread\-\_\-data)
\item 
static \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{kmp__tasking_8c_abf7a6f74ec729456a17e9af61df7a624}{\-\_\-\-\_\-kmp\-\_\-realloc\-\_\-task\-\_\-threads\-\_\-data} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$thread, \hyperlink{kmp_8h_a1570ef2f4a50702c1be60039e4f5e605}{kmp\-\_\-task\-\_\-team\-\_\-t} $\ast$task\-\_\-team)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a346d02e275d2c2ff66c4a17d7e012f37}{\-\_\-\-\_\-kmp\-\_\-null\-\_\-resume\-\_\-wrapper} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} gtid, volatile \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$flag)
\item 
static kmp\-\_\-int32 \hyperlink{kmp__tasking_8c_a8680b6e7d17754968a23499e185ae51f}{\-\_\-\-\_\-kmp\-\_\-push\-\_\-task} (kmp\-\_\-int32 gtid, \hyperlink{group__BASIC__TYPES_ga2783514e154e897944132a3ba6ed8789}{kmp\-\_\-task\-\_\-t} $\ast$\hyperlink{ittnotify__static_8h_aed9673d42c4239c5498e39aad80df904}{task})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_ae3470280dc2ee8dde4f95debde6575e4}{\-\_\-\-\_\-kmp\-\_\-pop\-\_\-current\-\_\-task\-\_\-from\-\_\-thread} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$this\-\_\-thr)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_acbb44e4a3167875a9a9d4b5eca8fb3d8}{\-\_\-\-\_\-kmp\-\_\-push\-\_\-current\-\_\-task\-\_\-to\-\_\-thread} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$this\-\_\-thr, \hyperlink{kmp_8h_a95f7a64bda9b774add6c27c4a7b2a143}{kmp\-\_\-team\-\_\-t} $\ast$team, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} tid)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a260526cdd24e8cf269a2af7df3258b0e}{\-\_\-\-\_\-kmp\-\_\-task\-\_\-start} (kmp\-\_\-int32 gtid, \hyperlink{group__BASIC__TYPES_ga2783514e154e897944132a3ba6ed8789}{kmp\-\_\-task\-\_\-t} $\ast$\hyperlink{ittnotify__static_8h_aed9673d42c4239c5498e39aad80df904}{task}, \hyperlink{kmp_8h_af73aa077ec760ca83750f8144a5e65fb}{kmp\-\_\-taskdata\-\_\-t} $\ast$current\-\_\-task)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a3bacb88486fc4653eb456f8982f7c6e8}{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-begin\-\_\-if0} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc\-\_\-ref, kmp\-\_\-int32 gtid, \hyperlink{group__BASIC__TYPES_ga2783514e154e897944132a3ba6ed8789}{kmp\-\_\-task\-\_\-t} $\ast$\hyperlink{ittnotify__static_8h_aed9673d42c4239c5498e39aad80df904}{task})
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a76eb2ed770af199a808b9c3b30e94f65}{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task} (kmp\-\_\-int32 gtid, \hyperlink{kmp_8h_af73aa077ec760ca83750f8144a5e65fb}{kmp\-\_\-taskdata\-\_\-t} $\ast$taskdata, \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$thread)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a45ba0fe4070338321814da7f9b0d7364}{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-and\-\_\-ancestors} (kmp\-\_\-int32 gtid, \hyperlink{kmp_8h_af73aa077ec760ca83750f8144a5e65fb}{kmp\-\_\-taskdata\-\_\-t} $\ast$taskdata, \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$thread)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a25ab616c3e16ed294de1f4838ff74aef}{\-\_\-\-\_\-kmp\-\_\-task\-\_\-finish} (kmp\-\_\-int32 gtid, \hyperlink{group__BASIC__TYPES_ga2783514e154e897944132a3ba6ed8789}{kmp\-\_\-task\-\_\-t} $\ast$\hyperlink{ittnotify__static_8h_aed9673d42c4239c5498e39aad80df904}{task}, \hyperlink{kmp_8h_af73aa077ec760ca83750f8144a5e65fb}{kmp\-\_\-taskdata\-\_\-t} $\ast$resumed\-\_\-task)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a3315cb8b0dc9f5863edb0229c535a3d6}{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-complete\-\_\-if0} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc\-\_\-ref, kmp\-\_\-int32 gtid, \hyperlink{group__BASIC__TYPES_ga2783514e154e897944132a3ba6ed8789}{kmp\-\_\-task\-\_\-t} $\ast$\hyperlink{ittnotify__static_8h_aed9673d42c4239c5498e39aad80df904}{task})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a8387c1b95f3b497a14fc3916515ad4c3}{\-\_\-\-\_\-kmp\-\_\-init\-\_\-implicit\-\_\-task} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc\-\_\-ref, \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$this\-\_\-thr, \hyperlink{kmp_8h_a95f7a64bda9b774add6c27c4a7b2a143}{kmp\-\_\-team\-\_\-t} $\ast$team, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} tid, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} set\-\_\-curr\-\_\-task)
\item 
static size\-\_\-t \hyperlink{kmp__tasking_8c_aae70dda0695f463bf14776f84d02f7b9}{\-\_\-\-\_\-kmp\-\_\-round\-\_\-up\-\_\-to\-\_\-val} (size\-\_\-t \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size}, size\-\_\-t val)
\item 
\hyperlink{group__BASIC__TYPES_ga2783514e154e897944132a3ba6ed8789}{kmp\-\_\-task\-\_\-t} $\ast$ \hyperlink{kmp__tasking_8c_a7a0441f3fc01669f2f7f2c2954f77bdb}{\-\_\-\-\_\-kmp\-\_\-task\-\_\-alloc} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc\-\_\-ref, kmp\-\_\-int32 gtid, \hyperlink{kmp_8h_aae6caf584826156e4957a68682e38420}{kmp\-\_\-tasking\-\_\-flags\-\_\-t} $\ast$flags, size\-\_\-t sizeof\-\_\-kmp\-\_\-task\-\_\-t, size\-\_\-t sizeof\-\_\-shareds, \hyperlink{group__BASIC__TYPES_ga76e21422ff9984d9bafd0b36277ae115}{kmp\-\_\-routine\-\_\-entry\-\_\-t} task\-\_\-entry)
\item 
\hyperlink{group__BASIC__TYPES_ga2783514e154e897944132a3ba6ed8789}{kmp\-\_\-task\-\_\-t} $\ast$ \hyperlink{kmp__tasking_8c_a26b7b2c9f53459685ed424ddefe1260c}{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-alloc} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc\-\_\-ref, kmp\-\_\-int32 gtid, kmp\-\_\-int32 flags, size\-\_\-t sizeof\-\_\-kmp\-\_\-task\-\_\-t, size\-\_\-t sizeof\-\_\-shareds, \hyperlink{group__BASIC__TYPES_ga76e21422ff9984d9bafd0b36277ae115}{kmp\-\_\-routine\-\_\-entry\-\_\-t} task\-\_\-entry)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a4bfeb67d512f48a8f79ceb5ea0bdc1d7}{\-\_\-\-\_\-kmp\-\_\-invoke\-\_\-task} (kmp\-\_\-int32 gtid, \hyperlink{group__BASIC__TYPES_ga2783514e154e897944132a3ba6ed8789}{kmp\-\_\-task\-\_\-t} $\ast$\hyperlink{ittnotify__static_8h_aed9673d42c4239c5498e39aad80df904}{task}, \hyperlink{kmp_8h_af73aa077ec760ca83750f8144a5e65fb}{kmp\-\_\-taskdata\-\_\-t} $\ast$current\-\_\-task)
\item 
kmp\-\_\-int32 \hyperlink{kmp__tasking_8c_a7dbc4568b1892b9f82ceeab53bcd5fce}{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-parts} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc\-\_\-ref, kmp\-\_\-int32 gtid, \hyperlink{group__BASIC__TYPES_ga2783514e154e897944132a3ba6ed8789}{kmp\-\_\-task\-\_\-t} $\ast$new\-\_\-task)
\item 
kmp\-\_\-int32 \hyperlink{kmp__tasking_8c_ae2e47b86ed1dc13258c5969b02b4c971}{\-\_\-\-\_\-kmp\-\_\-omp\-\_\-task} (kmp\-\_\-int32 gtid, \hyperlink{group__BASIC__TYPES_ga2783514e154e897944132a3ba6ed8789}{kmp\-\_\-task\-\_\-t} $\ast$new\-\_\-task, bool serialize\-\_\-immediate)
\item 
kmp\-\_\-int32 \hyperlink{kmp__tasking_8c_a25af9574d53be55422c50d824dc31e01}{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc\-\_\-ref, kmp\-\_\-int32 gtid, \hyperlink{group__BASIC__TYPES_ga2783514e154e897944132a3ba6ed8789}{kmp\-\_\-task\-\_\-t} $\ast$new\-\_\-task)
\item 
kmp\-\_\-int32 \hyperlink{kmp__tasking_8c_aca1d4fc4e3806ec10bc80023395e9877}{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-taskwait} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc\-\_\-ref, kmp\-\_\-int32 gtid)
\item 
kmp\-\_\-int32 \hyperlink{kmp__tasking_8c_a236ce7c159e9173eeedfdbd9302fc5e0}{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-taskyield} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc\-\_\-ref, kmp\-\_\-int32 gtid, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} end\-\_\-part)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_adefa1c9d2f6ccdeea3373d518ea8694e}{\-\_\-\-\_\-kmpc\-\_\-taskgroup} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} gtid)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a3a8f3bed14519d54ee8f61af3759564f}{\-\_\-\-\_\-kmpc\-\_\-end\-\_\-taskgroup} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} gtid)
\item 
static \hyperlink{group__BASIC__TYPES_ga2783514e154e897944132a3ba6ed8789}{kmp\-\_\-task\-\_\-t} $\ast$ \hyperlink{kmp__tasking_8c_a0a77c0e2bc6507126e97141974373702}{\-\_\-\-\_\-kmp\-\_\-remove\-\_\-my\-\_\-task} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$thread, kmp\-\_\-int32 gtid, \hyperlink{kmp_8h_a1570ef2f4a50702c1be60039e4f5e605}{kmp\-\_\-task\-\_\-team\-\_\-t} $\ast$task\-\_\-team, kmp\-\_\-int32 is\-\_\-constrained)
\item 
static \hyperlink{group__BASIC__TYPES_ga2783514e154e897944132a3ba6ed8789}{kmp\-\_\-task\-\_\-t} $\ast$ \hyperlink{kmp__tasking_8c_a416c88d9ab9aa62c4ed0b110b1cc0d7b}{\-\_\-\-\_\-kmp\-\_\-steal\-\_\-task} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$victim, kmp\-\_\-int32 gtid, \hyperlink{kmp_8h_a1570ef2f4a50702c1be60039e4f5e605}{kmp\-\_\-task\-\_\-team\-\_\-t} $\ast$task\-\_\-team, volatile kmp\-\_\-uint32 $\ast$unfinished\-\_\-threads, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} $\ast$thread\-\_\-finished, kmp\-\_\-int32 is\-\_\-constrained)
\item 
{\footnotesize template$<$class C $>$ }\\static \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{kmp__tasking_8c_a404525114425cf63065ee1cc9c8a1032}{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-template} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$thread, kmp\-\_\-int32 gtid, C $\ast$flag, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} final\-\_\-spin, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} $\ast$thread\-\_\-finished \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{U\-S\-E\-\_\-\-I\-T\-T\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-R\-G}(\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$itt\-\_\-sync\-\_\-obj), kmp\-\_\-int32 is\-\_\-constrained)
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{kmp__tasking_8c_a364d937a49ecd51fe09bce93f4844a7e}{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-32} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$thread, kmp\-\_\-int32 gtid, \hyperlink{classkmp__flag__32}{kmp\-\_\-flag\-\_\-32} $\ast$flag, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} final\-\_\-spin, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} $\ast$thread\-\_\-finished \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{U\-S\-E\-\_\-\-I\-T\-T\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-R\-G}(\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$itt\-\_\-sync\-\_\-obj), kmp\-\_\-int32 is\-\_\-constrained)
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{kmp__tasking_8c_a8f5449a54fb2bebaf3211f2d19607e21}{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-64} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$thread, kmp\-\_\-int32 gtid, \hyperlink{classkmp__flag__64}{kmp\-\_\-flag\-\_\-64} $\ast$flag, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} final\-\_\-spin, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} $\ast$thread\-\_\-finished \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{U\-S\-E\-\_\-\-I\-T\-T\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-R\-G}(\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$itt\-\_\-sync\-\_\-obj), kmp\-\_\-int32 is\-\_\-constrained)
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{kmp__tasking_8c_aacf66e85881c3eb2a8795816abfd0f31}{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-oncore} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$thread, kmp\-\_\-int32 gtid, \hyperlink{classkmp__flag__oncore}{kmp\-\_\-flag\-\_\-oncore} $\ast$flag, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} final\-\_\-spin, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} $\ast$thread\-\_\-finished \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{U\-S\-E\-\_\-\-I\-T\-T\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-R\-G}(\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$itt\-\_\-sync\-\_\-obj), kmp\-\_\-int32 is\-\_\-constrained)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_aee19f743379ff8d87e9de386675422d6}{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-deque} (\hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\-\_\-thread\-\_\-data\-\_\-t} $\ast$thread\-\_\-data)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a63ab26c647493216462fbd8a639219c6}{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-threads\-\_\-data} (\hyperlink{kmp_8h_a1570ef2f4a50702c1be60039e4f5e605}{kmp\-\_\-task\-\_\-team\-\_\-t} $\ast$task\-\_\-team)
\item 
static \hyperlink{kmp_8h_a1570ef2f4a50702c1be60039e4f5e605}{kmp\-\_\-task\-\_\-team\-\_\-t} $\ast$ \hyperlink{kmp__tasking_8c_ac7e7f9850e866f8ee7dd5375227e250d}{\-\_\-\-\_\-kmp\-\_\-allocate\-\_\-task\-\_\-team} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$thread, \hyperlink{kmp_8h_a95f7a64bda9b774add6c27c4a7b2a143}{kmp\-\_\-team\-\_\-t} $\ast$team)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a006431c8d77d632eeb5b6f8c16d9fd87}{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-team} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$thread, \hyperlink{kmp_8h_a1570ef2f4a50702c1be60039e4f5e605}{kmp\-\_\-task\-\_\-team\-\_\-t} $\ast$task\-\_\-team)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a22a6e6a06a23962fc8de80d5d474e82c}{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-task\-\_\-teams} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a2ba40a9ae9c2993a034826efe186f41c}{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-to\-\_\-unref\-\_\-task\-\_\-teams} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_af98fb3c3ffb814bf6a38fc90dbe07fcc}{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-setup} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$this\-\_\-thr, \hyperlink{kmp_8h_a95f7a64bda9b774add6c27c4a7b2a143}{kmp\-\_\-team\-\_\-t} $\ast$team, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} always)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_a2c905b30d1208bb65979ea579f9b64f1}{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-sync} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$this\-\_\-thr, \hyperlink{kmp_8h_a95f7a64bda9b774add6c27c4a7b2a143}{kmp\-\_\-team\-\_\-t} $\ast$team)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_ae6f631ec9b8c83a4c0aa57cfced40c2a}{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-wait} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$this\-\_\-thr, \hyperlink{kmp_8h_a95f7a64bda9b774add6c27c4a7b2a143}{kmp\-\_\-team\-\_\-t} $\ast$team, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} wait)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__tasking_8c_aaada49301d2ae62b774b7d55dd220b5a}{\-\_\-\-\_\-kmp\-\_\-tasking\-\_\-barrier} (\hyperlink{kmp_8h_a95f7a64bda9b774add6c27c4a7b2a143}{kmp\-\_\-team\-\_\-t} $\ast$team, \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$thread, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} gtid)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{kmp_8h_a1570ef2f4a50702c1be60039e4f5e605}{kmp\-\_\-task\-\_\-team\-\_\-t} $\ast$ \hyperlink{kmp__tasking_8c_ac0f8028d2592221f303450428fa1e680}{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-teams} = N\-U\-L\-L
\item 
static \hyperlink{kmp__lock_8h_a480dc901a9c2be2a41f0ab8c381e94a7}{kmp\-\_\-bootstrap\-\_\-lock\-\_\-t} \hyperlink{kmp__tasking_8c_a41e8ad7ff702abc83af1e3c4d47a2e47}{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-lock} = \hyperlink{kmp__lock_8h_af85df20d1de9792c1ca66289d6922b51}{K\-M\-P\-\_\-\-B\-O\-O\-T\-S\-T\-R\-A\-P\-\_\-\-L\-O\-C\-K\-\_\-\-I\-N\-I\-T\-I\-A\-L\-I\-Z\-E\-R}( \-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-lock )
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{kmp__tasking_8c_aed22cf1086a01e5f909f2388f4799f24}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-alloc\-\_\-task\-\_\-deque@{\-\_\-\-\_\-kmp\-\_\-alloc\-\_\-task\-\_\-deque}}
\index{\-\_\-\-\_\-kmp\-\_\-alloc\-\_\-task\-\_\-deque@{\-\_\-\-\_\-kmp\-\_\-alloc\-\_\-task\-\_\-deque}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-alloc\-\_\-task\-\_\-deque}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-alloc\-\_\-task\-\_\-deque (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{thread, }
\item[{{\bf kmp\-\_\-thread\-\_\-data\-\_\-t} $\ast$}]{thread\-\_\-data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_aed22cf1086a01e5f909f2388f4799f24}


Definition at line 2202 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-push\-\_\-task(), and \-\_\-\-\_\-kmp\-\_\-task\-\_\-alloc().


\begin{DoxyCode}
2203 \{
2204     \hyperlink{kmp__lock_8h_ad0724dc0da849eb1ed970306cbf96e7b}{\_\_kmp\_init\_bootstrap\_lock}( & thread\_data -> td.td\_deque\_lock );
2205     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( thread\_data -> td.td\_deque == NULL );
2206 
2207     \textcolor{comment}{// Initialize last stolen task field to "none"}
2208     thread\_data -> td.td\_deque\_last\_stolen = -1;
2209 
2210     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(thread\_data -> td.td\_deque\_ntasks) == 0 );
2211     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( thread\_data -> td.td\_deque\_head == 0 );
2212     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( thread\_data -> td.td\_deque\_tail == 0 );
2213 
2214     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_alloc\_task\_deque: T#%d allocating deque[%d] for thread\_data %p\(\backslash\)n"},
2215                    \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( thread ), 
      \hyperlink{kmp_8h_ad0d7ca7c2df268bc02d6ee85803e02ef}{TASK\_DEQUE\_SIZE}, thread\_data ) );
2216     \textcolor{comment}{// Allocate space for task deque, and zero the deque}
2217     \textcolor{comment}{// Cannot use \_\_kmp\_thread\_calloc() because threads not around for}
2218     \textcolor{comment}{// kmp\_reap\_task\_team( ).}
2219     thread\_data -> td.td\_deque = (\hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} **)
2220             \hyperlink{kmp_8h_aa6a69b47037dcffbfc5dba21a4a64d85}{\_\_kmp\_allocate}( \hyperlink{kmp_8h_ad0d7ca7c2df268bc02d6ee85803e02ef}{TASK\_DEQUE\_SIZE} * \textcolor{keyword}{sizeof}(
      \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} *));
2221 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_ac7e7f9850e866f8ee7dd5375227e250d}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-allocate\-\_\-task\-\_\-team@{\-\_\-\-\_\-kmp\-\_\-allocate\-\_\-task\-\_\-team}}
\index{\-\_\-\-\_\-kmp\-\_\-allocate\-\_\-task\-\_\-team@{\-\_\-\-\_\-kmp\-\_\-allocate\-\_\-task\-\_\-team}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-allocate\-\_\-task\-\_\-team}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf kmp\-\_\-task\-\_\-team\-\_\-t}$\ast$ \-\_\-\-\_\-kmp\-\_\-allocate\-\_\-task\-\_\-team (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{thread, }
\item[{{\bf kmp\-\_\-team\-\_\-t} $\ast$}]{team}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_ac7e7f9850e866f8ee7dd5375227e250d}


Definition at line 2390 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-setup().


\begin{DoxyCode}
2391 \{
2392     \hyperlink{unionkmp__task__team}{kmp\_task\_team\_t} *task\_team = NULL;
2393     \textcolor{keywordtype}{int} nthreads;
2394 
2395     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 20, ( \textcolor{stringliteral}{"\_\_kmp\_allocate\_task\_team: T#%d entering; team = %p\(\backslash\)n"},
2396                     (thread ? \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( thread ) : -1), team ) );
2397 
2398     \textcolor{keywordflow}{if} (\hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}(\hyperlink{kmp__tasking_8c_ac0f8028d2592221f303450428fa1e680}{\_\_kmp\_free\_task\_teams}) != NULL) \{
2399         \textcolor{comment}{// Take a task team from the task team pool}
2400         \hyperlink{kmp__lock_8h_a85412da5c0d085bde951a77690cf1f74}{\_\_kmp\_acquire\_bootstrap\_lock}( &
      \hyperlink{kmp__tasking_8c_a41e8ad7ff702abc83af1e3c4d47a2e47}{\_\_kmp\_task\_team\_lock} );
2401         \textcolor{keywordflow}{if} (\hyperlink{kmp__tasking_8c_ac0f8028d2592221f303450428fa1e680}{\_\_kmp\_free\_task\_teams} != NULL) \{
2402             task\_team = \hyperlink{kmp__tasking_8c_ac0f8028d2592221f303450428fa1e680}{\_\_kmp\_free\_task\_teams};
2403             \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(\hyperlink{kmp__tasking_8c_ac0f8028d2592221f303450428fa1e680}{\_\_kmp\_free\_task\_teams}, task\_team -> tt.tt\_next);
2404             task\_team -> tt.tt\_next = NULL;
2405         \}
2406         \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( &
      \hyperlink{kmp__tasking_8c_a41e8ad7ff702abc83af1e3c4d47a2e47}{\_\_kmp\_task\_team\_lock} );
2407     \}
2408 
2409     \textcolor{keywordflow}{if} (task\_team == NULL) \{
2410         \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_allocate\_task\_team: T#%d allocating "}
2411                        \textcolor{stringliteral}{"task team for team %p\(\backslash\)n"},
2412                        \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( thread ), team ) );
2413         \textcolor{comment}{// Allocate a new task team if one is not available.}
2414         \textcolor{comment}{// Cannot use \_\_kmp\_thread\_malloc() because threads not around for}
2415         \textcolor{comment}{// kmp\_reap\_task\_team( ).}
2416         task\_team = (\hyperlink{unionkmp__task__team}{kmp\_task\_team\_t} *) \hyperlink{kmp_8h_aa6a69b47037dcffbfc5dba21a4a64d85}{\_\_kmp\_allocate}( \textcolor{keyword}{sizeof}(
      \hyperlink{unionkmp__task__team}{kmp\_task\_team\_t}) );
2417         \hyperlink{kmp__lock_8h_ad0724dc0da849eb1ed970306cbf96e7b}{\_\_kmp\_init\_bootstrap\_lock}( & task\_team -> tt.tt\_threads\_lock );
2418         \textcolor{comment}{//task\_team -> tt.tt\_threads\_data = NULL;   // AC: \_\_kmp\_allocate zeroes returned memory}
2419         \textcolor{comment}{//task\_team -> tt.tt\_max\_threads = 0;}
2420         \textcolor{comment}{//task\_team -> tt.tt\_next = NULL;}
2421     \}
2422 
2423     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(task\_team -> tt.tt\_found\_tasks, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
2424 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
2425 \textcolor{preprocessor}{}    \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(task\_team -> tt.tt\_found\_proxy\_tasks, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
2426 \textcolor{preprocessor}{#endif}
2427 \textcolor{preprocessor}{}    task\_team -> tt.tt\_nproc = nthreads = team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc;
2428 
2429     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( task\_team -> tt.tt\_unfinished\_threads, nthreads );
2430     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( task\_team -> tt.tt\_active, \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} );
2431 
2432     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 20, ( \textcolor{stringliteral}{"\_\_kmp\_allocate\_task\_team: T#%d exiting; task\_team = %p unfinished\_threads
       init'd to %d\(\backslash\)n"},
2433                     (thread ? \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( thread ) : -1), task\_team, 
      task\_team -> tt.tt\_unfinished\_threads) );
2434     \textcolor{keywordflow}{return} task\_team;
2435 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a98d61b65441709c36e312a5687bee6ac}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-enable\-\_\-tasking@{\-\_\-\-\_\-kmp\-\_\-enable\-\_\-tasking}}
\index{\-\_\-\-\_\-kmp\-\_\-enable\-\_\-tasking@{\-\_\-\-\_\-kmp\-\_\-enable\-\_\-tasking}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-enable\-\_\-tasking}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-enable\-\_\-tasking (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-task\-\_\-team\-\_\-t} $\ast$}]{task\-\_\-team, }
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{this\-\_\-thr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_a98d61b65441709c36e312a5687bee6ac}


Definition at line 2085 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-push\-\_\-task(), and \-\_\-\-\_\-kmp\-\_\-task\-\_\-alloc().


\begin{DoxyCode}
2086 \{
2087     \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} *threads\_data;
2088     \textcolor{keywordtype}{int} nthreads, \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i}, is\_init\_thread;
2089 
2090     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_enable\_tasking(enter): T#%d\(\backslash\)n"},
2091                     \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( this\_thr ) ) );
2092 
2093     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(task\_team != NULL);
2094     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(this\_thr->th.th\_team != NULL);
2095 
2096     nthreads = task\_team->\hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.\hyperlink{structkmp__base__task__team_a0e3fe27829e52d0100074babe5f7ed2d}{tt\_nproc};
2097     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(nthreads > 0);
2098     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(nthreads == this\_thr->th.th\_team->t.t\_nproc);
2099 
2100     \textcolor{comment}{// Allocate or increase the size of threads\_data if necessary}
2101     is\_init\_thread = \hyperlink{kmp__tasking_8c_abf7a6f74ec729456a17e9af61df7a624}{\_\_kmp\_realloc\_task\_threads\_data}( this\_thr, task\_team );
2102 
2103     \textcolor{keywordflow}{if} (!is\_init\_thread) \{
2104         \textcolor{comment}{// Some other thread already set up the array.}
2105         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 20, ( \textcolor{stringliteral}{"\_\_kmp\_enable\_tasking(exit): T#%d: threads array already set up.\(\backslash\)n"},
2106                         \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( this\_thr ) ) );
2107         \textcolor{keywordflow}{return};
2108     \}
2109     threads\_data = (\hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} *)\hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}(task\_team -> tt.tt\_threads\_data);
2110     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( threads\_data != NULL );
2111 
2112     \textcolor{keywordflow}{if} ( ( \hyperlink{kmp_8h_a39e87c52fb75a615c2564a822a013a5a}{\_\_kmp\_tasking\_mode} == \hyperlink{kmp_8h_aad1bdfbfac136cfd92611bcee79ca3f2ac2529646fad02f49ff61ec4c50287a5d}{tskm\_task\_teams} ) &&
2113          ( \hyperlink{kmp_8h_a3b56e2e90e1539c0b794e4137724bc1c}{\_\_kmp\_dflt\_blocktime} != \hyperlink{kmp_8h_a1ca6c6ce04115f143dc5df627de57958}{KMP\_MAX\_BLOCKTIME} ) )
2114     \{
2115         \textcolor{comment}{// Release any threads sleeping at the barrier, so that they can steal}
2116         \textcolor{comment}{// tasks and execute them.  In extra barrier mode, tasks do not sleep}
2117         \textcolor{comment}{// at the separate tasking barrier, so this isn't a problem.}
2118         \textcolor{keywordflow}{for} (i = 0; i < nthreads; i++) \{
2119             \textcolor{keyword}{volatile} \textcolor{keywordtype}{void} *sleep\_loc;
2120             \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *thread = threads\_data[\hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i}].td.td\_thr;
2121 
2122             \textcolor{keywordflow}{if} (i == this\_thr->th.th\_info.ds.ds\_tid) \{
2123                 \textcolor{keywordflow}{continue};
2124             \}
2125             \textcolor{comment}{// Since we haven't locked the thread's suspend mutex lock at this}
2126             \textcolor{comment}{// point, there is a small window where a thread might be putting}
2127             \textcolor{comment}{// itself to sleep, but hasn't set the th\_sleep\_loc field yet.}
2128             \textcolor{comment}{// To work around this, \_\_kmp\_execute\_tasks\_template() periodically checks}
2129             \textcolor{comment}{// see if other threads are sleeping (using the same random}
2130             \textcolor{comment}{// mechanism that is used for task stealing) and awakens them if}
2131             \textcolor{comment}{// they are.}
2132             \textcolor{keywordflow}{if} ( ( sleep\_loc = \hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}( thread -> th.th\_sleep\_loc) ) != NULL )
2133             \{
2134                 \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 50, ( \textcolor{stringliteral}{"\_\_kmp\_enable\_tasking: T#%d waking up thread T#%d\(\backslash\)n"},
2135                                  \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( this\_thr ),
2136                                  \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( thread ) ) );
2137                 \hyperlink{kmp__tasking_8c_a346d02e275d2c2ff66c4a17d7e012f37}{\_\_kmp\_null\_resume\_wrapper}(
      \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}(thread), sleep\_loc);
2138             \}
2139             \textcolor{keywordflow}{else} \{
2140                 \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 50, ( \textcolor{stringliteral}{"\_\_kmp\_enable\_tasking: T#%d don't wake up thread T#%d\(\backslash\)n"},
2141                                  \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( this\_thr ),
2142                                  \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( thread ) ) );
2143             \}
2144         \}
2145     \}
2146 
2147     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_enable\_tasking(exit): T#%d\(\backslash\)n"},
2148                     \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( this\_thr ) ) );
2149 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a364d937a49ecd51fe09bce93f4844a7e}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-32@{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-32}}
\index{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-32@{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-32}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-32}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-32 (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{thread, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-flag\-\_\-32} $\ast$}]{flag, }
\item[{{\bf int}}]{final\-\_\-spin, }
\item[{{\bf int} $\ast$thread\-\_\-finished }]{U\-S\-E\-\_\-\-I\-T\-T\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-R\-Gvoid $\ast$itt\-\_\-sync\-\_\-obj, }
\item[{kmp\-\_\-int32}]{is\-\_\-constrained}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_a364d937a49ecd51fe09bce93f4844a7e}


Definition at line 2053 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmpc\-\_\-omp\-\_\-taskyield().


\begin{DoxyCode}
2056 \{
2057     \textcolor{keywordflow}{return} \hyperlink{kmp__tasking_8c_a404525114425cf63065ee1cc9c8a1032}{\_\_kmp\_execute\_tasks\_template}(thread, gtid, flag, final\_spin, 
      thread\_finished
2058                                         \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{USE\_ITT\_BUILD\_ARG}(itt\_sync\_obj), is\_constrained);
2059 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a8f5449a54fb2bebaf3211f2d19607e21}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-64@{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-64}}
\index{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-64@{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-64}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-64}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-64 (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{thread, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-flag\-\_\-64} $\ast$}]{flag, }
\item[{{\bf int}}]{final\-\_\-spin, }
\item[{{\bf int} $\ast$thread\-\_\-finished }]{U\-S\-E\-\_\-\-I\-T\-T\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-R\-Gvoid $\ast$itt\-\_\-sync\-\_\-obj, }
\item[{kmp\-\_\-int32}]{is\-\_\-constrained}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_a8f5449a54fb2bebaf3211f2d19607e21}


Definition at line 2061 of file kmp\-\_\-tasking.\-c.


\begin{DoxyCode}
2064 \{
2065     \textcolor{keywordflow}{return} \hyperlink{kmp__tasking_8c_a404525114425cf63065ee1cc9c8a1032}{\_\_kmp\_execute\_tasks\_template}(thread, gtid, flag, final\_spin, 
      thread\_finished
2066                                         \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{USE\_ITT\_BUILD\_ARG}(itt\_sync\_obj), is\_constrained);
2067 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_aacf66e85881c3eb2a8795816abfd0f31}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-oncore@{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-oncore}}
\index{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-oncore@{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-oncore}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-oncore}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-oncore (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{thread, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-flag\-\_\-oncore} $\ast$}]{flag, }
\item[{{\bf int}}]{final\-\_\-spin, }
\item[{{\bf int} $\ast$thread\-\_\-finished }]{U\-S\-E\-\_\-\-I\-T\-T\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-R\-Gvoid $\ast$itt\-\_\-sync\-\_\-obj, }
\item[{kmp\-\_\-int32}]{is\-\_\-constrained}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_aacf66e85881c3eb2a8795816abfd0f31}


Definition at line 2069 of file kmp\-\_\-tasking.\-c.


\begin{DoxyCode}
2072 \{
2073     \textcolor{keywordflow}{return} \hyperlink{kmp__tasking_8c_a404525114425cf63065ee1cc9c8a1032}{\_\_kmp\_execute\_tasks\_template}(thread, gtid, flag, final\_spin, 
      thread\_finished
2074                                         \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{USE\_ITT\_BUILD\_ARG}(itt\_sync\_obj), is\_constrained);
2075 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a404525114425cf63065ee1cc9c8a1032}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-template@{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-template}}
\index{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-template@{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-template}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-template}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class C $>$ static {\bf int} \-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-template (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{thread, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{C $\ast$}]{flag, }
\item[{{\bf int}}]{final\-\_\-spin, }
\item[{{\bf int} $\ast$thread\-\_\-finished }]{U\-S\-E\-\_\-\-I\-T\-T\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-R\-Gvoid $\ast$itt\-\_\-sync\-\_\-obj, }
\item[{kmp\-\_\-int32}]{is\-\_\-constrained}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{kmp__tasking_8c_a404525114425cf63065ee1cc9c8a1032}


Definition at line 1748 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-32(), \-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-64(), and \-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-oncore().


\begin{DoxyCode}
1751 \{
1752     \hyperlink{unionkmp__task__team}{kmp\_task\_team\_t} *     task\_team;
1753     \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} *   threads\_data;
1754     \hyperlink{structkmp__task}{kmp\_task\_t} *          \hyperlink{ittnotify__static_8h_aed9673d42c4239c5498e39aad80df904}{task};
1755     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} *      current\_task = thread -> th.th\_current\_task;
1756     \textcolor{keyword}{volatile} kmp\_uint32 * unfinished\_threads;
1757     kmp\_int32             nthreads, last\_stolen, k, tid;
1758 
1759     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp_8h_a39e87c52fb75a615c2564a822a013a5a}{\_\_kmp\_tasking\_mode} != 
      \hyperlink{kmp_8h_aad1bdfbfac136cfd92611bcee79ca3f2af827998cf4eb3f61723edc4943b86c98}{tskm\_immediate\_exec} );
1760     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( thread == \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ] );
1761 
1762     task\_team = thread -> th.th\_task\_team;
1763     \textcolor{keywordflow}{if} (task\_team == NULL) \textcolor{keywordflow}{return} \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1764 
1765     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(15, (\textcolor{stringliteral}{"\_\_kmp\_execute\_tasks\_template(enter): T#%d final\_spin=%d *thread\_finished=%d\(\backslash\)n"},
1766                   gtid, final\_spin, *thread\_finished) );
1767 
1768     threads\_data = (\hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} *)\hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}(task\_team -> tt.tt\_threads\_data);
1769     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( threads\_data != NULL );
1770 
1771     nthreads = task\_team -> tt.tt\_nproc;
1772     unfinished\_threads = &(task\_team -> tt.tt\_unfinished\_threads);
1773 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
1774 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( nthreads > 1 || task\_team->\hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.tt\_found\_proxy\_tasks);
1775 \textcolor{preprocessor}{#else}
1776 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( nthreads > 1 );
1777 \textcolor{preprocessor}{#endif}
1778 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}((\textcolor{keywordtype}{int})*unfinished\_threads) >= 0 );
1779 
1780     \textcolor{comment}{// Choose tasks from our own work queue.}
1781     start:
1782     \textcolor{keywordflow}{while} (( task = \hyperlink{kmp__tasking_8c_a0a77c0e2bc6507126e97141974373702}{\_\_kmp\_remove\_my\_task}( thread, gtid, task\_team, is\_constrained )) !=
       NULL ) \{
1783 \textcolor{preprocessor}{#if USE\_ITT\_BUILD && USE\_ITT\_NOTIFY}
1784 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( \hyperlink{group__sync_gab7f1ba7abf5c98e0e0e0ea53d0e34661}{\_\_itt\_sync\_create\_ptr} || KMP\_ITT\_DEBUG ) \{
1785             \textcolor{keywordflow}{if} ( itt\_sync\_obj == NULL ) \{
1786                 \textcolor{comment}{// we are at fork barrier where we could not get the object reliably}
1787                 itt\_sync\_obj  = \_\_kmp\_itt\_barrier\_object( gtid, 
      \hyperlink{kmp_8h_ad0f7c21f2f1d446087ef5714eb0fd8cfab7dbfe1300085e4a7825c809112aaf7c}{bs\_forkjoin\_barrier} );
1788             \}
1789             \_\_kmp\_itt\_task\_starting( itt\_sync\_obj );
1790         \}
1791 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD && USE\_ITT\_NOTIFY */}\textcolor{preprocessor}{}
1792 \textcolor{preprocessor}{}        \hyperlink{kmp__tasking_8c_a4bfeb67d512f48a8f79ceb5ea0bdc1d7}{\_\_kmp\_invoke\_task}( gtid, task, current\_task );
1793 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1794 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( itt\_sync\_obj != NULL )
1795             \_\_kmp\_itt\_task\_finished( itt\_sync\_obj );
1796 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1797 \textcolor{preprocessor}{}
1798         \textcolor{comment}{// If this thread is only partway through the barrier and the condition}
1799         \textcolor{comment}{// is met, then return now, so that the barrier gather/release pattern can proceed.}
1800         \textcolor{comment}{// If this thread is in the last spin loop in the barrier, waiting to be}
1801         \textcolor{comment}{// released, we know that the termination condition will not be satisified,}
1802         \textcolor{comment}{// so don't waste any cycles checking it.}
1803         \textcolor{keywordflow}{if} (flag == NULL || (!final\_spin && flag->done\_check())) \{
1804             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(15, (\textcolor{stringliteral}{"\_\_kmp\_execute\_tasks\_template(exit #1): T#%d spin condition satisfied\(\backslash\)n"},
       gtid) );
1805             \textcolor{keywordflow}{return} \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1806         \}
1807         \textcolor{keywordflow}{if} (thread->th.th\_task\_team == NULL) \textcolor{keywordflow}{break};
1808         \hyperlink{kmp_8h_a9f0d88d1970adda4ad38d272e65d7844}{KMP\_YIELD}( \hyperlink{kmp_8h_aa8f77de14d1515a05937d68622e74d61}{\_\_kmp\_library} == \hyperlink{kmp_8h_aee0cf894df4706d555a64e6d5b51599daadaa2a9ce75fbdb96025b8f6e9c2a4d7}{library\_throughput} );   \textcolor{comment}{//
       Yield before executing next task}
1809     \}
1810 
1811     \textcolor{comment}{// This thread's work queue is empty.  If we are in the final spin loop}
1812     \textcolor{comment}{// of the barrier, check and see if the termination condition is satisfied.}
1813 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
1814 \textcolor{preprocessor}{}    \textcolor{comment}{// The work queue may be empty but there might be proxy tasks still executing}
1815     \textcolor{keywordflow}{if} (final\_spin && \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(current\_task -> td\_incomplete\_child\_tasks) == 0) 
1816 \textcolor{preprocessor}{#else}
1817 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (final\_spin) 
1818 \textcolor{preprocessor}{#endif}
1819 \textcolor{preprocessor}{}    \{
1820         \textcolor{comment}{// First, decrement the #unfinished threads, if that has not already}
1821         \textcolor{comment}{// been done.  This decrement might be to the spin location, and}
1822         \textcolor{comment}{// result in the termination condition being satisfied.}
1823         \textcolor{keywordflow}{if} (! *thread\_finished) \{
1824             kmp\_uint32 \hyperlink{ittnotify__static_8h_a9da14338c9c3be6f21c41cf4ec79eaf1}{count};
1825 
1826             count = \hyperlink{kmp__os_8h_a5b23523b95ee4b2307a8f344cbbe8050}{KMP\_TEST\_THEN\_DEC32}( (kmp\_int32 *)unfinished\_threads ) - 1;
1827             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_execute\_tasks\_template(dec #1): T#%d dec unfinished\_threads to %d
       task\_team=%p\(\backslash\)n"},
1828                           gtid, count, task\_team) );
1829             *thread\_finished = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1830         \}
1831 
1832         \textcolor{comment}{// It is now unsafe to reference thread->th.th\_team !!!}
1833         \textcolor{comment}{// Decrementing task\_team->tt.tt\_unfinished\_threads can allow the master}
1834         \textcolor{comment}{// thread to pass through the barrier, where it might reset each thread's}
1835         \textcolor{comment}{// th.th\_team field for the next parallel region.}
1836         \textcolor{comment}{// If we can steal more work, we know that this has not happened yet.}
1837         \textcolor{keywordflow}{if} (flag != NULL && flag->done\_check()) \{
1838             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(15, (\textcolor{stringliteral}{"\_\_kmp\_execute\_tasks\_template(exit #2): T#%d spin condition satisfied\(\backslash\)n"},
       gtid) );
1839             \textcolor{keywordflow}{return} \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1840         \}
1841     \}
1842 
1843     \textcolor{keywordflow}{if} (thread->th.th\_task\_team == NULL) \textcolor{keywordflow}{return} \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1844 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
1845 \textcolor{preprocessor}{}    \textcolor{comment}{// check if there are other threads to steal from, otherwise go back}
1846     \textcolor{keywordflow}{if} ( nthreads  == 1 )
1847         \textcolor{keywordflow}{goto} start;
1848 \textcolor{preprocessor}{#endif}
1849 \textcolor{preprocessor}{}
1850     \textcolor{comment}{// Try to steal from the last place I stole from successfully.}
1851     tid = thread -> th.th\_info.ds.ds\_tid;\textcolor{comment}{//\_\_kmp\_tid\_from\_gtid( gtid );}
1852     last\_stolen = threads\_data[ tid ].td.td\_deque\_last\_stolen;
1853 
1854     \textcolor{keywordflow}{if} (last\_stolen != -1) \{
1855         \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *other\_thread = threads\_data[last\_stolen].td.td\_thr;
1856 
1857         \textcolor{keywordflow}{while} ((task = \hyperlink{kmp__tasking_8c_a416c88d9ab9aa62c4ed0b110b1cc0d7b}{\_\_kmp\_steal\_task}( other\_thread, gtid, task\_team, unfinished\_threads,
1858                                          thread\_finished, is\_constrained )) != NULL)
1859         \{
1860 \textcolor{preprocessor}{#if USE\_ITT\_BUILD && USE\_ITT\_NOTIFY}
1861 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} ( \hyperlink{group__sync_gab7f1ba7abf5c98e0e0e0ea53d0e34661}{\_\_itt\_sync\_create\_ptr} || KMP\_ITT\_DEBUG ) \{
1862                 \textcolor{keywordflow}{if} ( itt\_sync\_obj == NULL ) \{
1863                     \textcolor{comment}{// we are at fork barrier where we could not get the object reliably}
1864                     itt\_sync\_obj  = \_\_kmp\_itt\_barrier\_object( gtid, 
      \hyperlink{kmp_8h_ad0f7c21f2f1d446087ef5714eb0fd8cfab7dbfe1300085e4a7825c809112aaf7c}{bs\_forkjoin\_barrier} );
1865                 \}
1866                 \_\_kmp\_itt\_task\_starting( itt\_sync\_obj );
1867             \}
1868 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD && USE\_ITT\_NOTIFY */}\textcolor{preprocessor}{}
1869 \textcolor{preprocessor}{}            \hyperlink{kmp__tasking_8c_a4bfeb67d512f48a8f79ceb5ea0bdc1d7}{\_\_kmp\_invoke\_task}( gtid, task, current\_task );
1870 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1871 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} ( itt\_sync\_obj != NULL )
1872                 \_\_kmp\_itt\_task\_finished( itt\_sync\_obj );
1873 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1874 \textcolor{preprocessor}{}
1875             \textcolor{comment}{// Check to see if this thread can proceed.}
1876             \textcolor{keywordflow}{if} (flag == NULL || (!final\_spin && flag->done\_check())) \{
1877                 \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(15, (\textcolor{stringliteral}{"\_\_kmp\_execute\_tasks\_template(exit #3): T#%d spin condition satisfied
      \(\backslash\)n"},
1878                               gtid) );
1879                 \textcolor{keywordflow}{return} \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1880             \}
1881 
1882             \textcolor{keywordflow}{if} (thread->th.th\_task\_team == NULL) \textcolor{keywordflow}{break};
1883             \hyperlink{kmp_8h_a9f0d88d1970adda4ad38d272e65d7844}{KMP\_YIELD}( \hyperlink{kmp_8h_aa8f77de14d1515a05937d68622e74d61}{\_\_kmp\_library} == \hyperlink{kmp_8h_aee0cf894df4706d555a64e6d5b51599daadaa2a9ce75fbdb96025b8f6e9c2a4d7}{library\_throughput} );   \textcolor{comment}{//
       Yield before executing next task}
1884             \textcolor{comment}{// If the execution of the stolen task resulted in more tasks being}
1885             \textcolor{comment}{// placed on our run queue, then restart the whole process.}
1886             \textcolor{keywordflow}{if} (\hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(threads\_data[ tid ].td.td\_deque\_ntasks) != 0) \{
1887                 \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_execute\_tasks\_template: T#%d stolen task spawned other tasks,
       restart\(\backslash\)n"},
1888                               gtid) );
1889                 \textcolor{keywordflow}{goto} start;
1890             \}
1891         \}
1892 
1893         \textcolor{comment}{// Don't give priority to stealing from this thread anymore.}
1894         threads\_data[ tid ].td.td\_deque\_last\_stolen = -1;
1895 
1896         \textcolor{comment}{// The victims's work queue is empty.  If we are in the final spin loop}
1897         \textcolor{comment}{// of the barrier, check and see if the termination condition is satisfied.}
1898 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
1899 \textcolor{preprocessor}{}        \textcolor{comment}{// The work queue may be empty but there might be proxy tasks still executing}
1900         \textcolor{keywordflow}{if} (final\_spin && \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(current\_task -> td\_incomplete\_child\_tasks) == 0) 
1901 \textcolor{preprocessor}{#else}
1902 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (final\_spin) 
1903 \textcolor{preprocessor}{#endif}
1904 \textcolor{preprocessor}{}        \{
1905             \textcolor{comment}{// First, decrement the #unfinished threads, if that has not already}
1906             \textcolor{comment}{// been done.  This decrement might be to the spin location, and}
1907             \textcolor{comment}{// result in the termination condition being satisfied.}
1908             \textcolor{keywordflow}{if} (! *thread\_finished) \{
1909                 kmp\_uint32 \hyperlink{ittnotify__static_8h_a9da14338c9c3be6f21c41cf4ec79eaf1}{count};
1910 
1911                 count = \hyperlink{kmp__os_8h_a5b23523b95ee4b2307a8f344cbbe8050}{KMP\_TEST\_THEN\_DEC32}( (kmp\_int32 *)unfinished\_threads ) - 1;
1912                 \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_execute\_tasks\_template(dec #2): T#%d dec unfinished\_threads to
       %d "}
1913                               \textcolor{stringliteral}{"task\_team=%p\(\backslash\)n"}, gtid, count, task\_team) );
1914                 *thread\_finished = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1915             \}
1916 
1917             \textcolor{comment}{// If \_\_kmp\_tasking\_mode != tskm\_immediate\_exec}
1918             \textcolor{comment}{// then it is now unsafe to reference thread->th.th\_team !!!}
1919             \textcolor{comment}{// Decrementing task\_team->tt.tt\_unfinished\_threads can allow the master}
1920             \textcolor{comment}{// thread to pass through the barrier, where it might reset each thread's}
1921             \textcolor{comment}{// th.th\_team field for the next parallel region.}
1922             \textcolor{comment}{// If we can steal more work, we know that this has not happened yet.}
1923             \textcolor{keywordflow}{if} (flag != NULL && flag->done\_check()) \{
1924                 \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(15, (\textcolor{stringliteral}{"\_\_kmp\_execute\_tasks\_template(exit #4): T#%d spin condition satisfied
      \(\backslash\)n"},
1925                               gtid) );
1926                 \textcolor{keywordflow}{return} \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1927             \}
1928         \}
1929         \textcolor{keywordflow}{if} (thread->th.th\_task\_team == NULL) \textcolor{keywordflow}{return} \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1930     \}
1931 
1932     \textcolor{comment}{// Find a different thread to steal work from.  Pick a random thread.}
1933     \textcolor{comment}{// My initial plan was to cycle through all the threads, and only return}
1934     \textcolor{comment}{// if we tried to steal from every thread, and failed.  Arch says that's}
1935     \textcolor{comment}{// not such a great idea.}
1936     \textcolor{comment}{// GEH - need yield code in this loop for throughput library mode?}
1937     new\_victim:
1938     k = \hyperlink{kmp_8h_a35a3fb5fe916330a8e3f844603bb6a09}{\_\_kmp\_get\_random}( thread ) % (nthreads - 1);
1939     \textcolor{keywordflow}{if} ( k >= thread -> th.th\_info.ds.ds\_tid ) \{
1940         ++k;               \textcolor{comment}{// Adjusts random distribution to exclude self}
1941     \}
1942     \{
1943         \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *other\_thread = threads\_data[k].td.td\_thr;
1944         \textcolor{keywordtype}{int} first;
1945 
1946         \textcolor{comment}{// There is a slight chance that \_\_kmp\_enable\_tasking() did not wake up}
1947         \textcolor{comment}{// all threads waiting at the barrier.  If this thread is sleeping, then}
1948         \textcolor{comment}{// wake it up.  Since we were going to pay the cache miss penalty}
1949         \textcolor{comment}{// for referencing another thread's kmp\_info\_t struct anyway, the check}
1950         \textcolor{comment}{// shouldn't cost too much performance at this point.}
1951         \textcolor{comment}{// In extra barrier mode, tasks do not sleep at the separate tasking}
1952         \textcolor{comment}{// barrier, so this isn't a problem.}
1953         \textcolor{keywordflow}{if} ( ( \hyperlink{kmp_8h_a39e87c52fb75a615c2564a822a013a5a}{\_\_kmp\_tasking\_mode} == \hyperlink{kmp_8h_aad1bdfbfac136cfd92611bcee79ca3f2ac2529646fad02f49ff61ec4c50287a5d}{tskm\_task\_teams} ) &&
1954              (\hyperlink{kmp_8h_a3b56e2e90e1539c0b794e4137724bc1c}{\_\_kmp\_dflt\_blocktime} != \hyperlink{kmp_8h_a1ca6c6ce04115f143dc5df627de57958}{KMP\_MAX\_BLOCKTIME}) &&
1955              (\hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}(other\_thread->th.th\_sleep\_loc) != NULL))
1956         \{
1957             \hyperlink{kmp__tasking_8c_a346d02e275d2c2ff66c4a17d7e012f37}{\_\_kmp\_null\_resume\_wrapper}(
      \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}(other\_thread), other\_thread->th.th\_sleep\_loc);
1958             \textcolor{comment}{// A sleeping thread should not have any tasks on it's queue.}
1959             \textcolor{comment}{// There is a slight possibility that it resumes, steals a task from}
1960             \textcolor{comment}{// another thread, which spawns more tasks, all in the time that it takes}
1961             \textcolor{comment}{// this thread to check => don't write an assertion that the victim's}
1962             \textcolor{comment}{// queue is empty.  Try stealing from a different thread.}
1963             \textcolor{keywordflow}{goto} new\_victim;
1964         \}
1965 
1966         \textcolor{comment}{// Now try to steal work from the selected thread}
1967         first = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1968         \textcolor{keywordflow}{while} ((task = \hyperlink{kmp__tasking_8c_a416c88d9ab9aa62c4ed0b110b1cc0d7b}{\_\_kmp\_steal\_task}( other\_thread, gtid, task\_team, unfinished\_threads,
1969                                          thread\_finished, is\_constrained )) != NULL)
1970         \{
1971 \textcolor{preprocessor}{#if USE\_ITT\_BUILD && USE\_ITT\_NOTIFY}
1972 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} ( \hyperlink{group__sync_gab7f1ba7abf5c98e0e0e0ea53d0e34661}{\_\_itt\_sync\_create\_ptr} || KMP\_ITT\_DEBUG ) \{
1973                 \textcolor{keywordflow}{if} ( itt\_sync\_obj == NULL ) \{
1974                     \textcolor{comment}{// we are at fork barrier where we could not get the object reliably}
1975                     itt\_sync\_obj  = \_\_kmp\_itt\_barrier\_object( gtid, 
      \hyperlink{kmp_8h_ad0f7c21f2f1d446087ef5714eb0fd8cfab7dbfe1300085e4a7825c809112aaf7c}{bs\_forkjoin\_barrier} );
1976                 \}
1977                 \_\_kmp\_itt\_task\_starting( itt\_sync\_obj );
1978             \}
1979 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD && USE\_ITT\_NOTIFY */}\textcolor{preprocessor}{}
1980 \textcolor{preprocessor}{}            \hyperlink{kmp__tasking_8c_a4bfeb67d512f48a8f79ceb5ea0bdc1d7}{\_\_kmp\_invoke\_task}( gtid, task, current\_task );
1981 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1982 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} ( itt\_sync\_obj != NULL )
1983                 \_\_kmp\_itt\_task\_finished( itt\_sync\_obj );
1984 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1985 \textcolor{preprocessor}{}
1986             \textcolor{comment}{// Try stealing from this victim again, in the future.}
1987             \textcolor{keywordflow}{if} (first) \{
1988                 threads\_data[ tid ].td.td\_deque\_last\_stolen = k;
1989                 first = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1990             \}
1991 
1992             \textcolor{comment}{// Check to see if this thread can proceed.}
1993             \textcolor{keywordflow}{if} (flag == NULL || (!final\_spin && flag->done\_check())) \{
1994                 \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(15, (\textcolor{stringliteral}{"\_\_kmp\_execute\_tasks\_template(exit #5): T#%d spin condition satisfied
      \(\backslash\)n"},
1995                               gtid) );
1996                 \textcolor{keywordflow}{return} \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1997             \}
1998             \textcolor{keywordflow}{if} (thread->th.th\_task\_team == NULL) \textcolor{keywordflow}{break};
1999             \hyperlink{kmp_8h_a9f0d88d1970adda4ad38d272e65d7844}{KMP\_YIELD}( \hyperlink{kmp_8h_aa8f77de14d1515a05937d68622e74d61}{\_\_kmp\_library} == \hyperlink{kmp_8h_aee0cf894df4706d555a64e6d5b51599daadaa2a9ce75fbdb96025b8f6e9c2a4d7}{library\_throughput} );   \textcolor{comment}{//
       Yield before executing next task}
2000 
2001             \textcolor{comment}{// If the execution of the stolen task resulted in more tasks being}
2002             \textcolor{comment}{// placed on our run queue, then restart the whole process.}
2003             \textcolor{keywordflow}{if} (\hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(threads\_data[ tid ].td.td\_deque\_ntasks) != 0) \{
2004                 \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_execute\_tasks\_template: T#%d stolen task spawned other tasks,
       restart\(\backslash\)n"},
2005                               gtid) );
2006                 \textcolor{keywordflow}{goto} start;
2007             \}
2008         \}
2009 
2010         \textcolor{comment}{// The victims's work queue is empty.  If we are in the final spin loop}
2011         \textcolor{comment}{// of the barrier, check and see if the termination condition is satisfied.}
2012         \textcolor{comment}{// Going on and finding a new victim to steal from is expensive, as it}
2013         \textcolor{comment}{// involves a lot of cache misses, so we definitely want to re-check the}
2014         \textcolor{comment}{// termination condition before doing that.}
2015 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
2016 \textcolor{preprocessor}{}        \textcolor{comment}{// The work queue may be empty but there might be proxy tasks still executing}
2017         \textcolor{keywordflow}{if} (final\_spin && \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(current\_task -> td\_incomplete\_child\_tasks) == 0) 
2018 \textcolor{preprocessor}{#else}
2019 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (final\_spin) 
2020 \textcolor{preprocessor}{#endif}
2021 \textcolor{preprocessor}{}        \{
2022             \textcolor{comment}{// First, decrement the #unfinished threads, if that has not already}
2023             \textcolor{comment}{// been done.  This decrement might be to the spin location, and}
2024             \textcolor{comment}{// result in the termination condition being satisfied.}
2025             \textcolor{keywordflow}{if} (! *thread\_finished) \{
2026                 kmp\_uint32 \hyperlink{ittnotify__static_8h_a9da14338c9c3be6f21c41cf4ec79eaf1}{count};
2027 
2028                 count = \hyperlink{kmp__os_8h_a5b23523b95ee4b2307a8f344cbbe8050}{KMP\_TEST\_THEN\_DEC32}( (kmp\_int32 *)unfinished\_threads ) - 1;
2029                 \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_execute\_tasks\_template(dec #3): T#%d dec unfinished\_threads to
       %d; "}
2030                               \textcolor{stringliteral}{"task\_team=%p\(\backslash\)n"},
2031                               gtid, count, task\_team) );
2032                 *thread\_finished = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
2033             \}
2034 
2035             \textcolor{comment}{// If \_\_kmp\_tasking\_mode != tskm\_immediate\_exec,}
2036             \textcolor{comment}{// then it is now unsafe to reference thread->th.th\_team !!!}
2037             \textcolor{comment}{// Decrementing task\_team->tt.tt\_unfinished\_threads can allow the master}
2038             \textcolor{comment}{// thread to pass through the barrier, where it might reset each thread's}
2039             \textcolor{comment}{// th.th\_team field for the next parallel region.}
2040             \textcolor{comment}{// If we can steal more work, we know that this has not happened yet.}
2041             \textcolor{keywordflow}{if} (flag != NULL && flag->done\_check()) \{
2042                 \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(15, (\textcolor{stringliteral}{"\_\_kmp\_execute\_tasks\_template(exit #6): T#%d spin condition satisfied
      \(\backslash\)n"}, gtid) );
2043                 \textcolor{keywordflow}{return} \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
2044             \}
2045         \}
2046         \textcolor{keywordflow}{if} (thread->th.th\_task\_team == NULL) \textcolor{keywordflow}{return} \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2047     \}
2048 
2049     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(15, (\textcolor{stringliteral}{"\_\_kmp\_execute\_tasks\_template(exit #7): T#%d can't find work\(\backslash\)n"}, gtid) );
2050     \textcolor{keywordflow}{return} \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2051 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a76eb2ed770af199a808b9c3b30e94f65}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-free\-\_\-task@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task}}
\index{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-free\-\_\-task (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-taskdata\-\_\-t} $\ast$}]{taskdata, }
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{thread}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_a76eb2ed770af199a808b9c3b30e94f65}


Definition at line 540 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-and\-\_\-ancestors().


\begin{DoxyCode}
541 \{
542     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(30, (\textcolor{stringliteral}{"\_\_kmp\_free\_task: T#%d freeing data from task %p\(\backslash\)n"},
543                   gtid, taskdata) );
544 
545     \textcolor{comment}{// Check to make sure all flags and counters have the correct values}
546     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_ac102ec6051f4b30f0e81c0f3b5d9e84a}{tasktype} == 
      \hyperlink{kmp_8h_a1251a006af9d33ac15f16bb2a934a97b}{TASK\_EXPLICIT} );
547     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a52dcbb49f0b94ac8ff3e130a54df591c}{executing} == 0 );
548     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a2bef3eff248d8bbbeaea3f77f918b1fc}{complete} == 1 );
549     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a44b2b3bfa5de44e0c8c8f8f63cf0c32c}{freed} == 0 );
550     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(taskdata->
      \hyperlink{structkmp__taskdata_a56dce087baa8fa613d288f54e5e26bdb}{td\_allocated\_child\_tasks}) == 0  || taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.
      \hyperlink{structkmp__tasking__flags_a1e4fa96ecc4d22b55ae1ddfa4f83bdfd}{task\_serial} == 1);
551     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(taskdata->
      \hyperlink{structkmp__taskdata_af2d9a1116312e78182a768bb19bc5021}{td\_incomplete\_child\_tasks}) == 0 );
552 
553     taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a44b2b3bfa5de44e0c8c8f8f63cf0c32c}{freed} = 1;
554     \textcolor{comment}{// deallocate the taskdata and shared variable blocks associated with this task}
555 \textcolor{preprocessor}{    #if USE\_FAST\_MEMORY}
556 \textcolor{preprocessor}{}        \hyperlink{kmp_8h_a9056ae93bbe8c65605e59d1e4dd93255}{\_\_kmp\_fast\_free}( thread, taskdata );
557 \textcolor{preprocessor}{    #else }\textcolor{comment}{/* ! USE\_FAST\_MEMORY */}\textcolor{preprocessor}{}
558 \textcolor{preprocessor}{}        \hyperlink{kmp_8h_aff8d21963670e8e527cb6e30a200bb97}{\_\_kmp\_thread\_free}( thread, taskdata );
559 \textcolor{preprocessor}{    #endif}
560 \textcolor{preprocessor}{}
561     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_free\_task: T#%d freed task %p\(\backslash\)n"},
562                   gtid, taskdata) );
563 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a45ba0fe4070338321814da7f9b0d7364}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-and\-\_\-ancestors@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-and\-\_\-ancestors}}
\index{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-and\-\_\-ancestors@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-and\-\_\-ancestors}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-and\-\_\-ancestors}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-and\-\_\-ancestors (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-taskdata\-\_\-t} $\ast$}]{taskdata, }
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{thread}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_a45ba0fe4070338321814da7f9b0d7364}


Definition at line 573 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-task\-\_\-finish().


\begin{DoxyCode}
574 \{
575     kmp\_int32 children = 0;
576     kmp\_int32 team\_or\_tasking\_serialized = taskdata -> td\_flags.team\_serial || taskdata -> td\_flags.
      tasking\_ser;
577 
578     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata -> td\_flags.tasktype == 
      \hyperlink{kmp_8h_a1251a006af9d33ac15f16bb2a934a97b}{TASK\_EXPLICIT} );
579 
580     \textcolor{keywordflow}{if} ( !team\_or\_tasking\_serialized ) \{
581         children = \hyperlink{kmp__os_8h_a5b23523b95ee4b2307a8f344cbbe8050}{KMP\_TEST\_THEN\_DEC32}( (kmp\_int32 *)(& taskdata -> 
      td\_allocated\_child\_tasks) ) - 1;
582         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( children >= 0 );
583     \}
584 
585     \textcolor{comment}{// Now, go up the ancestor tree to see if any ancestors can now be freed.}
586     \textcolor{keywordflow}{while} ( children == 0 )
587     \{
588         \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * parent\_taskdata = taskdata -> td\_parent;
589 
590         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_free\_task\_and\_ancestors(enter): T#%d task %p complete "}
591                       \textcolor{stringliteral}{"and freeing itself\(\backslash\)n"}, gtid, taskdata) );
592 
593         \textcolor{comment}{// --- Deallocate my ancestor task ---}
594         \hyperlink{kmp__tasking_8c_a76eb2ed770af199a808b9c3b30e94f65}{\_\_kmp\_free\_task}( gtid, taskdata, thread );
595 
596         taskdata = parent\_taskdata;
597 
598         \textcolor{comment}{// Stop checking ancestors at implicit task or if tasking serialized}
599         \textcolor{comment}{// instead of walking up ancestor tree to avoid premature deallocation of ancestors.}
600         \textcolor{keywordflow}{if} ( team\_or\_tasking\_serialized || taskdata -> td\_flags.tasktype == 
      \hyperlink{kmp_8h_a756ac44f6ffa658c995af306d38b2879}{TASK\_IMPLICIT} )
601             \textcolor{keywordflow}{return};
602 
603         \textcolor{keywordflow}{if} ( !team\_or\_tasking\_serialized ) \{
604             \textcolor{comment}{// Predecrement simulated by "- 1" calculation}
605             children = \hyperlink{kmp__os_8h_a5b23523b95ee4b2307a8f344cbbe8050}{KMP\_TEST\_THEN\_DEC32}( (kmp\_int32 *)(& taskdata -> 
      td\_allocated\_child\_tasks) ) - 1;
606             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( children >= 0 );
607         \}
608     \}
609 
610     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_free\_task\_and\_ancestors(exit): T#%d task %p has %d children; "}
611                   \textcolor{stringliteral}{"not freeing it yet\(\backslash\)n"}, gtid, taskdata, children) );
612 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_aee19f743379ff8d87e9de386675422d6}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-deque@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-deque}}
\index{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-deque@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-deque}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-deque}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-deque (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-thread\-\_\-data\-\_\-t} $\ast$}]{thread\-\_\-data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_aee19f743379ff8d87e9de386675422d6}


Definition at line 2230 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-threads\-\_\-data().


\begin{DoxyCode}
2231 \{
2232     \hyperlink{kmp__lock_8h_a85412da5c0d085bde951a77690cf1f74}{\_\_kmp\_acquire\_bootstrap\_lock}( & thread\_data -> td.td\_deque\_lock );
2233 
2234     \textcolor{keywordflow}{if} ( thread\_data -> td.td\_deque != NULL ) \{
2235         \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(thread\_data -> td.td\_deque\_ntasks, 0);
2236          \hyperlink{kmp_8h_a052396231429341ba56a7c1ceacbaa2f}{\_\_kmp\_free}( thread\_data -> td.td\_deque );
2237         thread\_data -> td.td\_deque = NULL;
2238     \}
2239     \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( & thread\_data -> td.td\_deque\_lock );
2240 
2241 \textcolor{preprocessor}{#ifdef BUILD\_TIED\_TASK\_STACK}
2242 \textcolor{preprocessor}{}    \textcolor{comment}{// GEH: Figure out what to do here for td\_susp\_tied\_tasks}
2243     \textcolor{keywordflow}{if} ( thread\_data -> td.td\_susp\_tied\_tasks.ts\_entries != TASK\_STACK\_EMPTY ) \{
2244         \_\_kmp\_free\_task\_stack( \hyperlink{kmp_8h_a1626e286e4eb82742a397442009721e6}{\_\_kmp\_thread\_from\_gtid}( gtid ), thread\_data );
2245     \}
2246 \textcolor{preprocessor}{#endif // BUILD\_TIED\_TASK\_STACK}
2247 \textcolor{preprocessor}{}\}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a006431c8d77d632eeb5b6f8c16d9fd87}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-team@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-team}}
\index{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-team@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-team}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-team}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-team (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{thread, }
\item[{{\bf kmp\-\_\-task\-\_\-team\-\_\-t} $\ast$}]{task\-\_\-team}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_a006431c8d77d632eeb5b6f8c16d9fd87}


Definition at line 2444 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-free\-\_\-team().


\begin{DoxyCode}
2445 \{
2446     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 20, ( \textcolor{stringliteral}{"\_\_kmp\_free\_task\_team: T#%d task\_team = %p\(\backslash\)n"},
2447                     thread ? \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( thread ) : -1, task\_team ) );
2448 
2449     \textcolor{comment}{// Put task team back on free list}
2450     \hyperlink{kmp__lock_8h_a85412da5c0d085bde951a77690cf1f74}{\_\_kmp\_acquire\_bootstrap\_lock}( & 
      \hyperlink{kmp__tasking_8c_a41e8ad7ff702abc83af1e3c4d47a2e47}{\_\_kmp\_task\_team\_lock} );
2451 
2452     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( task\_team -> tt.tt\_next == NULL );
2453     task\_team -> tt.tt\_next = \hyperlink{kmp__tasking_8c_ac0f8028d2592221f303450428fa1e680}{\_\_kmp\_free\_task\_teams};
2454     \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(\hyperlink{kmp__tasking_8c_ac0f8028d2592221f303450428fa1e680}{\_\_kmp\_free\_task\_teams}, task\_team);
2455 
2456     \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( & 
      \hyperlink{kmp__tasking_8c_a41e8ad7ff702abc83af1e3c4d47a2e47}{\_\_kmp\_task\_team\_lock} );
2457 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a63ab26c647493216462fbd8a639219c6}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-threads\-\_\-data@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-threads\-\_\-data}}
\index{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-threads\-\_\-data@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-threads\-\_\-data}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-threads\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-threads\-\_\-data (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-task\-\_\-team\-\_\-t} $\ast$}]{task\-\_\-team}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_a63ab26c647493216462fbd8a639219c6}


Definition at line 2369 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-reap\-\_\-task\-\_\-teams().


\begin{DoxyCode}
2370 \{
2371     \hyperlink{kmp__lock_8h_a85412da5c0d085bde951a77690cf1f74}{\_\_kmp\_acquire\_bootstrap\_lock}( & task\_team -> tt.tt\_threads\_lock );
2372     \textcolor{keywordflow}{if} ( task\_team -> tt.tt\_threads\_data != NULL ) \{
2373         \textcolor{keywordtype}{int} \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i};
2374         \textcolor{keywordflow}{for} (i = 0; i < task\_team->\hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.\hyperlink{structkmp__base__task__team_a0646ca6246f55d149ee022b5d9649a62}{tt\_max\_threads}; i++ ) \{
2375             \hyperlink{kmp__tasking_8c_aee19f743379ff8d87e9de386675422d6}{\_\_kmp\_free\_task\_deque}( & task\_team -> tt.tt\_threads\_data[i] );
2376         \}
2377         \hyperlink{kmp_8h_a052396231429341ba56a7c1ceacbaa2f}{\_\_kmp\_free}( task\_team -> tt.tt\_threads\_data );
2378         task\_team -> tt.tt\_threads\_data = NULL;
2379     \}
2380     \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( & task\_team -> tt.tt\_threads\_lock );
2381 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a8387c1b95f3b497a14fc3916515ad4c3}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-init\-\_\-implicit\-\_\-task@{\-\_\-\-\_\-kmp\-\_\-init\-\_\-implicit\-\_\-task}}
\index{\-\_\-\-\_\-kmp\-\_\-init\-\_\-implicit\-\_\-task@{\-\_\-\-\_\-kmp\-\_\-init\-\_\-implicit\-\_\-task}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-init\-\_\-implicit\-\_\-task}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-init\-\_\-implicit\-\_\-task (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc\-\_\-ref, }
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{this\-\_\-thr, }
\item[{{\bf kmp\-\_\-team\-\_\-t} $\ast$}]{team, }
\item[{{\bf int}}]{tid, }
\item[{{\bf int}}]{set\-\_\-curr\-\_\-task}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_a8387c1b95f3b497a14fc3916515ad4c3}


Definition at line 800 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-fork\-\_\-barrier(), \-\_\-\-\_\-kmp\-\_\-hierarchical\-\_\-barrier\-\_\-release(), \-\_\-\-\_\-kmp\-\_\-hyper\-\_\-barrier\-\_\-release(), \-\_\-\-\_\-kmp\-\_\-initialize\-\_\-info(), \-\_\-\-\_\-kmp\-\_\-linear\-\_\-barrier\-\_\-release(), \-\_\-\-\_\-kmp\-\_\-reinitialize\-\_\-team(), \-\_\-\-\_\-kmp\-\_\-setup\-\_\-icv\-\_\-copy(), and \-\_\-\-\_\-kmp\-\_\-tree\-\_\-barrier\-\_\-release().


\begin{DoxyCode}
801 \{
802     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * \hyperlink{ittnotify__static_8h_aed9673d42c4239c5498e39aad80df904}{task}   = & team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_implicit\_task\_taskdata[ tid ];
803 
804     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_init\_implicit\_task(enter): T#:%d team=%p task=%p, reinit=%s\(\backslash\)n"},
805                   tid, team, task, set\_curr\_task ? \textcolor{stringliteral}{"TRUE"} : \textcolor{stringliteral}{"FALSE"} ) );
806 
807     task->\hyperlink{structkmp__taskdata_a5e7bd3946ccea8fd5789f703a628344f}{td\_task\_id}  = \hyperlink{kmp_8h_a3ea4057f803408443d7a20c231170f86}{KMP\_GEN\_TASK\_ID}();
808     task->\hyperlink{structkmp__taskdata_a2ca48086b6f95cea53c615b83a94e424}{td\_team}     = team;
809 \textcolor{comment}{//    task->td\_parent   = NULL;  // fix for CQ230101 (broken parent task info in debugger)}
810     task->\hyperlink{structkmp__taskdata_a80a962f07e81cde9797d70decdd6119d}{td\_ident}    = loc\_ref;
811     task->\hyperlink{structkmp__taskdata_a11ddd31b5102384ab645eef338e40bf3}{td\_taskwait\_ident}   = NULL;
812     task->\hyperlink{structkmp__taskdata_a11a22c35abf51fc2e20a7559001a1e72}{td\_taskwait\_counter} = 0;
813     task->\hyperlink{structkmp__taskdata_a9721521ef95aac2b984b2ee053c3be9a}{td\_taskwait\_thread}  = 0;
814 
815     task->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a896a40bab626e74a4824539d1605d176}{tiedness}    = \hyperlink{kmp_8h_a8293a8f8b58f2b741e846444318b88d5}{TASK\_TIED};
816     task->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_ac102ec6051f4b30f0e81c0f3b5d9e84a}{tasktype}    = \hyperlink{kmp_8h_a756ac44f6ffa658c995af306d38b2879}{TASK\_IMPLICIT};
817 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
818 \textcolor{preprocessor}{}    task->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.proxy       = \hyperlink{kmp_8h_a380760b89bb46b5ca8ec2d1381b273c0}{TASK\_FULL};
819 \textcolor{preprocessor}{#endif}
820 \textcolor{preprocessor}{}
821     \textcolor{comment}{// All implicit tasks are executed immediately, not deferred}
822     task->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a1e4fa96ecc4d22b55ae1ddfa4f83bdfd}{task\_serial} = 1;
823     task->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a68f882661553dde50d4ccc2e472e9f05}{tasking\_ser} = ( \hyperlink{kmp_8h_a39e87c52fb75a615c2564a822a013a5a}{\_\_kmp\_tasking\_mode} == 
      \hyperlink{kmp_8h_aad1bdfbfac136cfd92611bcee79ca3f2af827998cf4eb3f61723edc4943b86c98}{tskm\_immediate\_exec} );
824     task->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a69abf7c2ecf0b7284861a90c7ac0cfe1}{team\_serial} = ( team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_serialized ) ? 1 : 0;
825 
826     task->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a9242efec8f2956663c96a10a12601c22}{started}     = 1;
827     task->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a52dcbb49f0b94ac8ff3e130a54df591c}{executing}   = 1;
828     task->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a2bef3eff248d8bbbeaea3f77f918b1fc}{complete}    = 0;
829     task->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a44b2b3bfa5de44e0c8c8f8f63cf0c32c}{freed}       = 0;
830 
831 \textcolor{preprocessor}{#if OMP\_40\_ENABLED}
832 \textcolor{preprocessor}{}    task->\hyperlink{structkmp__taskdata_a428a82593aa88b9d2420390cdee239d8}{td\_dephash} = NULL;
833     task->\hyperlink{structkmp__taskdata_a877878bd557ba3bdc7749e531cb845b3}{td\_depnode} = NULL;
834 \textcolor{preprocessor}{#endif}
835 \textcolor{preprocessor}{}
836     \textcolor{keywordflow}{if} (set\_curr\_task) \{  \textcolor{comment}{// only do this initialization the first time a thread is created}
837         task->\hyperlink{structkmp__taskdata_af2d9a1116312e78182a768bb19bc5021}{td\_incomplete\_child\_tasks} = 0;
838         task->\hyperlink{structkmp__taskdata_a56dce087baa8fa613d288f54e5e26bdb}{td\_allocated\_child\_tasks}  = 0; \textcolor{comment}{// Not used because do not need to
       deallocate implicit task}
839 \textcolor{preprocessor}{#if OMP\_40\_ENABLED}
840 \textcolor{preprocessor}{}        task->\hyperlink{structkmp__taskdata_a568185a9e8c23a1682491fa55973d61c}{td\_taskgroup} = NULL;           \textcolor{comment}{// An implicit task does not have taskgroup}
841 \textcolor{preprocessor}{#endif}
842 \textcolor{preprocessor}{}        \hyperlink{kmp__tasking_8c_acbb44e4a3167875a9a9d4b5eca8fb3d8}{\_\_kmp\_push\_current\_task\_to\_thread}( this\_thr, team, tid );
843     \} \textcolor{keywordflow}{else} \{
844         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(task->\hyperlink{structkmp__taskdata_af2d9a1116312e78182a768bb19bc5021}{td\_incomplete\_child\_tasks} == 0);
845         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(task->\hyperlink{structkmp__taskdata_a56dce087baa8fa613d288f54e5e26bdb}{td\_allocated\_child\_tasks}  == 0);
846     \}
847 
848 \textcolor{preprocessor}{#if OMPT\_SUPPORT}
849 \textcolor{preprocessor}{}    \_\_kmp\_task\_init\_ompt(task, tid, NULL);
850 \textcolor{preprocessor}{#endif}
851 \textcolor{preprocessor}{}
852     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_init\_implicit\_task(exit): T#:%d team=%p task=%p\(\backslash\)n"},
853                   tid, team, task ) );
854 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a4bfeb67d512f48a8f79ceb5ea0bdc1d7}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-invoke\-\_\-task@{\-\_\-\-\_\-kmp\-\_\-invoke\-\_\-task}}
\index{\-\_\-\-\_\-kmp\-\_\-invoke\-\_\-task@{\-\_\-\-\_\-kmp\-\_\-invoke\-\_\-task}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-invoke\-\_\-task}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-invoke\-\_\-task (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-task\-\_\-t} $\ast$}]{task, }
\item[{{\bf kmp\-\_\-taskdata\-\_\-t} $\ast$}]{current\-\_\-task}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_a4bfeb67d512f48a8f79ceb5ea0bdc1d7}


Definition at line 1103 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-template(), \-\_\-\-\_\-kmp\-\_\-omp\-\_\-task(), and \-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-parts().


\begin{DoxyCode}
1104 \{
1105     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * taskdata = \hyperlink{kmp_8h_a7996bdfd391438365a93a3c7fba1c440}{KMP\_TASK\_TO\_TASKDATA}(task);
1106 \textcolor{preprocessor}{#if OMP\_40\_ENABLED}
1107 \textcolor{preprocessor}{}    \textcolor{keywordtype}{int} discard = 0 \textcolor{comment}{/* false */};
1108 \textcolor{preprocessor}{#endif}
1109 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(30, (\textcolor{stringliteral}{"\_\_kmp\_invoke\_task(enter): T#%d invoking task %p, current\_task=%p\(\backslash\)n"},
1110                   gtid, taskdata, current\_task) );
1111     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(task);
1112 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
1113 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} ( taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.proxy == \hyperlink{kmp_8h_a09ec98eec6915a3858e6146869f27a50}{TASK\_PROXY} &&
1114          taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a2bef3eff248d8bbbeaea3f77f918b1fc}{complete} == 1)
1115          \{
1116             \textcolor{comment}{// This is a proxy task that was already completed but it needs to run}
1117             \textcolor{comment}{// its bottom-half finish}
1118             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(30, (\textcolor{stringliteral}{"\_\_kmp\_invoke\_task: T#%d running bottom finish for proxy task %p\(\backslash\)n"},
1119                   gtid, taskdata) );
1120 
1121             \_\_kmp\_bottom\_half\_finish\_proxy(gtid,task);
1122 
1123             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(30, (\textcolor{stringliteral}{"\_\_kmp\_invoke\_task(exit): T#%d completed bottom finish for proxy task %p,
       resuming task %p\(\backslash\)n"}, gtid, taskdata, current\_task) );
1124 
1125             \textcolor{keywordflow}{return};
1126          \}
1127 \textcolor{preprocessor}{#endif}
1128 \textcolor{preprocessor}{}
1129 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
1130 \textcolor{preprocessor}{}    \textcolor{comment}{// Proxy tasks are not handled by the runtime}
1131     \textcolor{keywordflow}{if} ( taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.proxy != \hyperlink{kmp_8h_a09ec98eec6915a3858e6146869f27a50}{TASK\_PROXY} )
1132 \textcolor{preprocessor}{#endif}
1133 \textcolor{preprocessor}{}    \hyperlink{kmp__tasking_8c_a260526cdd24e8cf269a2af7df3258b0e}{\_\_kmp\_task\_start}( gtid, task, current\_task );
1134 
1135 \textcolor{preprocessor}{#if OMPT\_SUPPORT}
1136 \textcolor{preprocessor}{}    \hyperlink{structompt__thread__info__t}{ompt\_thread\_info\_t} oldInfo;
1137     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} * thread;
1138     \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled}) \{
1139         \textcolor{comment}{// Store the threads states and restore them after the task}
1140         thread = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
1141         oldInfo = thread->th.ompt\_thread\_info;
1142         thread->th.ompt\_thread\_info.\hyperlink{structompt__thread__info__t_a8655f45d3e0fe40c28f0a49076a560c3}{wait\_id} = 0;
1143         thread->th.ompt\_thread\_info.state = ompt\_state\_work\_parallel;
1144         taskdata->ompt\_task\_info.frame.exit\_runtime\_frame = \_\_builtin\_frame\_address(0);
1145     \}
1146 \textcolor{preprocessor}{#endif}
1147 \textcolor{preprocessor}{}
1148 \textcolor{preprocessor}{#if OMP\_40\_ENABLED}
1149 \textcolor{preprocessor}{}    \textcolor{comment}{// TODO: cancel tasks if the parallel region has also been cancelled}
1150     \textcolor{comment}{// TODO: check if this sequence can be hoisted above \_\_kmp\_task\_start}
1151     \textcolor{comment}{// if cancellation has been enabled for this run ...}
1152     \textcolor{keywordflow}{if} (\hyperlink{kmp_8h_a44033de9713edf20b0c77706153df1d2}{\_\_kmp\_omp\_cancellation}) \{
1153         \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *this\_thr = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads} [ gtid ];
1154         \hyperlink{unionkmp__team}{kmp\_team\_t} * this\_team = this\_thr->th.th\_team;
1155         \hyperlink{structkmp__taskgroup}{kmp\_taskgroup\_t} * taskgroup = taskdata->\hyperlink{structkmp__taskdata_a568185a9e8c23a1682491fa55973d61c}{td\_taskgroup};
1156         \textcolor{keywordflow}{if} ((taskgroup && taskgroup->\hyperlink{structkmp__taskgroup_a0775c7306150a24b509b4f897be92bce}{cancel\_request}) || (this\_team->
      \hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_cancel\_request == \hyperlink{kmp_8h_a7346f2e741ade19c05b63e57099c7cfea1045e4eac24d7f88e6d33eccf0306f2b}{cancel\_parallel})) \{
1157             \hyperlink{group__STATS__GATHERING_ga7fa64ec62947bf0b97f3f4778dd22196}{KMP\_COUNT\_BLOCK}(TASK\_cancelled);
1158             \textcolor{comment}{// this task belongs to a task group and we need to cancel it}
1159             discard = 1 \textcolor{comment}{/* true */};
1160         \}
1161     \}
1162 
1163     \textcolor{comment}{//}
1164     \textcolor{comment}{// Invoke the task routine and pass in relevant data.}
1165     \textcolor{comment}{// Thunks generated by gcc take a different argument list.}
1166     \textcolor{comment}{//}
1167     \textcolor{keywordflow}{if} (!discard) \{
1168         \hyperlink{group__STATS__GATHERING_ga7fa64ec62947bf0b97f3f4778dd22196}{KMP\_COUNT\_BLOCK}(TASK\_executed);
1169         \hyperlink{group__STATS__GATHERING_ga62f4b6e3a4ba48c04b172b97df137839}{KMP\_TIME\_BLOCK} (OMP\_task);
1170 \textcolor{preprocessor}{#endif // OMP\_40\_ENABLED}
1171 \textcolor{preprocessor}{}
1172 \textcolor{preprocessor}{#if OMPT\_SUPPORT && OMPT\_TRACE}
1173 \textcolor{preprocessor}{}        \textcolor{comment}{/* let OMPT know that we're about to run this task */}
1174         \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled} &&
1175              \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_task\_switch))
1176         \{
1177           \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_task\_switch)(
1178             current\_task->ompt\_task\_info.task\_id,
1179             taskdata->ompt\_task\_info.task\_id);
1180         \}
1181 \textcolor{preprocessor}{#endif}
1182 \textcolor{preprocessor}{}
1183 \textcolor{preprocessor}{#ifdef KMP\_GOMP\_COMPAT}
1184 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a6e26667bc33ef72a60338aaf00497f3a}{native}) \{
1185             ((\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} (*)(\textcolor{keywordtype}{void} *))(*(task->\hyperlink{structkmp__task_ac00e18629b8e1b48d156efc2a420a129}{routine})))(task->\hyperlink{structkmp__task_ad0e726e6cc9b1f0200ef55def8edb2da}{shareds});
1186         \}
1187         \textcolor{keywordflow}{else}
1188 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_GOMP\_COMPAT */}\textcolor{preprocessor}{}
1189 \textcolor{preprocessor}{}        \{
1190             (*(task->\hyperlink{structkmp__task_ac00e18629b8e1b48d156efc2a420a129}{routine}))(gtid, \hyperlink{ittnotify__static_8h_aed9673d42c4239c5498e39aad80df904}{task});
1191         \}
1192 
1193 \textcolor{preprocessor}{#if OMPT\_SUPPORT && OMPT\_TRACE}
1194 \textcolor{preprocessor}{}        \textcolor{comment}{/* let OMPT know that we're returning to the callee task */}
1195         \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled} &&
1196              \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_task\_switch))
1197         \{
1198           \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_task\_switch)(
1199             taskdata->ompt\_task\_info.task\_id,
1200             current\_task->ompt\_task\_info.task\_id);
1201         \}
1202 \textcolor{preprocessor}{#endif}
1203 \textcolor{preprocessor}{}
1204 \textcolor{preprocessor}{#if OMP\_40\_ENABLED}
1205 \textcolor{preprocessor}{}    \}
1206 \textcolor{preprocessor}{#endif // OMP\_40\_ENABLED}
1207 \textcolor{preprocessor}{}
1208 
1209 \textcolor{preprocessor}{#if OMPT\_SUPPORT}
1210 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled}) \{
1211         thread->th.ompt\_thread\_info = oldInfo;
1212         taskdata->ompt\_task\_info.frame.exit\_runtime\_frame = 0;
1213     \}
1214 \textcolor{preprocessor}{#endif}
1215 \textcolor{preprocessor}{}
1216 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
1217 \textcolor{preprocessor}{}    \textcolor{comment}{// Proxy tasks are not handled by the runtime}
1218     \textcolor{keywordflow}{if} ( taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.proxy != \hyperlink{kmp_8h_a09ec98eec6915a3858e6146869f27a50}{TASK\_PROXY} )
1219 \textcolor{preprocessor}{#endif}
1220 \textcolor{preprocessor}{}       \hyperlink{kmp__tasking_8c_a25ab616c3e16ed294de1f4838ff74aef}{\_\_kmp\_task\_finish}( gtid, task, current\_task );
1221 
1222     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(30, (\textcolor{stringliteral}{"\_\_kmp\_invoke\_task(exit): T#%d completed task %p, resuming task %p\(\backslash\)n"},
1223                   gtid, taskdata, current\_task) );
1224     \textcolor{keywordflow}{return};
1225 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a346d02e275d2c2ff66c4a17d7e012f37}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-null\-\_\-resume\-\_\-wrapper@{\-\_\-\-\_\-kmp\-\_\-null\-\_\-resume\-\_\-wrapper}}
\index{\-\_\-\-\_\-kmp\-\_\-null\-\_\-resume\-\_\-wrapper@{\-\_\-\-\_\-kmp\-\_\-null\-\_\-resume\-\_\-wrapper}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-null\-\_\-resume\-\_\-wrapper}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-null\-\_\-resume\-\_\-wrapper (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{gtid, }
\item[{volatile {\bf void} $\ast$}]{flag}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{kmp__tasking_8c_a346d02e275d2c2ff66c4a17d7e012f37}


Definition at line 39 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-enable\-\_\-tasking(), \-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-template(), and \-\_\-\-\_\-kmp\-\_\-wait\-\_\-to\-\_\-unref\-\_\-task\-\_\-teams().


\begin{DoxyCode}
39                                                                             \{
40     \textcolor{keywordflow}{if} (!flag) \textcolor{keywordflow}{return};
41     \textcolor{comment}{// Attempt to wake up a thread: examine its type and call appropriate template}
42     \textcolor{keywordflow}{switch} (((\hyperlink{classkmp__flag__64}{kmp\_flag\_64} *)flag)->get\_type()) \{
43     \textcolor{keywordflow}{case} \hyperlink{group__WAIT__RELEASE_gga507a7197646f995b5529a68c1481e39baa8e37e16d043d78e34da1d19387be5ba}{flag32}: \hyperlink{kmp_8h_acfe9e02a35d4e38951a53bd689ca2141}{\_\_kmp\_resume\_32}(gtid, NULL); \textcolor{keywordflow}{break};
44     \textcolor{keywordflow}{case} \hyperlink{group__WAIT__RELEASE_gga507a7197646f995b5529a68c1481e39ba8b02d824728fb546d43123b8b069ed04}{flag64}: \hyperlink{kmp_8h_a6d3052650a7678516a888600044b6d63}{\_\_kmp\_resume\_64}(gtid, NULL); \textcolor{keywordflow}{break};
45     \textcolor{keywordflow}{case} \hyperlink{group__WAIT__RELEASE_gga507a7197646f995b5529a68c1481e39ba9e8f1573ea73441426c6a6dda73b4e49}{flag\_oncore}: \hyperlink{kmp_8h_ace5ec17d5fee86980dead25d07a595d9}{\_\_kmp\_resume\_oncore}(gtid, NULL); \textcolor{keywordflow}{break};
46     \}
47 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_ae2e47b86ed1dc13258c5969b02b4c971}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-omp\-\_\-task@{\-\_\-\-\_\-kmp\-\_\-omp\-\_\-task}}
\index{\-\_\-\-\_\-kmp\-\_\-omp\-\_\-task@{\-\_\-\-\_\-kmp\-\_\-omp\-\_\-task}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-omp\-\_\-task}]{\setlength{\rightskip}{0pt plus 5cm}kmp\-\_\-int32 \-\_\-\-\_\-kmp\-\_\-omp\-\_\-task (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-task\-\_\-t} $\ast$}]{new\-\_\-task, }
\item[{bool}]{serialize\-\_\-immediate}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_ae2e47b86ed1dc13258c5969b02b4c971}


Definition at line 1272 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-release\-\_\-deps(), and \-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task().


\begin{DoxyCode}
1273 \{
1274     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * new\_taskdata = \hyperlink{kmp_8h_a7996bdfd391438365a93a3c7fba1c440}{KMP\_TASK\_TO\_TASKDATA}(new\_task);
1275 
1276 \textcolor{preprocessor}{#if OMPT\_SUPPORT}
1277 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled}) \{
1278         new\_taskdata->ompt\_task\_info.frame.reenter\_runtime\_frame =
1279             \_\_builtin\_frame\_address(0);
1280     \}
1281 \textcolor{preprocessor}{#endif}
1282 \textcolor{preprocessor}{}
1283     \textcolor{comment}{/* Should we execute the new task or queue it?   For now, let's just always try to}
1284 \textcolor{comment}{       queue it.  If the queue fills up, then we'll execute it.  */}
1285 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
1286 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} ( new\_taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.proxy == \hyperlink{kmp_8h_a09ec98eec6915a3858e6146869f27a50}{TASK\_PROXY} || 
      \hyperlink{kmp__tasking_8c_a8680b6e7d17754968a23499e185ae51f}{\_\_kmp\_push\_task}( gtid, new\_task ) == \hyperlink{kmp_8h_a036b27640903b0818afa8180c388e135}{TASK\_NOT\_PUSHED} ) \textcolor{comment}{// if cannot defer}
1287 \textcolor{preprocessor}{#else}
1288 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} ( \hyperlink{kmp__tasking_8c_a8680b6e7d17754968a23499e185ae51f}{\_\_kmp\_push\_task}( gtid, new\_task ) == \hyperlink{kmp_8h_a036b27640903b0818afa8180c388e135}{TASK\_NOT\_PUSHED} ) \textcolor{comment}{// if cannot
       defer}
1289 \textcolor{preprocessor}{#endif}
1290 \textcolor{preprocessor}{}    \{                                                           \textcolor{comment}{// Execute this task immediately}
1291         \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * current\_task = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ] -> th.
      th\_current\_task;
1292         \textcolor{keywordflow}{if} ( serialize\_immediate )
1293           new\_taskdata -> td\_flags.task\_serial = 1;
1294         \hyperlink{kmp__tasking_8c_a4bfeb67d512f48a8f79ceb5ea0bdc1d7}{\_\_kmp\_invoke\_task}( gtid, new\_task, current\_task );
1295     \}
1296 
1297 \textcolor{preprocessor}{#if OMPT\_SUPPORT}
1298 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled}) \{
1299         new\_taskdata->ompt\_task\_info.frame.reenter\_runtime\_frame = 0;
1300     \}
1301 \textcolor{preprocessor}{#endif}
1302 \textcolor{preprocessor}{}
1303     \textcolor{keywordflow}{return} \hyperlink{kmp_8h_a5acf257816ecbf4dd8fa709c0506a4da}{TASK\_CURRENT\_NOT\_QUEUED};
1304 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_ae3470280dc2ee8dde4f95debde6575e4}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-pop\-\_\-current\-\_\-task\-\_\-from\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-pop\-\_\-current\-\_\-task\-\_\-from\-\_\-thread}}
\index{\-\_\-\-\_\-kmp\-\_\-pop\-\_\-current\-\_\-task\-\_\-from\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-pop\-\_\-current\-\_\-task\-\_\-from\-\_\-thread}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-pop\-\_\-current\-\_\-task\-\_\-from\-\_\-thread}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-pop\-\_\-current\-\_\-task\-\_\-from\-\_\-thread (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{this\-\_\-thr}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_ae3470280dc2ee8dde4f95debde6575e4}


Definition at line 356 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-join\-\_\-call(), and \-\_\-\-\_\-kmpc\-\_\-end\-\_\-serialized\-\_\-parallel().


\begin{DoxyCode}
357 \{
358     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_pop\_current\_task\_from\_thread(enter): T#%d this\_thread=%p, curtask=%p, "}
359                    \textcolor{stringliteral}{"curtask\_parent=%p\(\backslash\)n"},
360                    0, this\_thr, this\_thr -> th.th\_current\_task,
361                    this\_thr -> th.th\_current\_task -> td\_parent ) );
362 
363     this\_thr -> th.th\_current\_task = this\_thr -> th.th\_current\_task -> td\_parent;
364 
365     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_pop\_current\_task\_from\_thread(exit): T#%d this\_thread=%p, curtask=%p, "}
366                    \textcolor{stringliteral}{"curtask\_parent=%p\(\backslash\)n"},
367                    0, this\_thr, this\_thr -> th.th\_current\_task,
368                    this\_thr -> th.th\_current\_task -> td\_parent ) );
369 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_acbb44e4a3167875a9a9d4b5eca8fb3d8}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-push\-\_\-current\-\_\-task\-\_\-to\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-push\-\_\-current\-\_\-task\-\_\-to\-\_\-thread}}
\index{\-\_\-\-\_\-kmp\-\_\-push\-\_\-current\-\_\-task\-\_\-to\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-push\-\_\-current\-\_\-task\-\_\-to\-\_\-thread}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-push\-\_\-current\-\_\-task\-\_\-to\-\_\-thread}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-push\-\_\-current\-\_\-task\-\_\-to\-\_\-thread (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{this\-\_\-thr, }
\item[{{\bf kmp\-\_\-team\-\_\-t} $\ast$}]{team, }
\item[{{\bf int}}]{tid}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_acbb44e4a3167875a9a9d4b5eca8fb3d8}


Definition at line 379 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-allocate\-\_\-team(), \-\_\-\-\_\-kmp\-\_\-init\-\_\-implicit\-\_\-task(), and \-\_\-\-\_\-kmp\-\_\-serialized\-\_\-parallel().


\begin{DoxyCode}
380 \{
381     \textcolor{comment}{// current task of the thread is a parent of the new just created implicit tasks of new team}
382     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_push\_current\_task\_to\_thread(enter): T#%d this\_thread=%p curtask=%p "}
383                     \textcolor{stringliteral}{"parent\_task=%p\(\backslash\)n"},
384                     tid, this\_thr, this\_thr->th.th\_current\_task,
385                     team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_implicit\_task\_taskdata[tid].td\_parent ) );
386 
387     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT} (this\_thr != NULL);
388 
389     \textcolor{keywordflow}{if}( tid == 0 ) \{
390         \textcolor{keywordflow}{if}( this\_thr->th.th\_current\_task != & team -> t.t\_implicit\_task\_taskdata[ 0 ] ) \{
391             team -> t.t\_implicit\_task\_taskdata[ 0 ].td\_parent = this\_thr->th.th\_current\_task;
392             this\_thr->th.th\_current\_task = & team -> t.t\_implicit\_task\_taskdata[ 0 ];
393         \}
394     \} \textcolor{keywordflow}{else} \{
395         team -> t.t\_implicit\_task\_taskdata[ tid ].td\_parent = team -> t.t\_implicit\_task\_taskdata[ 0 ].
      td\_parent;
396         this\_thr->th.th\_current\_task = & team -> t.t\_implicit\_task\_taskdata[ tid ];
397     \}
398 
399     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_push\_current\_task\_to\_thread(exit): T#%d this\_thread=%p curtask=%p "}
400                     \textcolor{stringliteral}{"parent\_task=%p\(\backslash\)n"},
401                     tid, this\_thr, this\_thr->th.th\_current\_task,
402                     team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_implicit\_task\_taskdata[tid].td\_parent ) );
403 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a8680b6e7d17754968a23499e185ae51f}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-push\-\_\-task@{\-\_\-\-\_\-kmp\-\_\-push\-\_\-task}}
\index{\-\_\-\-\_\-kmp\-\_\-push\-\_\-task@{\-\_\-\-\_\-kmp\-\_\-push\-\_\-task}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-push\-\_\-task}]{\setlength{\rightskip}{0pt plus 5cm}static kmp\-\_\-int32 \-\_\-\-\_\-kmp\-\_\-push\-\_\-task (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-task\-\_\-t} $\ast$}]{task}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_a8680b6e7d17754968a23499e185ae51f}


Definition at line 277 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-omp\-\_\-task(), and \-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-parts().


\begin{DoxyCode}
278 \{
279     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *        thread = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
280     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} *    taskdata = \hyperlink{kmp_8h_a7996bdfd391438365a93a3c7fba1c440}{KMP\_TASK\_TO\_TASKDATA}(task);
281     \hyperlink{unionkmp__task__team}{kmp\_task\_team\_t} *   task\_team = thread->th.th\_task\_team;
282     kmp\_int32           tid = \hyperlink{kmp_8h_afb8f84fff9682417eb1c484ffbfdc6ee}{\_\_kmp\_tid\_from\_gtid}( gtid );
283     \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} * thread\_data;
284 
285     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_push\_task: T#%d trying to push task %p.\(\backslash\)n"}, gtid, taskdata ) );
286 
287     \textcolor{comment}{// The first check avoids building task\_team thread data if serialized}
288     \textcolor{keywordflow}{if} ( taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a1e4fa96ecc4d22b55ae1ddfa4f83bdfd}{task\_serial} ) \{
289         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, ( \textcolor{stringliteral}{"\_\_kmp\_push\_task: T#%d team serialized; returning TASK\_NOT\_PUSHED for task
       %p\(\backslash\)n"},
290                        gtid, taskdata ) );
291         \textcolor{keywordflow}{return} \hyperlink{kmp_8h_a036b27640903b0818afa8180c388e135}{TASK\_NOT\_PUSHED};
292     \}
293 
294     \textcolor{comment}{// Now that serialized tasks have returned, we can assume that we are not in immediate exec mode}
295     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp_8h_a39e87c52fb75a615c2564a822a013a5a}{\_\_kmp\_tasking\_mode} != 
      \hyperlink{kmp_8h_aad1bdfbfac136cfd92611bcee79ca3f2af827998cf4eb3f61723edc4943b86c98}{tskm\_immediate\_exec} );
296     \textcolor{keywordflow}{if} ( ! \hyperlink{kmp_8h_a8b15269c2644fa0ba3ee09b0eb025867}{KMP\_TASKING\_ENABLED}(task\_team) ) \{
297          \hyperlink{kmp__tasking_8c_a98d61b65441709c36e312a5687bee6ac}{\_\_kmp\_enable\_tasking}( task\_team, thread );
298     \}
299     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(task\_team -> tt.tt\_found\_tasks) == 
      \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} );
300     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}(task\_team -> tt.tt\_threads\_data) != NULL );
301 
302     \textcolor{comment}{// Find tasking deque specific to encountering thread}
303     thread\_data = & task\_team -> tt.tt\_threads\_data[ tid ];
304 
305     \textcolor{comment}{// No lock needed since only owner can allocate}
306     \textcolor{keywordflow}{if} (thread\_data -> td.td\_deque == NULL ) \{
307         \hyperlink{kmp__tasking_8c_aed22cf1086a01e5f909f2388f4799f24}{\_\_kmp\_alloc\_task\_deque}( thread, thread\_data );
308     \}
309 
310     \textcolor{comment}{// Check if deque is full}
311     \textcolor{keywordflow}{if} ( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(thread\_data -> td.td\_deque\_ntasks) >= \hyperlink{kmp_8h_ad0d7ca7c2df268bc02d6ee85803e02ef}{TASK\_DEQUE\_SIZE} )
312     \{
313         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, ( \textcolor{stringliteral}{"\_\_kmp\_push\_task: T#%d deque is full; returning TASK\_NOT\_PUSHED for task %p
      \(\backslash\)n"},
314                        gtid, taskdata ) );
315         \textcolor{keywordflow}{return} \hyperlink{kmp_8h_a036b27640903b0818afa8180c388e135}{TASK\_NOT\_PUSHED};
316     \}
317 
318     \textcolor{comment}{// Lock the deque for the task push operation}
319     \hyperlink{kmp__lock_8h_a85412da5c0d085bde951a77690cf1f74}{\_\_kmp\_acquire\_bootstrap\_lock}( & thread\_data -> td.td\_deque\_lock );
320 
321 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
322 \textcolor{preprocessor}{}    \textcolor{comment}{// Need to recheck as we can get a proxy task from a thread outside of OpenMP}
323     \textcolor{keywordflow}{if} ( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(thread\_data -> td.td\_deque\_ntasks) >= \hyperlink{kmp_8h_ad0d7ca7c2df268bc02d6ee85803e02ef}{TASK\_DEQUE\_SIZE} )
324     \{
325         \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( & thread\_data -> td.td\_deque\_lock );
326         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, ( \textcolor{stringliteral}{"\_\_kmp\_push\_task: T#%d deque is full on 2nd check; returning TASK\_NOT\_PUSHED
       for task %p\(\backslash\)n"},
327                        gtid, taskdata ) );
328         \textcolor{keywordflow}{return} \hyperlink{kmp_8h_a036b27640903b0818afa8180c388e135}{TASK\_NOT\_PUSHED};
329     \}
330 \textcolor{preprocessor}{#else}
331 \textcolor{preprocessor}{}    \textcolor{comment}{// Must have room since no thread can add tasks but calling thread}
332     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(thread\_data -> td.td\_deque\_ntasks) < 
      \hyperlink{kmp_8h_ad0d7ca7c2df268bc02d6ee85803e02ef}{TASK\_DEQUE\_SIZE} );
333 \textcolor{preprocessor}{#endif}
334 \textcolor{preprocessor}{}
335     thread\_data -> td.td\_deque[ thread\_data -> td.td\_deque\_tail ] = taskdata;  \textcolor{comment}{// Push taskdata}
336     \textcolor{comment}{// Wrap index.}
337     thread\_data -> td.td\_deque\_tail = ( thread\_data -> td.td\_deque\_tail + 1 ) & 
      \hyperlink{kmp_8h_a33c7c9f8f5103d9fea2773bf8422ddd9}{TASK\_DEQUE\_MASK};
338     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(thread\_data -> td.td\_deque\_ntasks, \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(thread\_data -> td.td\_deque\_ntasks) + 1);      
             \textcolor{comment}{// Adjust task count}
339 
340     \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( & thread\_data -> td.td\_deque\_lock );
341 
342     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_push\_task: T#%d returning TASK\_SUCCESSFULLY\_PUSHED: "}
343                   \textcolor{stringliteral}{"task=%p ntasks=%d head=%u tail=%u\(\backslash\)n"},
344                   gtid, taskdata, thread\_data->td.td\_deque\_ntasks,
345                   thread\_data->td.td\_deque\_tail, thread\_data->td.td\_deque\_head) );
346 
347     \textcolor{keywordflow}{return} \hyperlink{kmp_8h_a80d22d7ff91ba2ce73de722166480f17}{TASK\_SUCCESSFULLY\_PUSHED};
348 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_abf7a6f74ec729456a17e9af61df7a624}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-realloc\-\_\-task\-\_\-threads\-\_\-data@{\-\_\-\-\_\-kmp\-\_\-realloc\-\_\-task\-\_\-threads\-\_\-data}}
\index{\-\_\-\-\_\-kmp\-\_\-realloc\-\_\-task\-\_\-threads\-\_\-data@{\-\_\-\-\_\-kmp\-\_\-realloc\-\_\-task\-\_\-threads\-\_\-data}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-realloc\-\_\-task\-\_\-threads\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf int} \-\_\-\-\_\-kmp\-\_\-realloc\-\_\-task\-\_\-threads\-\_\-data (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{thread, }
\item[{{\bf kmp\-\_\-task\-\_\-team\-\_\-t} $\ast$}]{task\-\_\-team}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_abf7a6f74ec729456a17e9af61df7a624}


Definition at line 2260 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-enable\-\_\-tasking().


\begin{DoxyCode}
2261 \{
2262     \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} ** threads\_data\_p;
2263     kmp\_int32            nthreads, maxthreads;
2264     \textcolor{keywordtype}{int}                  is\_init\_thread = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2265 
2266     \textcolor{keywordflow}{if} ( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(task\_team -> tt.tt\_found\_tasks) ) \{
2267         \textcolor{comment}{// Already reallocated and initialized.}
2268         \textcolor{keywordflow}{return} \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2269     \}
2270 
2271     threads\_data\_p = & task\_team -> tt.tt\_threads\_data;
2272     nthreads   = task\_team -> tt.tt\_nproc;
2273     maxthreads = task\_team -> tt.tt\_max\_threads;
2274 
2275     \textcolor{comment}{// All threads must lock when they encounter the first task of the implicit task}
2276     \textcolor{comment}{// region to make sure threads\_data fields are (re)initialized before used.}
2277     \hyperlink{kmp__lock_8h_a85412da5c0d085bde951a77690cf1f74}{\_\_kmp\_acquire\_bootstrap\_lock}( & task\_team -> tt.tt\_threads\_lock );
2278 
2279     \textcolor{keywordflow}{if} ( ! \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(task\_team -> tt.tt\_found\_tasks) ) \{
2280         \textcolor{comment}{// first thread to enable tasking}
2281         \hyperlink{unionkmp__team}{kmp\_team\_t} *team = thread -> th.th\_team;
2282         \textcolor{keywordtype}{int} \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i};
2283 
2284         is\_init\_thread = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
2285         \textcolor{keywordflow}{if} ( maxthreads < nthreads ) \{
2286 
2287             \textcolor{keywordflow}{if} ( *threads\_data\_p != NULL ) \{
2288                 \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} *old\_data = *threads\_data\_p;
2289                 \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} *new\_data = NULL;
2290 
2291                 \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_realloc\_task\_threads\_data: T#%d reallocating "}
2292                                \textcolor{stringliteral}{"threads data for task\_team %p, new\_size = %d, old\_size = %d\(\backslash\)n"},
2293                                \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( thread ), task\_team,
2294                                nthreads, maxthreads ) );
2295                 \textcolor{comment}{// Reallocate threads\_data to have more elements than current array}
2296                 \textcolor{comment}{// Cannot use \_\_kmp\_thread\_realloc() because threads not around for}
2297                 \textcolor{comment}{// kmp\_reap\_task\_team( ).  Note all new array entries are initialized}
2298                 \textcolor{comment}{// to zero by \_\_kmp\_allocate().}
2299                 new\_data = (\hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} *)
2300                             \hyperlink{kmp_8h_aa6a69b47037dcffbfc5dba21a4a64d85}{\_\_kmp\_allocate}( nthreads * \textcolor{keyword}{sizeof}(
      \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t}) );
2301                 \textcolor{comment}{// copy old data to new data}
2302                 \hyperlink{kmp__safe__c__api_8h_abbf1dc5ebfe437e02858f8a119d8377d}{KMP\_MEMCPY\_S}( (\textcolor{keywordtype}{void} *) new\_data, nthreads * \textcolor{keyword}{sizeof}(
      \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t}),
2303                               (\textcolor{keywordtype}{void} *) old\_data,
2304                               maxthreads * \textcolor{keyword}{sizeof}(\hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} *) );
2305 
2306 \textcolor{preprocessor}{#ifdef BUILD\_TIED\_TASK\_STACK}
2307 \textcolor{preprocessor}{}                \textcolor{comment}{// GEH: Figure out if this is the right thing to do}
2308                 \textcolor{keywordflow}{for} (i = maxthreads; i < nthreads; i++) \{
2309                     \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} *thread\_data = & (*threads\_data\_p)[
      \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i}];
2310                     \_\_kmp\_init\_task\_stack( \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( thread ), 
      thread\_data );
2311                 \}
2312 \textcolor{preprocessor}{#endif // BUILD\_TIED\_TASK\_STACK}
2313 \textcolor{preprocessor}{}                \textcolor{comment}{// Install the new data and free the old data}
2314                 (*threads\_data\_p) = new\_data;
2315                 \hyperlink{kmp_8h_a052396231429341ba56a7c1ceacbaa2f}{\_\_kmp\_free}( old\_data );
2316             \}
2317             \textcolor{keywordflow}{else} \{
2318                 \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_realloc\_task\_threads\_data: T#%d allocating "}
2319                                \textcolor{stringliteral}{"threads data for task\_team %p, size = %d\(\backslash\)n"},
2320                                \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( thread ), task\_team, nthreads 
      ) );
2321                 \textcolor{comment}{// Make the initial allocate for threads\_data array, and zero entries}
2322                 \textcolor{comment}{// Cannot use \_\_kmp\_thread\_calloc() because threads not around for}
2323                 \textcolor{comment}{// kmp\_reap\_task\_team( ).}
2324                 *threads\_data\_p = (\hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} *)
2325                                   \hyperlink{kmp_8h_aa6a69b47037dcffbfc5dba21a4a64d85}{\_\_kmp\_allocate}( nthreads * \textcolor{keyword}{sizeof}(
      \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t}) );
2326 \textcolor{preprocessor}{#ifdef BUILD\_TIED\_TASK\_STACK}
2327 \textcolor{preprocessor}{}                \textcolor{comment}{// GEH: Figure out if this is the right thing to do}
2328                 \textcolor{keywordflow}{for} (i = 0; i < nthreads; i++) \{
2329                     \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} *thread\_data = & (*threads\_data\_p)[
      \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i}];
2330                     \_\_kmp\_init\_task\_stack( \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( thread ), 
      thread\_data );
2331                 \}
2332 \textcolor{preprocessor}{#endif // BUILD\_TIED\_TASK\_STACK}
2333 \textcolor{preprocessor}{}            \}
2334             task\_team -> tt.tt\_max\_threads = nthreads;
2335         \}
2336         \textcolor{keywordflow}{else} \{
2337             \textcolor{comment}{// If array has (more than) enough elements, go ahead and use it}
2338             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( *threads\_data\_p != NULL );
2339         \}
2340 
2341         \textcolor{comment}{// initialize threads\_data pointers back to thread\_info structures}
2342         \textcolor{keywordflow}{for} (i = 0; i < nthreads; i++) \{
2343             \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} *thread\_data = & (*threads\_data\_p)[
      \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i}];
2344             thread\_data -> td.td\_thr = team -> t.t\_threads[\hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i}];
2345 
2346             \textcolor{keywordflow}{if} ( thread\_data -> td.td\_deque\_last\_stolen >= nthreads) \{
2347                 \textcolor{comment}{// The last stolen field survives across teams / barrier, and the number}
2348                 \textcolor{comment}{// of threads may have changed.  It's possible (likely?) that a new}
2349                 \textcolor{comment}{// parallel region will exhibit the same behavior as the previous region.}
2350                 thread\_data -> td.td\_deque\_last\_stolen = -1;
2351             \}
2352         \}
2353 
2354         \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();
2355         \hyperlink{kmp__os_8h_aa87da17e7b31a360efb533f0b7150bd4}{TCW\_SYNC\_4}(task\_team -> tt.tt\_found\_tasks, \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
2356     \}
2357 
2358     \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( & task\_team -> tt.tt\_threads\_lock );
2359     \textcolor{keywordflow}{return} is\_init\_thread;
2360 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a22a6e6a06a23962fc8de80d5d474e82c}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-reap\-\_\-task\-\_\-teams@{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-task\-\_\-teams}}
\index{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-task\-\_\-teams@{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-task\-\_\-teams}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-task\-\_\-teams}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-reap\-\_\-task\-\_\-teams (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_a22a6e6a06a23962fc8de80d5d474e82c}


Definition at line 2467 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-internal\-\_\-end().


\begin{DoxyCode}
2468 \{
2469     \hyperlink{unionkmp__task__team}{kmp\_task\_team\_t}   *task\_team;
2470 
2471     \textcolor{keywordflow}{if} ( \hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}(\hyperlink{kmp__tasking_8c_ac0f8028d2592221f303450428fa1e680}{\_\_kmp\_free\_task\_teams}) != NULL ) \{
2472         \textcolor{comment}{// Free all task\_teams on the free list}
2473         \hyperlink{kmp__lock_8h_a85412da5c0d085bde951a77690cf1f74}{\_\_kmp\_acquire\_bootstrap\_lock}( &
      \hyperlink{kmp__tasking_8c_a41e8ad7ff702abc83af1e3c4d47a2e47}{\_\_kmp\_task\_team\_lock} );
2474         \textcolor{keywordflow}{while} ( ( task\_team = \hyperlink{kmp__tasking_8c_ac0f8028d2592221f303450428fa1e680}{\_\_kmp\_free\_task\_teams} ) != NULL ) \{
2475             \hyperlink{kmp__tasking_8c_ac0f8028d2592221f303450428fa1e680}{\_\_kmp\_free\_task\_teams} = task\_team -> tt.tt\_next;
2476             task\_team -> tt.tt\_next = NULL;
2477 
2478             \textcolor{comment}{// Free threads\_data if necessary}
2479             \textcolor{keywordflow}{if} ( task\_team -> tt.tt\_threads\_data != NULL ) \{
2480                 \hyperlink{kmp__tasking_8c_a63ab26c647493216462fbd8a639219c6}{\_\_kmp\_free\_task\_threads\_data}( task\_team );
2481             \}
2482             \hyperlink{kmp_8h_a052396231429341ba56a7c1ceacbaa2f}{\_\_kmp\_free}( task\_team );
2483         \}
2484         \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( &
      \hyperlink{kmp__tasking_8c_a41e8ad7ff702abc83af1e3c4d47a2e47}{\_\_kmp\_task\_team\_lock} );
2485     \}
2486 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a0a77c0e2bc6507126e97141974373702}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-remove\-\_\-my\-\_\-task@{\-\_\-\-\_\-kmp\-\_\-remove\-\_\-my\-\_\-task}}
\index{\-\_\-\-\_\-kmp\-\_\-remove\-\_\-my\-\_\-task@{\-\_\-\-\_\-kmp\-\_\-remove\-\_\-my\-\_\-task}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-remove\-\_\-my\-\_\-task}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf kmp\-\_\-task\-\_\-t}$\ast$ \-\_\-\-\_\-kmp\-\_\-remove\-\_\-my\-\_\-task (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{thread, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-task\-\_\-team\-\_\-t} $\ast$}]{task\-\_\-team, }
\item[{kmp\-\_\-int32}]{is\-\_\-constrained}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_a0a77c0e2bc6507126e97141974373702}


Definition at line 1555 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-template().


\begin{DoxyCode}
1557 \{
1558     \hyperlink{structkmp__task}{kmp\_task\_t} * \hyperlink{ittnotify__static_8h_aed9673d42c4239c5498e39aad80df904}{task};
1559     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * taskdata;
1560     \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} *thread\_data;
1561     kmp\_uint32 \hyperlink{ittnotify__static_8h_a7205a2ef1da3b41743f40e66ffb8a1be}{tail};
1562 
1563     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp_8h_a39e87c52fb75a615c2564a822a013a5a}{\_\_kmp\_tasking\_mode} != 
      \hyperlink{kmp_8h_aad1bdfbfac136cfd92611bcee79ca3f2af827998cf4eb3f61723edc4943b86c98}{tskm\_immediate\_exec} );
1564     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( task\_team -> tt.tt\_threads\_data != NULL ); \textcolor{comment}{// Caller should check
       this condition}
1565 
1566         thread\_data = & task\_team -> tt.tt\_threads\_data[ \hyperlink{kmp_8h_afb8f84fff9682417eb1c484ffbfdc6ee}{\_\_kmp\_tid\_from\_gtid}( gtid ) ];
1567 
1568     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_remove\_my\_task(enter): T#%d ntasks=%d head=%u tail=%u\(\backslash\)n"},
1569                   gtid, thread\_data->td.td\_deque\_ntasks, thread\_data->td.td\_deque\_head,
1570                   thread\_data->td.td\_deque\_tail) );
1571 
1572     \textcolor{keywordflow}{if} (\hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(thread\_data -> td.td\_deque\_ntasks) == 0) \{
1573         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_remove\_my\_task(exit #1): T#%d No tasks to remove: ntasks=%d head=%u
       tail=%u\(\backslash\)n"},
1574                       gtid, thread\_data->td.td\_deque\_ntasks, thread\_data->td.td\_deque\_head,
1575                       thread\_data->td.td\_deque\_tail) );
1576         \textcolor{keywordflow}{return} NULL;
1577     \}
1578 
1579     \hyperlink{kmp__lock_8h_a85412da5c0d085bde951a77690cf1f74}{\_\_kmp\_acquire\_bootstrap\_lock}( & thread\_data -> td.td\_deque\_lock );
1580 
1581     \textcolor{keywordflow}{if} (\hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(thread\_data -> td.td\_deque\_ntasks) == 0) \{
1582         \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( & thread\_data -> td.td\_deque\_lock );
1583         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_remove\_my\_task(exit #2): T#%d No tasks to remove: ntasks=%d head=%u
       tail=%u\(\backslash\)n"},
1584                       gtid, thread\_data->td.td\_deque\_ntasks, thread\_data->td.td\_deque\_head,
1585                       thread\_data->td.td\_deque\_tail) );
1586         \textcolor{keywordflow}{return} NULL;
1587     \}
1588 
1589     tail = ( thread\_data -> td.td\_deque\_tail - 1 ) & \hyperlink{kmp_8h_a33c7c9f8f5103d9fea2773bf8422ddd9}{TASK\_DEQUE\_MASK};  \textcolor{comment}{// Wrap index.}
1590     taskdata = thread\_data -> td.td\_deque[ \hyperlink{ittnotify__static_8h_a7205a2ef1da3b41743f40e66ffb8a1be}{tail} ];
1591 
1592     \textcolor{keywordflow}{if} (is\_constrained) \{
1593         \textcolor{comment}{// we need to check if the candidate obeys task scheduling constraint:}
1594         \textcolor{comment}{// only child of current task can be scheduled}
1595         \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * current = thread->th.th\_current\_task;
1596         kmp\_int32        level = current->\hyperlink{structkmp__taskdata_a1dce0edb2ca087c66580ff685fae081a}{td\_level};
1597         \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * \hyperlink{ittnotify__static_8h_a05e33740d1c7ac239093593607ff58a9}{parent} = taskdata->\hyperlink{structkmp__taskdata_a47e9134b90866241cb795112acf9dabb}{td\_parent};
1598         \textcolor{keywordflow}{while} ( parent != current && parent->\hyperlink{structkmp__taskdata_a1dce0edb2ca087c66580ff685fae081a}{td\_level} > level ) \{
1599             parent = parent->\hyperlink{structkmp__taskdata_a47e9134b90866241cb795112acf9dabb}{td\_parent};  \textcolor{comment}{// check generation up to the level of the current task}
1600             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(parent != NULL);
1601         \}
1602         \textcolor{keywordflow}{if} ( parent != current ) \{
1603             \textcolor{comment}{// If the tail task is not a child, then no other childs can appear in the deque.}
1604             \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( & thread\_data -> td.td\_deque\_lock );
1605             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_remove\_my\_task(exit #2): T#%d No tasks to remove: ntasks=%d
       head=%u tail=%u\(\backslash\)n"},
1606                           gtid, thread\_data->td.td\_deque\_ntasks, thread\_data->td.td\_deque\_head,
1607                           thread\_data->td.td\_deque\_tail) );
1608             \textcolor{keywordflow}{return} NULL;
1609         \}
1610     \}
1611 
1612     thread\_data -> td.td\_deque\_tail = \hyperlink{ittnotify__static_8h_a7205a2ef1da3b41743f40e66ffb8a1be}{tail};
1613     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(thread\_data -> td.td\_deque\_ntasks, thread\_data -> td.td\_deque\_ntasks - 1);
1614 
1615     \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( & thread\_data->td.td\_deque\_lock );
1616 
1617     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_remove\_my\_task(exit #2): T#%d task %p removed: ntasks=%d head=%u tail=%u\(\backslash\)n
      "},
1618                   gtid, taskdata, thread\_data->td.td\_deque\_ntasks, thread\_data->td.td\_deque\_head,
1619                   thread\_data->td.td\_deque\_tail) );
1620 
1621     task = \hyperlink{kmp_8h_a31d908c2f639a50b62c9c4f1bf11df38}{KMP\_TASKDATA\_TO\_TASK}( taskdata );
1622     \textcolor{keywordflow}{return} \hyperlink{ittnotify__static_8h_aed9673d42c4239c5498e39aad80df904}{task};
1623 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_aae70dda0695f463bf14776f84d02f7b9}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-round\-\_\-up\-\_\-to\-\_\-val@{\-\_\-\-\_\-kmp\-\_\-round\-\_\-up\-\_\-to\-\_\-val}}
\index{\-\_\-\-\_\-kmp\-\_\-round\-\_\-up\-\_\-to\-\_\-val@{\-\_\-\-\_\-kmp\-\_\-round\-\_\-up\-\_\-to\-\_\-val}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-round\-\_\-up\-\_\-to\-\_\-val}]{\setlength{\rightskip}{0pt plus 5cm}static size\-\_\-t \-\_\-\-\_\-kmp\-\_\-round\-\_\-up\-\_\-to\-\_\-val (
\begin{DoxyParamCaption}
\item[{size\-\_\-t}]{size, }
\item[{size\-\_\-t}]{val}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_aae70dda0695f463bf14776f84d02f7b9}


Definition at line 859 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-task\-\_\-alloc().


\begin{DoxyCode}
859                                                  \{
860     \textcolor{keywordflow}{if} ( \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} & ( val - 1 ) ) \{
861         \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} &= ~ ( val - 1 );
862         \textcolor{keywordflow}{if} ( \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} <= \hyperlink{kmp__os_8h_a2946e9f5701c22f4038024f9040d33ff}{KMP\_SIZE\_T\_MAX} - val ) \{
863             \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} += val;    \textcolor{comment}{// Round up if there is no overflow.}
864         \}; \textcolor{comment}{// if}
865     \}; \textcolor{comment}{// if}
866     \textcolor{keywordflow}{return} \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size};
867 \} \textcolor{comment}{// \_\_kmp\_round\_up\_to\_va}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a416c88d9ab9aa62c4ed0b110b1cc0d7b}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-steal\-\_\-task@{\-\_\-\-\_\-kmp\-\_\-steal\-\_\-task}}
\index{\-\_\-\-\_\-kmp\-\_\-steal\-\_\-task@{\-\_\-\-\_\-kmp\-\_\-steal\-\_\-task}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-steal\-\_\-task}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf kmp\-\_\-task\-\_\-t}$\ast$ \-\_\-\-\_\-kmp\-\_\-steal\-\_\-task (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{victim, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-task\-\_\-team\-\_\-t} $\ast$}]{task\-\_\-team, }
\item[{volatile kmp\-\_\-uint32 $\ast$}]{unfinished\-\_\-threads, }
\item[{{\bf int} $\ast$}]{thread\-\_\-finished, }
\item[{kmp\-\_\-int32}]{is\-\_\-constrained}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_a416c88d9ab9aa62c4ed0b110b1cc0d7b}


Definition at line 1632 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-execute\-\_\-tasks\-\_\-template().


\begin{DoxyCode}
1635 \{
1636     \hyperlink{structkmp__task}{kmp\_task\_t} * \hyperlink{ittnotify__static_8h_aed9673d42c4239c5498e39aad80df904}{task};
1637     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * taskdata;
1638     \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} *victim\_td, *threads\_data;
1639     kmp\_int32 victim\_tid;
1640 
1641     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp_8h_a39e87c52fb75a615c2564a822a013a5a}{\_\_kmp\_tasking\_mode} != 
      \hyperlink{kmp_8h_aad1bdfbfac136cfd92611bcee79ca3f2af827998cf4eb3f61723edc4943b86c98}{tskm\_immediate\_exec} );
1642 
1643     threads\_data = task\_team -> tt.tt\_threads\_data;
1644     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( threads\_data != NULL );  \textcolor{comment}{// Caller should check this condition}
1645 
1646     victim\_tid = victim->th.th\_info.ds.ds\_tid;
1647     victim\_td = & threads\_data[ victim\_tid ];
1648 
1649     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_steal\_task(enter): T#%d try to steal from T#%d: task\_team=%p ntasks=%d "}
1650                   \textcolor{stringliteral}{"head=%u tail=%u\(\backslash\)n"},
1651                   gtid, \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( victim ), task\_team, victim\_td->td.
      td\_deque\_ntasks,
1652                   victim\_td->td.td\_deque\_head, victim\_td->td.td\_deque\_tail) );
1653 
1654     \textcolor{keywordflow}{if} ( (\hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(victim\_td -> td.td\_deque\_ntasks) == 0) || \textcolor{comment}{// Caller should not check this condition}
1655          (\hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}(victim->th.th\_task\_team) != task\_team)) \textcolor{comment}{// GEH: why would this happen?}
1656     \{
1657         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_steal\_task(exit #1): T#%d could not steal from T#%d: task\_team=%p "}
1658                       \textcolor{stringliteral}{"ntasks=%d head=%u tail=%u\(\backslash\)n"},
1659                       gtid, \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( victim ), task\_team, victim\_td->
      td.td\_deque\_ntasks,
1660                       victim\_td->td.td\_deque\_head, victim\_td->td.td\_deque\_tail) );
1661         \textcolor{keywordflow}{return} NULL;
1662     \}
1663 
1664     \hyperlink{kmp__lock_8h_a85412da5c0d085bde951a77690cf1f74}{\_\_kmp\_acquire\_bootstrap\_lock}( & victim\_td -> td.td\_deque\_lock );
1665 
1666     \textcolor{comment}{// Check again after we acquire the lock}
1667     \textcolor{keywordflow}{if} ( (\hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(victim\_td -> td.td\_deque\_ntasks) == 0) ||
1668          (\hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}(victim->th.th\_task\_team) != task\_team)) \textcolor{comment}{// GEH: why would this happen?}
1669     \{
1670         \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( & victim\_td -> td.td\_deque\_lock );
1671         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_steal\_task(exit #2): T#%d could not steal from T#%d: task\_team=%p "}
1672                       \textcolor{stringliteral}{"ntasks=%d head=%u tail=%u\(\backslash\)n"},
1673                       gtid, \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( victim ), task\_team, victim\_td->
      td.td\_deque\_ntasks,
1674                       victim\_td->td.td\_deque\_head, victim\_td->td.td\_deque\_tail) );
1675         \textcolor{keywordflow}{return} NULL;
1676     \}
1677 
1678     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( victim\_td -> td.td\_deque != NULL );
1679 
1680     \textcolor{keywordflow}{if} ( !is\_constrained ) \{
1681         taskdata = victim\_td -> td.td\_deque[ victim\_td -> td.td\_deque\_head ];
1682         \textcolor{comment}{// Bump head pointer and Wrap.}
1683         victim\_td -> td.td\_deque\_head = ( victim\_td -> td.td\_deque\_head + 1 ) & 
      \hyperlink{kmp_8h_a33c7c9f8f5103d9fea2773bf8422ddd9}{TASK\_DEQUE\_MASK};
1684     \} \textcolor{keywordflow}{else} \{
1685         \textcolor{comment}{// While we have postponed tasks let's steal from tail of the deque (smaller tasks)}
1686         kmp\_int32 \hyperlink{ittnotify__static_8h_a7205a2ef1da3b41743f40e66ffb8a1be}{tail} = ( victim\_td -> td.td\_deque\_tail - 1 ) & 
      \hyperlink{kmp_8h_a33c7c9f8f5103d9fea2773bf8422ddd9}{TASK\_DEQUE\_MASK};  \textcolor{comment}{// Wrap index.}
1687         taskdata = victim\_td -> td.td\_deque[ \hyperlink{ittnotify__static_8h_a7205a2ef1da3b41743f40e66ffb8a1be}{tail} ];
1688         \textcolor{comment}{// we need to check if the candidate obeys task scheduling constraint:}
1689         \textcolor{comment}{// only child of current task can be scheduled}
1690         \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * current = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ]->th.th\_current\_task;
1691         kmp\_int32        level = current->\hyperlink{structkmp__taskdata_a1dce0edb2ca087c66580ff685fae081a}{td\_level};
1692         \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * \hyperlink{ittnotify__static_8h_a05e33740d1c7ac239093593607ff58a9}{parent} = taskdata->\hyperlink{structkmp__taskdata_a47e9134b90866241cb795112acf9dabb}{td\_parent};
1693         \textcolor{keywordflow}{while} ( parent != current && parent->\hyperlink{structkmp__taskdata_a1dce0edb2ca087c66580ff685fae081a}{td\_level} > level ) \{
1694             parent = parent->\hyperlink{structkmp__taskdata_a47e9134b90866241cb795112acf9dabb}{td\_parent};  \textcolor{comment}{// check generation up to the level of the current task}
1695             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(parent != NULL);
1696         \}
1697         \textcolor{keywordflow}{if} ( parent != current ) \{
1698             \textcolor{comment}{// If the tail task is not a child, then no other childs can appear in the deque (?).}
1699             \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( & victim\_td -> td.td\_deque\_lock );
1700             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_steal\_task(exit #2): T#%d could not steal from T#%d: task\_team=%p 
      "}
1701                           \textcolor{stringliteral}{"ntasks=%d head=%u tail=%u\(\backslash\)n"},
1702                           gtid, \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( threads\_data[victim\_tid].td.
      td\_thr ),
1703                           task\_team, victim\_td->td.td\_deque\_ntasks,
1704                           victim\_td->td.td\_deque\_head, victim\_td->td.td\_deque\_tail) );
1705             \textcolor{keywordflow}{return} NULL;
1706         \}
1707         victim\_td -> td.td\_deque\_tail = \hyperlink{ittnotify__static_8h_a7205a2ef1da3b41743f40e66ffb8a1be}{tail};
1708     \}
1709     \textcolor{keywordflow}{if} (*thread\_finished) \{
1710         \textcolor{comment}{// We need to un-mark this victim as a finished victim.  This must be done before}
1711         \textcolor{comment}{// releasing the lock, or else other threads (starting with the master victim)}
1712         \textcolor{comment}{// might be prematurely released from the barrier!!!}
1713         kmp\_uint32 \hyperlink{ittnotify__static_8h_a9da14338c9c3be6f21c41cf4ec79eaf1}{count};
1714 
1715         count = \hyperlink{kmp__os_8h_a201982f51ff23ad84ae6781ad4265e3a}{KMP\_TEST\_THEN\_INC32}( (kmp\_int32 *)unfinished\_threads );
1716 
1717         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_steal\_task: T#%d inc unfinished\_threads to %d: task\_team=%p\(\backslash\)n"},
1718                       gtid, count + 1, task\_team) );
1719 
1720         *thread\_finished = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1721     \}
1722     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(victim\_td -> td.td\_deque\_ntasks, \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(victim\_td -> td.td\_deque\_ntasks) - 1);
1723 
1724     \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( & victim\_td -> td.td\_deque\_lock );
1725 
1726     \hyperlink{group__STATS__GATHERING_ga7fa64ec62947bf0b97f3f4778dd22196}{KMP\_COUNT\_BLOCK}(TASK\_stolen);
1727     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_steal\_task(exit #3): T#%d stole task %p from T#%d: task\_team=%p "}
1728                   \textcolor{stringliteral}{"ntasks=%d head=%u tail=%u\(\backslash\)n"},
1729                   gtid, taskdata, \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( victim ), task\_team,
1730                   victim\_td->td.td\_deque\_ntasks, victim\_td->td.td\_deque\_head,
1731                   victim\_td->td.td\_deque\_tail) );
1732 
1733     task = \hyperlink{kmp_8h_a31d908c2f639a50b62c9c4f1bf11df38}{KMP\_TASKDATA\_TO\_TASK}( taskdata );
1734     \textcolor{keywordflow}{return} \hyperlink{ittnotify__static_8h_aed9673d42c4239c5498e39aad80df904}{task};
1735 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a7a0441f3fc01669f2f7f2c2954f77bdb}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-task\-\_\-alloc@{\-\_\-\-\_\-kmp\-\_\-task\-\_\-alloc}}
\index{\-\_\-\-\_\-kmp\-\_\-task\-\_\-alloc@{\-\_\-\-\_\-kmp\-\_\-task\-\_\-alloc}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-task\-\_\-alloc}]{\setlength{\rightskip}{0pt plus 5cm}{\bf kmp\-\_\-task\-\_\-t}$\ast$ \-\_\-\-\_\-kmp\-\_\-task\-\_\-alloc (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc\-\_\-ref, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-tasking\-\_\-flags\-\_\-t} $\ast$}]{flags, }
\item[{size\-\_\-t}]{sizeof\-\_\-kmp\-\_\-task\-\_\-t, }
\item[{size\-\_\-t}]{sizeof\-\_\-shareds, }
\item[{{\bf kmp\-\_\-routine\-\_\-entry\-\_\-t}}]{task\-\_\-entry}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_a7a0441f3fc01669f2f7f2c2954f77bdb}


Definition at line 883 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-alloc(), and P\-A\-R\-A\-L\-L\-E\-L\-\_\-\-L\-O\-O\-P\-\_\-\-S\-T\-A\-R\-T().


\begin{DoxyCode}
886 \{
887     \hyperlink{structkmp__task}{kmp\_task\_t} *\hyperlink{ittnotify__static_8h_aed9673d42c4239c5498e39aad80df904}{task};
888     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} *taskdata;
889     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *thread = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
890     \hyperlink{unionkmp__team}{kmp\_team\_t} *team = thread->th.th\_team;
891     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} *parent\_task = thread->th.th\_current\_task;
892     \textcolor{keywordtype}{size\_t} shareds\_offset;
893 
894     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_task\_alloc(enter): T#%d loc=%p, flags=(0x%x) "}
895                   \textcolor{stringliteral}{"sizeof\_task=%ld sizeof\_shared=%ld entry=%p\(\backslash\)n"},
896                   gtid, loc\_ref, *((kmp\_int32 *)flags), sizeof\_kmp\_task\_t,
897                   sizeof\_shareds, task\_entry) );
898 
899     \textcolor{keywordflow}{if} ( parent\_task->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_adc49b76236bc45b6c68457f8e81230b7}{final} ) \{
900         \textcolor{keywordflow}{if} (flags->\hyperlink{structkmp__tasking__flags_a21feec95b8d05beac5923ca04b98ad0e}{merged\_if0}) \{
901         \}
902         flags->\hyperlink{structkmp__tasking__flags_adc49b76236bc45b6c68457f8e81230b7}{final} = 1;
903     \}
904 
905 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
906 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} ( flags->proxy == \hyperlink{kmp_8h_a09ec98eec6915a3858e6146869f27a50}{TASK\_PROXY} ) \{
907         flags->\hyperlink{structkmp__tasking__flags_a896a40bab626e74a4824539d1605d176}{tiedness} = \hyperlink{kmp_8h_a021e6a8141b7233285dd1bd91404360c}{TASK\_UNTIED};
908         flags->\hyperlink{structkmp__tasking__flags_a21feec95b8d05beac5923ca04b98ad0e}{merged\_if0} = 1;
909 
910         \textcolor{comment}{/* are we running in a sequential parallel or tskm\_immediate\_exec... we need tasking support
       enabled */}
911         \textcolor{keywordflow}{if} ( (thread->th.th\_task\_team) == NULL ) \{
912             \textcolor{comment}{/* This should only happen if the team is serialized}
913 \textcolor{comment}{                setup a task team and propagate it to the thread}
914 \textcolor{comment}{            */}
915             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_serialized);
916             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(30,(\textcolor{stringliteral}{"T#%d creating task team in \_\_kmp\_task\_alloc for proxy task\(\backslash\)n"}, gtid));
917             \hyperlink{kmp__tasking_8c_af98fb3c3ffb814bf6a38fc90dbe07fcc}{\_\_kmp\_task\_team\_setup}(thread,team,1); \textcolor{comment}{// 1 indicates setup the current
       team regardless of nthreads}
918             thread->th.th\_task\_team = team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_task\_team[thread->th.th\_task\_state];
919         \}
920         \hyperlink{unionkmp__task__team}{kmp\_task\_team\_t} * task\_team = thread->th.th\_task\_team;
921 
922         \textcolor{comment}{/* tasking must be enabled now as the task might not be pushed */}
923         \textcolor{keywordflow}{if} ( !\hyperlink{kmp_8h_a8b15269c2644fa0ba3ee09b0eb025867}{KMP\_TASKING\_ENABLED}( task\_team ) ) \{
924             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(30,(\textcolor{stringliteral}{"T#%d enabling tasking in \_\_kmp\_task\_alloc for proxy task\(\backslash\)n"}, gtid));
925             \hyperlink{kmp__tasking_8c_a98d61b65441709c36e312a5687bee6ac}{\_\_kmp\_enable\_tasking}( task\_team, thread );
926             kmp\_int32 tid = thread->th.th\_info.ds.ds\_tid;
927             \hyperlink{kmp_8h_a1341a4d3305053812a11b5219464d339}{kmp\_thread\_data\_t} * thread\_data = & task\_team -> tt.tt\_threads\_data[ tid ];
928             \textcolor{comment}{// No lock needed since only owner can allocate}
929             \textcolor{keywordflow}{if} (thread\_data -> td.td\_deque == NULL ) \{
930                 \hyperlink{kmp__tasking_8c_aed22cf1086a01e5f909f2388f4799f24}{\_\_kmp\_alloc\_task\_deque}( thread, thread\_data );
931             \}
932         \}
933 
934         \textcolor{keywordflow}{if} ( task\_team->\hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.tt\_found\_proxy\_tasks == \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE} )
935           \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(task\_team -> tt.tt\_found\_proxy\_tasks, \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
936     \}
937 \textcolor{preprocessor}{#endif}
938 \textcolor{preprocessor}{}
939     \textcolor{comment}{// Calculate shared structure offset including padding after kmp\_task\_t struct}
940     \textcolor{comment}{// to align pointers in shared struct}
941     shareds\_offset = \textcolor{keyword}{sizeof}( \hyperlink{kmp_8h_af73aa077ec760ca83750f8144a5e65fb}{kmp\_taskdata\_t} ) + sizeof\_kmp\_task\_t;
942     shareds\_offset = \hyperlink{kmp__tasking_8c_aae70dda0695f463bf14776f84d02f7b9}{\_\_kmp\_round\_up\_to\_val}( shareds\_offset, \textcolor{keyword}{sizeof}( \textcolor{keywordtype}{void} * ));
943 
944     \textcolor{comment}{// Allocate a kmp\_taskdata\_t block and a kmp\_task\_t block.}
945     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(30, (\textcolor{stringliteral}{"\_\_kmp\_task\_alloc: T#%d First malloc size: %ld\(\backslash\)n"},
946                   gtid, shareds\_offset) );
947     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(30, (\textcolor{stringliteral}{"\_\_kmp\_task\_alloc: T#%d Second malloc size: %ld\(\backslash\)n"},
948                   gtid, sizeof\_shareds) );
949 
950     \textcolor{comment}{// Avoid double allocation here by combining shareds with taskdata}
951 \textcolor{preprocessor}{    #if USE\_FAST\_MEMORY}
952 \textcolor{preprocessor}{}    taskdata = (\hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} *) \hyperlink{kmp_8h_a2adbf8a689a0e42c899bde3d997ac1c0}{\_\_kmp\_fast\_allocate}( thread, 
      shareds\_offset + sizeof\_shareds );
953 \textcolor{preprocessor}{    #else }\textcolor{comment}{/* ! USE\_FAST\_MEMORY */}\textcolor{preprocessor}{}
954 \textcolor{preprocessor}{}    taskdata = (\hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} *) \hyperlink{kmp_8h_a83a0d4c2333a2ee3931cba6b12e0d5a6}{\_\_kmp\_thread\_malloc}( thread, 
      shareds\_offset + sizeof\_shareds );
955 \textcolor{preprocessor}{    #endif }\textcolor{comment}{/* USE\_FAST\_MEMORY */}\textcolor{preprocessor}{}
956 \textcolor{preprocessor}{}
957     task                      = \hyperlink{kmp_8h_a31d908c2f639a50b62c9c4f1bf11df38}{KMP\_TASKDATA\_TO\_TASK}(taskdata);
958 
959     \textcolor{comment}{// Make sure task & taskdata are aligned appropriately}
960 \textcolor{preprocessor}{#if KMP\_ARCH\_X86 || KMP\_ARCH\_PPC64 || !KMP\_HAVE\_QUAD}
961 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( ( ((\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})taskdata) & (\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double})-1) ) == 0 
      );
962     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( ( ((\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})task) & (\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double})-1) ) == 0 );
963 \textcolor{preprocessor}{#else}
964 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( ( ((\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})taskdata) & (\textcolor{keyword}{sizeof}(\_Quad)-1) ) == 0 )
      ;
965     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( ( ((\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})task) & (\textcolor{keyword}{sizeof}(\_Quad)-1) ) == 0 );
966 \textcolor{preprocessor}{#endif}
967 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (sizeof\_shareds > 0) \{
968         \textcolor{comment}{// Avoid double allocation here by combining shareds with taskdata}
969         task->shareds         = & ((\textcolor{keywordtype}{char} *) taskdata)[ shareds\_offset ];
970         \textcolor{comment}{// Make sure shareds struct is aligned to pointer size}
971         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( ( ((\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})task->shareds) & (\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{void} *)-1
      ) ) == 0 );
972     \} \textcolor{keywordflow}{else} \{
973         task->shareds         = NULL;
974     \}
975     task->routine             = task\_entry;
976     task->part\_id             = 0;      \textcolor{comment}{// AC: Always start with 0 part id}
977 
978     taskdata->td\_task\_id      = \hyperlink{kmp_8h_a3ea4057f803408443d7a20c231170f86}{KMP\_GEN\_TASK\_ID}();
979     taskdata->td\_team         = team;
980     taskdata->td\_alloc\_thread = thread;
981     taskdata->td\_parent       = parent\_task;
982     taskdata->\hyperlink{structkmp__taskdata_a1dce0edb2ca087c66580ff685fae081a}{td\_level}        = parent\_task->\hyperlink{structkmp__taskdata_a1dce0edb2ca087c66580ff685fae081a}{td\_level} + 1; \textcolor{comment}{// increment nesting level}
983     taskdata->td\_ident        = loc\_ref;
984     taskdata->td\_taskwait\_ident   = NULL;
985     taskdata->td\_taskwait\_counter = 0;
986     taskdata->td\_taskwait\_thread  = 0;
987     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata->td\_parent != NULL );
988 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
989 \textcolor{preprocessor}{}    \textcolor{comment}{// avoid copying icvs for proxy tasks}
990     \textcolor{keywordflow}{if} ( flags->proxy == \hyperlink{kmp_8h_a380760b89bb46b5ca8ec2d1381b273c0}{TASK\_FULL} )
991 \textcolor{preprocessor}{#endif}
992 \textcolor{preprocessor}{}       \hyperlink{kmp_8h_a87574bd68566bdaab6ba1cd63223ab46}{copy\_icvs}( &taskdata->td\_icvs, &taskdata->td\_parent->td\_icvs );
993 
994     taskdata->td\_flags.tiedness    = flags->\hyperlink{structkmp__tasking__flags_a896a40bab626e74a4824539d1605d176}{tiedness};
995     taskdata->td\_flags.final       = flags->\hyperlink{structkmp__tasking__flags_adc49b76236bc45b6c68457f8e81230b7}{final};
996     taskdata->td\_flags.merged\_if0  = flags->\hyperlink{structkmp__tasking__flags_a21feec95b8d05beac5923ca04b98ad0e}{merged\_if0};
997 \textcolor{preprocessor}{#if OMP\_40\_ENABLED}
998 \textcolor{preprocessor}{}    taskdata->td\_flags.destructors\_thunk = flags->\hyperlink{structkmp__tasking__flags_a998b866c0ee12e696ddb77d334b61e72}{destructors\_thunk};
999 \textcolor{preprocessor}{#endif // OMP\_40\_ENABLED}
1000 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if OMP\_41\_ENABLED}
1001 \textcolor{preprocessor}{}    taskdata->td\_flags.proxy           = flags->proxy;
1002     taskdata->td\_task\_team         = thread->th.th\_task\_team;
1003     taskdata->td\_size\_alloc        = shareds\_offset + sizeof\_shareds;
1004 \textcolor{preprocessor}{#endif}
1005 \textcolor{preprocessor}{}    taskdata->td\_flags.\hyperlink{structkmp__tasking__flags_ac102ec6051f4b30f0e81c0f3b5d9e84a}{tasktype}    = \hyperlink{kmp_8h_a1251a006af9d33ac15f16bb2a934a97b}{TASK\_EXPLICIT};
1006 
1007     \textcolor{comment}{// GEH - TODO: fix this to copy parent task's value of tasking\_ser flag}
1008     taskdata->td\_flags.tasking\_ser = ( \hyperlink{kmp_8h_a39e87c52fb75a615c2564a822a013a5a}{\_\_kmp\_tasking\_mode} == 
      \hyperlink{kmp_8h_aad1bdfbfac136cfd92611bcee79ca3f2af827998cf4eb3f61723edc4943b86c98}{tskm\_immediate\_exec} );
1009 
1010     \textcolor{comment}{// GEH - TODO: fix this to copy parent task's value of team\_serial flag}
1011     taskdata->td\_flags.team\_serial = ( team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_serialized ) ? 1 : 0;
1012 
1013     \textcolor{comment}{// GEH - Note we serialize the task if the team is serialized to make sure implicit parallel region}
1014     \textcolor{comment}{//       tasks are not left until program termination to execute.  Also, it helps locality to execute}
1015     \textcolor{comment}{//       immediately.}
1016     taskdata->td\_flags.task\_serial = ( parent\_task->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_adc49b76236bc45b6c68457f8e81230b7}{final}
1017       || taskdata->td\_flags.team\_serial || taskdata->td\_flags.tasking\_ser );
1018 
1019     taskdata->td\_flags.started     = 0;
1020     taskdata->td\_flags.executing   = 0;
1021     taskdata->td\_flags.complete    = 0;
1022     taskdata->td\_flags.freed       = 0;
1023 
1024     taskdata->td\_flags.native      = flags->\hyperlink{structkmp__tasking__flags_a6e26667bc33ef72a60338aaf00497f3a}{native};
1025 
1026     taskdata->td\_incomplete\_child\_tasks = 0;
1027     taskdata->td\_allocated\_child\_tasks  = 1; \textcolor{comment}{// start at one because counts current task and children}
1028 \textcolor{preprocessor}{#if OMP\_40\_ENABLED}
1029 \textcolor{preprocessor}{}    taskdata->td\_taskgroup = parent\_task->\hyperlink{structkmp__taskdata_a568185a9e8c23a1682491fa55973d61c}{td\_taskgroup}; \textcolor{comment}{// task inherits the taskgroup from the
       parent task}
1030     taskdata->td\_dephash = NULL;
1031     taskdata->td\_depnode = NULL;
1032 \textcolor{preprocessor}{#endif}
1033 \textcolor{preprocessor}{}
1034     \textcolor{comment}{// Only need to keep track of child task counts if team parallel and tasking not serialized or if it is
       a proxy task}
1035 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
1036 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} ( flags->proxy == \hyperlink{kmp_8h_a09ec98eec6915a3858e6146869f27a50}{TASK\_PROXY} || !( taskdata -> td\_flags.team\_serial || taskdata -> 
      td\_flags.tasking\_ser ) ) 
1037 #\textcolor{keywordflow}{else}
1038     \textcolor{keywordflow}{if} ( !( taskdata -> td\_flags.team\_serial || taskdata -> td\_flags.tasking\_ser ) ) 
1039 #endif
1040     \{
1041         \hyperlink{kmp__os_8h_a201982f51ff23ad84ae6781ad4265e3a}{KMP\_TEST\_THEN\_INC32}( (kmp\_int32 *)(& parent\_task->
      \hyperlink{structkmp__taskdata_af2d9a1116312e78182a768bb19bc5021}{td\_incomplete\_child\_tasks}) );
1042 \textcolor{preprocessor}{#if OMP\_40\_ENABLED}
1043 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( parent\_task->\hyperlink{structkmp__taskdata_a568185a9e8c23a1682491fa55973d61c}{td\_taskgroup} )
1044             \hyperlink{kmp__os_8h_a201982f51ff23ad84ae6781ad4265e3a}{KMP\_TEST\_THEN\_INC32}( (kmp\_int32 *)(& parent\_task->
      \hyperlink{structkmp__taskdata_a568185a9e8c23a1682491fa55973d61c}{td\_taskgroup}->\hyperlink{structkmp__taskgroup_aa0ed4b8e5fd1730ebad7b0f3f3ebadf9}{count}) );
1045 \textcolor{preprocessor}{#endif}
1046 \textcolor{preprocessor}{}        \textcolor{comment}{// Only need to keep track of allocated child tasks for explicit tasks since implicit not
       deallocated}
1047         \textcolor{keywordflow}{if} ( taskdata->td\_parent->td\_flags.tasktype == \hyperlink{kmp_8h_a1251a006af9d33ac15f16bb2a934a97b}{TASK\_EXPLICIT} ) \{
1048             \hyperlink{kmp__os_8h_a201982f51ff23ad84ae6781ad4265e3a}{KMP\_TEST\_THEN\_INC32}( (kmp\_int32 *)(& taskdata->td\_parent->
      td\_allocated\_child\_tasks) );
1049         \}
1050     \}
1051 
1052     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_task\_alloc(exit): T#%d created task %p parent=%p\(\backslash\)n"},
1053                   gtid, taskdata, taskdata->td\_parent) );
1054 
1055 \textcolor{preprocessor}{#if OMPT\_SUPPORT}
1056 \textcolor{preprocessor}{}    \_\_kmp\_task\_init\_ompt(taskdata, gtid, (\textcolor{keywordtype}{void}*) task\_entry);
1057 \textcolor{preprocessor}{#endif}
1058 \textcolor{preprocessor}{}
1059     \textcolor{keywordflow}{return} \hyperlink{ittnotify__static_8h_aed9673d42c4239c5498e39aad80df904}{task};
1060 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a25ab616c3e16ed294de1f4838ff74aef}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-task\-\_\-finish@{\-\_\-\-\_\-kmp\-\_\-task\-\_\-finish}}
\index{\-\_\-\-\_\-kmp\-\_\-task\-\_\-finish@{\-\_\-\-\_\-kmp\-\_\-task\-\_\-finish}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-task\-\_\-finish}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-task\-\_\-finish (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-task\-\_\-t} $\ast$}]{task, }
\item[{{\bf kmp\-\_\-taskdata\-\_\-t} $\ast$}]{resumed\-\_\-task}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_a25ab616c3e16ed294de1f4838ff74aef}


Definition at line 621 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-invoke\-\_\-task(), and \-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-complete\-\_\-if0().


\begin{DoxyCode}
622 \{
623     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * taskdata = \hyperlink{kmp_8h_a7996bdfd391438365a93a3c7fba1c440}{KMP\_TASK\_TO\_TASKDATA}(task);
624     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} * thread = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
625     kmp\_int32 children = 0;
626 
627 \textcolor{preprocessor}{#if OMPT\_SUPPORT}
628 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled} &&
629         \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_task\_end)) \{
630         \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} *\hyperlink{ittnotify__static_8h_a05e33740d1c7ac239093593607ff58a9}{parent} = taskdata->\hyperlink{structkmp__taskdata_a47e9134b90866241cb795112acf9dabb}{td\_parent};
631         \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_task\_end)(
632             taskdata->ompt\_task\_info.task\_id);
633     \}
634 \textcolor{preprocessor}{#endif}
635 \textcolor{preprocessor}{}
636     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_task\_finish(enter): T#%d finishing task %p and resuming task %p\(\backslash\)n"},
637                   gtid, taskdata, resumed\_task) );
638 
639     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata -> td\_flags.tasktype == 
      \hyperlink{kmp_8h_a1251a006af9d33ac15f16bb2a934a97b}{TASK\_EXPLICIT} );
640 
641     \textcolor{comment}{// Pop task from stack if tied}
642 \textcolor{preprocessor}{#ifdef BUILD\_TIED\_TASK\_STACK}
643 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} ( taskdata -> td\_flags.tiedness == \hyperlink{kmp_8h_a8293a8f8b58f2b741e846444318b88d5}{TASK\_TIED} )
644     \{
645         \_\_kmp\_pop\_task\_stack( gtid, thread, taskdata );
646     \}
647 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* BUILD\_TIED\_TASK\_STACK */}\textcolor{preprocessor}{}
648 \textcolor{preprocessor}{}
649     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata -> td\_flags.complete == 0 );
650     taskdata -> td\_flags.complete = 1;   \textcolor{comment}{// mark the task as completed}
651     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata -> td\_flags.started == 1 );
652     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata -> td\_flags.freed == 0 );
653 
654     \textcolor{comment}{// Only need to keep track of count if team parallel and tasking not serialized}
655     \textcolor{keywordflow}{if} ( !( taskdata -> td\_flags.team\_serial || taskdata -> td\_flags.tasking\_ser ) ) \{
656         \textcolor{comment}{// Predecrement simulated by "- 1" calculation}
657         children = \hyperlink{kmp__os_8h_a5b23523b95ee4b2307a8f344cbbe8050}{KMP\_TEST\_THEN\_DEC32}( (kmp\_int32 *)(& taskdata -> td\_parent -> 
      td\_incomplete\_child\_tasks) ) - 1;
658         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( children >= 0 );
659 \textcolor{preprocessor}{#if OMP\_40\_ENABLED}
660 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( taskdata->\hyperlink{structkmp__taskdata_a568185a9e8c23a1682491fa55973d61c}{td\_taskgroup} )
661             \hyperlink{kmp__os_8h_a5b23523b95ee4b2307a8f344cbbe8050}{KMP\_TEST\_THEN\_DEC32}( (kmp\_int32 *)(& taskdata->
      \hyperlink{structkmp__taskdata_a568185a9e8c23a1682491fa55973d61c}{td\_taskgroup}->\hyperlink{structkmp__taskgroup_aa0ed4b8e5fd1730ebad7b0f3f3ebadf9}{count}) );
662         \hyperlink{kmp_8h_a68130554d0ae8970e6817c0bbd12c8bd}{\_\_kmp\_release\_deps}(gtid,taskdata);
663 \textcolor{preprocessor}{#endif}
664 \textcolor{preprocessor}{}    \}
665 
666     \textcolor{comment}{// td\_flags.executing  must be marked as 0 after \_\_kmp\_release\_deps has been called}
667     \textcolor{comment}{// Othertwise, if a task is executed immediately from the release\_deps code}
668     \textcolor{comment}{// the flag will be reset to 1 again by this same function}
669     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata -> td\_flags.executing == 1 );
670     taskdata -> td\_flags.executing = 0;  \textcolor{comment}{// suspend the finishing task}
671 
672     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_task\_finish: T#%d finished task %p, %d incomplete children\(\backslash\)n"},
673                   gtid, taskdata, children) );
674 
675 \textcolor{preprocessor}{#if OMP\_40\_ENABLED}
676 \textcolor{preprocessor}{}    \textcolor{comment}{/* If the tasks' destructor thunk flag has been set, we need to invoke the}
677 \textcolor{comment}{       destructor thunk that has been generated by the compiler.}
678 \textcolor{comment}{       The code is placed here, since at this point other tasks might have been released}
679 \textcolor{comment}{       hence overlapping the destructor invokations with some other work in the}
680 \textcolor{comment}{       released tasks.  The OpenMP spec is not specific on when the destructors are}
681 \textcolor{comment}{       invoked, so we should be free to choose.}
682 \textcolor{comment}{    */}
683     \textcolor{keywordflow}{if} (taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a998b866c0ee12e696ddb77d334b61e72}{destructors\_thunk}) \{
684         \hyperlink{group__BASIC__TYPES_ga76e21422ff9984d9bafd0b36277ae115}{kmp\_routine\_entry\_t} destr\_thunk = task->\hyperlink{structkmp__task_a5b1637c2a81c11598b53be9e4851a64b}{data1}.
      \hyperlink{unionkmp__cmplrdata_a55f86681cc0ecc440233e7a93f89b402}{destructors};
685         \hyperlink{kmp__debug_8h_a5323a368e8ba273b17c46906dd9ec78c}{KMP\_ASSERT}(destr\_thunk);
686         destr\_thunk(gtid, task);
687     \}
688 \textcolor{preprocessor}{#endif // OMP\_40\_ENABLED}
689 \textcolor{preprocessor}{}
690     \textcolor{comment}{// bookkeeping for resuming task:}
691     \textcolor{comment}{// GEH - note tasking\_ser => task\_serial}
692     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( (taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a68f882661553dde50d4ccc2e472e9f05}{tasking\_ser} || taskdata->
      \hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a1e4fa96ecc4d22b55ae1ddfa4f83bdfd}{task\_serial}) ==
693                        taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a1e4fa96ecc4d22b55ae1ddfa4f83bdfd}{task\_serial});
694     \textcolor{keywordflow}{if} ( taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a1e4fa96ecc4d22b55ae1ddfa4f83bdfd}{task\_serial} )
695     \{
696         \textcolor{keywordflow}{if} (resumed\_task == NULL) \{
697             resumed\_task = taskdata->\hyperlink{structkmp__taskdata_a47e9134b90866241cb795112acf9dabb}{td\_parent};  \textcolor{comment}{// In a serialized task, the resumed task is the
       parent}
698         \}
699         \textcolor{keywordflow}{else} \{
700             \textcolor{comment}{// verify resumed task passed in points to parent}
701             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( resumed\_task == taskdata->
      \hyperlink{structkmp__taskdata_a47e9134b90866241cb795112acf9dabb}{td\_parent} );
702         \}
703     \}
704     \textcolor{keywordflow}{else} \{
705         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( resumed\_task != NULL );        \textcolor{comment}{// verify that resumed task is
       passed as arguemnt}
706     \}
707 
708     \textcolor{comment}{// Free this task and then ancestor tasks if they have no children.}
709     \textcolor{comment}{// Restore th\_current\_task first as suggested by John:}
710     \textcolor{comment}{// johnmc: if an asynchronous inquiry peers into the runtime system}
711     \textcolor{comment}{// it doesn't see the freed task as the current task.}
712     thread->th.th\_current\_task = resumed\_task;
713     \hyperlink{kmp__tasking_8c_a45ba0fe4070338321814da7f9b0d7364}{\_\_kmp\_free\_task\_and\_ancestors}(gtid, taskdata, thread);
714 
715     \textcolor{comment}{// TODO: GEH - make sure root team implicit task is initialized properly.}
716     \textcolor{comment}{// KMP\_DEBUG\_ASSERT( resumed\_task->td\_flags.executing == 0 );}
717     resumed\_task->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a52dcbb49f0b94ac8ff3e130a54df591c}{executing} = 1;  \textcolor{comment}{// resume previous task}
718 
719     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_task\_finish(exit): T#%d finished task %p, resuming task %p\(\backslash\)n"},
720                   gtid, taskdata, resumed\_task) );
721 
722     \textcolor{keywordflow}{return};
723 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a260526cdd24e8cf269a2af7df3258b0e}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-task\-\_\-start@{\-\_\-\-\_\-kmp\-\_\-task\-\_\-start}}
\index{\-\_\-\-\_\-kmp\-\_\-task\-\_\-start@{\-\_\-\-\_\-kmp\-\_\-task\-\_\-start}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-task\-\_\-start}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-task\-\_\-start (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-task\-\_\-t} $\ast$}]{task, }
\item[{{\bf kmp\-\_\-taskdata\-\_\-t} $\ast$}]{current\-\_\-task}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_a260526cdd24e8cf269a2af7df3258b0e}


Definition at line 413 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-invoke\-\_\-task(), and \-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-begin\-\_\-if0().


\begin{DoxyCode}
414 \{
415     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * taskdata = \hyperlink{kmp_8h_a7996bdfd391438365a93a3c7fba1c440}{KMP\_TASK\_TO\_TASKDATA}(task);
416     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} * thread = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
417 
418     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_task\_start(enter): T#%d starting task %p: current\_task=%p\(\backslash\)n"},
419                   gtid, taskdata, current\_task) );
420 
421     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata -> td\_flags.tasktype == 
      \hyperlink{kmp_8h_a1251a006af9d33ac15f16bb2a934a97b}{TASK\_EXPLICIT} );
422 
423     \textcolor{comment}{// mark currently executing task as suspended}
424     \textcolor{comment}{// TODO: GEH - make sure root team implicit task is initialized properly.}
425     \textcolor{comment}{// KMP\_DEBUG\_ASSERT( current\_task -> td\_flags.executing == 1 );}
426     current\_task -> td\_flags.executing = 0;
427 
428     \textcolor{comment}{// Add task to stack if tied}
429 \textcolor{preprocessor}{#ifdef BUILD\_TIED\_TASK\_STACK}
430 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} ( taskdata -> td\_flags.tiedness == \hyperlink{kmp_8h_a8293a8f8b58f2b741e846444318b88d5}{TASK\_TIED} )
431     \{
432         \_\_kmp\_push\_task\_stack( gtid, thread, taskdata );
433     \}
434 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* BUILD\_TIED\_TASK\_STACK */}\textcolor{preprocessor}{}
435 \textcolor{preprocessor}{}
436     \textcolor{comment}{// mark starting task as executing and as current task}
437     thread -> th.th\_current\_task = taskdata;
438 
439     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata -> td\_flags.started == 0 );
440     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata -> td\_flags.executing == 0 );
441     taskdata -> td\_flags.started = 1;
442     taskdata -> td\_flags.executing = 1;
443     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata -> td\_flags.complete == 0 );
444     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskdata -> td\_flags.freed == 0 );
445 
446     \textcolor{comment}{// GEH TODO: shouldn't we pass some sort of location identifier here?}
447     \textcolor{comment}{// APT: yes, we will pass location here.}
448     \textcolor{comment}{// need to store current thread state (in a thread or taskdata structure)}
449     \textcolor{comment}{// before setting work\_state, otherwise wrong state is set after end of task}
450 
451     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmp\_task\_start(exit): T#%d task=%p\(\backslash\)n"},
452                   gtid, taskdata ) );
453 
454 \textcolor{preprocessor}{#if OMPT\_SUPPORT}
455 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled} &&
456         \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_task\_begin)) \{
457         \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} *\hyperlink{ittnotify__static_8h_a05e33740d1c7ac239093593607ff58a9}{parent} = taskdata->\hyperlink{structkmp__taskdata_a47e9134b90866241cb795112acf9dabb}{td\_parent};
458         \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_task\_begin)(
459             parent ? parent->ompt\_task\_info.task\_id : ompt\_task\_id\_none,
460             parent ? &(parent->ompt\_task\_info.frame) : NULL,
461             taskdata->ompt\_task\_info.task\_id,
462             taskdata->ompt\_task\_info.function);
463     \}
464 \textcolor{preprocessor}{#endif}
465 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if OMP\_40\_ENABLED && OMPT\_SUPPORT && OMPT\_TRACE}
466 \textcolor{preprocessor}{}    \textcolor{comment}{/* OMPT emit all dependences if requested by the tool */}
467     \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled} && taskdata->ompt\_task\_info.ndeps > 0 &&
468         \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_task\_dependences))
469         \{
470         \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_task\_dependences)(
471             taskdata->ompt\_task\_info.task\_id,
472             taskdata->ompt\_task\_info.deps,
473             taskdata->ompt\_task\_info.ndeps
474         );
475                 \textcolor{comment}{/* We can now free the allocated memory for the dependencies */}
476                 KMP\_OMPT\_DEPS\_FREE (thread, taskdata->ompt\_task\_info.deps);
477         taskdata->ompt\_task\_info.deps = NULL;
478         taskdata->ompt\_task\_info.ndeps = 0;
479     \}
480 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* OMP\_40\_ENABLED && OMPT\_SUPPORT && OMPT\_TRACE */}\textcolor{preprocessor}{}
481 \textcolor{preprocessor}{}
482     \textcolor{keywordflow}{return};
483 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_af98fb3c3ffb814bf6a38fc90dbe07fcc}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-setup@{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-setup}}
\index{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-setup@{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-setup}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-setup}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-setup (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{this\-\_\-thr, }
\item[{{\bf kmp\-\_\-team\-\_\-t} $\ast$}]{team, }
\item[{{\bf int}}]{always}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_af98fb3c3ffb814bf6a38fc90dbe07fcc}


Definition at line 2561 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-barrier(), \-\_\-\-\_\-kmp\-\_\-fork\-\_\-barrier(), and \-\_\-\-\_\-kmp\-\_\-task\-\_\-alloc().


\begin{DoxyCode}
2562 \{
2563     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp_8h_a39e87c52fb75a615c2564a822a013a5a}{\_\_kmp\_tasking\_mode} != 
      \hyperlink{kmp_8h_aad1bdfbfac136cfd92611bcee79ca3f2af827998cf4eb3f61723edc4943b86c98}{tskm\_immediate\_exec} );
2564 
2565     \textcolor{comment}{// If this task\_team hasn't been created yet, allocate it. It will be used in the region after the
       next.}
2566     \textcolor{comment}{// If it exists, it is the current task team and shouldn't be touched yet as it may still be in use.}
2567     \textcolor{keywordflow}{if} (team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_task\_team[this\_thr->th.th\_task\_state] == NULL && (always || team->
      \hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc > 1) ) \{ 
2568         team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_task\_team[this\_thr->th.th\_task\_state] = 
      \hyperlink{kmp__tasking_8c_ac7e7f9850e866f8ee7dd5375227e250d}{\_\_kmp\_allocate\_task\_team}( this\_thr, team );
2569         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_task\_team\_setup: Master T#%d created new task\_team %p for team %d at
       parity=%d\(\backslash\)n"},
2570                       \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}(this\_thr), team->
      \hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_task\_team[this\_thr->th.th\_task\_state],
2571                       ((team != NULL) ? team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_id : -1), this\_thr->th.th\_task\_state));
2572     \}
2573 
2574     \textcolor{comment}{// After threads exit the release, they will call sync, and then point to this other task\_team; make
       sure it is }
2575     \textcolor{comment}{// allocated and properly initialized. As threads spin in the barrier release phase, they will continue
       to use the}
2576     \textcolor{comment}{// previous task\_team struct(above), until they receive the signal to stop checking for tasks (they
       can't safely}
2577     \textcolor{comment}{// reference the kmp\_team\_t struct, which could be reallocated by the master thread). No task teams are
       formed for }
2578     \textcolor{comment}{// serialized teams.}
2579     \textcolor{keywordflow}{if} (team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc > 1) \{
2580         \textcolor{keywordtype}{int} other\_team = 1 - this\_thr->th.th\_task\_state;
2581         \textcolor{keywordflow}{if} (team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_task\_team[other\_team] == NULL) \{ \textcolor{comment}{// setup other team as well}
2582                 team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_task\_team[other\_team] = \hyperlink{kmp__tasking_8c_ac7e7f9850e866f8ee7dd5375227e250d}{\_\_kmp\_allocate\_task\_team}( 
      this\_thr, team );
2583                 \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_task\_team\_setup: Master T#%d created second new task\_team %p
       for team %d at parity=%d\(\backslash\)n"},
2584                                 \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( this\_thr ), team->
      \hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_task\_team[other\_team],
2585                               ((team != NULL) ? team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_id : -1), other\_team ));
2586         \}
2587         \textcolor{keywordflow}{else} \{ \textcolor{comment}{// Leave the old task team struct in place for the upcoming region; adjust as needed}
2588             \hyperlink{unionkmp__task__team}{kmp\_task\_team\_t} *task\_team = team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_task\_team[other\_team];
2589             \textcolor{keywordflow}{if} (!task\_team->\hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.\hyperlink{structkmp__base__task__team_aa6e9a8311f759172e980d0f75bf81f7b}{tt\_active} || team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc != task\_team->
      \hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.\hyperlink{structkmp__base__task__team_a0e3fe27829e52d0100074babe5f7ed2d}{tt\_nproc}) \{
2590                 \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(task\_team->\hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.\hyperlink{structkmp__base__task__team_a0e3fe27829e52d0100074babe5f7ed2d}{tt\_nproc}, team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc);
2591                 \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(task\_team->\hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.\hyperlink{structkmp__base__task__team_afb1c5ccacb58cdd0dd0895e4d535c120}{tt\_found\_tasks}, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
2592 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
2593 \textcolor{preprocessor}{}                \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(task\_team->\hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.tt\_found\_proxy\_tasks, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
2594 \textcolor{preprocessor}{#endif}
2595 \textcolor{preprocessor}{}                \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(task\_team->\hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.\hyperlink{structkmp__base__task__team_a01de70849591effdf315bfc233c6ba1a}{tt\_unfinished\_threads}, team->
      \hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc );
2596                 \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(task\_team->\hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.\hyperlink{structkmp__base__task__team_aa6e9a8311f759172e980d0f75bf81f7b}{tt\_active}, \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} );
2597             \}
2598             \textcolor{comment}{// if team size has changed, the first thread to enable tasking will realloc threads\_data if
       necessary}
2599             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_task\_team\_setup: Master T#%d reset next task\_team %p for team %d
       at parity=%d\(\backslash\)n"},
2600                           \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( this\_thr ), team->
      \hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_task\_team[other\_team],
2601                           ((team != NULL) ? team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_id : -1), other\_team ));
2602         \}
2603     \}
2604 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a2c905b30d1208bb65979ea579f9b64f1}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-sync@{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-sync}}
\index{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-sync@{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-sync}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-sync}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-sync (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{this\-\_\-thr, }
\item[{{\bf kmp\-\_\-team\-\_\-t} $\ast$}]{team}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_a2c905b30d1208bb65979ea579f9b64f1}


Definition at line 2613 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-barrier(), \-\_\-\-\_\-kmp\-\_\-end\-\_\-split\-\_\-barrier(), and \-\_\-\-\_\-kmp\-\_\-fork\-\_\-barrier().


\begin{DoxyCode}
2614 \{
2615     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp_8h_a39e87c52fb75a615c2564a822a013a5a}{\_\_kmp\_tasking\_mode} != 
      \hyperlink{kmp_8h_aad1bdfbfac136cfd92611bcee79ca3f2af827998cf4eb3f61723edc4943b86c98}{tskm\_immediate\_exec} );
2616 
2617     \textcolor{comment}{// Toggle the th\_task\_state field, to switch which task\_team this thread refers to}
2618     this\_thr->th.th\_task\_state = 1 - this\_thr->th.th\_task\_state;
2619     \textcolor{comment}{// It is now safe to propagate the task team pointer from the team struct to the current thread.}
2620     \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(this\_thr->th.th\_task\_team, team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_task\_team[this\_thr->th.th\_task\_state]);
2621     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_task\_team\_sync: Thread T#%d task team switched to task\_team %p from Team
       #%d (parity=%d)\(\backslash\)n"},
2622                   \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( this\_thr ), this\_thr->th.th\_task\_team,
2623                   ((team != NULL) ? team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_id : -1), this\_thr->th.th\_task\_state));
2624 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_ae6f631ec9b8c83a4c0aa57cfced40c2a}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-wait@{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-wait}}
\index{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-wait@{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-wait}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-wait}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-wait (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{this\-\_\-thr, }
\item[{{\bf kmp\-\_\-team\-\_\-t} $\ast$}]{team, }
\item[{{\bf int}}]{wait}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_ae6f631ec9b8c83a4c0aa57cfced40c2a}


Definition at line 2634 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-barrier(), \-\_\-\-\_\-kmp\-\_\-join\-\_\-barrier(), \-\_\-\-\_\-kmp\-\_\-unregister\-\_\-root\-\_\-current\-\_\-thread(), and \-\_\-\-\_\-kmpc\-\_\-end\-\_\-serialized\-\_\-parallel().


\begin{DoxyCode}
2637 \{
2638     \hyperlink{unionkmp__task__team}{kmp\_task\_team\_t} *task\_team = team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_task\_team[this\_thr->th.th\_task\_state];
2639 
2640     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp_8h_a39e87c52fb75a615c2564a822a013a5a}{\_\_kmp\_tasking\_mode} != 
      \hyperlink{kmp_8h_aad1bdfbfac136cfd92611bcee79ca3f2af827998cf4eb3f61723edc4943b86c98}{tskm\_immediate\_exec} );
2641     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( task\_team == this\_thr->th.th\_task\_team );
2642 
2643     \textcolor{keywordflow}{if} ( ( task\_team != NULL ) && \hyperlink{kmp_8h_a8b15269c2644fa0ba3ee09b0eb025867}{KMP\_TASKING\_ENABLED}(task\_team) ) \{
2644         \textcolor{keywordflow}{if} (wait) \{
2645             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_task\_team\_wait: Master T#%d waiting for all tasks (for
       unfinished\_threads to reach 0) on task\_team = %p\(\backslash\)n"},
2646                           \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}(this\_thr), task\_team));
2647             \textcolor{comment}{// Worker threads may have dropped through to release phase, but could still be executing
       tasks. Wait}
2648             \textcolor{comment}{// here for tasks to complete. To avoid memory contention, only master thread checks
       termination condition.}
2649             \hyperlink{classkmp__flag__32}{kmp\_flag\_32} flag(&task\_team->\hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.\hyperlink{structkmp__base__task__team_a01de70849591effdf315bfc233c6ba1a}{tt\_unfinished\_threads}, 0U);
2650             flag.wait(this\_thr, \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}
2651                       \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{USE\_ITT\_BUILD\_ARG}(itt\_sync\_obj));
2652         \}
2653         \textcolor{comment}{// Deactivate the old task team, so that the worker threads will stop referencing it while
       spinning.}
2654         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmp\_task\_team\_wait: Master T#%d deactivating task\_team %p: "}
2655                       \textcolor{stringliteral}{"setting active to false, setting local and team's pointer to NULL\(\backslash\)n"},
2656                       \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}(this\_thr), task\_team));
2657 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
2658 \textcolor{preprocessor}{}        \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( task\_team->\hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.\hyperlink{structkmp__base__task__team_a0e3fe27829e52d0100074babe5f7ed2d}{tt\_nproc} > 1 || task\_team->
      \hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.tt\_found\_proxy\_tasks == \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} );
2659         \hyperlink{kmp__os_8h_aa87da17e7b31a360efb533f0b7150bd4}{TCW\_SYNC\_4}( task\_team->\hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.tt\_found\_proxy\_tasks, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE} );
2660 \textcolor{preprocessor}{#else}
2661 \textcolor{preprocessor}{}        \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( task\_team->\hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.\hyperlink{structkmp__base__task__team_a0e3fe27829e52d0100074babe5f7ed2d}{tt\_nproc} > 1 );
2662 \textcolor{preprocessor}{#endif}
2663 \textcolor{preprocessor}{}        \hyperlink{kmp__os_8h_aa87da17e7b31a360efb533f0b7150bd4}{TCW\_SYNC\_4}( task\_team->\hyperlink{unionkmp__task__team_a18728e49ce76f29250a4be77cd7a2ff4}{tt}.\hyperlink{structkmp__base__task__team_aa6e9a8311f759172e980d0f75bf81f7b}{tt\_active}, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE} );
2664         \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();
2665 
2666         \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(this\_thr->th.th\_task\_team, NULL);
2667     \}
2668 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_aaada49301d2ae62b774b7d55dd220b5a}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-tasking\-\_\-barrier@{\-\_\-\-\_\-kmp\-\_\-tasking\-\_\-barrier}}
\index{\-\_\-\-\_\-kmp\-\_\-tasking\-\_\-barrier@{\-\_\-\-\_\-kmp\-\_\-tasking\-\_\-barrier}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-tasking\-\_\-barrier}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-tasking\-\_\-barrier (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-team\-\_\-t} $\ast$}]{team, }
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{thread, }
\item[{{\bf int}}]{gtid}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_aaada49301d2ae62b774b7d55dd220b5a}


Definition at line 2679 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-barrier(), and \-\_\-\-\_\-kmp\-\_\-join\-\_\-barrier().


\begin{DoxyCode}
2680 \{
2681     \textcolor{keyword}{volatile} kmp\_uint32 *spin = &team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_task\_team[thread->th.th\_task\_state]->tt.tt\_unfinished\_threads;
2682     \textcolor{keywordtype}{int} flag = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2683     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp_8h_a39e87c52fb75a615c2564a822a013a5a}{\_\_kmp\_tasking\_mode} == 
      \hyperlink{kmp_8h_aad1bdfbfac136cfd92611bcee79ca3f2a001d1f241bf760fd902d3fccc21918d3}{tskm\_extra\_barrier} );
2684 
2685 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
2686 \textcolor{preprocessor}{}    \hyperlink{kmp__itt_8h_ae9ed9a1ec697c0049760eee81cf6521a}{KMP\_FSYNC\_SPIN\_INIT}( spin, (kmp\_uint32*) NULL );
2687 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
2688 \textcolor{preprocessor}{}    \hyperlink{classkmp__flag__32}{kmp\_flag\_32} spin\_flag(spin, 0U);
2689     \textcolor{keywordflow}{while} (! spin\_flag.execute\_tasks(thread, gtid, \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE}, &flag
2690                                      \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{USE\_ITT\_BUILD\_ARG}(NULL), 0 ) ) \{
2691 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
2692 \textcolor{preprocessor}{}        \textcolor{comment}{// TODO: What about itt\_sync\_obj??}
2693         \hyperlink{kmp__itt_8h_aadbbcf10e55850897e6d495729925851}{KMP\_FSYNC\_SPIN\_PREPARE}( spin );
2694 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
2695 \textcolor{preprocessor}{}
2696         \textcolor{keywordflow}{if}( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(\hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_done) ) \{
2697             \textcolor{keywordflow}{if}( \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_abort )
2698                 \hyperlink{kmp_8h_a3af0772074c6291cf8d346cef0e22c75}{\_\_kmp\_abort\_thread}( );
2699             \textcolor{keywordflow}{break};
2700         \}
2701         \hyperlink{kmp_8h_a9f0d88d1970adda4ad38d272e65d7844}{KMP\_YIELD}( \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} );       \textcolor{comment}{// GH: We always yield here}
2702     \}
2703 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
2704 \textcolor{preprocessor}{}    \hyperlink{kmp__itt_8h_a580841033d05175a7d1d36d91bdb9267}{KMP\_FSYNC\_SPIN\_ACQUIRED}( (\textcolor{keywordtype}{void}*) spin );
2705 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
2706 \textcolor{preprocessor}{}\}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a2ba40a9ae9c2993a034826efe186f41c}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-wait\-\_\-to\-\_\-unref\-\_\-task\-\_\-teams@{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-to\-\_\-unref\-\_\-task\-\_\-teams}}
\index{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-to\-\_\-unref\-\_\-task\-\_\-teams@{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-to\-\_\-unref\-\_\-task\-\_\-teams}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-to\-\_\-unref\-\_\-task\-\_\-teams}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-wait\-\_\-to\-\_\-unref\-\_\-task\-\_\-teams (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_a2ba40a9ae9c2993a034826efe186f41c}


Definition at line 2494 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-reset\-\_\-root().


\begin{DoxyCode}
2495 \{
2496     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *thread;
2497     kmp\_uint32 spins;
2498     \textcolor{keywordtype}{int} done;
2499 
2500     \hyperlink{kmp_8h_a98cb21bfd34ebd451007a151f135b31c}{KMP\_INIT\_YIELD}( spins );
2501 
2502     \textcolor{keywordflow}{for} (;;) \{
2503         done = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
2504 
2505         \textcolor{comment}{// TODO: GEH - this may be is wrong because some sync would be necessary}
2506         \textcolor{comment}{//             in case threads are added to the pool during the traversal.}
2507         \textcolor{comment}{//             Need to verify that lock for thread pool is held when calling}
2508         \textcolor{comment}{//             this routine.}
2509         \textcolor{keywordflow}{for} (thread = (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *)\hyperlink{kmp_8h_a3cab107cb6b7391dc221c14353ec6350}{\_\_kmp\_thread\_pool};
2510              thread != NULL;
2511              thread = thread->th.th\_next\_pool)
2512         \{
2513 \textcolor{preprocessor}{#if KMP\_OS\_WINDOWS}
2514 \textcolor{preprocessor}{}            DWORD exit\_val;
2515 \textcolor{preprocessor}{#endif}
2516 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} ( \hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}(thread->th.th\_task\_team) == NULL ) \{
2517                 \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_wait\_to\_unref\_task\_team: T#%d task\_team == NULL\(\backslash\)n"},
2518                                \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( thread ) ) );
2519                 \textcolor{keywordflow}{continue};
2520             \}
2521 \textcolor{preprocessor}{#if KMP\_OS\_WINDOWS}
2522 \textcolor{preprocessor}{}            \textcolor{comment}{// TODO: GEH - add this check for Linux* OS / OS X* as well?}
2523             \textcolor{keywordflow}{if} (!\hyperlink{z__Windows__NT__util_8c_ad4d0392f67428e1609f99892f0ba65cc}{\_\_kmp\_is\_thread\_alive}(thread, &exit\_val)) \{
2524                 thread->th.th\_task\_team = NULL;
2525                 \textcolor{keywordflow}{continue};
2526             \}
2527 \textcolor{preprocessor}{#endif}
2528 \textcolor{preprocessor}{}
2529             done = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};  \textcolor{comment}{// Because th\_task\_team pointer is not NULL for this thread}
2530 
2531             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_wait\_to\_unref\_task\_team: Waiting for T#%d to unreference
       task\_team\(\backslash\)n"},
2532                            \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( thread ) ) );
2533 
2534             \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a3b56e2e90e1539c0b794e4137724bc1c}{\_\_kmp\_dflt\_blocktime} != \hyperlink{kmp_8h_a1ca6c6ce04115f143dc5df627de57958}{KMP\_MAX\_BLOCKTIME} ) \{
2535                 \textcolor{keyword}{volatile} \textcolor{keywordtype}{void} *sleep\_loc;
2536                 \textcolor{comment}{// If the thread is sleeping, awaken it.}
2537                 \textcolor{keywordflow}{if} ( ( sleep\_loc = \hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}( thread->th.th\_sleep\_loc) ) != NULL ) \{
2538                     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_wait\_to\_unref\_task\_team: T#%d waking up thread T#%d\(\backslash\)n"},
2539                                     \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( thread ), 
      \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( thread ) ) );
2540                     \hyperlink{kmp__tasking_8c_a346d02e275d2c2ff66c4a17d7e012f37}{\_\_kmp\_null\_resume\_wrapper}(
      \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}(thread), sleep\_loc);
2541                 \}
2542             \}
2543         \}
2544         \textcolor{keywordflow}{if} (done) \{
2545             \textcolor{keywordflow}{break};
2546         \}
2547 
2548         \textcolor{comment}{// If we are oversubscribed,}
2549         \textcolor{comment}{// or have waited a bit (and library mode is throughput), yield.}
2550         \textcolor{comment}{// Pause is in the following code.}
2551         \hyperlink{kmp_8h_a9f0d88d1970adda4ad38d272e65d7844}{KMP\_YIELD}( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(\hyperlink{kmp_8h_a774ce85ac109df119feaca45ed4e69b1}{\_\_kmp\_nth}) > \hyperlink{kmp_8h_adc73a89e0c77c9b0a3233f9fde48a5b2}{\_\_kmp\_avail\_proc} );
2552         \hyperlink{kmp_8h_a0b31ac108fea7d8034ea5145d74a7a77}{KMP\_YIELD\_SPIN}( spins );        \textcolor{comment}{// Yields only if KMP\_LIBRARY=throughput}
2553     \}
2554 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a3a8f3bed14519d54ee8f61af3759564f}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmpc\-\_\-end\-\_\-taskgroup@{\-\_\-\-\_\-kmpc\-\_\-end\-\_\-taskgroup}}
\index{\-\_\-\-\_\-kmpc\-\_\-end\-\_\-taskgroup@{\-\_\-\-\_\-kmpc\-\_\-end\-\_\-taskgroup}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmpc\-\_\-end\-\_\-taskgroup}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmpc\-\_\-end\-\_\-taskgroup (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc, }
\item[{{\bf int}}]{gtid}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_a3a8f3bed14519d54ee8f61af3759564f}


Definition at line 1504 of file kmp\-\_\-tasking.\-c.



Referenced by K\-M\-P\-\_\-\-A\-P\-I\-\_\-\-N\-A\-M\-E\-\_\-\-G\-O\-M\-P\-\_\-\-T\-A\-S\-K\-G\-R\-O\-U\-P\-\_\-\-E\-N\-D().


\begin{DoxyCode}
1505 \{
1506     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}      * thread = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
1507     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t}  * taskdata = thread->th.th\_current\_task;
1508     \hyperlink{structkmp__taskgroup}{kmp\_taskgroup\_t} * taskgroup = taskdata->\hyperlink{structkmp__taskdata_a568185a9e8c23a1682491fa55973d61c}{td\_taskgroup};
1509     \textcolor{keywordtype}{int} thread\_finished = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1510 
1511     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_end\_taskgroup(enter): T#%d loc=%p\(\backslash\)n"}, gtid, loc) );
1512     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskgroup != NULL );
1513 
1514     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a39e87c52fb75a615c2564a822a013a5a}{\_\_kmp\_tasking\_mode} != \hyperlink{kmp_8h_aad1bdfbfac136cfd92611bcee79ca3f2af827998cf4eb3f61723edc4943b86c98}{tskm\_immediate\_exec} ) \{
1515 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1516 \textcolor{preprocessor}{}        \textcolor{comment}{// For ITT the taskgroup wait is similar to taskwait until we need to distinguish them}
1517         \textcolor{keywordtype}{void} * itt\_sync\_obj = \_\_kmp\_itt\_taskwait\_object( gtid );
1518         \textcolor{keywordflow}{if} ( itt\_sync\_obj != NULL )
1519             \_\_kmp\_itt\_taskwait\_starting( gtid, itt\_sync\_obj );
1520 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1521 \textcolor{preprocessor}{}
1522 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
1523 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( ! taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a69abf7c2ecf0b7284861a90c7ac0cfe1}{team\_serial} || (thread->th.th\_task\_team != NULL && 
      thread->th.th\_task\_team->tt.tt\_found\_proxy\_tasks) ) 
1524 \textcolor{preprocessor}{#else}
1525 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( ! taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a69abf7c2ecf0b7284861a90c7ac0cfe1}{team\_serial} ) 
1526 \textcolor{preprocessor}{#endif}
1527 \textcolor{preprocessor}{}        \{
1528             \hyperlink{classkmp__flag__32}{kmp\_flag\_32} flag(&(taskgroup->\hyperlink{structkmp__taskgroup_aa0ed4b8e5fd1730ebad7b0f3f3ebadf9}{count}), 0U);
1529             \textcolor{keywordflow}{while} ( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(taskgroup->\hyperlink{structkmp__taskgroup_aa0ed4b8e5fd1730ebad7b0f3f3ebadf9}{count}) != 0 ) \{
1530                 flag.execute\_tasks(thread, gtid, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, &thread\_finished
1531                                    \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{USE\_ITT\_BUILD\_ARG}(itt\_sync\_obj), 
      \hyperlink{kmp_8h_a8fed3df0b84562bb900b41b72dd88033}{\_\_kmp\_task\_stealing\_constraint} );
1532             \}
1533         \}
1534 
1535 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1536 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( itt\_sync\_obj != NULL )
1537             \_\_kmp\_itt\_taskwait\_finished( gtid, itt\_sync\_obj );
1538 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1539 \textcolor{preprocessor}{}    \}
1540     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( taskgroup->\hyperlink{structkmp__taskgroup_aa0ed4b8e5fd1730ebad7b0f3f3ebadf9}{count} == 0 );
1541 
1542     \textcolor{comment}{// Restore parent taskgroup for the current task}
1543     taskdata->\hyperlink{structkmp__taskdata_a568185a9e8c23a1682491fa55973d61c}{td\_taskgroup} = taskgroup->\hyperlink{structkmp__taskgroup_acc9d4f642b6a421dcdc66e44baeca4af}{parent};
1544     \hyperlink{kmp_8h_aff8d21963670e8e527cb6e30a200bb97}{\_\_kmp\_thread\_free}( thread, taskgroup );
1545 
1546     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_end\_taskgroup(exit): T#%d task %p finished waiting\(\backslash\)n"}, gtid, taskdata) );
1547 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a25af9574d53be55422c50d824dc31e01}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task@{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task}}
\index{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task@{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task}]{\setlength{\rightskip}{0pt plus 5cm}kmp\-\_\-int32 \-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc\-\_\-ref, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-task\-\_\-t} $\ast$}]{new\-\_\-task}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_a25af9574d53be55422c50d824dc31e01}


Definition at line 1318 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-with\-\_\-deps(), and P\-A\-R\-A\-L\-L\-E\-L\-\_\-\-L\-O\-O\-P\-\_\-\-S\-T\-A\-R\-T().


\begin{DoxyCode}
1319 \{
1320     kmp\_int32 res;
1321 
1322 \textcolor{preprocessor}{#if KMP\_DEBUG}
1323 \textcolor{preprocessor}{}    \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * new\_taskdata = \hyperlink{kmp_8h_a7996bdfd391438365a93a3c7fba1c440}{KMP\_TASK\_TO\_TASKDATA}(new\_task);
1324 \textcolor{preprocessor}{#endif}
1325 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_omp\_task(enter): T#%d loc=%p task=%p\(\backslash\)n"},
1326                   gtid, loc\_ref, new\_taskdata ) );
1327 
1328     res =  \hyperlink{kmp__tasking_8c_ae2e47b86ed1dc13258c5969b02b4c971}{\_\_kmp\_omp\_task}(gtid,new\_task,\textcolor{keyword}{true});
1329 
1330     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_omp\_task(exit): T#%d returning TASK\_CURRENT\_NOT\_QUEUED: loc=%p task=%p\(\backslash\)n"}
      ,
1331                   gtid, loc\_ref, new\_taskdata ) );
1332     \textcolor{keywordflow}{return} res;
1333 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a26b7b2c9f53459685ed424ddefe1260c}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-alloc@{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-alloc}}
\index{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-alloc@{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-alloc}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-alloc}]{\setlength{\rightskip}{0pt plus 5cm}{\bf kmp\-\_\-task\-\_\-t}$\ast$ \-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-alloc (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc\-\_\-ref, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{kmp\-\_\-int32}]{flags, }
\item[{size\-\_\-t}]{sizeof\-\_\-kmp\-\_\-task\-\_\-t, }
\item[{size\-\_\-t}]{sizeof\-\_\-shareds, }
\item[{{\bf kmp\-\_\-routine\-\_\-entry\-\_\-t}}]{task\-\_\-entry}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_a26b7b2c9f53459685ed424ddefe1260c}


Definition at line 1064 of file kmp\-\_\-tasking.\-c.


\begin{DoxyCode}
1067 \{
1068     \hyperlink{structkmp__task}{kmp\_task\_t} *retval;
1069     \hyperlink{structkmp__tasking__flags}{kmp\_tasking\_flags\_t} *input\_flags = (\hyperlink{structkmp__tasking__flags}{kmp\_tasking\_flags\_t} *) & 
      flags;
1070 
1071     input\_flags->\hyperlink{structkmp__tasking__flags_a6e26667bc33ef72a60338aaf00497f3a}{native} = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1072     \textcolor{comment}{// \_\_kmp\_task\_alloc() sets up all other runtime flags}
1073 
1074 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
1075 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_omp\_task\_alloc(enter): T#%d loc=%p, flags=(%s %s) "}
1076                   \textcolor{stringliteral}{"sizeof\_task=%ld sizeof\_shared=%ld entry=%p\(\backslash\)n"},
1077                   gtid, loc\_ref, input\_flags->\hyperlink{structkmp__tasking__flags_a896a40bab626e74a4824539d1605d176}{tiedness} ? \textcolor{stringliteral}{"tied  "} : \textcolor{stringliteral}{"untied"},
1078                   input\_flags->proxy ? \textcolor{stringliteral}{"proxy"} : \textcolor{stringliteral}{""},
1079                   sizeof\_kmp\_task\_t, sizeof\_shareds, task\_entry) );
1080 \textcolor{preprocessor}{#else}
1081 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_omp\_task\_alloc(enter): T#%d loc=%p, flags=(%s) "}
1082                   \textcolor{stringliteral}{"sizeof\_task=%ld sizeof\_shared=%ld entry=%p\(\backslash\)n"},
1083                   gtid, loc\_ref, input\_flags->\hyperlink{structkmp__tasking__flags_a896a40bab626e74a4824539d1605d176}{tiedness} ? \textcolor{stringliteral}{"tied  "} : \textcolor{stringliteral}{"untied"},
1084                   sizeof\_kmp\_task\_t, sizeof\_shareds, task\_entry) );
1085 \textcolor{preprocessor}{#endif}
1086 \textcolor{preprocessor}{}
1087     retval = \hyperlink{kmp__tasking_8c_a7a0441f3fc01669f2f7f2c2954f77bdb}{\_\_kmp\_task\_alloc}( loc\_ref, gtid, input\_flags, sizeof\_kmp\_task\_t,
1088                                sizeof\_shareds, task\_entry );
1089 
1090     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(20, (\textcolor{stringliteral}{"\_\_kmpc\_omp\_task\_alloc(exit): T#%d retval %p\(\backslash\)n"}, gtid, retval) );
1091 
1092     \textcolor{keywordflow}{return} retval;
1093 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a3bacb88486fc4653eb456f8982f7c6e8}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-begin\-\_\-if0@{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-begin\-\_\-if0}}
\index{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-begin\-\_\-if0@{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-begin\-\_\-if0}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-begin\-\_\-if0}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-begin\-\_\-if0 (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc\-\_\-ref, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-task\-\_\-t} $\ast$}]{task}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_a3bacb88486fc4653eb456f8982f7c6e8}


Definition at line 493 of file kmp\-\_\-tasking.\-c.



Referenced by P\-A\-R\-A\-L\-L\-E\-L\-\_\-\-L\-O\-O\-P\-\_\-\-S\-T\-A\-R\-T().


\begin{DoxyCode}
494 \{
495     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * taskdata = \hyperlink{kmp_8h_a7996bdfd391438365a93a3c7fba1c440}{KMP\_TASK\_TO\_TASKDATA}(task);
496     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * current\_task = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ] -> th.th\_current\_task;
497 
498     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_omp\_task\_begin\_if0(enter): T#%d loc=%p task=%p current\_task=%p\(\backslash\)n"},
499                   gtid, loc\_ref, taskdata, current\_task ) );
500 
501     taskdata -> td\_flags.task\_serial = 1;  \textcolor{comment}{// Execute this task immediately, not deferred.}
502     \hyperlink{kmp__tasking_8c_a260526cdd24e8cf269a2af7df3258b0e}{\_\_kmp\_task\_start}( gtid, task, current\_task );
503 
504     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_omp\_task\_begin\_if0(exit): T#%d loc=%p task=%p,\(\backslash\)n"},
505                   gtid, loc\_ref, taskdata ) );
506 
507     \textcolor{keywordflow}{return};
508 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a3315cb8b0dc9f5863edb0229c535a3d6}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-complete\-\_\-if0@{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-complete\-\_\-if0}}
\index{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-complete\-\_\-if0@{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-complete\-\_\-if0}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-complete\-\_\-if0}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-complete\-\_\-if0 (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc\-\_\-ref, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-task\-\_\-t} $\ast$}]{task}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_a3315cb8b0dc9f5863edb0229c535a3d6}


Definition at line 732 of file kmp\-\_\-tasking.\-c.



Referenced by P\-A\-R\-A\-L\-L\-E\-L\-\_\-\-L\-O\-O\-P\-\_\-\-S\-T\-A\-R\-T().


\begin{DoxyCode}
733 \{
734     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_omp\_task\_complete\_if0(enter): T#%d loc=%p task=%p\(\backslash\)n"},
735                   gtid, loc\_ref, \hyperlink{kmp_8h_a7996bdfd391438365a93a3c7fba1c440}{KMP\_TASK\_TO\_TASKDATA}(task) ) );
736 
737     \hyperlink{kmp__tasking_8c_a25ab616c3e16ed294de1f4838ff74aef}{\_\_kmp\_task\_finish}( gtid, task, NULL );  \textcolor{comment}{// this routine will provide task to resume}
738 
739     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_omp\_task\_complete\_if0(exit): T#%d loc=%p task=%p\(\backslash\)n"},
740                   gtid, loc\_ref, \hyperlink{kmp_8h_a7996bdfd391438365a93a3c7fba1c440}{KMP\_TASK\_TO\_TASKDATA}(task) ) );
741 
742     \textcolor{keywordflow}{return};
743 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a7dbc4568b1892b9f82ceeab53bcd5fce}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-parts@{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-parts}}
\index{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-parts@{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-parts}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-parts}]{\setlength{\rightskip}{0pt plus 5cm}kmp\-\_\-int32 \-\_\-\-\_\-kmpc\-\_\-omp\-\_\-task\-\_\-parts (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc\-\_\-ref, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf kmp\-\_\-task\-\_\-t} $\ast$}]{new\-\_\-task}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_a7dbc4568b1892b9f82ceeab53bcd5fce}


Definition at line 1238 of file kmp\-\_\-tasking.\-c.


\begin{DoxyCode}
1239 \{
1240     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * new\_taskdata = \hyperlink{kmp_8h_a7996bdfd391438365a93a3c7fba1c440}{KMP\_TASK\_TO\_TASKDATA}(new\_task);
1241 
1242     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_omp\_task\_parts(enter): T#%d loc=%p task=%p\(\backslash\)n"},
1243                   gtid, loc\_ref, new\_taskdata ) );
1244 
1245     \textcolor{comment}{/* Should we execute the new task or queue it?   For now, let's just always try to}
1246 \textcolor{comment}{       queue it.  If the queue fills up, then we'll execute it.  */}
1247 
1248     \textcolor{keywordflow}{if} ( \hyperlink{kmp__tasking_8c_a8680b6e7d17754968a23499e185ae51f}{\_\_kmp\_push\_task}( gtid, new\_task ) == \hyperlink{kmp_8h_a036b27640903b0818afa8180c388e135}{TASK\_NOT\_PUSHED} ) \textcolor{comment}{// if cannot
       defer}
1249     \{                                                           \textcolor{comment}{// Execute this task immediately}
1250         \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * current\_task = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ] -> th.
      th\_current\_task;
1251         new\_taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a1e4fa96ecc4d22b55ae1ddfa4f83bdfd}{task\_serial} = 1;
1252         \hyperlink{kmp__tasking_8c_a4bfeb67d512f48a8f79ceb5ea0bdc1d7}{\_\_kmp\_invoke\_task}( gtid, new\_task, current\_task );
1253     \}
1254 
1255     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_omp\_task\_parts(exit): T#%d returning TASK\_CURRENT\_NOT\_QUEUED: "}
1256                   \textcolor{stringliteral}{"loc=%p task=%p, return: TASK\_CURRENT\_NOT\_QUEUED\(\backslash\)n"}, gtid, loc\_ref,
1257                   new\_taskdata ) );
1258 
1259     \textcolor{keywordflow}{return} \hyperlink{kmp_8h_a5acf257816ecbf4dd8fa709c0506a4da}{TASK\_CURRENT\_NOT\_QUEUED};
1260 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_aca1d4fc4e3806ec10bc80023395e9877}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-taskwait@{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-taskwait}}
\index{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-taskwait@{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-taskwait}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-taskwait}]{\setlength{\rightskip}{0pt plus 5cm}kmp\-\_\-int32 \-\_\-\-\_\-kmpc\-\_\-omp\-\_\-taskwait (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc\-\_\-ref, }
\item[{kmp\-\_\-int32}]{gtid}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_aca1d4fc4e3806ec10bc80023395e9877}


Definition at line 1339 of file kmp\-\_\-tasking.\-c.



Referenced by K\-M\-P\-\_\-\-A\-P\-I\-\_\-\-N\-A\-M\-E\-\_\-\-G\-O\-M\-P\-\_\-\-T\-A\-S\-K\-W\-A\-I\-T().


\begin{DoxyCode}
1340 \{
1341     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * taskdata;
1342     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} * thread;
1343     \textcolor{keywordtype}{int} thread\_finished = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1344 
1345     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_omp\_taskwait(enter): T#%d loc=%p\(\backslash\)n"}, gtid, loc\_ref) );
1346 
1347     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a39e87c52fb75a615c2564a822a013a5a}{\_\_kmp\_tasking\_mode} != \hyperlink{kmp_8h_aad1bdfbfac136cfd92611bcee79ca3f2af827998cf4eb3f61723edc4943b86c98}{tskm\_immediate\_exec} ) \{
1348         \textcolor{comment}{// GEH TODO: shouldn't we have some sort of OMPRAP API calls here to mark begin wait?}
1349 
1350         thread = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
1351         taskdata = thread -> th.th\_current\_task;
1352 
1353 \textcolor{preprocessor}{#if OMPT\_SUPPORT && OMPT\_TRACE}
1354 \textcolor{preprocessor}{}        ompt\_task\_id\_t my\_task\_id;
1355         ompt\_parallel\_id\_t my\_parallel\_id;
1356         
1357         \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled}) \{
1358             \hyperlink{unionkmp__team}{kmp\_team\_t} *team = thread->th.th\_team;
1359             my\_task\_id = taskdata->ompt\_task\_info.task\_id;
1360             my\_parallel\_id = team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.ompt\_team\_info.parallel\_id;
1361             
1362             taskdata->ompt\_task\_info.frame.reenter\_runtime\_frame = \_\_builtin\_frame\_address(0);
1363             \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_taskwait\_begin)) \{
1364                 \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_taskwait\_begin)(
1365                                 my\_parallel\_id, my\_task\_id);
1366             \}
1367         \}
1368 \textcolor{preprocessor}{#endif}
1369 \textcolor{preprocessor}{}
1370 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1371 \textcolor{preprocessor}{}        \textcolor{comment}{// Note: These values are used by ITT events as well.}
1372 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1373 \textcolor{preprocessor}{}        taskdata->\hyperlink{structkmp__taskdata_a11a22c35abf51fc2e20a7559001a1e72}{td\_taskwait\_counter} += 1;
1374         taskdata->\hyperlink{structkmp__taskdata_a11ddd31b5102384ab645eef338e40bf3}{td\_taskwait\_ident}    = loc\_ref;
1375         taskdata->\hyperlink{structkmp__taskdata_a9721521ef95aac2b984b2ee053c3be9a}{td\_taskwait\_thread}   = gtid + 1;
1376 
1377 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1378 \textcolor{preprocessor}{}        \textcolor{keywordtype}{void} * itt\_sync\_obj = \_\_kmp\_itt\_taskwait\_object( gtid );
1379         \textcolor{keywordflow}{if} ( itt\_sync\_obj != NULL )
1380             \_\_kmp\_itt\_taskwait\_starting( gtid, itt\_sync\_obj );
1381 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1382 \textcolor{preprocessor}{}
1383 \textcolor{preprocessor}{#if OMP\_41\_ENABLED}
1384 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( ! taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a69abf7c2ecf0b7284861a90c7ac0cfe1}{team\_serial} || (thread->th.th\_task\_team != NULL && 
      thread->th.th\_task\_team->tt.tt\_found\_proxy\_tasks) ) 
1385 \textcolor{preprocessor}{#else}
1386 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( ! taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a69abf7c2ecf0b7284861a90c7ac0cfe1}{team\_serial} ) 
1387 \textcolor{preprocessor}{#endif}
1388 \textcolor{preprocessor}{}        \{
1389             \textcolor{comment}{// GEH: if team serialized, avoid reading the volatile variable below.}
1390             \hyperlink{classkmp__flag__32}{kmp\_flag\_32} flag(&(taskdata->\hyperlink{structkmp__taskdata_af2d9a1116312e78182a768bb19bc5021}{td\_incomplete\_child\_tasks}), 0U
      );
1391             \textcolor{keywordflow}{while} ( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(taskdata -> td\_incomplete\_child\_tasks) != 0 ) \{
1392                 flag.execute\_tasks(thread, gtid, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, &thread\_finished
1393                                    \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{USE\_ITT\_BUILD\_ARG}(itt\_sync\_obj), 
      \hyperlink{kmp_8h_a8fed3df0b84562bb900b41b72dd88033}{\_\_kmp\_task\_stealing\_constraint} );
1394             \}
1395         \}
1396 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1397 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( itt\_sync\_obj != NULL )
1398             \_\_kmp\_itt\_taskwait\_finished( gtid, itt\_sync\_obj );
1399 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1400 \textcolor{preprocessor}{}
1401         \textcolor{comment}{// GEH TODO: shouldn't we have some sort of OMPRAP API calls here to mark end of wait?}
1402         taskdata->\hyperlink{structkmp__taskdata_a9721521ef95aac2b984b2ee053c3be9a}{td\_taskwait\_thread} = - taskdata->
      \hyperlink{structkmp__taskdata_a9721521ef95aac2b984b2ee053c3be9a}{td\_taskwait\_thread};
1403 
1404 \textcolor{preprocessor}{#if OMPT\_SUPPORT && OMPT\_TRACE}
1405 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled}) \{
1406             \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_taskwait\_end)) \{
1407                 \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_taskwait\_end)(
1408                                 my\_parallel\_id, my\_task\_id);
1409             \}
1410             taskdata->ompt\_task\_info.frame.reenter\_runtime\_frame = 0;
1411         \}
1412 \textcolor{preprocessor}{#endif}
1413 \textcolor{preprocessor}{}    \}
1414 
1415     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_omp\_taskwait(exit): T#%d task %p finished waiting, "}
1416                   \textcolor{stringliteral}{"returning TASK\_CURRENT\_NOT\_QUEUED\(\backslash\)n"}, gtid, taskdata) );
1417 
1418     \textcolor{keywordflow}{return} \hyperlink{kmp_8h_a5acf257816ecbf4dd8fa709c0506a4da}{TASK\_CURRENT\_NOT\_QUEUED};
1419 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_a236ce7c159e9173eeedfdbd9302fc5e0}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-taskyield@{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-taskyield}}
\index{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-taskyield@{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-taskyield}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmpc\-\_\-omp\-\_\-taskyield}]{\setlength{\rightskip}{0pt plus 5cm}kmp\-\_\-int32 \-\_\-\-\_\-kmpc\-\_\-omp\-\_\-taskyield (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc\-\_\-ref, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{{\bf int}}]{end\-\_\-part}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_a236ce7c159e9173eeedfdbd9302fc5e0}


Definition at line 1426 of file kmp\-\_\-tasking.\-c.


\begin{DoxyCode}
1427 \{
1428     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t} * taskdata;
1429     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} * thread;
1430     \textcolor{keywordtype}{int} thread\_finished = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1431 
1432     \hyperlink{group__STATS__GATHERING_ga7fa64ec62947bf0b97f3f4778dd22196}{KMP\_COUNT\_BLOCK}(OMP\_TASKYIELD);
1433 
1434     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_omp\_taskyield(enter): T#%d loc=%p end\_part = %d\(\backslash\)n"},
1435                   gtid, loc\_ref, end\_part) );
1436 
1437     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a39e87c52fb75a615c2564a822a013a5a}{\_\_kmp\_tasking\_mode} != \hyperlink{kmp_8h_aad1bdfbfac136cfd92611bcee79ca3f2af827998cf4eb3f61723edc4943b86c98}{tskm\_immediate\_exec} && 
      \hyperlink{kmp_8h_aa23ece0d05f38387c8a8441aaad368df}{\_\_kmp\_init\_parallel} ) \{
1438         \textcolor{comment}{// GEH TODO: shouldn't we have some sort of OMPRAP API calls here to mark begin wait?}
1439 
1440         thread = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
1441         taskdata = thread -> th.th\_current\_task;
1442         \textcolor{comment}{// Should we model this as a task wait or not?}
1443 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1444 \textcolor{preprocessor}{}        \textcolor{comment}{// Note: These values are used by ITT events as well.}
1445 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1446 \textcolor{preprocessor}{}        taskdata->\hyperlink{structkmp__taskdata_a11a22c35abf51fc2e20a7559001a1e72}{td\_taskwait\_counter} += 1;
1447         taskdata->\hyperlink{structkmp__taskdata_a11ddd31b5102384ab645eef338e40bf3}{td\_taskwait\_ident}    = loc\_ref;
1448         taskdata->\hyperlink{structkmp__taskdata_a9721521ef95aac2b984b2ee053c3be9a}{td\_taskwait\_thread}   = gtid + 1;
1449 
1450 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1451 \textcolor{preprocessor}{}        \textcolor{keywordtype}{void} * itt\_sync\_obj = \_\_kmp\_itt\_taskwait\_object( gtid );
1452         \textcolor{keywordflow}{if} ( itt\_sync\_obj != NULL )
1453             \_\_kmp\_itt\_taskwait\_starting( gtid, itt\_sync\_obj );
1454 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1455 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( ! taskdata->\hyperlink{structkmp__taskdata_aa6380b6723d2482345a1e6cffcd15e9f}{td\_flags}.\hyperlink{structkmp__tasking__flags_a69abf7c2ecf0b7284861a90c7ac0cfe1}{team\_serial} ) \{
1456             \hyperlink{unionkmp__task__team}{kmp\_task\_team\_t} * task\_team = thread->th.th\_task\_team;
1457             \textcolor{keywordflow}{if} (task\_team != NULL) \{
1458                 \textcolor{keywordflow}{if} (\hyperlink{kmp_8h_a8b15269c2644fa0ba3ee09b0eb025867}{KMP\_TASKING\_ENABLED}(task\_team)) \{
1459                     \hyperlink{kmp__tasking_8c_a364d937a49ecd51fe09bce93f4844a7e}{\_\_kmp\_execute\_tasks\_32}( thread, gtid, NULL, 
      \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE}, &thread\_finished
1460                                             \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{USE\_ITT\_BUILD\_ARG}(itt\_sync\_obj), 
      \hyperlink{kmp_8h_a8fed3df0b84562bb900b41b72dd88033}{\_\_kmp\_task\_stealing\_constraint} );
1461                 \}
1462             \}
1463         \}
1464 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1465 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( itt\_sync\_obj != NULL )
1466             \_\_kmp\_itt\_taskwait\_finished( gtid, itt\_sync\_obj );
1467 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1468 \textcolor{preprocessor}{}
1469         \textcolor{comment}{// GEH TODO: shouldn't we have some sort of OMPRAP API calls here to mark end of wait?}
1470         taskdata->\hyperlink{structkmp__taskdata_a9721521ef95aac2b984b2ee053c3be9a}{td\_taskwait\_thread} = - taskdata->
      \hyperlink{structkmp__taskdata_a9721521ef95aac2b984b2ee053c3be9a}{td\_taskwait\_thread};
1471     \}
1472 
1473     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_omp\_taskyield(exit): T#%d task %p resuming, "}
1474                   \textcolor{stringliteral}{"returning TASK\_CURRENT\_NOT\_QUEUED\(\backslash\)n"}, gtid, taskdata) );
1475 
1476     \textcolor{keywordflow}{return} \hyperlink{kmp_8h_a5acf257816ecbf4dd8fa709c0506a4da}{TASK\_CURRENT\_NOT\_QUEUED};
1477 \}
\end{DoxyCode}
\hypertarget{kmp__tasking_8c_adefa1c9d2f6ccdeea3373d518ea8694e}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmpc\-\_\-taskgroup@{\-\_\-\-\_\-kmpc\-\_\-taskgroup}}
\index{\-\_\-\-\_\-kmpc\-\_\-taskgroup@{\-\_\-\-\_\-kmpc\-\_\-taskgroup}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmpc\-\_\-taskgroup}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmpc\-\_\-taskgroup (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc, }
\item[{{\bf int}}]{gtid}
\end{DoxyParamCaption}
)}}\label{kmp__tasking_8c_adefa1c9d2f6ccdeea3373d518ea8694e}


Definition at line 1485 of file kmp\-\_\-tasking.\-c.



Referenced by K\-M\-P\-\_\-\-A\-P\-I\-\_\-\-N\-A\-M\-E\-\_\-\-G\-O\-M\-P\-\_\-\-T\-A\-S\-K\-G\-R\-O\-U\-P\-\_\-\-S\-T\-A\-R\-T().


\begin{DoxyCode}
1486 \{
1487     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}      * thread = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
1488     \hyperlink{structkmp__taskdata}{kmp\_taskdata\_t}  * taskdata = thread->th.th\_current\_task;
1489     \hyperlink{structkmp__taskgroup}{kmp\_taskgroup\_t} * tg\_new =
1490         (\hyperlink{structkmp__taskgroup}{kmp\_taskgroup\_t} *)\hyperlink{kmp_8h_a83a0d4c2333a2ee3931cba6b12e0d5a6}{\_\_kmp\_thread\_malloc}( thread, \textcolor{keyword}{sizeof}( 
      \hyperlink{structkmp__taskgroup}{kmp\_taskgroup\_t} ) );
1491     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}(10, (\textcolor{stringliteral}{"\_\_kmpc\_taskgroup: T#%d loc=%p group=%p\(\backslash\)n"}, gtid, loc, tg\_new) );
1492     tg\_new->\hyperlink{structkmp__taskgroup_aa0ed4b8e5fd1730ebad7b0f3f3ebadf9}{count} = 0;
1493     tg\_new->\hyperlink{structkmp__taskgroup_a0775c7306150a24b509b4f897be92bce}{cancel\_request} = \hyperlink{kmp_8h_a7346f2e741ade19c05b63e57099c7cfeaf5b4fc915ab576dd1e7d4ad12b5dc6c0}{cancel\_noreq};
1494     tg\_new->\hyperlink{structkmp__taskgroup_acc9d4f642b6a421dcdc66e44baeca4af}{parent} = taskdata->\hyperlink{structkmp__taskdata_a568185a9e8c23a1682491fa55973d61c}{td\_taskgroup};
1495     taskdata->\hyperlink{structkmp__taskdata_a568185a9e8c23a1682491fa55973d61c}{td\_taskgroup} = tg\_new;
1496 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{kmp__tasking_8c_ac0f8028d2592221f303450428fa1e680}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-teams@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-teams}}
\index{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-teams@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-teams}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-teams}]{\setlength{\rightskip}{0pt plus 5cm}{\bf kmp\-\_\-task\-\_\-team\-\_\-t}$\ast$ \-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-teams = N\-U\-L\-L\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_ac0f8028d2592221f303450428fa1e680}


Definition at line 2188 of file kmp\-\_\-tasking.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-allocate\-\_\-task\-\_\-team(), and \-\_\-\-\_\-kmp\-\_\-free\-\_\-task\-\_\-team().

\hypertarget{kmp__tasking_8c_a41e8ad7ff702abc83af1e3c4d47a2e47}{\index{kmp\-\_\-tasking.\-c@{kmp\-\_\-tasking.\-c}!\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-lock@{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-lock}}
\index{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-lock@{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-lock}!kmp_tasking.c@{kmp\-\_\-tasking.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-lock}]{\setlength{\rightskip}{0pt plus 5cm}{\bf kmp\-\_\-bootstrap\-\_\-lock\-\_\-t} \-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-lock = {\bf K\-M\-P\-\_\-\-B\-O\-O\-T\-S\-T\-R\-A\-P\-\_\-\-L\-O\-C\-K\-\_\-\-I\-N\-I\-T\-I\-A\-L\-I\-Z\-E\-R}( \-\_\-\-\_\-kmp\-\_\-task\-\_\-team\-\_\-lock )\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__tasking_8c_a41e8ad7ff702abc83af1e3c4d47a2e47}


Definition at line 2190 of file kmp\-\_\-tasking.\-c.

