\hypertarget{kmp__sched_8cpp}{\section{kmp\-\_\-sched.\-cpp File Reference}
\label{kmp__sched_8cpp}\index{kmp\-\_\-sched.\-cpp@{kmp\-\_\-sched.\-cpp}}
}
{\ttfamily \#include \char`\"{}kmp.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-i18n.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-str.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-error.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-stats.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-itt.\-h\char`\"{}}\\*
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structi__maxmin}{i\-\_\-maxmin$<$ T $>$}
\item 
struct \hyperlink{structi__maxmin_3_01int_01_4}{i\-\_\-maxmin$<$ int $>$}
\item 
struct \hyperlink{structi__maxmin_3_01unsigned_01int_01_4}{i\-\_\-maxmin$<$ unsigned int $>$}
\item 
struct \hyperlink{structi__maxmin_3_01long_01long_01_4}{i\-\_\-maxmin$<$ long long $>$}
\item 
struct \hyperlink{structi__maxmin_3_01unsigned_01long_01long_01_4}{i\-\_\-maxmin$<$ unsigned long long $>$}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename T $>$ }\\static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__sched_8cpp_a625c108802186f9976aea789464a6a5e}{\-\_\-\-\_\-kmp\-\_\-for\-\_\-static\-\_\-init} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 global\-\_\-tid, kmp\-\_\-int32 schedtype, kmp\-\_\-int32 $\ast$plastiter, T $\ast$plower, T $\ast$pupper, typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t $\ast$pstride, typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t incr, typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t chunk)
\item 
{\footnotesize template$<$typename T $>$ }\\static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__sched_8cpp_a295c58050481d16077e163b9d59b8527}{\-\_\-\-\_\-kmp\-\_\-dist\-\_\-for\-\_\-static\-\_\-init} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 schedule, kmp\-\_\-int32 $\ast$plastiter, T $\ast$plower, T $\ast$pupper, T $\ast$pupper\-Dist, typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t $\ast$pstride, typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t incr, typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t chunk)
\item 
{\footnotesize template$<$typename T $>$ }\\static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__sched_8cpp_a6d93690d8695fb15f0e12fbda3c65180}{\-\_\-\-\_\-kmp\-\_\-team\-\_\-static\-\_\-init} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 $\ast$p\-\_\-last, T $\ast$p\-\_\-lb, T $\ast$p\-\_\-ub, typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t $\ast$p\-\_\-st, typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t incr, typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t chunk)
\end{DoxyCompactItemize}
{\bf }\par
\begin{DoxyCompactItemize}
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_gab516cbd738ec072f4929faecbbc456f9}{\-\_\-\-\_\-kmpc\-\_\-for\-\_\-static\-\_\-init\-\_\-4} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 schedtype, kmp\-\_\-int32 $\ast$plastiter, kmp\-\_\-int32 $\ast$plower, kmp\-\_\-int32 $\ast$pupper, kmp\-\_\-int32 $\ast$pstride, kmp\-\_\-int32 incr, kmp\-\_\-int32 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_ga305bbe90a798fdc8347aa809978365f5}{\-\_\-\-\_\-kmpc\-\_\-for\-\_\-static\-\_\-init\-\_\-4u} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 schedtype, kmp\-\_\-int32 $\ast$plastiter, kmp\-\_\-uint32 $\ast$plower, kmp\-\_\-uint32 $\ast$pupper, kmp\-\_\-int32 $\ast$pstride, kmp\-\_\-int32 incr, kmp\-\_\-int32 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_ga20f319fbf345661d19fc6bfd325231a5}{\-\_\-\-\_\-kmpc\-\_\-for\-\_\-static\-\_\-init\-\_\-8} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 schedtype, kmp\-\_\-int32 $\ast$plastiter, kmp\-\_\-int64 $\ast$plower, kmp\-\_\-int64 $\ast$pupper, kmp\-\_\-int64 $\ast$pstride, kmp\-\_\-int64 incr, kmp\-\_\-int64 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_ga91d58a0a222e1f75e1d5d65b8ece3645}{\-\_\-\-\_\-kmpc\-\_\-for\-\_\-static\-\_\-init\-\_\-8u} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 schedtype, kmp\-\_\-int32 $\ast$plastiter, kmp\-\_\-uint64 $\ast$plower, kmp\-\_\-uint64 $\ast$pupper, kmp\-\_\-int64 $\ast$pstride, kmp\-\_\-int64 incr, kmp\-\_\-int64 chunk)
\end{DoxyCompactItemize}

{\bf }\par
\begin{DoxyCompactItemize}
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_gab1acaeaf1525bb1d998ba2110c268b24}{\-\_\-\-\_\-kmpc\-\_\-dist\-\_\-for\-\_\-static\-\_\-init\-\_\-4} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 schedule, kmp\-\_\-int32 $\ast$plastiter, kmp\-\_\-int32 $\ast$plower, kmp\-\_\-int32 $\ast$pupper, kmp\-\_\-int32 $\ast$pupper\-D, kmp\-\_\-int32 $\ast$pstride, kmp\-\_\-int32 incr, kmp\-\_\-int32 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_ga7054a4ec6bf4a65dda00a0aab75db65f}{\-\_\-\-\_\-kmpc\-\_\-dist\-\_\-for\-\_\-static\-\_\-init\-\_\-4u} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 schedule, kmp\-\_\-int32 $\ast$plastiter, kmp\-\_\-uint32 $\ast$plower, kmp\-\_\-uint32 $\ast$pupper, kmp\-\_\-uint32 $\ast$pupper\-D, kmp\-\_\-int32 $\ast$pstride, kmp\-\_\-int32 incr, kmp\-\_\-int32 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_ga21ff57e990e07b43d08dfb4214d928c8}{\-\_\-\-\_\-kmpc\-\_\-dist\-\_\-for\-\_\-static\-\_\-init\-\_\-8} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 schedule, kmp\-\_\-int32 $\ast$plastiter, kmp\-\_\-int64 $\ast$plower, kmp\-\_\-int64 $\ast$pupper, kmp\-\_\-int64 $\ast$pupper\-D, kmp\-\_\-int64 $\ast$pstride, kmp\-\_\-int64 incr, kmp\-\_\-int64 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_gac7d4d8d2d7f5d33b5c2b33d89b3ec0af}{\-\_\-\-\_\-kmpc\-\_\-dist\-\_\-for\-\_\-static\-\_\-init\-\_\-8u} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 schedule, kmp\-\_\-int32 $\ast$plastiter, kmp\-\_\-uint64 $\ast$plower, kmp\-\_\-uint64 $\ast$pupper, kmp\-\_\-uint64 $\ast$pupper\-D, kmp\-\_\-int64 $\ast$pstride, kmp\-\_\-int64 incr, kmp\-\_\-int64 chunk)
\end{DoxyCompactItemize}

{\bf }\par
\begin{DoxyCompactItemize}
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_gac43752941984fb8fda7dc8f2a430f4cb}{\-\_\-\-\_\-kmpc\-\_\-team\-\_\-static\-\_\-init\-\_\-4} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 $\ast$p\-\_\-last, kmp\-\_\-int32 $\ast$p\-\_\-lb, kmp\-\_\-int32 $\ast$p\-\_\-ub, kmp\-\_\-int32 $\ast$p\-\_\-st, kmp\-\_\-int32 incr, kmp\-\_\-int32 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_ga99c820d33a0515e359a8f3414d3e9392}{\-\_\-\-\_\-kmpc\-\_\-team\-\_\-static\-\_\-init\-\_\-4u} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 $\ast$p\-\_\-last, kmp\-\_\-uint32 $\ast$p\-\_\-lb, kmp\-\_\-uint32 $\ast$p\-\_\-ub, kmp\-\_\-int32 $\ast$p\-\_\-st, kmp\-\_\-int32 incr, kmp\-\_\-int32 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_ga5d02abafbc1bf1f9c8d7f3d44ad85970}{\-\_\-\-\_\-kmpc\-\_\-team\-\_\-static\-\_\-init\-\_\-8} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 $\ast$p\-\_\-last, kmp\-\_\-int64 $\ast$p\-\_\-lb, kmp\-\_\-int64 $\ast$p\-\_\-ub, kmp\-\_\-int64 $\ast$p\-\_\-st, kmp\-\_\-int64 incr, kmp\-\_\-int64 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_ga81091e3b6b3dfe02aab5e0a661f65433}{\-\_\-\-\_\-kmpc\-\_\-team\-\_\-static\-\_\-init\-\_\-8u} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 $\ast$p\-\_\-last, kmp\-\_\-uint64 $\ast$p\-\_\-lb, kmp\-\_\-uint64 $\ast$p\-\_\-ub, kmp\-\_\-int64 $\ast$p\-\_\-st, kmp\-\_\-int64 incr, kmp\-\_\-int64 chunk)
\end{DoxyCompactItemize}



\subsection{Function Documentation}
\hypertarget{kmp__sched_8cpp_a295c58050481d16077e163b9d59b8527}{\index{kmp\-\_\-sched.\-cpp@{kmp\-\_\-sched.\-cpp}!\-\_\-\-\_\-kmp\-\_\-dist\-\_\-for\-\_\-static\-\_\-init@{\-\_\-\-\_\-kmp\-\_\-dist\-\_\-for\-\_\-static\-\_\-init}}
\index{\-\_\-\-\_\-kmp\-\_\-dist\-\_\-for\-\_\-static\-\_\-init@{\-\_\-\-\_\-kmp\-\_\-dist\-\_\-for\-\_\-static\-\_\-init}!kmp_sched.cpp@{kmp\-\_\-sched.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-dist\-\_\-for\-\_\-static\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ static {\bf void} \-\_\-\-\_\-kmp\-\_\-dist\-\_\-for\-\_\-static\-\_\-init (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{kmp\-\_\-int32}]{schedule, }
\item[{kmp\-\_\-int32 $\ast$}]{plastiter, }
\item[{T $\ast$}]{plower, }
\item[{T $\ast$}]{pupper, }
\item[{T $\ast$}]{pupper\-Dist, }
\item[{typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t $\ast$}]{pstride, }
\item[{typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t}]{incr, }
\item[{typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t}]{chunk}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__sched_8cpp_a295c58050481d16077e163b9d59b8527}


Definition at line 376 of file kmp\-\_\-sched.\-cpp.


\begin{DoxyCode}
387   \{
388     \hyperlink{group__STATS__GATHERING_ga7fa64ec62947bf0b97f3f4778dd22196}{KMP\_COUNT\_BLOCK}(OMP\_DISTRIBUTE);
389     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< T >::unsigned\_t  UT;
390     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< T >::signed\_t    ST;
391     \textcolor{keyword}{register} kmp\_uint32  tid;
392     \textcolor{keyword}{register} kmp\_uint32  nth;
393     \textcolor{keyword}{register} kmp\_uint32  team\_id;
394     \textcolor{keyword}{register} kmp\_uint32  nteams;
395     \textcolor{keyword}{register} UT          trip\_count;
396     \textcolor{keyword}{register} \hyperlink{unionkmp__team}{kmp\_team\_t} *team;
397     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} * th;
398 
399     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( plastiter && plower && pupper && pupperDist && pstride );
400     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmpc\_dist\_for\_static\_init called (%d)\(\backslash\)n"}, gtid));
401 \textcolor{preprocessor}{    #ifdef KMP\_DEBUG}
402 \textcolor{preprocessor}{}    \{
403         \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
404         \textcolor{comment}{// create format specifiers before the debug output}
405         buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
406             \textcolor{stringliteral}{"\_\_kmpc\_dist\_for\_static\_init: T#%%d schedLoop=%%d liter=%%d "}\(\backslash\)
407             \textcolor{stringliteral}{"iter=(%%%s, %%%s, %%%s) chunk=%%%s signed?<%s>\(\backslash\)n"},
408             traits\_t< T >::spec, traits\_t< T >::spec, traits\_t< ST >::spec,
409             traits\_t< ST >::spec, traits\_t< T >::spec );
410         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, ( buff, gtid, schedule, *plastiter,
411                        *plower, *pupper, incr, chunk ) );
412         \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
413     \}
414 \textcolor{preprocessor}{    #endif}
415 \textcolor{preprocessor}{}
416     \textcolor{keywordflow}{if}( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
417         \hyperlink{kmp__error_8c_a66a32e32866271e32187760f4a9d4e3e}{\_\_kmp\_push\_workshare}( gtid, \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315aef2b45cd9b1ab8d75031c716a27adce9}{ct\_pdo}, loc );
418         \textcolor{keywordflow}{if}( incr == 0 ) \{
419             \hyperlink{kmp__error_8c_aa91d3ecb565b21ade2e4156254f9941e}{\_\_kmp\_error\_construct}( kmp\_i18n\_msg\_CnsLoopIncrZeroProhibited, 
      \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315aef2b45cd9b1ab8d75031c716a27adce9}{ct\_pdo}, loc );
420         \}
421         \textcolor{keywordflow}{if}( incr > 0 ? (*pupper < *plower) : (*plower < *pupper) ) \{
422             \textcolor{comment}{// The loop is illegal.}
423             \textcolor{comment}{// Some zero-trip loops maintained by compiler, e.g.:}
424             \textcolor{comment}{//   for(i=10;i<0;++i) // lower >= upper - run-time check}
425             \textcolor{comment}{//   for(i=0;i>10;--i) // lower <= upper - run-time check}
426             \textcolor{comment}{//   for(i=0;i>10;++i) // incr > 0       - compile-time check}
427             \textcolor{comment}{//   for(i=10;i<0;--i) // incr < 0       - compile-time check}
428             \textcolor{comment}{// Compiler does not check the following illegal loops:}
429             \textcolor{comment}{//   for(i=0;i<10;i+=incr) // where incr<0}
430             \textcolor{comment}{//   for(i=10;i>0;i-=incr) // where incr<0}
431             \hyperlink{kmp__error_8c_aa91d3ecb565b21ade2e4156254f9941e}{\_\_kmp\_error\_construct}( kmp\_i18n\_msg\_CnsLoopIncrIllegal, 
      \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315aef2b45cd9b1ab8d75031c716a27adce9}{ct\_pdo}, loc );
432         \}
433     \}
434     tid = \hyperlink{kmp_8h_afb8f84fff9682417eb1c484ffbfdc6ee}{\_\_kmp\_tid\_from\_gtid}( gtid );
435     th = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[gtid];
436     nth = th->th.th\_team\_nproc;
437     team = th->th.th\_team;
438 \textcolor{preprocessor}{    #if OMP\_40\_ENABLED}
439 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(th->th.th\_teams\_microtask);   \textcolor{comment}{// we are in the teams construct}
440     nteams = th->th.th\_teams\_size.nteams;
441 \textcolor{preprocessor}{    #endif}
442 \textcolor{preprocessor}{}    team\_id = team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_master\_tid;
443     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(nteams == team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_parent->t.t\_nproc);
444 
445     \textcolor{comment}{// compute global trip count}
446     \textcolor{keywordflow}{if}( incr == 1 ) \{
447         trip\_count = *pupper - *plower + 1;
448     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(incr == -1) \{
449         trip\_count = *plower - *pupper + 1;
450     \} \textcolor{keywordflow}{else} \{
451         trip\_count = (ST)(*pupper - *plower) / incr + 1; \textcolor{comment}{// cast to signed to cover incr<0 case}
452     \}
453 
454     *pstride = *pupper - *plower;  \textcolor{comment}{// just in case (can be unused)}
455     \textcolor{keywordflow}{if}( trip\_count <= nteams ) \{
456         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(
457             \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea67c1b7c70c012361c0218269ac063606}{kmp\_sch\_static\_greedy} || \(\backslash\)
458             \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea5869a7f3c202fef826c9368fa155dcdb}{kmp\_sch\_static\_balanced}
459         ); \textcolor{comment}{// Unknown static scheduling type.}
460         \textcolor{comment}{// only masters of some teams get single iteration, other threads get nothing}
461         \textcolor{keywordflow}{if}( team\_id < trip\_count && tid == 0 ) \{
462             *pupper = *pupperDist = *plower = *plower + team\_id * incr;
463         \} \textcolor{keywordflow}{else} \{
464             *pupperDist = *pupper;
465             *plower = *pupper + incr; \textcolor{comment}{// compiler should skip loop body}
466         \}
467         \textcolor{keywordflow}{if}( plastiter != NULL )
468             *plastiter = ( tid == 0 && team\_id == trip\_count - 1 );
469     \} \textcolor{keywordflow}{else} \{
470         \textcolor{comment}{// Get the team's chunk first (each team gets at most one chunk)}
471         \textcolor{keywordflow}{if}( \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea5869a7f3c202fef826c9368fa155dcdb}{kmp\_sch\_static\_balanced} ) \{
472             \textcolor{keyword}{register} UT chunkD = trip\_count / nteams;
473             \textcolor{keyword}{register} UT extras = trip\_count % nteams;
474             *plower += incr * ( team\_id * chunkD + ( team\_id < extras ? team\_id : extras ) );
475             *pupperDist = *plower + chunkD * incr - ( team\_id < extras ? 0 : incr );
476             \textcolor{keywordflow}{if}( plastiter != NULL )
477                 *plastiter = ( team\_id == nteams - 1 );
478         \} \textcolor{keywordflow}{else} \{
479             \textcolor{keyword}{register} T chunk\_inc\_count =
480                 ( trip\_count / nteams + ( ( trip\_count % nteams ) ? 1 : 0) ) * incr;
481             \textcolor{keyword}{register} T upper = *pupper;
482             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == 
      \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea67c1b7c70c012361c0218269ac063606}{kmp\_sch\_static\_greedy} );
483                 \textcolor{comment}{// Unknown static scheduling type.}
484             *plower += team\_id * chunk\_inc\_count;
485             *pupperDist = *plower + chunk\_inc\_count - incr;
486             \textcolor{comment}{// Check/correct bounds if needed}
487             \textcolor{keywordflow}{if}( incr > 0 ) \{
488                 \textcolor{keywordflow}{if}( *pupperDist < *plower )
489                     *pupperDist = \hyperlink{structi__maxmin}{i\_maxmin< T >::mx};
490                 \textcolor{keywordflow}{if}( plastiter != NULL )
491                     *plastiter = *plower <= upper && *pupperDist > upper - incr;
492                 \textcolor{keywordflow}{if}( *pupperDist > upper )
493                     *pupperDist = upper; \textcolor{comment}{// tracker C73258}
494                 \textcolor{keywordflow}{if}( *plower > *pupperDist ) \{
495                     *pupper = *pupperDist;  \textcolor{comment}{// no iterations available for the team}
496                     \textcolor{keywordflow}{goto} end;
497                 \}
498             \} \textcolor{keywordflow}{else} \{
499                 \textcolor{keywordflow}{if}( *pupperDist > *plower )
500                     *pupperDist = \hyperlink{structi__maxmin}{i\_maxmin< T >::mn};
501                 \textcolor{keywordflow}{if}( plastiter != NULL )
502                     *plastiter = *plower >= upper && *pupperDist < upper - incr;
503                 \textcolor{keywordflow}{if}( *pupperDist < upper )
504                     *pupperDist = upper; \textcolor{comment}{// tracker C73258}
505                 \textcolor{keywordflow}{if}( *plower < *pupperDist ) \{
506                     *pupper = *pupperDist;  \textcolor{comment}{// no iterations available for the team}
507                     \textcolor{keywordflow}{goto} end;
508                 \}
509             \}
510         \}
511         \textcolor{comment}{// Get the parallel loop chunk now (for thread)}
512         \textcolor{comment}{// compute trip count for team's chunk}
513         \textcolor{keywordflow}{if}( incr == 1 ) \{
514             trip\_count = *pupperDist - *plower + 1;
515         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(incr == -1) \{
516             trip\_count = *plower - *pupperDist + 1;
517         \} \textcolor{keywordflow}{else} \{
518             trip\_count = (ST)(*pupperDist - *plower) / incr + 1;
519         \}
520         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( trip\_count );
521         \textcolor{keywordflow}{switch}( schedule ) \{
522         \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea2a987351b9605b918693a17d4dd90772}{kmp\_sch\_static}:
523         \{
524             \textcolor{keywordflow}{if}( trip\_count <= nth ) \{
525                 \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(
526                     \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea67c1b7c70c012361c0218269ac063606}{kmp\_sch\_static\_greedy} || \(\backslash\)
527                     \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea5869a7f3c202fef826c9368fa155dcdb}{kmp\_sch\_static\_balanced}
528                 ); \textcolor{comment}{// Unknown static scheduling type.}
529                 \textcolor{keywordflow}{if}( tid < trip\_count )
530                     *pupper = *plower = *plower + tid * incr;
531                 \textcolor{keywordflow}{else}
532                     *plower = *pupper + incr; \textcolor{comment}{// no iterations available}
533                 \textcolor{keywordflow}{if}( plastiter != NULL )
534                     \textcolor{keywordflow}{if}( *plastiter != 0 && !( tid == trip\_count - 1 ) )
535                         *plastiter = 0;
536             \} \textcolor{keywordflow}{else} \{
537                 \textcolor{keywordflow}{if}( \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea5869a7f3c202fef826c9368fa155dcdb}{kmp\_sch\_static\_balanced} ) \{
538                     \textcolor{keyword}{register} UT chunkL = trip\_count / nth;
539                     \textcolor{keyword}{register} UT extras = trip\_count % nth;
540                     *plower += incr * (tid * chunkL + (tid < extras ? tid : extras));
541                     *pupper = *plower + chunkL * incr - (tid < extras ? 0 : incr);
542                     \textcolor{keywordflow}{if}( plastiter != NULL )
543                         \textcolor{keywordflow}{if}( *plastiter != 0 && !( tid == nth - 1 ) )
544                             *plastiter = 0;
545                 \} \textcolor{keywordflow}{else} \{
546                     \textcolor{keyword}{register} T chunk\_inc\_count =
547                         ( trip\_count / nth + ( ( trip\_count % nth ) ? 1 : 0) ) * incr;
548                     \textcolor{keyword}{register} T upper = *pupperDist;
549                     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == 
      \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea67c1b7c70c012361c0218269ac063606}{kmp\_sch\_static\_greedy} );
550                         \textcolor{comment}{// Unknown static scheduling type.}
551                     *plower += tid * chunk\_inc\_count;
552                     *pupper = *plower + chunk\_inc\_count - incr;
553                     \textcolor{keywordflow}{if}( incr > 0 ) \{
554                         \textcolor{keywordflow}{if}( *pupper < *plower )
555                             *pupper = \hyperlink{structi__maxmin}{i\_maxmin< T >::mx};
556                         \textcolor{keywordflow}{if}( plastiter != NULL )
557                             \textcolor{keywordflow}{if}( *plastiter != 0 && !(*plower <= upper && *pupper > upper - incr) )
558                                 *plastiter = 0;
559                         \textcolor{keywordflow}{if}( *pupper > upper )
560                             *pupper = upper;\textcolor{comment}{//tracker C73258}
561                     \} \textcolor{keywordflow}{else} \{
562                         \textcolor{keywordflow}{if}( *pupper > *plower )
563                             *pupper = \hyperlink{structi__maxmin}{i\_maxmin< T >::mn};
564                         \textcolor{keywordflow}{if}( plastiter != NULL )
565                             \textcolor{keywordflow}{if}( *plastiter != 0 && !(*plower >= upper && *pupper < upper - incr) )
566                                 *plastiter = 0;
567                         \textcolor{keywordflow}{if}( *pupper < upper )
568                             *pupper = upper;\textcolor{comment}{//tracker C73258}
569                     \}
570                 \}
571             \}
572             \textcolor{keywordflow}{break};
573         \}
574         \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea8521b598e4c2014936813c104adfab4b}{kmp\_sch\_static\_chunked}:
575         \{
576             \textcolor{keyword}{register} ST span;
577             \textcolor{keywordflow}{if}( chunk < 1 )
578                 chunk = 1;
579             span = chunk * incr;
580             *pstride = span * nth;
581             *plower = *plower + (span * tid);
582             *pupper = *plower + span - incr;
583             \textcolor{keywordflow}{if}( plastiter != NULL )
584                 \textcolor{keywordflow}{if}( *plastiter != 0 && !(tid == ((trip\_count - 1) / ( UT )chunk) % nth) )
585                     *plastiter = 0;
586             \textcolor{keywordflow}{break};
587         \}
588         \textcolor{keywordflow}{default}:
589             \hyperlink{kmp__debug_8h_afa985a577299cb10dafe8d3bd462d635}{KMP\_ASSERT2}( 0, \textcolor{stringliteral}{"\_\_kmpc\_dist\_for\_static\_init: unknown loop scheduling type"} );
590             \textcolor{keywordflow}{break};
591         \}
592     \}
593     end:;
594 \textcolor{preprocessor}{    #ifdef KMP\_DEBUG}
595 \textcolor{preprocessor}{}    \{
596         \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
597         \textcolor{comment}{// create format specifiers before the debug output}
598         buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
599             \textcolor{stringliteral}{"\_\_kmpc\_dist\_for\_static\_init: last=%%d lo=%%%s up=%%%s upDist=%%%s "}\(\backslash\)
600             \textcolor{stringliteral}{"stride=%%%s signed?<%s>\(\backslash\)n"},
601             traits\_t< T >::spec, traits\_t< T >::spec, traits\_t< T >::spec,
602             traits\_t< ST >::spec, traits\_t< T >::spec );
603         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, ( buff, *plastiter, *plower, *pupper, *pupperDist, *pstride ) );
604         \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
605     \}
606 \textcolor{preprocessor}{    #endif}
607 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmpc\_dist\_for\_static\_init: T#%d return\(\backslash\)n"}, gtid ) );
608     \textcolor{keywordflow}{return};
609 \}
\end{DoxyCode}
\hypertarget{kmp__sched_8cpp_a625c108802186f9976aea789464a6a5e}{\index{kmp\-\_\-sched.\-cpp@{kmp\-\_\-sched.\-cpp}!\-\_\-\-\_\-kmp\-\_\-for\-\_\-static\-\_\-init@{\-\_\-\-\_\-kmp\-\_\-for\-\_\-static\-\_\-init}}
\index{\-\_\-\-\_\-kmp\-\_\-for\-\_\-static\-\_\-init@{\-\_\-\-\_\-kmp\-\_\-for\-\_\-static\-\_\-init}!kmp_sched.cpp@{kmp\-\_\-sched.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-for\-\_\-static\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ static {\bf void} \-\_\-\-\_\-kmp\-\_\-for\-\_\-static\-\_\-init (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc, }
\item[{kmp\-\_\-int32}]{global\-\_\-tid, }
\item[{kmp\-\_\-int32}]{schedtype, }
\item[{kmp\-\_\-int32 $\ast$}]{plastiter, }
\item[{T $\ast$}]{plower, }
\item[{T $\ast$}]{pupper, }
\item[{typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t $\ast$}]{pstride, }
\item[{typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t}]{incr, }
\item[{typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t}]{chunk}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__sched_8cpp_a625c108802186f9976aea789464a6a5e}


Definition at line 75 of file kmp\-\_\-sched.\-cpp.


\begin{DoxyCode}
85   \{
86     \hyperlink{group__STATS__GATHERING_ga7fa64ec62947bf0b97f3f4778dd22196}{KMP\_COUNT\_BLOCK}(OMP\_FOR\_static);
87     \hyperlink{group__STATS__GATHERING_ga62f4b6e3a4ba48c04b172b97df137839}{KMP\_TIME\_BLOCK} (FOR\_static\_scheduling);
88 
89     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< T >::unsigned\_t  UT;
90     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< T >::signed\_t    ST;
91     \textcolor{comment}{/*  this all has to be changed back to TID and such.. */}
92     \textcolor{keyword}{register} kmp\_int32   gtid = global\_tid;
93     \textcolor{keyword}{register} kmp\_uint32  tid;
94     \textcolor{keyword}{register} kmp\_uint32  nth;
95     \textcolor{keyword}{register} UT          trip\_count;
96     \textcolor{keyword}{register} \hyperlink{unionkmp__team}{kmp\_team\_t} *team;
97     \textcolor{keyword}{register} \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *th = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
98 
99 \textcolor{preprocessor}{#if OMPT\_SUPPORT && OMPT\_TRACE}
100 \textcolor{preprocessor}{}    \hyperlink{structompt__team__info__t}{ompt\_team\_info\_t} *team\_info = NULL; 
101     \hyperlink{structompt__task__info__t}{ompt\_task\_info\_t} *task\_info = NULL; 
102 
103     \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled}) \{
104         \textcolor{comment}{// Only fully initialize variables needed by OMPT if OMPT is enabled.}
105         team\_info = \hyperlink{ompt-specific_8c_a89edd4fa7a424dfc144f73cedde5116c}{\_\_ompt\_get\_teaminfo}(0, NULL);
106         task\_info = \hyperlink{ompt-specific_8c_a31168da811886ba5fef353af949900b3}{\_\_ompt\_get\_taskinfo}(0);
107     \}
108 \textcolor{preprocessor}{#endif}
109 \textcolor{preprocessor}{}
110     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( plastiter && plower && pupper && pstride );
111     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmpc\_for\_static\_init called (%d)\(\backslash\)n"}, global\_tid));
112 \textcolor{preprocessor}{    #ifdef KMP\_DEBUG}
113 \textcolor{preprocessor}{}    \{
114         \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
115         \textcolor{comment}{// create format specifiers before the debug output}
116         buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
117             \textcolor{stringliteral}{"\_\_kmpc\_for\_static\_init: T#%%d sched=%%d liter=%%d iter=(%%%s,"} \(\backslash\)
118             \textcolor{stringliteral}{" %%%s, %%%s) incr=%%%s chunk=%%%s signed?<%s>\(\backslash\)n"},
119             traits\_t< T >::spec, traits\_t< T >::spec, traits\_t< ST >::spec,
120             traits\_t< ST >::spec, traits\_t< ST >::spec, traits\_t< T >::spec );
121         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, ( buff, global\_tid, schedtype, *plastiter,
122             *plower, *pupper, *pstride, incr, chunk ) );
123         \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
124     \}
125 \textcolor{preprocessor}{    #endif}
126 \textcolor{preprocessor}{}
127     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
128         \hyperlink{kmp__error_8c_a66a32e32866271e32187760f4a9d4e3e}{\_\_kmp\_push\_workshare}( global\_tid, \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315aef2b45cd9b1ab8d75031c716a27adce9}{ct\_pdo}, loc );
129         \textcolor{keywordflow}{if} ( incr == 0 ) \{
130             \hyperlink{kmp__error_8c_aa91d3ecb565b21ade2e4156254f9941e}{\_\_kmp\_error\_construct}( kmp\_i18n\_msg\_CnsLoopIncrZeroProhibited, 
      \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315aef2b45cd9b1ab8d75031c716a27adce9}{ct\_pdo}, loc );
131         \}
132     \}
133     \textcolor{comment}{/* special handling for zero-trip loops */}
134     \textcolor{keywordflow}{if} ( incr > 0 ? (*pupper < *plower) : (*plower < *pupper) ) \{
135         \textcolor{keywordflow}{if}( plastiter != NULL )
136             *plastiter = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
137         \textcolor{comment}{/* leave pupper and plower set to entire iteration space */}
138         *pstride = incr;   \textcolor{comment}{/* value should never be used */}
139         \textcolor{comment}{//        *plower = *pupper - incr;   // let compiler bypass the illegal loop (like
       for(i=1;i<10;i--))  THIS LINE CAUSED shape2F/h\_tests\_1.f TO HAVE A FAILURE ON A ZERO-TRIP LOOP (lower=1,\(\backslash\)}
140 \textcolor{comment}{          upper=0,stride=1) - JPH June 23, 2009.}
141 \textcolor{preprocessor}{        #ifdef KMP\_DEBUG}
142 \textcolor{preprocessor}{}        \{
143             \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
144             \textcolor{comment}{// create format specifiers before the debug output}
145             buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
146                 \textcolor{stringliteral}{"\_\_kmpc\_for\_static\_init:(ZERO TRIP) liter=%%d lower=%%%s upper=%%%s stride = %%%s
       signed?<%s>, loc = %%s\(\backslash\)n"},
147                 traits\_t< T >::spec, traits\_t< T >::spec, traits\_t< ST >::spec, traits\_t< T >::spec );
148             \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, ( buff, *plastiter, *plower, *pupper, *pstride, loc->
      \hyperlink{structident_a8c2ccc106967f36d7191d59d4d5a65dc}{psource} ) );
149             \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
150         \}
151 \textcolor{preprocessor}{        #endif}
152 \textcolor{preprocessor}{}        \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmpc\_for\_static\_init: T#%d return\(\backslash\)n"}, global\_tid ) );
153 
154 \textcolor{preprocessor}{#if OMPT\_SUPPORT && OMPT\_TRACE}
155 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled} &&
156             \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_loop\_begin)) \{
157             \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_loop\_begin)(
158                 team\_info->\hyperlink{structompt__team__info__t_aea8969d8ca37577c35b466c675a7a241}{parallel\_id}, task\_info->\hyperlink{structompt__task__info__t_a9b45ec47bd1086973892108a3a71e6fe}{task\_id},
159                 team\_info->\hyperlink{structompt__team__info__t_a8fa76f60a770055c3f0bed45a7120cd6}{microtask});
160         \}
161 \textcolor{preprocessor}{#endif}
162 \textcolor{preprocessor}{}        \hyperlink{group__STATS__GATHERING_ga7691000a7864b475046ae62fcf0536ac}{KMP\_COUNT\_VALUE} (FOR\_static\_iterations, 0);
163         \textcolor{keywordflow}{return};
164     \}
165 
166 \textcolor{preprocessor}{    #if OMP\_40\_ENABLED}
167 \textcolor{preprocessor}{}    \textcolor{comment}{// Although there are schedule enumerations above kmp\_ord\_upper which are not schedules for
       "distribute",}
168     \textcolor{comment}{// the only ones which are useful are dynamic, so cannot be seen here, since this codepath is only
       executed}
169     \textcolor{comment}{// for static schedules.}
170     \textcolor{keywordflow}{if} ( schedtype > \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81beabbef146a7c8d44992e9c61bec2309348}{kmp\_ord\_upper} ) \{
171         \textcolor{comment}{// we are in DISTRIBUTE construct}
172         schedtype += \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea2a987351b9605b918693a17d4dd90772}{kmp\_sch\_static} - \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea4132f477daf882e74036a9062a97b7a3}{kmp\_distribute\_static};      \textcolor{comment}{// AC:
       convert to usual schedule type}
173         tid  = th->th.th\_team->t.t\_master\_tid;
174         team = th->th.th\_team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_parent;
175     \} \textcolor{keywordflow}{else}
176 \textcolor{preprocessor}{    #endif}
177 \textcolor{preprocessor}{}    \{
178         tid  = \hyperlink{kmp_8h_afb8f84fff9682417eb1c484ffbfdc6ee}{\_\_kmp\_tid\_from\_gtid}( global\_tid );
179         team = th->th.th\_team;
180     \}
181 
182     \textcolor{comment}{/* determine if "for" loop is an active worksharing construct */}
183     \textcolor{keywordflow}{if} ( team -> t.t\_serialized ) \{
184         \textcolor{comment}{/* serialized parallel, each thread executes whole iteration space */}
185         \textcolor{keywordflow}{if}( plastiter != NULL )
186             *plastiter = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
187         \textcolor{comment}{/* leave pupper and plower set to entire iteration space */}
188         *pstride = (incr > 0) ? (*pupper - *plower + 1) : (-(*plower - *pupper + 1));
189 
190 \textcolor{preprocessor}{        #ifdef KMP\_DEBUG}
191 \textcolor{preprocessor}{}        \{
192             \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
193             \textcolor{comment}{// create format specifiers before the debug output}
194             buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
195                 \textcolor{stringliteral}{"\_\_kmpc\_for\_static\_init: (serial) liter=%%d lower=%%%s upper=%%%s stride = %%%s\(\backslash\)n"},
196                 traits\_t< T >::spec, traits\_t< T >::spec, traits\_t< ST >::spec );
197             \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, ( buff, *plastiter, *plower, *pupper, *pstride ) );
198             \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
199         \}
200 \textcolor{preprocessor}{        #endif}
201 \textcolor{preprocessor}{}        \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmpc\_for\_static\_init: T#%d return\(\backslash\)n"}, global\_tid ) );
202 
203 \textcolor{preprocessor}{#if OMPT\_SUPPORT && OMPT\_TRACE}
204 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled} &&
205             \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_loop\_begin)) \{
206             \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_loop\_begin)(
207                 team\_info->\hyperlink{structompt__team__info__t_aea8969d8ca37577c35b466c675a7a241}{parallel\_id}, task\_info->\hyperlink{structompt__task__info__t_a9b45ec47bd1086973892108a3a71e6fe}{task\_id},
208                 team\_info->\hyperlink{structompt__team__info__t_a8fa76f60a770055c3f0bed45a7120cd6}{microtask});
209         \}
210 \textcolor{preprocessor}{#endif}
211 \textcolor{preprocessor}{}        \textcolor{keywordflow}{return};
212     \}
213     nth = team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc;
214     \textcolor{keywordflow}{if} ( nth == 1 ) \{
215         \textcolor{keywordflow}{if}( plastiter != NULL )
216             *plastiter = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
217         *pstride = (incr > 0) ? (*pupper - *plower + 1) : (-(*plower - *pupper + 1));
218 \textcolor{preprocessor}{        #ifdef KMP\_DEBUG}
219 \textcolor{preprocessor}{}        \{
220             \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
221             \textcolor{comment}{// create format specifiers before the debug output}
222             buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
223                 \textcolor{stringliteral}{"\_\_kmpc\_for\_static\_init: (serial) liter=%%d lower=%%%s upper=%%%s stride = %%%s\(\backslash\)n"},
224                 traits\_t< T >::spec, traits\_t< T >::spec, traits\_t< ST >::spec );
225             \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, ( buff, *plastiter, *plower, *pupper, *pstride ) );
226             \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
227         \}
228 \textcolor{preprocessor}{        #endif}
229 \textcolor{preprocessor}{}        \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmpc\_for\_static\_init: T#%d return\(\backslash\)n"}, global\_tid ) );
230 
231 \textcolor{preprocessor}{#if OMPT\_SUPPORT && OMPT\_TRACE}
232 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled} &&
233             \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_loop\_begin)) \{
234             \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_loop\_begin)(
235                 team\_info->\hyperlink{structompt__team__info__t_aea8969d8ca37577c35b466c675a7a241}{parallel\_id}, task\_info->\hyperlink{structompt__task__info__t_a9b45ec47bd1086973892108a3a71e6fe}{task\_id},
236                 team\_info->\hyperlink{structompt__team__info__t_a8fa76f60a770055c3f0bed45a7120cd6}{microtask});
237         \}
238 \textcolor{preprocessor}{#endif}
239 \textcolor{preprocessor}{}        \textcolor{keywordflow}{return};
240     \}
241 
242     \textcolor{comment}{/* compute trip count */}
243     \textcolor{keywordflow}{if} ( incr == 1 ) \{
244         trip\_count = *pupper - *plower + 1;
245     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (incr == -1) \{
246         trip\_count = *plower - *pupper + 1;
247     \} \textcolor{keywordflow}{else} \{
248         \textcolor{keywordflow}{if} ( incr > 1 ) \{  \textcolor{comment}{// the check is needed for unsigned division when incr < 0}
249             trip\_count = (*pupper - *plower) / incr + 1;
250         \} \textcolor{keywordflow}{else} \{
251             trip\_count = (*plower - *pupper) / ( -incr ) + 1;
252         \}
253     \}
254 
255     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
256         \textcolor{comment}{/* tripcount overflow? */}
257         \textcolor{keywordflow}{if} ( trip\_count == 0 && *pupper != *plower ) \{
258             \hyperlink{kmp__error_8c_aa91d3ecb565b21ade2e4156254f9941e}{\_\_kmp\_error\_construct}( kmp\_i18n\_msg\_CnsIterationRangeTooLarge, 
      \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315aef2b45cd9b1ab8d75031c716a27adce9}{ct\_pdo}, loc );
259         \}
260     \}
261     \hyperlink{group__STATS__GATHERING_ga7691000a7864b475046ae62fcf0536ac}{KMP\_COUNT\_VALUE} (FOR\_static\_iterations, trip\_count);
262 
263     \textcolor{comment}{/* compute remaining parameters */}
264     \textcolor{keywordflow}{switch} ( schedtype ) \{
265     \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea2a987351b9605b918693a17d4dd90772}{kmp\_sch\_static}:
266         \{
267             \textcolor{keywordflow}{if} ( trip\_count < nth ) \{
268                 \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(
269                     \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea67c1b7c70c012361c0218269ac063606}{kmp\_sch\_static\_greedy} || \(\backslash\)
270                     \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea5869a7f3c202fef826c9368fa155dcdb}{kmp\_sch\_static\_balanced}
271                 ); \textcolor{comment}{// Unknown static scheduling type.}
272                 \textcolor{keywordflow}{if} ( tid < trip\_count ) \{
273                     *pupper = *plower = *plower + tid * incr;
274                 \} \textcolor{keywordflow}{else} \{
275                     *plower = *pupper + incr;
276                 \}
277                 \textcolor{keywordflow}{if}( plastiter != NULL )
278                     *plastiter = ( tid == trip\_count - 1 );
279             \} \textcolor{keywordflow}{else} \{
280                 \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea5869a7f3c202fef826c9368fa155dcdb}{kmp\_sch\_static\_balanced} ) \{
281                     \textcolor{keyword}{register} UT small\_chunk = trip\_count / nth;
282                     \textcolor{keyword}{register} UT extras = trip\_count % nth;
283                     *plower += incr * ( tid * small\_chunk + ( tid < extras ? tid : extras ) );
284                     *pupper = *plower + small\_chunk * incr - ( tid < extras ? 0 : incr );
285                     \textcolor{keywordflow}{if}( plastiter != NULL )
286                         *plastiter = ( tid == nth - 1 );
287                 \} \textcolor{keywordflow}{else} \{
288                     \textcolor{keyword}{register} T big\_chunk\_inc\_count = ( trip\_count/nth +
289                                                      ( ( trip\_count % nth ) ? 1 : 0) ) * incr;
290                     \textcolor{keyword}{register} T old\_upper = *pupper;
291 
292                     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == 
      \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea67c1b7c70c012361c0218269ac063606}{kmp\_sch\_static\_greedy} );
293                         \textcolor{comment}{// Unknown static scheduling type.}
294 
295                     *plower += tid * big\_chunk\_inc\_count;
296                     *pupper = *plower + big\_chunk\_inc\_count - incr;
297                     \textcolor{keywordflow}{if} ( incr > 0 ) \{
298                         \textcolor{keywordflow}{if}( *pupper < *plower )
299                             *pupper = \hyperlink{structi__maxmin}{i\_maxmin< T >::mx};
300                         \textcolor{keywordflow}{if}( plastiter != NULL )
301                             *plastiter = *plower <= old\_upper && *pupper > old\_upper - incr;
302                         \textcolor{keywordflow}{if} ( *pupper > old\_upper ) *pupper = old\_upper; \textcolor{comment}{// tracker C73258}
303                     \} \textcolor{keywordflow}{else} \{
304                         \textcolor{keywordflow}{if}( *pupper > *plower )
305                             *pupper = \hyperlink{structi__maxmin}{i\_maxmin< T >::mn};
306                         \textcolor{keywordflow}{if}( plastiter != NULL )
307                             *plastiter = *plower >= old\_upper && *pupper < old\_upper - incr;
308                         \textcolor{keywordflow}{if} ( *pupper < old\_upper ) *pupper = old\_upper; \textcolor{comment}{// tracker C73258}
309                     \}
310                 \}
311             \}
312             \textcolor{keywordflow}{break};
313         \}
314     \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea8521b598e4c2014936813c104adfab4b}{kmp\_sch\_static\_chunked}:
315         \{
316             \textcolor{keyword}{register} ST span;
317             \textcolor{keywordflow}{if} ( chunk < 1 ) \{
318                 chunk = 1;
319             \}
320             span = chunk * incr;
321             *pstride = span * nth;
322             *plower = *plower + (span * tid);
323             *pupper = *plower + span - incr;
324             \textcolor{keywordflow}{if}( plastiter != NULL )
325                 *plastiter = (tid == ((trip\_count - 1)/( UT )chunk) % nth);
326             \textcolor{keywordflow}{break};
327         \}
328     \textcolor{keywordflow}{default}:
329         \hyperlink{kmp__debug_8h_afa985a577299cb10dafe8d3bd462d635}{KMP\_ASSERT2}( 0, \textcolor{stringliteral}{"\_\_kmpc\_for\_static\_init: unknown scheduling type"} );
330         \textcolor{keywordflow}{break};
331     \}
332 
333 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
334 \textcolor{preprocessor}{}    \textcolor{comment}{// Report loop metadata}
335     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a7a4e2494d803bbee99f23af2117f6dd8}{KMP\_MASTER\_TID}(tid) && \_\_itt\_metadata\_add\_ptr && \_\_kmp\_forkjoin\_frames\_mode == 3 &&
336 #\textcolor{keywordflow}{if} OMP\_40\_ENABLED
337         th->th.th\_teams\_microtask == NULL &&
338 #endif
339         team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_active\_level == 1 )
340     \{
341         kmp\_uint64 cur\_chunk = chunk;
342         \textcolor{comment}{// Calculate chunk in case it was not specified; it is specified for kmp\_sch\_static\_chunked}
343         \textcolor{keywordflow}{if} ( schedtype == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea2a987351b9605b918693a17d4dd90772}{kmp\_sch\_static} ) \{
344             cur\_chunk = trip\_count / nth + ( ( trip\_count % nth ) ? 1 : 0);
345         \}
346         \textcolor{comment}{// 0 - "static" schedule}
347         \_\_kmp\_itt\_metadata\_loop(loc, 0, trip\_count, cur\_chunk);
348     \}
349 \textcolor{preprocessor}{#endif}
350 \textcolor{preprocessor}{}\textcolor{preprocessor}{    #ifdef KMP\_DEBUG}
351 \textcolor{preprocessor}{}    \{
352         \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
353         \textcolor{comment}{// create format specifiers before the debug output}
354         buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
355             \textcolor{stringliteral}{"\_\_kmpc\_for\_static\_init: liter=%%d lower=%%%s upper=%%%s stride = %%%s signed?<%s>\(\backslash\)n"},
356             traits\_t< T >::spec, traits\_t< T >::spec, traits\_t< ST >::spec, traits\_t< T >::spec );
357         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, ( buff, *plastiter, *plower, *pupper, *pstride ) );
358         \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
359     \}
360 \textcolor{preprocessor}{    #endif}
361 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmpc\_for\_static\_init: T#%d return\(\backslash\)n"}, global\_tid ) );
362 
363 \textcolor{preprocessor}{#if OMPT\_SUPPORT && OMPT\_TRACE}
364 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled} &&
365         \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_loop\_begin)) \{
366         \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_loop\_begin)(
367             team\_info->\hyperlink{structompt__team__info__t_aea8969d8ca37577c35b466c675a7a241}{parallel\_id}, task\_info->\hyperlink{structompt__task__info__t_a9b45ec47bd1086973892108a3a71e6fe}{task\_id}, team\_info->
      \hyperlink{structompt__team__info__t_a8fa76f60a770055c3f0bed45a7120cd6}{microtask});
368     \}
369 \textcolor{preprocessor}{#endif}
370 \textcolor{preprocessor}{}
371     \textcolor{keywordflow}{return};
372 \}
\end{DoxyCode}
\hypertarget{kmp__sched_8cpp_a6d93690d8695fb15f0e12fbda3c65180}{\index{kmp\-\_\-sched.\-cpp@{kmp\-\_\-sched.\-cpp}!\-\_\-\-\_\-kmp\-\_\-team\-\_\-static\-\_\-init@{\-\_\-\-\_\-kmp\-\_\-team\-\_\-static\-\_\-init}}
\index{\-\_\-\-\_\-kmp\-\_\-team\-\_\-static\-\_\-init@{\-\_\-\-\_\-kmp\-\_\-team\-\_\-static\-\_\-init}!kmp_sched.cpp@{kmp\-\_\-sched.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-team\-\_\-static\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ static {\bf void} \-\_\-\-\_\-kmp\-\_\-team\-\_\-static\-\_\-init (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{kmp\-\_\-int32 $\ast$}]{p\-\_\-last, }
\item[{T $\ast$}]{p\-\_\-lb, }
\item[{T $\ast$}]{p\-\_\-ub, }
\item[{typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t $\ast$}]{p\-\_\-st, }
\item[{typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t}]{incr, }
\item[{typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t}]{chunk}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__sched_8cpp_a6d93690d8695fb15f0e12fbda3c65180}


Definition at line 613 of file kmp\-\_\-sched.\-cpp.


\begin{DoxyCode}
622   \{
623     \textcolor{comment}{// The routine returns the first chunk distributed to the team and}
624     \textcolor{comment}{// stride for next chunks calculation.}
625     \textcolor{comment}{// Last iteration flag set for the team that will execute}
626     \textcolor{comment}{// the last iteration of the loop.}
627     \textcolor{comment}{// The routine is called for dist\_schedue(static,chunk) only.}
628     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< T >::unsigned\_t  UT;
629     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< T >::signed\_t    ST;
630     kmp\_uint32  team\_id;
631     kmp\_uint32  nteams;
632     UT          trip\_count;
633     T           lower;
634     T           upper;
635     ST          span;
636     \hyperlink{unionkmp__team}{kmp\_team\_t} *team;
637     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *th;
638 
639     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( p\_last && p\_lb && p\_ub && p\_st );
640     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_team\_static\_init called (%d)\(\backslash\)n"}, gtid));
641 \textcolor{preprocessor}{    #ifdef KMP\_DEBUG}
642 \textcolor{preprocessor}{}    \{
643         \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
644         \textcolor{comment}{// create format specifiers before the debug output}
645         buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}( \textcolor{stringliteral}{"\_\_kmp\_team\_static\_init enter: T#%%d liter=%%d "}\(\backslash\)
646             \textcolor{stringliteral}{"iter=(%%%s, %%%s, %%%s) chunk %%%s; signed?<%s>\(\backslash\)n"},
647             traits\_t< T >::spec, traits\_t< T >::spec, traits\_t< ST >::spec,
648             traits\_t< ST >::spec, traits\_t< T >::spec );
649         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, ( buff, gtid, *p\_last, *p\_lb, *p\_ub, *p\_st, chunk ) );
650         \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
651     \}
652 \textcolor{preprocessor}{    #endif}
653 \textcolor{preprocessor}{}
654     lower = *p\_lb;
655     upper = *p\_ub;
656     \textcolor{keywordflow}{if}( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
657         \textcolor{keywordflow}{if}( incr == 0 ) \{
658             \hyperlink{kmp__error_8c_aa91d3ecb565b21ade2e4156254f9941e}{\_\_kmp\_error\_construct}( kmp\_i18n\_msg\_CnsLoopIncrZeroProhibited, 
      \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315aef2b45cd9b1ab8d75031c716a27adce9}{ct\_pdo}, loc );
659         \}
660         \textcolor{keywordflow}{if}( incr > 0 ? (upper < lower) : (lower < upper) ) \{
661             \textcolor{comment}{// The loop is illegal.}
662             \textcolor{comment}{// Some zero-trip loops maintained by compiler, e.g.:}
663             \textcolor{comment}{//   for(i=10;i<0;++i) // lower >= upper - run-time check}
664             \textcolor{comment}{//   for(i=0;i>10;--i) // lower <= upper - run-time check}
665             \textcolor{comment}{//   for(i=0;i>10;++i) // incr > 0       - compile-time check}
666             \textcolor{comment}{//   for(i=10;i<0;--i) // incr < 0       - compile-time check}
667             \textcolor{comment}{// Compiler does not check the following illegal loops:}
668             \textcolor{comment}{//   for(i=0;i<10;i+=incr) // where incr<0}
669             \textcolor{comment}{//   for(i=10;i>0;i-=incr) // where incr<0}
670             \hyperlink{kmp__error_8c_aa91d3ecb565b21ade2e4156254f9941e}{\_\_kmp\_error\_construct}( kmp\_i18n\_msg\_CnsLoopIncrIllegal, 
      \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315aef2b45cd9b1ab8d75031c716a27adce9}{ct\_pdo}, loc );
671         \}
672     \}
673     th = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[gtid];
674     team = th->th.th\_team;
675 \textcolor{preprocessor}{    #if OMP\_40\_ENABLED}
676 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(th->th.th\_teams\_microtask);   \textcolor{comment}{// we are in the teams construct}
677     nteams = th->th.th\_teams\_size.nteams;
678 \textcolor{preprocessor}{    #endif}
679 \textcolor{preprocessor}{}    team\_id = team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_master\_tid;
680     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(nteams == team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_parent->t.t\_nproc);
681 
682     \textcolor{comment}{// compute trip count}
683     \textcolor{keywordflow}{if}( incr == 1 ) \{
684         trip\_count = upper - lower + 1;
685     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(incr == -1) \{
686         trip\_count = lower - upper + 1;
687     \} \textcolor{keywordflow}{else} \{
688         trip\_count = (ST)(upper - lower) / incr + 1; \textcolor{comment}{// cast to signed to cover incr<0 case}
689     \}
690     \textcolor{keywordflow}{if}( chunk < 1 )
691         chunk = 1;
692     span = chunk * incr;
693     *p\_st = span * nteams;
694     *p\_lb = lower + (span * team\_id);
695     *p\_ub = *p\_lb + span - incr;
696     \textcolor{keywordflow}{if} ( p\_last != NULL )
697         *p\_last = (team\_id == ((trip\_count - 1)/(UT)chunk) % nteams);
698     \textcolor{comment}{// Correct upper bound if needed}
699     \textcolor{keywordflow}{if}( incr > 0 ) \{
700         \textcolor{keywordflow}{if}( *p\_ub < *p\_lb ) \textcolor{comment}{// overflow?}
701             *p\_ub = \hyperlink{structi__maxmin}{i\_maxmin< T >::mx};
702         \textcolor{keywordflow}{if}( *p\_ub > upper )
703             *p\_ub = upper; \textcolor{comment}{// tracker C73258}
704     \} \textcolor{keywordflow}{else} \{   \textcolor{comment}{// incr < 0}
705         \textcolor{keywordflow}{if}( *p\_ub > *p\_lb )
706             *p\_ub = \hyperlink{structi__maxmin}{i\_maxmin< T >::mn};
707         \textcolor{keywordflow}{if}( *p\_ub < upper )
708             *p\_ub = upper; \textcolor{comment}{// tracker C73258}
709     \}
710 \textcolor{preprocessor}{    #ifdef KMP\_DEBUG}
711 \textcolor{preprocessor}{}    \{
712         \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
713         \textcolor{comment}{// create format specifiers before the debug output}
714         buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}( \textcolor{stringliteral}{"\_\_kmp\_team\_static\_init exit: T#%%d team%%u liter=%%d "}\(\backslash\)
715             \textcolor{stringliteral}{"iter=(%%%s, %%%s, %%%s) chunk %%%s\(\backslash\)n"},
716             traits\_t< T >::spec, traits\_t< T >::spec, traits\_t< ST >::spec,
717             traits\_t< ST >::spec );
718         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, ( buff, gtid, team\_id, *p\_last, *p\_lb, *p\_ub, *p\_st, chunk ) );
719         \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
720     \}
721 \textcolor{preprocessor}{    #endif}
722 \textcolor{preprocessor}{}\}
\end{DoxyCode}
