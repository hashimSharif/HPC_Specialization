<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>LLVM OpenMP* Runtime Library: hierarchy_info Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LLVM OpenMP* Runtime Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="classhierarchy__info-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">hierarchy_info Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a72afd05b52405fca73987c898caaf5b1"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1">init_status</a> { <a class="el" href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1a62492b533e6c2a820622602a0291dede">initialized</a> =0, 
<a class="el" href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1ac0a8e5f501a8d2ecb151b0d46d71add8">not_initialized</a> =1, 
<a class="el" href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1ad3f87952fafc2375cad49ce25e04351c">initializing</a> =2
 }</td></tr>
<tr class="separator:a72afd05b52405fca73987c898caaf5b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab7d03fbfa83490719f2819e2e8149231"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ittnotify__static_8h.html#af941d56e55e3c5465135b60c4d6343ed">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhierarchy__info.html#ab7d03fbfa83490719f2819e2e8149231">deriveLevels</a> (<a class="el" href="classAddrUnsPair.html">AddrUnsPair</a> *adr2os, <a class="el" href="ittnotify__static_8h.html#a8b8dcd723308a8cb5d84277c7a3fff70">int</a> num_addrs)</td></tr>
<tr class="separator:ab7d03fbfa83490719f2819e2e8149231"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d804a7dc9dae10488df076742c06420"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhierarchy__info.html#a0d804a7dc9dae10488df076742c06420">hierarchy_info</a> ()</td></tr>
<tr class="separator:a0d804a7dc9dae10488df076742c06420"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bd94261d14cd3644006557a49cd4a11"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ittnotify__static_8h.html#af941d56e55e3c5465135b60c4d6343ed">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhierarchy__info.html#a6bd94261d14cd3644006557a49cd4a11">fini</a> ()</td></tr>
<tr class="separator:a6bd94261d14cd3644006557a49cd4a11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a812ad40d00a154a8ecdee9e9daa546a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ittnotify__static_8h.html#af941d56e55e3c5465135b60c4d6343ed">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhierarchy__info.html#a812ad40d00a154a8ecdee9e9daa546a5">init</a> (<a class="el" href="classAddrUnsPair.html">AddrUnsPair</a> *adr2os, <a class="el" href="ittnotify__static_8h.html#a8b8dcd723308a8cb5d84277c7a3fff70">int</a> num_addrs)</td></tr>
<tr class="separator:a812ad40d00a154a8ecdee9e9daa546a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85116254d0daac14aa741e3cdb213f8b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ittnotify__static_8h.html#af941d56e55e3c5465135b60c4d6343ed">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhierarchy__info.html#a85116254d0daac14aa741e3cdb213f8b">resize</a> (kmp_uint32 nproc)</td></tr>
<tr class="separator:a85116254d0daac14aa741e3cdb213f8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:aafbad4b89a239ea459aaef1ab4908aba"><td class="memItemLeft" align="right" valign="top">kmp_uint32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">maxLevels</a></td></tr>
<tr class="separator:aafbad4b89a239ea459aaef1ab4908aba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeebcad75a7d471e1b1fd37aab6216f22"><td class="memItemLeft" align="right" valign="top">kmp_uint32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhierarchy__info.html#aeebcad75a7d471e1b1fd37aab6216f22">depth</a></td></tr>
<tr class="separator:aeebcad75a7d471e1b1fd37aab6216f22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9055a443e8da4aefcfef1b5f1fd43b42"><td class="memItemLeft" align="right" valign="top">kmp_uint32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhierarchy__info.html#a9055a443e8da4aefcfef1b5f1fd43b42">base_num_threads</a></td></tr>
<tr class="separator:a9055a443e8da4aefcfef1b5f1fd43b42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93f1e8f2ed894dc2477e5feb22d24c2c"><td class="memItemLeft" align="right" valign="top">volatile kmp_int8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhierarchy__info.html#a93f1e8f2ed894dc2477e5feb22d24c2c">uninitialized</a></td></tr>
<tr class="separator:a93f1e8f2ed894dc2477e5feb22d24c2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa2edd0b49e3c69a50f3bbebfbd4ad77"><td class="memItemLeft" align="right" valign="top">volatile kmp_int8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhierarchy__info.html#afa2edd0b49e3c69a50f3bbebfbd4ad77">resizing</a></td></tr>
<tr class="separator:afa2edd0b49e3c69a50f3bbebfbd4ad77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12fc455d853883d91e3a19567aaac3fe"><td class="memItemLeft" align="right" valign="top">kmp_uint32 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a></td></tr>
<tr class="separator:a12fc455d853883d91e3a19567aaac3fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80259c2cd48bb476b3eea860723e7fa8"><td class="memItemLeft" align="right" valign="top">kmp_uint32 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a></td></tr>
<tr class="separator:a80259c2cd48bb476b3eea860723e7fa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a4122e10b5d763f2ca3f13076f836ddfe"><td class="memItemLeft" align="right" valign="top">static const kmp_uint32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhierarchy__info.html#a4122e10b5d763f2ca3f13076f836ddfe">maxLeaves</a> =4</td></tr>
<tr class="separator:a4122e10b5d763f2ca3f13076f836ddfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe34e439673297d9ac44c43722c042f0"><td class="memItemLeft" align="right" valign="top">static const kmp_uint32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhierarchy__info.html#afe34e439673297d9ac44c43722c042f0">minBranch</a> =4</td></tr>
<tr class="separator:afe34e439673297d9ac44c43722c042f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A structure for holding machine-specific hierarchy info to be computed once at init. This structure represents a mapping of threads to the actual machine hierarchy, or to our best guess at what the hierarchy might be, for the purpose of performing an efficient barrier. In the worst case, when there is no machine hierarchy information, it produces a tree suitable for a barrier, similar to the tree used in the hyper barrier. </p>

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00146">146</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="a72afd05b52405fca73987c898caaf5b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1">hierarchy_info::init_status</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a72afd05b52405fca73987c898caaf5b1a62492b533e6c2a820622602a0291dede"></a>initialized</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a72afd05b52405fca73987c898caaf5b1ac0a8e5f501a8d2ecb151b0d46d71add8"></a>not_initialized</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a72afd05b52405fca73987c898caaf5b1ad3f87952fafc2375cad49ce25e04351c"></a>initializing</em>&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00163">163</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;{ <a class="code" href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1a62492b533e6c2a820622602a0291dede">initialized</a>=0, <a class="code" href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1ac0a8e5f501a8d2ecb151b0d46d71add8">not_initialized</a>=1, <a class="code" href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1ad3f87952fafc2375cad49ce25e04351c">initializing</a>=2 };</div>
<div class="ttc" id="classhierarchy__info_html_a72afd05b52405fca73987c898caaf5b1ad3f87952fafc2375cad49ce25e04351c"><div class="ttname"><a href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1ad3f87952fafc2375cad49ce25e04351c">hierarchy_info::initializing</a></div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00163">kmp_affinity.h:163</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a72afd05b52405fca73987c898caaf5b1ac0a8e5f501a8d2ecb151b0d46d71add8"><div class="ttname"><a href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1ac0a8e5f501a8d2ecb151b0d46d71add8">hierarchy_info::not_initialized</a></div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00163">kmp_affinity.h:163</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a72afd05b52405fca73987c898caaf5b1a62492b533e6c2a820622602a0291dede"><div class="ttname"><a href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1a62492b533e6c2a820622602a0291dede">hierarchy_info::initialized</a></div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00163">kmp_affinity.h:163</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a0d804a7dc9dae10488df076742c06420"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">hierarchy_info::hierarchy_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00187">187</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;: <a class="code" href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">maxLevels</a>(7), <a class="code" href="classhierarchy__info.html#aeebcad75a7d471e1b1fd37aab6216f22">depth</a>(1), <a class="code" href="classhierarchy__info.html#a93f1e8f2ed894dc2477e5feb22d24c2c">uninitialized</a>(<a class="code" href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1ac0a8e5f501a8d2ecb151b0d46d71add8">not_initialized</a>), <a class="code" href="classhierarchy__info.html#afa2edd0b49e3c69a50f3bbebfbd4ad77">resizing</a>(0) {}</div>
<div class="ttc" id="classhierarchy__info_html_aeebcad75a7d471e1b1fd37aab6216f22"><div class="ttname"><a href="classhierarchy__info.html#aeebcad75a7d471e1b1fd37aab6216f22">hierarchy_info::depth</a></div><div class="ttdeci">kmp_uint32 depth</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00161">kmp_affinity.h:161</a></div></div>
<div class="ttc" id="classhierarchy__info_html_afa2edd0b49e3c69a50f3bbebfbd4ad77"><div class="ttname"><a href="classhierarchy__info.html#afa2edd0b49e3c69a50f3bbebfbd4ad77">hierarchy_info::resizing</a></div><div class="ttdeci">volatile kmp_int8 resizing</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00165">kmp_affinity.h:165</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a72afd05b52405fca73987c898caaf5b1ac0a8e5f501a8d2ecb151b0d46d71add8"><div class="ttname"><a href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1ac0a8e5f501a8d2ecb151b0d46d71add8">hierarchy_info::not_initialized</a></div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00163">kmp_affinity.h:163</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a93f1e8f2ed894dc2477e5feb22d24c2c"><div class="ttname"><a href="classhierarchy__info.html#a93f1e8f2ed894dc2477e5feb22d24c2c">hierarchy_info::uninitialized</a></div><div class="ttdeci">volatile kmp_int8 uninitialized</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00164">kmp_affinity.h:164</a></div></div>
<div class="ttc" id="classhierarchy__info_html_aafbad4b89a239ea459aaef1ab4908aba"><div class="ttname"><a href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">hierarchy_info::maxLevels</a></div><div class="ttdeci">kmp_uint32 maxLevels</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00156">kmp_affinity.h:156</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ab7d03fbfa83490719f2819e2e8149231"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ittnotify__static_8h.html#af941d56e55e3c5465135b60c4d6343ed">void</a> hierarchy_info::deriveLevels </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAddrUnsPair.html">AddrUnsPair</a> *&#160;</td>
          <td class="paramname"><em>adr2os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ittnotify__static_8h.html#a8b8dcd723308a8cb5d84277c7a3fff70">int</a>&#160;</td>
          <td class="paramname"><em>num_addrs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00173">173</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>

<p>Referenced by <a class="el" href="classhierarchy__info.html#a812ad40d00a154a8ecdee9e9daa546a5">init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                                          {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordtype">int</span> hier_depth = adr2os[0].<a class="code" href="classAddrUnsPair.html#a982f64b113d22417f89b279ec24f097e">first</a>.<a class="code" href="classAddress.html#a1adef13df4b328813a1bf4b92c56ee10">depth</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordtype">int</span> level = 0;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>=hier_depth-1; <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>&gt;=0; --<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="keywordtype">int</span> max = -1;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;num_addrs; ++j) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                <span class="keywordtype">int</span> <a class="code" href="structshared__common.html#aa54da923f39ba340f472b4a62205b967">next</a> = adr2os[j].<a class="code" href="classAddrUnsPair.html#a982f64b113d22417f89b279ec24f097e">first</a>.<a class="code" href="classAddress.html#aae88cf413f1d90429d34a23387a8fe81">childNums</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>];</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keywordflow">if</span> (next &gt; max) max = <a class="code" href="structshared__common.html#aa54da923f39ba340f472b4a62205b967">next</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[level] = max+1;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            ++level;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div>
<div class="ttc" id="kmp__stub_8c_html_a08582ce460e3d5e1cf0b7fea017d608e"><div class="ttname"><a href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="kmp__stub_8c_source.html#l00082">kmp_stub.c:82</a></div></div>
<div class="ttc" id="structshared__common_html_aa54da923f39ba340f472b4a62205b967"><div class="ttname"><a href="structshared__common.html#aa54da923f39ba340f472b4a62205b967">shared_common::next</a></div><div class="ttdeci">struct shared_common * next</div><div class="ttdef"><b>Definition:</b> <a href="kmp_8h_source.html#l01494">kmp.h:1494</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a12fc455d853883d91e3a19567aaac3fe"><div class="ttname"><a href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">hierarchy_info::numPerLevel</a></div><div class="ttdeci">kmp_uint32 * numPerLevel</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00170">kmp_affinity.h:170</a></div></div>
<div class="ttc" id="classAddrUnsPair_html_a982f64b113d22417f89b279ec24f097e"><div class="ttname"><a href="classAddrUnsPair.html#a982f64b113d22417f89b279ec24f097e">AddrUnsPair::first</a></div><div class="ttdeci">Address first</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00071">kmp_affinity.h:71</a></div></div>
<div class="ttc" id="classAddress_html_a1adef13df4b328813a1bf4b92c56ee10"><div class="ttname"><a href="classAddress.html#a1adef13df4b328813a1bf4b92c56ee10">Address::depth</a></div><div class="ttdeci">unsigned depth</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00025">kmp_affinity.h:25</a></div></div>
<div class="ttc" id="classAddress_html_aae88cf413f1d90429d34a23387a8fe81"><div class="ttname"><a href="classAddress.html#aae88cf413f1d90429d34a23387a8fe81">Address::childNums</a></div><div class="ttdeci">unsigned childNums[maxDepth]</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00024">kmp_affinity.h:24</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6bd94261d14cd3644006557a49cd4a11"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ittnotify__static_8h.html#af941d56e55e3c5465135b60c4d6343ed">void</a> hierarchy_info::fini </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00189">189</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>

<p>Referenced by <a class="el" href="kmp__affinity_8cpp.html#ae1270304d33ab083a416e67cab92dafc">__kmp_cleanup_hierarchy()</a>.</p>
<div class="fragment"><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;{ <span class="keywordflow">if</span> (!<a class="code" href="classhierarchy__info.html#a93f1e8f2ed894dc2477e5feb22d24c2c">uninitialized</a> &amp;&amp; <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>) <a class="code" href="kmp_8h.html#a052396231429341ba56a7c1ceacbaa2f">__kmp_free</a>(<a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>); }</div>
<div class="ttc" id="classhierarchy__info_html_a12fc455d853883d91e3a19567aaac3fe"><div class="ttname"><a href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">hierarchy_info::numPerLevel</a></div><div class="ttdeci">kmp_uint32 * numPerLevel</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00170">kmp_affinity.h:170</a></div></div>
<div class="ttc" id="kmp_8h_html_a052396231429341ba56a7c1ceacbaa2f"><div class="ttname"><a href="kmp_8h.html#a052396231429341ba56a7c1ceacbaa2f">__kmp_free</a></div><div class="ttdeci">#define __kmp_free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="kmp_8h_source.html#l02974">kmp.h:2974</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a93f1e8f2ed894dc2477e5feb22d24c2c"><div class="ttname"><a href="classhierarchy__info.html#a93f1e8f2ed894dc2477e5feb22d24c2c">hierarchy_info::uninitialized</a></div><div class="ttdeci">volatile kmp_int8 uninitialized</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00164">kmp_affinity.h:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a812ad40d00a154a8ecdee9e9daa546a5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ittnotify__static_8h.html#af941d56e55e3c5465135b60c4d6343ed">void</a> hierarchy_info::init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classAddrUnsPair.html">AddrUnsPair</a> *&#160;</td>
          <td class="paramname"><em>adr2os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ittnotify__static_8h.html#a8b8dcd723308a8cb5d84277c7a3fff70">int</a>&#160;</td>
          <td class="paramname"><em>num_addrs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00191">191</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>

<p>Referenced by <a class="el" href="kmp__affinity_8cpp.html#a3e762a8f344dc00cf1b1d9026919d3cb">__kmp_get_hierarchy()</a>.</p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        kmp_int8 bool_result = <a class="code" href="kmp__os_8h.html#a595d26e973de7e2012d0c93da326d08e">KMP_COMPARE_AND_STORE_ACQ8</a>(&amp;<a class="code" href="classhierarchy__info.html#a93f1e8f2ed894dc2477e5feb22d24c2c">uninitialized</a>, <a class="code" href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1ac0a8e5f501a8d2ecb151b0d46d71add8">not_initialized</a>, <a class="code" href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1ad3f87952fafc2375cad49ce25e04351c">initializing</a>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">if</span> (bool_result == 0) { <span class="comment">// Wait for initialization</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordflow">while</span> (<a class="code" href="kmp__os_8h.html#a33c84284b0f734b18cd53b0166240fcc">TCR_1</a>(<a class="code" href="classhierarchy__info.html#a93f1e8f2ed894dc2477e5feb22d24c2c">uninitialized</a>) != <a class="code" href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1a62492b533e6c2a820622602a0291dede">initialized</a>) <a class="code" href="kmp_8h.html#a0ae7084deafcd923a77e45e93058c459">KMP_CPU_PAUSE</a>();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <a class="code" href="kmp__debug_8h.html#ad766efc30e33e28634691088e80cdf08">KMP_DEBUG_ASSERT</a>(bool_result==1);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="comment">/* Added explicit initialization of the data fields here to prevent usage of dirty value</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">           observed when static library is re-initialized multiple times (e.g. when</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">           non-OpenMP thread repeatedly launches/joins thread that uses OpenMP). */</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="classhierarchy__info.html#aeebcad75a7d471e1b1fd37aab6216f22">depth</a> = 1;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="classhierarchy__info.html#afa2edd0b49e3c69a50f3bbebfbd4ad77">resizing</a> = 0;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">maxLevels</a> = 7;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a> = (kmp_uint32 *)<a class="code" href="kmp_8h.html#aa6a69b47037dcffbfc5dba21a4a64d85">__kmp_allocate</a>(<a class="code" href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">maxLevels</a>*2*<span class="keyword">sizeof</span>(kmp_uint32));</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a> = &amp;(<a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[<a class="code" href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">maxLevels</a>]);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">for</span> (kmp_uint32 <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>=0; <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>&lt;<a class="code" href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">maxLevels</a>; ++<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>) { <span class="comment">// init numPerLevel[*] to 1 item per level</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>] = 1;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>] = 1;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="comment">// Sort table by physical ID</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">if</span> (adr2os) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            qsort(adr2os, num_addrs, <span class="keyword">sizeof</span>(*adr2os), <a class="code" href="kmp__affinity_8h.html#adc724fec24e25e4ded8a920781f80574">__kmp_affinity_cmp_Address_labels</a>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <a class="code" href="classhierarchy__info.html#ab7d03fbfa83490719f2819e2e8149231">deriveLevels</a>(adr2os, num_addrs);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[0] = <a class="code" href="classhierarchy__info.html#a4122e10b5d763f2ca3f13076f836ddfe">maxLeaves</a>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[1] = num_addrs/<a class="code" href="classhierarchy__info.html#a4122e10b5d763f2ca3f13076f836ddfe">maxLeaves</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">if</span> (num_addrs%<a class="code" href="classhierarchy__info.html#a4122e10b5d763f2ca3f13076f836ddfe">maxLeaves</a>) <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[1]++;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="classhierarchy__info.html#a9055a443e8da4aefcfef1b5f1fd43b42">base_num_threads</a> = num_addrs;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>=maxLevels-1; <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>&gt;=0; --<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>) <span class="comment">// count non-empty levels to get depth</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>] != 1 || <a class="code" href="classhierarchy__info.html#aeebcad75a7d471e1b1fd37aab6216f22">depth</a> &gt; 1) <span class="comment">// only count one top-level &#39;1&#39;</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <a class="code" href="classhierarchy__info.html#aeebcad75a7d471e1b1fd37aab6216f22">depth</a>++;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        kmp_uint32 branch = <a class="code" href="classhierarchy__info.html#afe34e439673297d9ac44c43722c042f0">minBranch</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[0] == 1) branch = num_addrs/<a class="code" href="classhierarchy__info.html#a4122e10b5d763f2ca3f13076f836ddfe">maxLeaves</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">if</span> (branch&lt;<a class="code" href="classhierarchy__info.html#afe34e439673297d9ac44c43722c042f0">minBranch</a>) branch=<a class="code" href="classhierarchy__info.html#afe34e439673297d9ac44c43722c042f0">minBranch</a>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">for</span> (kmp_uint32 <a class="code" href="ittnotify__static_8h.html#a6b8793c3e5dd8bb67b04141713a65d2d">d</a>=0; <a class="code" href="ittnotify__static_8h.html#a6b8793c3e5dd8bb67b04141713a65d2d">d</a>&lt;<a class="code" href="classhierarchy__info.html#aeebcad75a7d471e1b1fd37aab6216f22">depth</a>-1; ++<a class="code" href="ittnotify__static_8h.html#a6b8793c3e5dd8bb67b04141713a65d2d">d</a>) { <span class="comment">// optimize hierarchy width</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="keywordflow">while</span> (<a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[<a class="code" href="ittnotify__static_8h.html#a6b8793c3e5dd8bb67b04141713a65d2d">d</a>] &gt; branch || (<a class="code" href="ittnotify__static_8h.html#a6b8793c3e5dd8bb67b04141713a65d2d">d</a>==0 &amp;&amp; <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[<a class="code" href="ittnotify__static_8h.html#a6b8793c3e5dd8bb67b04141713a65d2d">d</a>]&gt;<a class="code" href="classhierarchy__info.html#a4122e10b5d763f2ca3f13076f836ddfe">maxLeaves</a>)) { <span class="comment">// max 4 on level 0!</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[<a class="code" href="ittnotify__static_8h.html#a6b8793c3e5dd8bb67b04141713a65d2d">d</a>] &amp; 1) <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[<a class="code" href="ittnotify__static_8h.html#a6b8793c3e5dd8bb67b04141713a65d2d">d</a>]++;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[<a class="code" href="ittnotify__static_8h.html#a6b8793c3e5dd8bb67b04141713a65d2d">d</a>] = <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[<a class="code" href="ittnotify__static_8h.html#a6b8793c3e5dd8bb67b04141713a65d2d">d</a>] &gt;&gt; 1;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[d+1] == 1) depth++;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[d+1] = <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[d+1] &lt;&lt; 1;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[0] == 1) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                branch = branch &gt;&gt; 1;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <span class="keywordflow">if</span> (branch&lt;4) branch = <a class="code" href="classhierarchy__info.html#afe34e439673297d9ac44c43722c042f0">minBranch</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">for</span> (kmp_uint32 <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>=1; <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>&lt;<a class="code" href="classhierarchy__info.html#aeebcad75a7d471e1b1fd37aab6216f22">depth</a>; ++<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>] = <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>-1] * <a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>-1];</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="comment">// Fill in hierarchy in the case of oversubscription</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">for</span> (kmp_uint32 <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>=depth; <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>&lt;<a class="code" href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">maxLevels</a>; ++<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>)</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>] = 2*<a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>-1];</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <a class="code" href="classhierarchy__info.html#a93f1e8f2ed894dc2477e5feb22d24c2c">uninitialized</a> = <a class="code" href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1a62492b533e6c2a820622602a0291dede">initialized</a>; <span class="comment">// One writer</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    }</div>
<div class="ttc" id="classhierarchy__info_html_afe34e439673297d9ac44c43722c042f0"><div class="ttname"><a href="classhierarchy__info.html#afe34e439673297d9ac44c43722c042f0">hierarchy_info::minBranch</a></div><div class="ttdeci">static const kmp_uint32 minBranch</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00151">kmp_affinity.h:151</a></div></div>
<div class="ttc" id="classhierarchy__info_html_aeebcad75a7d471e1b1fd37aab6216f22"><div class="ttname"><a href="classhierarchy__info.html#aeebcad75a7d471e1b1fd37aab6216f22">hierarchy_info::depth</a></div><div class="ttdeci">kmp_uint32 depth</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00161">kmp_affinity.h:161</a></div></div>
<div class="ttc" id="kmp__stub_8c_html_a08582ce460e3d5e1cf0b7fea017d608e"><div class="ttname"><a href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="kmp__stub_8c_source.html#l00082">kmp_stub.c:82</a></div></div>
<div class="ttc" id="kmp__debug_8h_html_ad766efc30e33e28634691088e80cdf08"><div class="ttname"><a href="kmp__debug_8h.html#ad766efc30e33e28634691088e80cdf08">KMP_DEBUG_ASSERT</a></div><div class="ttdeci">#define KMP_DEBUG_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kmp__debug_8h_source.html#l00074">kmp_debug.h:74</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a4122e10b5d763f2ca3f13076f836ddfe"><div class="ttname"><a href="classhierarchy__info.html#a4122e10b5d763f2ca3f13076f836ddfe">hierarchy_info::maxLeaves</a></div><div class="ttdeci">static const kmp_uint32 maxLeaves</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00150">kmp_affinity.h:150</a></div></div>
<div class="ttc" id="classhierarchy__info_html_afa2edd0b49e3c69a50f3bbebfbd4ad77"><div class="ttname"><a href="classhierarchy__info.html#afa2edd0b49e3c69a50f3bbebfbd4ad77">hierarchy_info::resizing</a></div><div class="ttdeci">volatile kmp_int8 resizing</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00165">kmp_affinity.h:165</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a9055a443e8da4aefcfef1b5f1fd43b42"><div class="ttname"><a href="classhierarchy__info.html#a9055a443e8da4aefcfef1b5f1fd43b42">hierarchy_info::base_num_threads</a></div><div class="ttdeci">kmp_uint32 base_num_threads</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00162">kmp_affinity.h:162</a></div></div>
<div class="ttc" id="kmp__os_8h_html_a33c84284b0f734b18cd53b0166240fcc"><div class="ttname"><a href="kmp__os_8h.html#a33c84284b0f734b18cd53b0166240fcc">TCR_1</a></div><div class="ttdeci">#define TCR_1(a)</div><div class="ttdef"><b>Definition:</b> <a href="kmp__os_8h_source.html#l00581">kmp_os.h:581</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a12fc455d853883d91e3a19567aaac3fe"><div class="ttname"><a href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">hierarchy_info::numPerLevel</a></div><div class="ttdeci">kmp_uint32 * numPerLevel</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00170">kmp_affinity.h:170</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a72afd05b52405fca73987c898caaf5b1ad3f87952fafc2375cad49ce25e04351c"><div class="ttname"><a href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1ad3f87952fafc2375cad49ce25e04351c">hierarchy_info::initializing</a></div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00163">kmp_affinity.h:163</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a72afd05b52405fca73987c898caaf5b1ac0a8e5f501a8d2ecb151b0d46d71add8"><div class="ttname"><a href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1ac0a8e5f501a8d2ecb151b0d46d71add8">hierarchy_info::not_initialized</a></div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00163">kmp_affinity.h:163</a></div></div>
<div class="ttc" id="kmp__affinity_8h_html_adc724fec24e25e4ded8a920781f80574"><div class="ttname"><a href="kmp__affinity_8h.html#adc724fec24e25e4ded8a920781f80574">__kmp_affinity_cmp_Address_labels</a></div><div class="ttdeci">static int __kmp_affinity_cmp_Address_labels(const void *a, const void *b)</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00098">kmp_affinity.h:98</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a72afd05b52405fca73987c898caaf5b1a62492b533e6c2a820622602a0291dede"><div class="ttname"><a href="classhierarchy__info.html#a72afd05b52405fca73987c898caaf5b1a62492b533e6c2a820622602a0291dede">hierarchy_info::initialized</a></div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00163">kmp_affinity.h:163</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a80259c2cd48bb476b3eea860723e7fa8"><div class="ttname"><a href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">hierarchy_info::skipPerLevel</a></div><div class="ttdeci">kmp_uint32 * skipPerLevel</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00171">kmp_affinity.h:171</a></div></div>
<div class="ttc" id="kmp_8h_html_a0ae7084deafcd923a77e45e93058c459"><div class="ttname"><a href="kmp_8h.html#a0ae7084deafcd923a77e45e93058c459">KMP_CPU_PAUSE</a></div><div class="ttdeci">#define KMP_CPU_PAUSE()</div><div class="ttdef"><b>Definition:</b> <a href="kmp_8h_source.html#l01139">kmp.h:1139</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a93f1e8f2ed894dc2477e5feb22d24c2c"><div class="ttname"><a href="classhierarchy__info.html#a93f1e8f2ed894dc2477e5feb22d24c2c">hierarchy_info::uninitialized</a></div><div class="ttdeci">volatile kmp_int8 uninitialized</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00164">kmp_affinity.h:164</a></div></div>
<div class="ttc" id="kmp_8h_html_aa6a69b47037dcffbfc5dba21a4a64d85"><div class="ttname"><a href="kmp_8h.html#aa6a69b47037dcffbfc5dba21a4a64d85">__kmp_allocate</a></div><div class="ttdeci">#define __kmp_allocate(size)</div><div class="ttdef"><b>Definition:</b> <a href="kmp_8h_source.html#l02972">kmp.h:2972</a></div></div>
<div class="ttc" id="kmp__os_8h_html_a595d26e973de7e2012d0c93da326d08e"><div class="ttname"><a href="kmp__os_8h.html#a595d26e973de7e2012d0c93da326d08e">KMP_COMPARE_AND_STORE_ACQ8</a></div><div class="ttdeci">#define KMP_COMPARE_AND_STORE_ACQ8(p, cv, sv)</div><div class="ttdef"><b>Definition:</b> <a href="kmp__os_8h_source.html#l00428">kmp_os.h:428</a></div></div>
<div class="ttc" id="classhierarchy__info_html_ab7d03fbfa83490719f2819e2e8149231"><div class="ttname"><a href="classhierarchy__info.html#ab7d03fbfa83490719f2819e2e8149231">hierarchy_info::deriveLevels</a></div><div class="ttdeci">void deriveLevels(AddrUnsPair *adr2os, int num_addrs)</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00173">kmp_affinity.h:173</a></div></div>
<div class="ttc" id="classhierarchy__info_html_aafbad4b89a239ea459aaef1ab4908aba"><div class="ttname"><a href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">hierarchy_info::maxLevels</a></div><div class="ttdeci">kmp_uint32 maxLevels</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00156">kmp_affinity.h:156</a></div></div>
<div class="ttc" id="ittnotify__static_8h_html_a6b8793c3e5dd8bb67b04141713a65d2d"><div class="ttname"><a href="ittnotify__static_8h.html#a6b8793c3e5dd8bb67b04141713a65d2d">d</a></div><div class="ttdeci">void const wchar_t const wchar_t int ITT_FORMAT __itt_group_sync x void const wchar_t ITT_FORMAT __itt_group_sync S void ITT_FORMAT p void ITT_FORMAT p unsigned int ITT_FORMAT p __itt_suppress_mode_t unsigned int void size_t ITT_FORMAT d</div><div class="ttdef"><b>Definition:</b> <a href="ittnotify__static_8h_source.html#l00085">ittnotify_static.h:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a85116254d0daac14aa741e3cdb213f8b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ittnotify__static_8h.html#af941d56e55e3c5465135b60c4d6343ed">void</a> hierarchy_info::resize </td>
          <td>(</td>
          <td class="paramtype">kmp_uint32&#160;</td>
          <td class="paramname"><em>nproc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00256">256</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>

<p>Referenced by <a class="el" href="kmp__affinity_8cpp.html#a3e762a8f344dc00cf1b1d9026919d3cb">__kmp_get_hierarchy()</a>.</p>
<div class="fragment"><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        kmp_int8 bool_result = <a class="code" href="kmp__os_8h.html#a595d26e973de7e2012d0c93da326d08e">KMP_COMPARE_AND_STORE_ACQ8</a>(&amp;<a class="code" href="classhierarchy__info.html#afa2edd0b49e3c69a50f3bbebfbd4ad77">resizing</a>, 0, 1);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">while</span> (bool_result == 0) { <span class="comment">// someone else is trying to resize</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <a class="code" href="kmp_8h.html#a0ae7084deafcd923a77e45e93058c459">KMP_CPU_PAUSE</a>();</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="keywordflow">if</span> (nproc &lt;= <a class="code" href="classhierarchy__info.html#a9055a443e8da4aefcfef1b5f1fd43b42">base_num_threads</a>)  <span class="comment">// happy with other thread&#39;s resize</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="keywordflow">else</span> <span class="comment">// try to resize</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                bool_result = <a class="code" href="kmp__os_8h.html#a595d26e973de7e2012d0c93da326d08e">KMP_COMPARE_AND_STORE_ACQ8</a>(&amp;<a class="code" href="classhierarchy__info.html#afa2edd0b49e3c69a50f3bbebfbd4ad77">resizing</a>, 0, 1);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="kmp__debug_8h.html#ad766efc30e33e28634691088e80cdf08">KMP_DEBUG_ASSERT</a>(bool_result!=0);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">if</span> (nproc &lt;= <a class="code" href="classhierarchy__info.html#a9055a443e8da4aefcfef1b5f1fd43b42">base_num_threads</a>) <span class="keywordflow">return</span>; <span class="comment">// happy with other thread&#39;s resize</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">// Calculate new maxLevels</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        kmp_uint32 old_sz = <a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a>[<a class="code" href="classhierarchy__info.html#aeebcad75a7d471e1b1fd37aab6216f22">depth</a>-1];</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        kmp_uint32 incs = 0, old_maxLevels = <a class="code" href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">maxLevels</a>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">// First see if old maxLevels is enough to contain new size</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">for</span> (kmp_uint32 <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>=<a class="code" href="classhierarchy__info.html#aeebcad75a7d471e1b1fd37aab6216f22">depth</a>; i&lt;maxLevels &amp;&amp; nproc&gt;old_sz; ++<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>] = 2*<a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>-1];</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>-1] *= 2;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            old_sz *= 2;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <a class="code" href="classhierarchy__info.html#aeebcad75a7d471e1b1fd37aab6216f22">depth</a>++;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">if</span> (nproc &gt; old_sz) { <span class="comment">// Not enough space, need to expand hierarchy</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordflow">while</span> (nproc &gt; old_sz) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                old_sz *=2;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                incs++;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                <a class="code" href="classhierarchy__info.html#aeebcad75a7d471e1b1fd37aab6216f22">depth</a>++;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <a class="code" href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">maxLevels</a> += incs;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="comment">// Resize arrays</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            kmp_uint32 *old_numPerLevel = <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            kmp_uint32 *old_skipPerLevel = <a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a> = <a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a> = NULL;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a> = (kmp_uint32 *)<a class="code" href="kmp_8h.html#aa6a69b47037dcffbfc5dba21a4a64d85">__kmp_allocate</a>(<a class="code" href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">maxLevels</a>*2*<span class="keyword">sizeof</span>(kmp_uint32));</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a> = &amp;(<a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[<a class="code" href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">maxLevels</a>]);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="comment">// Copy old elements from old arrays</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="keywordflow">for</span> (kmp_uint32 <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>=0; <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>&lt;old_maxLevels; ++<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>) { <span class="comment">// init numPerLevel[*] to 1 item per level</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>] = old_numPerLevel[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>];</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>] = old_skipPerLevel[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>];</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="comment">// Init new elements in arrays to 1</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordflow">for</span> (kmp_uint32 <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>=old_maxLevels; <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>&lt;<a class="code" href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">maxLevels</a>; ++<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>) { <span class="comment">// init numPerLevel[*] to 1 item per level</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <a class="code" href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">numPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>] = 1;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>] = 1;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="comment">// Free old arrays</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <a class="code" href="kmp_8h.html#a052396231429341ba56a7c1ceacbaa2f">__kmp_free</a>(old_numPerLevel);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="comment">// Fill in oversubscription levels of hierarchy</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">for</span> (kmp_uint32 <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>=old_maxLevels; <a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>&lt;<a class="code" href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">maxLevels</a>; ++<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>] = 2*<a class="code" href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">skipPerLevel</a>[<a class="code" href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a>-1];</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <a class="code" href="classhierarchy__info.html#a9055a443e8da4aefcfef1b5f1fd43b42">base_num_threads</a> = nproc;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <a class="code" href="classhierarchy__info.html#afa2edd0b49e3c69a50f3bbebfbd4ad77">resizing</a> = 0; <span class="comment">// One writer</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div>
<div class="ttc" id="classhierarchy__info_html_aeebcad75a7d471e1b1fd37aab6216f22"><div class="ttname"><a href="classhierarchy__info.html#aeebcad75a7d471e1b1fd37aab6216f22">hierarchy_info::depth</a></div><div class="ttdeci">kmp_uint32 depth</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00161">kmp_affinity.h:161</a></div></div>
<div class="ttc" id="kmp__stub_8c_html_a08582ce460e3d5e1cf0b7fea017d608e"><div class="ttname"><a href="kmp__stub_8c.html#a08582ce460e3d5e1cf0b7fea017d608e">i</a></div><div class="ttdeci">#define i</div><div class="ttdef"><b>Definition:</b> <a href="kmp__stub_8c_source.html#l00082">kmp_stub.c:82</a></div></div>
<div class="ttc" id="kmp__debug_8h_html_ad766efc30e33e28634691088e80cdf08"><div class="ttname"><a href="kmp__debug_8h.html#ad766efc30e33e28634691088e80cdf08">KMP_DEBUG_ASSERT</a></div><div class="ttdeci">#define KMP_DEBUG_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kmp__debug_8h_source.html#l00074">kmp_debug.h:74</a></div></div>
<div class="ttc" id="classhierarchy__info_html_afa2edd0b49e3c69a50f3bbebfbd4ad77"><div class="ttname"><a href="classhierarchy__info.html#afa2edd0b49e3c69a50f3bbebfbd4ad77">hierarchy_info::resizing</a></div><div class="ttdeci">volatile kmp_int8 resizing</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00165">kmp_affinity.h:165</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a9055a443e8da4aefcfef1b5f1fd43b42"><div class="ttname"><a href="classhierarchy__info.html#a9055a443e8da4aefcfef1b5f1fd43b42">hierarchy_info::base_num_threads</a></div><div class="ttdeci">kmp_uint32 base_num_threads</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00162">kmp_affinity.h:162</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a12fc455d853883d91e3a19567aaac3fe"><div class="ttname"><a href="classhierarchy__info.html#a12fc455d853883d91e3a19567aaac3fe">hierarchy_info::numPerLevel</a></div><div class="ttdeci">kmp_uint32 * numPerLevel</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00170">kmp_affinity.h:170</a></div></div>
<div class="ttc" id="classhierarchy__info_html_a80259c2cd48bb476b3eea860723e7fa8"><div class="ttname"><a href="classhierarchy__info.html#a80259c2cd48bb476b3eea860723e7fa8">hierarchy_info::skipPerLevel</a></div><div class="ttdeci">kmp_uint32 * skipPerLevel</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00171">kmp_affinity.h:171</a></div></div>
<div class="ttc" id="kmp_8h_html_a0ae7084deafcd923a77e45e93058c459"><div class="ttname"><a href="kmp_8h.html#a0ae7084deafcd923a77e45e93058c459">KMP_CPU_PAUSE</a></div><div class="ttdeci">#define KMP_CPU_PAUSE()</div><div class="ttdef"><b>Definition:</b> <a href="kmp_8h_source.html#l01139">kmp.h:1139</a></div></div>
<div class="ttc" id="kmp_8h_html_a052396231429341ba56a7c1ceacbaa2f"><div class="ttname"><a href="kmp_8h.html#a052396231429341ba56a7c1ceacbaa2f">__kmp_free</a></div><div class="ttdeci">#define __kmp_free(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="kmp_8h_source.html#l02974">kmp.h:2974</a></div></div>
<div class="ttc" id="kmp_8h_html_aa6a69b47037dcffbfc5dba21a4a64d85"><div class="ttname"><a href="kmp_8h.html#aa6a69b47037dcffbfc5dba21a4a64d85">__kmp_allocate</a></div><div class="ttdeci">#define __kmp_allocate(size)</div><div class="ttdef"><b>Definition:</b> <a href="kmp_8h_source.html#l02972">kmp.h:2972</a></div></div>
<div class="ttc" id="kmp__os_8h_html_a595d26e973de7e2012d0c93da326d08e"><div class="ttname"><a href="kmp__os_8h.html#a595d26e973de7e2012d0c93da326d08e">KMP_COMPARE_AND_STORE_ACQ8</a></div><div class="ttdeci">#define KMP_COMPARE_AND_STORE_ACQ8(p, cv, sv)</div><div class="ttdef"><b>Definition:</b> <a href="kmp__os_8h_source.html#l00428">kmp_os.h:428</a></div></div>
<div class="ttc" id="classhierarchy__info_html_aafbad4b89a239ea459aaef1ab4908aba"><div class="ttname"><a href="classhierarchy__info.html#aafbad4b89a239ea459aaef1ab4908aba">hierarchy_info::maxLevels</a></div><div class="ttdeci">kmp_uint32 maxLevels</div><div class="ttdef"><b>Definition:</b> <a href="kmp__affinity_8h_source.html#l00156">kmp_affinity.h:156</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a9055a443e8da4aefcfef1b5f1fd43b42"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">kmp_uint32 hierarchy_info::base_num_threads</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00162">162</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>

<p>Referenced by <a class="el" href="kmp__affinity_8cpp.html#a3e762a8f344dc00cf1b1d9026919d3cb">__kmp_get_hierarchy()</a>, <a class="el" href="classhierarchy__info.html#a812ad40d00a154a8ecdee9e9daa546a5">init()</a>, and <a class="el" href="classhierarchy__info.html#a85116254d0daac14aa741e3cdb213f8b">resize()</a>.</p>

</div>
</div>
<a class="anchor" id="aeebcad75a7d471e1b1fd37aab6216f22"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">kmp_uint32 hierarchy_info::depth</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is specifically the depth of the machine configuration hierarchy, in terms of the number of levels along the longest path from root to any leaf. It corresponds to the number of entries in numPerLevel if we exclude all but one trailing 1. </p>

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00161">161</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>

<p>Referenced by <a class="el" href="kmp__affinity_8cpp.html#a3e762a8f344dc00cf1b1d9026919d3cb">__kmp_get_hierarchy()</a>, <a class="el" href="classhierarchy__info.html#a812ad40d00a154a8ecdee9e9daa546a5">init()</a>, and <a class="el" href="classhierarchy__info.html#a85116254d0daac14aa741e3cdb213f8b">resize()</a>.</p>

</div>
</div>
<a class="anchor" id="a4122e10b5d763f2ca3f13076f836ddfe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const kmp_uint32 hierarchy_info::maxLeaves =4</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Good default values for number of leaves and branching factor, given no affinity information. Behaves a bit like hyper barrier. </p>

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00150">150</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>

<p>Referenced by <a class="el" href="classhierarchy__info.html#a812ad40d00a154a8ecdee9e9daa546a5">init()</a>.</p>

</div>
</div>
<a class="anchor" id="aafbad4b89a239ea459aaef1ab4908aba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">kmp_uint32 hierarchy_info::maxLevels</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of levels in the hierarchy. Typical levels are threads/core, cores/package or socket, packages/node, nodes/machine, etc. We don't want to get specific with nomenclature. When the machine is oversubscribed we add levels to duplicate the hierarchy, doubling the thread capacity of the hierarchy each time we add a level. </p>

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00156">156</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>

<p>Referenced by <a class="el" href="classhierarchy__info.html#a812ad40d00a154a8ecdee9e9daa546a5">init()</a>, and <a class="el" href="classhierarchy__info.html#a85116254d0daac14aa741e3cdb213f8b">resize()</a>.</p>

</div>
</div>
<a class="anchor" id="afe34e439673297d9ac44c43722c042f0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const kmp_uint32 hierarchy_info::minBranch =4</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00151">151</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>

<p>Referenced by <a class="el" href="classhierarchy__info.html#a812ad40d00a154a8ecdee9e9daa546a5">init()</a>.</p>

</div>
</div>
<a class="anchor" id="a12fc455d853883d91e3a19567aaac3fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">kmp_uint32* hierarchy_info::numPerLevel</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Level 0 corresponds to leaves. numPerLevel[i] is the number of children the parent of a node at level i has. For example, if we have a machine with 4 packages, 4 cores/package and 2 HT per core, then numPerLevel = {2, 4, 4, 1, 1}. All empty levels are set to 1. </p>

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00170">170</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>

<p>Referenced by <a class="el" href="kmp__affinity_8cpp.html#a3e762a8f344dc00cf1b1d9026919d3cb">__kmp_get_hierarchy()</a>, <a class="el" href="classhierarchy__info.html#ab7d03fbfa83490719f2819e2e8149231">deriveLevels()</a>, <a class="el" href="classhierarchy__info.html#a6bd94261d14cd3644006557a49cd4a11">fini()</a>, <a class="el" href="classhierarchy__info.html#a812ad40d00a154a8ecdee9e9daa546a5">init()</a>, and <a class="el" href="classhierarchy__info.html#a85116254d0daac14aa741e3cdb213f8b">resize()</a>.</p>

</div>
</div>
<a class="anchor" id="afa2edd0b49e3c69a50f3bbebfbd4ad77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile kmp_int8 hierarchy_info::resizing</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00165">165</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>

<p>Referenced by <a class="el" href="classhierarchy__info.html#a812ad40d00a154a8ecdee9e9daa546a5">init()</a>, and <a class="el" href="classhierarchy__info.html#a85116254d0daac14aa741e3cdb213f8b">resize()</a>.</p>

</div>
</div>
<a class="anchor" id="a80259c2cd48bb476b3eea860723e7fa8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">kmp_uint32* hierarchy_info::skipPerLevel</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00171">171</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>

<p>Referenced by <a class="el" href="kmp__affinity_8cpp.html#a3e762a8f344dc00cf1b1d9026919d3cb">__kmp_get_hierarchy()</a>, <a class="el" href="classhierarchy__info.html#a812ad40d00a154a8ecdee9e9daa546a5">init()</a>, and <a class="el" href="classhierarchy__info.html#a85116254d0daac14aa741e3cdb213f8b">resize()</a>.</p>

</div>
</div>
<a class="anchor" id="a93f1e8f2ed894dc2477e5feb22d24c2c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile kmp_int8 hierarchy_info::uninitialized</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="kmp__affinity_8h_source.html#l00164">164</a> of file <a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a>.</p>

<p>Referenced by <a class="el" href="kmp__affinity_8cpp.html#a3e762a8f344dc00cf1b1d9026919d3cb">__kmp_get_hierarchy()</a>, <a class="el" href="classhierarchy__info.html#a6bd94261d14cd3644006557a49cd4a11">fini()</a>, and <a class="el" href="classhierarchy__info.html#a812ad40d00a154a8ecdee9e9daa546a5">init()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="kmp__affinity_8h_source.html">kmp_affinity.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Aug 17 2016 17:14:10 for LLVM OpenMP* Runtime Library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
