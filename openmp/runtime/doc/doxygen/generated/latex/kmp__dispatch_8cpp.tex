\hypertarget{kmp__dispatch_8cpp}{\section{kmp\-\_\-dispatch.\-cpp File Reference}
\label{kmp__dispatch_8cpp}\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}}
}
{\ttfamily \#include \char`\"{}kmp.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-i18n.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-itt.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-str.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-error.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-stats.\-h\char`\"{}}\\*
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structi__maxmin}{i\-\_\-maxmin$<$ T $>$}
\item 
struct \hyperlink{structi__maxmin_3_01int_01_4}{i\-\_\-maxmin$<$ int $>$}
\item 
struct \hyperlink{structi__maxmin_3_01unsigned_01int_01_4}{i\-\_\-maxmin$<$ unsigned int $>$}
\item 
struct \hyperlink{structi__maxmin_3_01long_01long_01_4}{i\-\_\-maxmin$<$ long long $>$}
\item 
struct \hyperlink{structi__maxmin_3_01unsigned_01long_01long_01_4}{i\-\_\-maxmin$<$ unsigned long long $>$}
\item 
struct \hyperlink{structdispatch__private__infoXX__template}{dispatch\-\_\-private\-\_\-info\-X\-X\-\_\-template$<$ T $>$}
\item 
struct \hyperlink{structdispatch__private__info__template}{dispatch\-\_\-private\-\_\-info\-\_\-template$<$ T $>$}
\item 
union \hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl}{dispatch\-\_\-private\-\_\-info\-\_\-template$<$ T $>$\-::private\-\_\-info\-\_\-tmpl}
\item 
struct \hyperlink{structdispatch__shared__infoXX__template}{dispatch\-\_\-shared\-\_\-info\-X\-X\-\_\-template$<$ U\-T $>$}
\item 
struct \hyperlink{structdispatch__shared__info__template}{dispatch\-\_\-shared\-\_\-info\-\_\-template$<$ U\-T $>$}
\item 
union \hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl}{dispatch\-\_\-shared\-\_\-info\-\_\-template$<$ U\-T $>$\-::shared\-\_\-info\-\_\-tmpl}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{kmp__dispatch_8cpp_a0fae686f1908344ce3f13a95bea3f242}{G\-U\-I\-D\-E\-D\-\_\-\-A\-N\-A\-L\-Y\-T\-I\-C\-A\-L\-\_\-\-W\-O\-R\-K\-A\-R\-O\-U\-N\-D}~(\hyperlink{ittnotify__static_8h_a25eb27b280775b27a5ddc4d1673225aa}{x})
\item 
\#define \hyperlink{kmp__dispatch_8cpp_a11568d85642b5813503752538a5a9c73}{O\-M\-P\-T\-\_\-\-L\-O\-O\-P\-\_\-\-E\-N\-D}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename T $>$ }\\static \-\_\-\-\_\-forceinline T \hyperlink{kmp__dispatch_8cpp_ac83edd517b2d8882fce640b5040efcab}{test\-\_\-then\-\_\-add} (volatile T $\ast$\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p}, T \hyperlink{ittnotify__static_8h_a6b8793c3e5dd8bb67b04141713a65d2d}{d})
\item 
{\footnotesize template$<$$>$ }\\\-\_\-\-\_\-forceinline kmp\-\_\-int32 \hyperlink{kmp__dispatch_8cpp_ad1ef2bfd50602d9adeff01ea7579afc3}{test\-\_\-then\-\_\-add$<$ kmp\-\_\-int32 $>$} (volatile kmp\-\_\-int32 $\ast$\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p}, kmp\-\_\-int32 \hyperlink{ittnotify__static_8h_a6b8793c3e5dd8bb67b04141713a65d2d}{d})
\item 
{\footnotesize template$<$$>$ }\\\-\_\-\-\_\-forceinline kmp\-\_\-int64 \hyperlink{kmp__dispatch_8cpp_a66f960eba9cdec2919b779d4b407ceb9}{test\-\_\-then\-\_\-add$<$ kmp\-\_\-int64 $>$} (volatile kmp\-\_\-int64 $\ast$\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p}, kmp\-\_\-int64 \hyperlink{ittnotify__static_8h_a6b8793c3e5dd8bb67b04141713a65d2d}{d})
\item 
{\footnotesize template$<$typename T $>$ }\\static \-\_\-\-\_\-forceinline T \hyperlink{kmp__dispatch_8cpp_a60cf9ec235a5f35ab58e55bd5645c836}{test\-\_\-then\-\_\-inc\-\_\-acq} (volatile T $\ast$\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p})
\item 
{\footnotesize template$<$$>$ }\\\-\_\-\-\_\-forceinline kmp\-\_\-int32 \hyperlink{kmp__dispatch_8cpp_a99b3d841f800545b571be6a7840406c9}{test\-\_\-then\-\_\-inc\-\_\-acq$<$ kmp\-\_\-int32 $>$} (volatile kmp\-\_\-int32 $\ast$\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p})
\item 
{\footnotesize template$<$$>$ }\\\-\_\-\-\_\-forceinline kmp\-\_\-int64 \hyperlink{kmp__dispatch_8cpp_a1c6ce0de613a6b31caa6ff95337e13a4}{test\-\_\-then\-\_\-inc\-\_\-acq$<$ kmp\-\_\-int64 $>$} (volatile kmp\-\_\-int64 $\ast$\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p})
\item 
{\footnotesize template$<$typename T $>$ }\\static \-\_\-\-\_\-forceinline T \hyperlink{kmp__dispatch_8cpp_aa5246687602dcad8f78f649f404f03dc}{test\-\_\-then\-\_\-inc} (volatile T $\ast$\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p})
\item 
{\footnotesize template$<$$>$ }\\\-\_\-\-\_\-forceinline kmp\-\_\-int32 \hyperlink{kmp__dispatch_8cpp_a325e8f0eb4c8fb5629f1c4420cc5a3b6}{test\-\_\-then\-\_\-inc$<$ kmp\-\_\-int32 $>$} (volatile kmp\-\_\-int32 $\ast$\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p})
\item 
{\footnotesize template$<$$>$ }\\\-\_\-\-\_\-forceinline kmp\-\_\-int64 \hyperlink{kmp__dispatch_8cpp_a7adb4c762be99b08465c6686cd004000}{test\-\_\-then\-\_\-inc$<$ kmp\-\_\-int64 $>$} (volatile kmp\-\_\-int64 $\ast$\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p})
\item 
{\footnotesize template$<$typename T $>$ }\\static \-\_\-\-\_\-forceinline kmp\-\_\-int32 \hyperlink{kmp__dispatch_8cpp_a91d1e5b674d9e07f4ea98645fb37a9e4}{compare\-\_\-and\-\_\-swap} (volatile T $\ast$\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p}, T c, T \hyperlink{ittnotify__static_8h_a110bd9ede250f97ce56d81bb3c7b171d}{s})
\item 
{\footnotesize template$<$$>$ }\\\-\_\-\-\_\-forceinline kmp\-\_\-int32 \hyperlink{kmp__dispatch_8cpp_ae95aeef3a0c2ca9c42a645a3fdc5f999}{compare\-\_\-and\-\_\-swap$<$ kmp\-\_\-int32 $>$} (volatile kmp\-\_\-int32 $\ast$\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p}, kmp\-\_\-int32 c, kmp\-\_\-int32 \hyperlink{ittnotify__static_8h_a110bd9ede250f97ce56d81bb3c7b171d}{s})
\item 
{\footnotesize template$<$$>$ }\\\-\_\-\-\_\-forceinline kmp\-\_\-int32 \hyperlink{kmp__dispatch_8cpp_ab9ac8baea0c47de636ea7ae008688ffc}{compare\-\_\-and\-\_\-swap$<$ kmp\-\_\-int64 $>$} (volatile kmp\-\_\-int64 $\ast$\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p}, kmp\-\_\-int64 c, kmp\-\_\-int64 \hyperlink{ittnotify__static_8h_a110bd9ede250f97ce56d81bb3c7b171d}{s})
\item 
{\footnotesize template$<$typename U\-T $>$ }\\static U\-T \hyperlink{kmp__dispatch_8cpp_aef9590be7463f2f7dd1261f024e2e778}{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-yield} (volatile U\-T $\ast$spinner, U\-T checker, kmp\-\_\-uint32($\ast$pred)(U\-T, U\-T) \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{U\-S\-E\-\_\-\-I\-T\-T\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-R\-G}(\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$obj))
\item 
{\footnotesize template$<$typename U\-T $>$ }\\static kmp\-\_\-uint32 \hyperlink{kmp__dispatch_8cpp_a8538de09370075eaa1616cb7ddaa67e0}{\-\_\-\-\_\-kmp\-\_\-eq} (U\-T value, U\-T checker)
\item 
{\footnotesize template$<$typename U\-T $>$ }\\static kmp\-\_\-uint32 \hyperlink{kmp__dispatch_8cpp_a39b40e43c3b1b7162e1118e420c778b9}{\-\_\-\-\_\-kmp\-\_\-neq} (U\-T value, U\-T checker)
\item 
{\footnotesize template$<$typename U\-T $>$ }\\static kmp\-\_\-uint32 \hyperlink{kmp__dispatch_8cpp_a1d5a1fe3473189d2d72f53448b7fb5af}{\-\_\-\-\_\-kmp\-\_\-lt} (U\-T value, U\-T checker)
\item 
{\footnotesize template$<$typename U\-T $>$ }\\static kmp\-\_\-uint32 \hyperlink{kmp__dispatch_8cpp_ab3d3d8387d89a8425420e1f4f79ca605}{\-\_\-\-\_\-kmp\-\_\-ge} (U\-T value, U\-T checker)
\item 
{\footnotesize template$<$typename U\-T $>$ }\\static kmp\-\_\-uint32 \hyperlink{kmp__dispatch_8cpp_adcf2413c78ef466a9382b9d2a1deb1b0}{\-\_\-\-\_\-kmp\-\_\-le} (U\-T value, U\-T checker)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__dispatch_8cpp_ab1d683d42af758adcb691a6c5386f955}{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-deo\-\_\-error} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} $\ast$gtid\-\_\-ref, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} $\ast$cid\-\_\-ref, \hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc\-\_\-ref)
\item 
{\footnotesize template$<$typename U\-T $>$ }\\static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__dispatch_8cpp_a98e6aa0445bf147cea7d2ce8857170f0}{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-deo} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} $\ast$gtid\-\_\-ref, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} $\ast$cid\-\_\-ref, \hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc\-\_\-ref)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__dispatch_8cpp_ac5d9718495f3304a6d04de7bf4b86309}{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-dxo\-\_\-error} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} $\ast$gtid\-\_\-ref, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} $\ast$cid\-\_\-ref, \hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc\-\_\-ref)
\item 
{\footnotesize template$<$typename U\-T $>$ }\\static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__dispatch_8cpp_aa5b8615d9ec84accdd92042f71640699}{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-dxo} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} $\ast$gtid\-\_\-ref, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} $\ast$cid\-\_\-ref, \hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc\-\_\-ref)
\item 
{\footnotesize template$<$typename U\-T $>$ }\\static \-\_\-\-\_\-forceinline long double \hyperlink{kmp__dispatch_8cpp_ac08bc90a1f5a11934bcaf5760bf307f1}{\-\_\-\-\_\-kmp\-\_\-pow} (long double \hyperlink{ittnotify__static_8h_a25eb27b280775b27a5ddc4d1673225aa}{x}, U\-T y)
\item 
{\footnotesize template$<$typename T $>$ }\\static \-\_\-\-\_\-inline traits\-\_\-t$<$ T $>$\\*
\-::unsigned\-\_\-t \hyperlink{kmp__dispatch_8cpp_a0c219c6a43aa6c80e170c8baaa813de8}{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-guided\-\_\-remaining} (T tc, typename traits\-\_\-t$<$ T $>$\-::floating\-\_\-t base, typename traits\-\_\-t$<$ T $>$\-::unsigned\-\_\-t idx)
\item 
{\footnotesize template$<$typename T $>$ }\\static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__dispatch_8cpp_ad604dd0d1db785e25c9a9c113ac3a166}{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-init} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} gtid, enum \hyperlink{group__WORK__SHARING_gadcaf200537aaa0218a60c398438f81be}{sched\-\_\-type} schedule, T lb, T ub, typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t st, typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t chunk, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} push\-\_\-ws)
\item 
{\footnotesize template$<$typename U\-T $>$ }\\static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__dispatch_8cpp_aa124c5ab7d5fe3330cc7a8d8bb4d7903}{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-finish} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} gtid, \hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc)
\item 
{\footnotesize template$<$typename T $>$ }\\static \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{kmp__dispatch_8cpp_a4bd3681186a30c88e2f1da0242c4e69d}{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-next} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} gtid, kmp\-\_\-int32 $\ast$p\-\_\-last, T $\ast$p\-\_\-lb, T $\ast$p\-\_\-ub, typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t $\ast$p\-\_\-st)
\item 
{\footnotesize template$<$typename T $>$ }\\static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__dispatch_8cpp_ac05d836d7cfe4e63e04fe8002ce58b8f}{\-\_\-\-\_\-kmp\-\_\-dist\-\_\-get\-\_\-bounds} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 $\ast$plastiter, T $\ast$plower, T $\ast$pupper, typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t incr)
\item 
kmp\-\_\-uint32 \hyperlink{kmp__dispatch_8cpp_a4fdf7443cbc5230889201c7cb83f5cfc}{\-\_\-\-\_\-kmp\-\_\-eq\-\_\-4} (kmp\-\_\-uint32 value, kmp\-\_\-uint32 checker)
\item 
kmp\-\_\-uint32 \hyperlink{kmp__dispatch_8cpp_ab9e91c3377af2c1678dbd5e2dbd21aaa}{\-\_\-\-\_\-kmp\-\_\-neq\-\_\-4} (kmp\-\_\-uint32 value, kmp\-\_\-uint32 checker)
\item 
kmp\-\_\-uint32 \hyperlink{kmp__dispatch_8cpp_a7b9c106e652273ae3ace02e5cf54f652}{\-\_\-\-\_\-kmp\-\_\-lt\-\_\-4} (kmp\-\_\-uint32 value, kmp\-\_\-uint32 checker)
\item 
kmp\-\_\-uint32 \hyperlink{kmp__dispatch_8cpp_a0c247de17cd15138135bfd171d1f0765}{\-\_\-\-\_\-kmp\-\_\-ge\-\_\-4} (kmp\-\_\-uint32 value, kmp\-\_\-uint32 checker)
\item 
kmp\-\_\-uint32 \hyperlink{kmp__dispatch_8cpp_acba4cc83a5ab80e907946dc5e9813142}{\-\_\-\-\_\-kmp\-\_\-le\-\_\-4} (kmp\-\_\-uint32 value, kmp\-\_\-uint32 checker)
\item 
kmp\-\_\-uint32 \hyperlink{kmp__dispatch_8cpp_a1e3aca5b5d46360422f901c4e3c0e6fd}{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-yield\-\_\-4} (volatile kmp\-\_\-uint32 $\ast$spinner, kmp\-\_\-uint32 checker, kmp\-\_\-uint32($\ast$pred)(kmp\-\_\-uint32, kmp\-\_\-uint32), \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$obj)
\end{DoxyCompactItemize}
{\bf }\par
\begin{DoxyCompactItemize}
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_gae991c61cbe8e2942fe1f757a65442b26}{\-\_\-\-\_\-kmpc\-\_\-dispatch\-\_\-init\-\_\-4} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, enum \hyperlink{group__WORK__SHARING_gadcaf200537aaa0218a60c398438f81be}{sched\-\_\-type} schedule, kmp\-\_\-int32 lb, kmp\-\_\-int32 ub, kmp\-\_\-int32 st, kmp\-\_\-int32 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_gaed75fbf8e655bc644d585a48e810bcfc}{\-\_\-\-\_\-kmpc\-\_\-dispatch\-\_\-init\-\_\-4u} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, enum \hyperlink{group__WORK__SHARING_gadcaf200537aaa0218a60c398438f81be}{sched\-\_\-type} schedule, kmp\-\_\-uint32 lb, kmp\-\_\-uint32 ub, kmp\-\_\-int32 st, kmp\-\_\-int32 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_gafb31932f7af41b5db5e7d80b21926853}{\-\_\-\-\_\-kmpc\-\_\-dispatch\-\_\-init\-\_\-8} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, enum \hyperlink{group__WORK__SHARING_gadcaf200537aaa0218a60c398438f81be}{sched\-\_\-type} schedule, kmp\-\_\-int64 lb, kmp\-\_\-int64 ub, kmp\-\_\-int64 st, kmp\-\_\-int64 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_gaf047657f8ff072f15174f03ff80b4882}{\-\_\-\-\_\-kmpc\-\_\-dispatch\-\_\-init\-\_\-8u} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, enum \hyperlink{group__WORK__SHARING_gadcaf200537aaa0218a60c398438f81be}{sched\-\_\-type} schedule, kmp\-\_\-uint64 lb, kmp\-\_\-uint64 ub, kmp\-\_\-int64 st, kmp\-\_\-int64 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_ga9a4e5434d7a476580c6ef7ad2c776bb5}{\-\_\-\-\_\-kmpc\-\_\-dist\-\_\-dispatch\-\_\-init\-\_\-4} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, enum \hyperlink{group__WORK__SHARING_gadcaf200537aaa0218a60c398438f81be}{sched\-\_\-type} schedule, kmp\-\_\-int32 $\ast$p\-\_\-last, kmp\-\_\-int32 lb, kmp\-\_\-int32 ub, kmp\-\_\-int32 st, kmp\-\_\-int32 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_ga495d52d32fed082b74595e0c28ccbc11}{\-\_\-\-\_\-kmpc\-\_\-dist\-\_\-dispatch\-\_\-init\-\_\-4u} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, enum \hyperlink{group__WORK__SHARING_gadcaf200537aaa0218a60c398438f81be}{sched\-\_\-type} schedule, kmp\-\_\-int32 $\ast$p\-\_\-last, kmp\-\_\-uint32 lb, kmp\-\_\-uint32 ub, kmp\-\_\-int32 st, kmp\-\_\-int32 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_ga95541083a047e8ca4915e39b41fa1143}{\-\_\-\-\_\-kmpc\-\_\-dist\-\_\-dispatch\-\_\-init\-\_\-8} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, enum \hyperlink{group__WORK__SHARING_gadcaf200537aaa0218a60c398438f81be}{sched\-\_\-type} schedule, kmp\-\_\-int32 $\ast$p\-\_\-last, kmp\-\_\-int64 lb, kmp\-\_\-int64 ub, kmp\-\_\-int64 st, kmp\-\_\-int64 chunk)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_ga5784024653468c0445601c91da959e0f}{\-\_\-\-\_\-kmpc\-\_\-dist\-\_\-dispatch\-\_\-init\-\_\-8u} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, enum \hyperlink{group__WORK__SHARING_gadcaf200537aaa0218a60c398438f81be}{sched\-\_\-type} schedule, kmp\-\_\-int32 $\ast$p\-\_\-last, kmp\-\_\-uint64 lb, kmp\-\_\-uint64 ub, kmp\-\_\-int64 st, kmp\-\_\-int64 chunk)
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{group__WORK__SHARING_ga5671ff45051907f76cc3d214e1de854b}{\-\_\-\-\_\-kmpc\-\_\-dispatch\-\_\-next\-\_\-4} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 $\ast$p\-\_\-last, kmp\-\_\-int32 $\ast$p\-\_\-lb, kmp\-\_\-int32 $\ast$p\-\_\-ub, kmp\-\_\-int32 $\ast$p\-\_\-st)
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{group__WORK__SHARING_ga9ef4cfec5c836de61180767240c7f380}{\-\_\-\-\_\-kmpc\-\_\-dispatch\-\_\-next\-\_\-4u} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 $\ast$p\-\_\-last, kmp\-\_\-uint32 $\ast$p\-\_\-lb, kmp\-\_\-uint32 $\ast$p\-\_\-ub, kmp\-\_\-int32 $\ast$p\-\_\-st)
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{group__WORK__SHARING_gad49ead8c4196b726b6f04d4b1d53d01d}{\-\_\-\-\_\-kmpc\-\_\-dispatch\-\_\-next\-\_\-8} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 $\ast$p\-\_\-last, kmp\-\_\-int64 $\ast$p\-\_\-lb, kmp\-\_\-int64 $\ast$p\-\_\-ub, kmp\-\_\-int64 $\ast$p\-\_\-st)
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{group__WORK__SHARING_gab1eac772e1ef6ddc3a8512c00a4e78be}{\-\_\-\-\_\-kmpc\-\_\-dispatch\-\_\-next\-\_\-8u} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid, kmp\-\_\-int32 $\ast$p\-\_\-last, kmp\-\_\-uint64 $\ast$p\-\_\-lb, kmp\-\_\-uint64 $\ast$p\-\_\-ub, kmp\-\_\-int64 $\ast$p\-\_\-st)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_ga5f02c0e2081859da86664bfeaec6de62}{\-\_\-\-\_\-kmpc\-\_\-dispatch\-\_\-fini\-\_\-4} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_gac9f8cad27477155b583b54848887997d}{\-\_\-\-\_\-kmpc\-\_\-dispatch\-\_\-fini\-\_\-8} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_gaf293aeef6b6f673f2d824171d6ec20e3}{\-\_\-\-\_\-kmpc\-\_\-dispatch\-\_\-fini\-\_\-4u} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{group__WORK__SHARING_gad99af80b23202044e80aaed7d711b9ac}{\-\_\-\-\_\-kmpc\-\_\-dispatch\-\_\-fini\-\_\-8u} (\hyperlink{group__BASIC__TYPES_ga690fda6b92f039a72db263c6b4394ddb}{ident\-\_\-t} $\ast$loc, kmp\-\_\-int32 gtid)
\end{DoxyCompactItemize}

\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{kmp__dispatch_8cpp_a35e3a4cac3976f6194b63fa6552afbc7}{guided\-\_\-int\-\_\-param} = 2
\item 
static double \hyperlink{kmp__dispatch_8cpp_a966593cb61a9833fa94a07b9f6ecaaba}{guided\-\_\-flt\-\_\-param} = 0.\-5
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{kmp__dispatch_8cpp_a0fae686f1908344ce3f13a95bea3f242}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!G\-U\-I\-D\-E\-D\-\_\-\-A\-N\-A\-L\-Y\-T\-I\-C\-A\-L\-\_\-\-W\-O\-R\-K\-A\-R\-O\-U\-N\-D@{G\-U\-I\-D\-E\-D\-\_\-\-A\-N\-A\-L\-Y\-T\-I\-C\-A\-L\-\_\-\-W\-O\-R\-K\-A\-R\-O\-U\-N\-D}}
\index{G\-U\-I\-D\-E\-D\-\_\-\-A\-N\-A\-L\-Y\-T\-I\-C\-A\-L\-\_\-\-W\-O\-R\-K\-A\-R\-O\-U\-N\-D@{G\-U\-I\-D\-E\-D\-\_\-\-A\-N\-A\-L\-Y\-T\-I\-C\-A\-L\-\_\-\-W\-O\-R\-K\-A\-R\-O\-U\-N\-D}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{G\-U\-I\-D\-E\-D\-\_\-\-A\-N\-A\-L\-Y\-T\-I\-C\-A\-L\-\_\-\-W\-O\-R\-K\-A\-R\-O\-U\-N\-D}]{\setlength{\rightskip}{0pt plus 5cm}\#define G\-U\-I\-D\-E\-D\-\_\-\-A\-N\-A\-L\-Y\-T\-I\-C\-A\-L\-\_\-\-W\-O\-R\-K\-A\-R\-O\-U\-N\-D~({\bf x})}}\label{kmp__dispatch_8cpp_a0fae686f1908344ce3f13a95bea3f242}


Referenced by \-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-init().

\hypertarget{kmp__dispatch_8cpp_a11568d85642b5813503752538a5a9c73}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!O\-M\-P\-T\-\_\-\-L\-O\-O\-P\-\_\-\-E\-N\-D@{O\-M\-P\-T\-\_\-\-L\-O\-O\-P\-\_\-\-E\-N\-D}}
\index{O\-M\-P\-T\-\_\-\-L\-O\-O\-P\-\_\-\-E\-N\-D@{O\-M\-P\-T\-\_\-\-L\-O\-O\-P\-\_\-\-E\-N\-D}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{O\-M\-P\-T\-\_\-\-L\-O\-O\-P\-\_\-\-E\-N\-D}]{\setlength{\rightskip}{0pt plus 5cm}\#define O\-M\-P\-T\-\_\-\-L\-O\-O\-P\-\_\-\-E\-N\-D}}\label{kmp__dispatch_8cpp_a11568d85642b5813503752538a5a9c73}


Definition at line 1403 of file kmp\-\_\-dispatch.\-cpp.



Referenced by \-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-next().



\subsection{Function Documentation}
\hypertarget{kmp__dispatch_8cpp_a98e6aa0445bf147cea7d2ce8857170f0}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-deo@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-deo}}
\index{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-deo@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-deo}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-deo}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename U\-T $>$ static {\bf void} \-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-deo (
\begin{DoxyParamCaption}
\item[{{\bf int} $\ast$}]{gtid\-\_\-ref, }
\item[{{\bf int} $\ast$}]{cid\-\_\-ref, }
\item[{{\bf ident\-\_\-t} $\ast$}]{loc\-\_\-ref}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_a98e6aa0445bf147cea7d2ce8857170f0}


Definition at line 379 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
380 \{
381     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< UT >::signed\_t    ST;
382     \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< UT >} * pr;
383 
384     \textcolor{keywordtype}{int} gtid = *gtid\_ref;
385 \textcolor{comment}{//    int  cid = *cid\_ref;}
386     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *th = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
387     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( th -> th.th\_dispatch );
388 
389     \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_deo: T#%d called\(\backslash\)n"}, gtid ) );
390     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
391         pr = \textcolor{keyword}{reinterpret\_cast<} \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< UT >}* \textcolor{keyword}{>}
392             ( th -> th.th\_dispatch -> th\_dispatch\_pr\_current );
393         \textcolor{keywordflow}{if} ( pr -> pushed\_ws != \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a3eea97b407ad5cbc5f8707a949722738}{ct\_none} ) \{
394 \textcolor{preprocessor}{#if KMP\_USE\_DYNAMIC\_LOCK}
395 \textcolor{preprocessor}{}            \hyperlink{kmp__error_8c_a17886697972a1ad707cb5797332a7229}{\_\_kmp\_push\_sync}( gtid, \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a1daa71b233b95c7fc0e3da0eaf5877a9}{ct\_ordered\_in\_pdo}, loc\_ref, NULL, 0 );
396 \textcolor{preprocessor}{#else}
397 \textcolor{preprocessor}{}            \hyperlink{kmp__error_8c_a17886697972a1ad707cb5797332a7229}{\_\_kmp\_push\_sync}( gtid, \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a1daa71b233b95c7fc0e3da0eaf5877a9}{ct\_ordered\_in\_pdo}, loc\_ref, NULL );
398 \textcolor{preprocessor}{#endif}
399 \textcolor{preprocessor}{}        \}
400     \}
401 
402     \textcolor{keywordflow}{if} ( ! th -> th.th\_team -> t.t\_serialized ) \{
403         \hyperlink{structdispatch__shared__info__template}{dispatch\_shared\_info\_template< UT >}  * sh = \textcolor{keyword}{reinterpret\_cast<} 
      \hyperlink{structdispatch__shared__info__template}{dispatch\_shared\_info\_template< UT >}* \textcolor{keyword}{>}
404             ( th -> th.th\_dispatch -> th\_dispatch\_sh\_current );
405         UT  lower;
406 
407         \textcolor{keywordflow}{if} ( ! \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
408                 pr = \textcolor{keyword}{reinterpret\_cast<} \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< UT >}
      * \textcolor{keyword}{>}
409                     ( th -> th.th\_dispatch -> th\_dispatch\_pr\_current );
410         \}
411         lower = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower;
412 
413 \textcolor{preprocessor}{        #if ! defined( KMP\_GOMP\_COMPAT )}
414 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
415                 \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_ac04a2f8dd76f45d3103abd5b070c9924}{ordered\_bumped} ) \{
416                     \textcolor{keyword}{struct }\hyperlink{structcons__header}{cons\_header} *\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p} = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ]->th.th\_cons;
417                     \hyperlink{kmp__error_8c_ab89104d10bf42ad8a024131605f1a569}{\_\_kmp\_error\_construct2}(
418                         kmp\_i18n\_msg\_CnsMultipleNesting,
419                         \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a1daa71b233b95c7fc0e3da0eaf5877a9}{ct\_ordered\_in\_pdo}, loc\_ref,
420                         & p->\hyperlink{structcons__header_ad85d65edead496f21419376e08bc6e20}{stack\_data}[ p->\hyperlink{structcons__header_ac4dd32db9b0ccf46f318bb61260a8d67}{w\_top} ]
421                     );
422                 \}
423             \}
424 \textcolor{preprocessor}{        #endif }\textcolor{comment}{/* !defined(KMP\_GOMP\_COMPAT) */}\textcolor{preprocessor}{}
425 \textcolor{preprocessor}{}
426         \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();
427 \textcolor{preprocessor}{        #ifdef KMP\_DEBUG}
428 \textcolor{preprocessor}{}        \{
429             \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
430             \textcolor{comment}{// create format specifiers before the debug output}
431             buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
432                 \textcolor{stringliteral}{"\_\_kmp\_dispatch\_deo: T#%%d before wait: ordered\_iter:%%%s lower:%%%s\(\backslash\)n"},
433                 traits\_t< UT >::spec, traits\_t< UT >::spec );
434             \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(1000, ( buff, gtid, sh->\hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.ordered\_iteration, lower ) );
435             \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
436         \}
437 \textcolor{preprocessor}{        #endif}
438 \textcolor{preprocessor}{}
439         \_\_kmp\_wait\_yield< UT >( &sh->\hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.ordered\_iteration, lower, \_\_kmp\_ge< UT >
440                                 \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{USE\_ITT\_BUILD\_ARG}( NULL )
441                                 );
442         \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();  \textcolor{comment}{/* is this necessary? */}
443 \textcolor{preprocessor}{        #ifdef KMP\_DEBUG}
444 \textcolor{preprocessor}{}        \{
445             \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
446             \textcolor{comment}{// create format specifiers before the debug output}
447             buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
448                 \textcolor{stringliteral}{"\_\_kmp\_dispatch\_deo: T#%%d after wait: ordered\_iter:%%%s lower:%%%s\(\backslash\)n"},
449                 traits\_t< UT >::spec, traits\_t< UT >::spec );
450             \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(1000, ( buff, gtid, sh->\hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.ordered\_iteration, lower ) );
451             \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
452         \}
453 \textcolor{preprocessor}{        #endif}
454 \textcolor{preprocessor}{}    \}
455     \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_deo: T#%d returned\(\backslash\)n"}, gtid ) );
456 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_ab1d683d42af758adcb691a6c5386f955}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-deo\-\_\-error@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-deo\-\_\-error}}
\index{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-deo\-\_\-error@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-deo\-\_\-error}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-deo\-\_\-error}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-deo\-\_\-error (
\begin{DoxyParamCaption}
\item[{{\bf int} $\ast$}]{gtid\-\_\-ref, }
\item[{{\bf int} $\ast$}]{cid\-\_\-ref, }
\item[{{\bf ident\-\_\-t} $\ast$}]{loc\-\_\-ref}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_ab1d683d42af758adcb691a6c5386f955}


Definition at line 358 of file kmp\-\_\-dispatch.\-cpp.



Referenced by \-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-init().


\begin{DoxyCode}
359 \{
360     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *th;
361 
362     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( gtid\_ref );
363 
364     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
365         th = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[*gtid\_ref];
366         \textcolor{keywordflow}{if} ( th -> th.th\_root -> r.r\_active
367           && ( th -> th.th\_dispatch -> th\_dispatch\_pr\_current -> pushed\_ws != 
      \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a3eea97b407ad5cbc5f8707a949722738}{ct\_none} ) ) \{
368 \textcolor{preprocessor}{#if KMP\_USE\_DYNAMIC\_LOCK}
369 \textcolor{preprocessor}{}            \hyperlink{kmp__error_8c_a17886697972a1ad707cb5797332a7229}{\_\_kmp\_push\_sync}( *gtid\_ref, \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a1daa71b233b95c7fc0e3da0eaf5877a9}{ct\_ordered\_in\_pdo}, loc\_ref, NULL, 0
       );
370 \textcolor{preprocessor}{#else}
371 \textcolor{preprocessor}{}            \hyperlink{kmp__error_8c_a17886697972a1ad707cb5797332a7229}{\_\_kmp\_push\_sync}( *gtid\_ref, \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a1daa71b233b95c7fc0e3da0eaf5877a9}{ct\_ordered\_in\_pdo}, loc\_ref, NULL );
372 \textcolor{preprocessor}{#endif}
373 \textcolor{preprocessor}{}        \}
374     \}
375 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_aa5b8615d9ec84accdd92042f71640699}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-dxo@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-dxo}}
\index{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-dxo@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-dxo}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-dxo}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename U\-T $>$ static {\bf void} \-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-dxo (
\begin{DoxyParamCaption}
\item[{{\bf int} $\ast$}]{gtid\-\_\-ref, }
\item[{{\bf int} $\ast$}]{cid\-\_\-ref, }
\item[{{\bf ident\-\_\-t} $\ast$}]{loc\-\_\-ref}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_aa5b8615d9ec84accdd92042f71640699}


Definition at line 473 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
474 \{
475     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< UT >::signed\_t    ST;
476     \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< UT >} * pr;
477 
478     \textcolor{keywordtype}{int} gtid = *gtid\_ref;
479 \textcolor{comment}{//    int  cid = *cid\_ref;}
480     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *th = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
481     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( th -> th.th\_dispatch );
482 
483     \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_dxo: T#%d called\(\backslash\)n"}, gtid ) );
484     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
485         pr = \textcolor{keyword}{reinterpret\_cast<} \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< UT >}* \textcolor{keyword}{>}
486             ( th -> th.th\_dispatch -> th\_dispatch\_pr\_current );
487         \textcolor{keywordflow}{if} ( pr -> pushed\_ws != \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a3eea97b407ad5cbc5f8707a949722738}{ct\_none} ) \{
488             \hyperlink{kmp__error_8c_ab716717d70650eeeb205b057232d7c1c}{\_\_kmp\_pop\_sync}( gtid, \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a1daa71b233b95c7fc0e3da0eaf5877a9}{ct\_ordered\_in\_pdo}, loc\_ref );
489         \}
490     \}
491 
492     \textcolor{keywordflow}{if} ( ! th -> th.th\_team -> t.t\_serialized ) \{
493         \hyperlink{structdispatch__shared__info__template}{dispatch\_shared\_info\_template< UT >}  * sh = \textcolor{keyword}{reinterpret\_cast<} 
      \hyperlink{structdispatch__shared__info__template}{dispatch\_shared\_info\_template< UT >}* \textcolor{keyword}{>}
494             ( th -> th.th\_dispatch -> th\_dispatch\_sh\_current );
495 
496         \textcolor{keywordflow}{if} ( ! \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
497             pr = \textcolor{keyword}{reinterpret\_cast<} \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< UT >}
      * \textcolor{keyword}{>}
498                 ( th -> th.th\_dispatch -> th\_dispatch\_pr\_current );
499         \}
500 
501         \hyperlink{kmp__itt_8h_a321c5d523f392e432350caffc38aecee}{KMP\_FSYNC\_RELEASING}( & sh->\hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.ordered\_iteration );
502 \textcolor{preprocessor}{        #if ! defined( KMP\_GOMP\_COMPAT )}
503 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
504                 \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_ac04a2f8dd76f45d3103abd5b070c9924}{ordered\_bumped} != 0 ) \{
505                     \textcolor{keyword}{struct }\hyperlink{structcons__header}{cons\_header} *\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p} = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ]->th.th\_cons;
506                     \textcolor{comment}{/* How to test it? - OM */}
507                     \hyperlink{kmp__error_8c_ab89104d10bf42ad8a024131605f1a569}{\_\_kmp\_error\_construct2}(
508                         kmp\_i18n\_msg\_CnsMultipleNesting,
509                         \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a1daa71b233b95c7fc0e3da0eaf5877a9}{ct\_ordered\_in\_pdo}, loc\_ref,
510                         & p->\hyperlink{structcons__header_ad85d65edead496f21419376e08bc6e20}{stack\_data}[ p->\hyperlink{structcons__header_ac4dd32db9b0ccf46f318bb61260a8d67}{w\_top} ]
511                     );
512                 \}
513             \}
514 \textcolor{preprocessor}{        #endif }\textcolor{comment}{/* !defined(KMP\_GOMP\_COMPAT) */}\textcolor{preprocessor}{}
515 \textcolor{preprocessor}{}
516         \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
517 
518         pr->\hyperlink{structdispatch__private__info__template_ac04a2f8dd76f45d3103abd5b070c9924}{ordered\_bumped} += 1;
519 
520         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(1000, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_dxo: T#%d bumping ordered ordered\_bumped=%d\(\backslash\)n"},
521                         gtid, pr->\hyperlink{structdispatch__private__info__template_ac04a2f8dd76f45d3103abd5b070c9924}{ordered\_bumped} ) );
522 
523         \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
524 
525         \textcolor{comment}{/* TODO use general release procedure? */}
526         test\_then\_inc< ST >( (\textcolor{keyword}{volatile} ST *) & sh->\hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.ordered\_iteration );
527 
528         \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
529     \}
530     \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_dxo: T#%d returned\(\backslash\)n"}, gtid ) );
531 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_ac5d9718495f3304a6d04de7bf4b86309}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-dxo\-\_\-error@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-dxo\-\_\-error}}
\index{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-dxo\-\_\-error@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-dxo\-\_\-error}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-dxo\-\_\-error}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-dxo\-\_\-error (
\begin{DoxyParamCaption}
\item[{{\bf int} $\ast$}]{gtid\-\_\-ref, }
\item[{{\bf int} $\ast$}]{cid\-\_\-ref, }
\item[{{\bf ident\-\_\-t} $\ast$}]{loc\-\_\-ref}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_ac5d9718495f3304a6d04de7bf4b86309}


Definition at line 459 of file kmp\-\_\-dispatch.\-cpp.



Referenced by \-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-init().


\begin{DoxyCode}
460 \{
461     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *th;
462 
463     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
464         th = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[*gtid\_ref];
465         \textcolor{keywordflow}{if} ( th -> th.th\_dispatch -> th\_dispatch\_pr\_current -> pushed\_ws != 
      \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a3eea97b407ad5cbc5f8707a949722738}{ct\_none} ) \{
466             \hyperlink{kmp__error_8c_ab716717d70650eeeb205b057232d7c1c}{\_\_kmp\_pop\_sync}( *gtid\_ref, \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a1daa71b233b95c7fc0e3da0eaf5877a9}{ct\_ordered\_in\_pdo}, loc\_ref );
467         \}
468     \}
469 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_aa124c5ab7d5fe3330cc7a8d8bb4d7903}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-finish@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-finish}}
\index{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-finish@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-finish}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-finish}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename U\-T $>$ static {\bf void} \-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-finish (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{gtid, }
\item[{{\bf ident\-\_\-t} $\ast$}]{loc}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_aa124c5ab7d5fe3330cc7a8d8bb4d7903}


Definition at line 1249 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
1250 \{
1251     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< UT >::signed\_t ST;
1252     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *th = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
1253 
1254     \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_finish: T#%d called\(\backslash\)n"}, gtid ) );
1255     \textcolor{keywordflow}{if} ( ! th -> th.th\_team -> t.t\_serialized ) \{
1256 
1257         \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< UT >} * pr =
1258             \textcolor{keyword}{reinterpret\_cast<} \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< UT >}* \textcolor{keyword}{>}
1259             ( th->th.th\_dispatch->th\_dispatch\_pr\_current );
1260         \hyperlink{structdispatch__shared__info__template}{dispatch\_shared\_info\_template< UT >} \textcolor{keyword}{volatile} * sh =
1261             \textcolor{keyword}{reinterpret\_cast<} \hyperlink{structdispatch__shared__info__template}{dispatch\_shared\_info\_template< UT >}
      volatile* \textcolor{keyword}{>}
1262             ( th->th.th\_dispatch->th\_dispatch\_sh\_current );
1263         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( pr );
1264         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( sh );
1265         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( th->th.th\_dispatch ==
1266                  &th->th.th\_team->t.t\_dispatch[th->th.th\_info.ds.ds\_tid] );
1267 
1268         \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_ac04a2f8dd76f45d3103abd5b070c9924}{ordered\_bumped} ) \{
1269             \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(1000, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_finish: T#%d resetting ordered\_bumped to zero\(\backslash\)n"},
1270                             gtid ) );
1271             pr->\hyperlink{structdispatch__private__info__template_ac04a2f8dd76f45d3103abd5b070c9924}{ordered\_bumped} = 0;
1272         \} \textcolor{keywordflow}{else} \{
1273             UT lower = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower;
1274 
1275 \textcolor{preprocessor}{            #ifdef KMP\_DEBUG}
1276 \textcolor{preprocessor}{}            \{
1277                 \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
1278                 \textcolor{comment}{// create format specifiers before the debug output}
1279                 buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
1280                     \textcolor{stringliteral}{"\_\_kmp\_dispatch\_finish: T#%%d before wait: ordered\_iteration:%%%s lower:%%%s\(\backslash\)n"},
1281                     traits\_t< UT >::spec, traits\_t< UT >::spec );
1282                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(1000, ( buff, gtid, sh->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.s.ordered\_iteration, lower ) );
1283                 \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
1284             \}
1285 \textcolor{preprocessor}{            #endif}
1286 \textcolor{preprocessor}{}
1287             \_\_kmp\_wait\_yield< UT >(&sh->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.s.ordered\_iteration, lower, \_\_kmp\_ge< UT >
1288                                    \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{USE\_ITT\_BUILD\_ARG}(NULL)
1289                                    );
1290             \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();  \textcolor{comment}{/* is this necessary? */}
1291 \textcolor{preprocessor}{            #ifdef KMP\_DEBUG}
1292 \textcolor{preprocessor}{}            \{
1293                 \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
1294                 \textcolor{comment}{// create format specifiers before the debug output}
1295                 buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
1296                     \textcolor{stringliteral}{"\_\_kmp\_dispatch\_finish: T#%%d after wait: ordered\_iteration:%%%s lower:%%%s\(\backslash\)n"},
1297                     traits\_t< UT >::spec, traits\_t< UT >::spec );
1298                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(1000, ( buff, gtid, sh->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.s.ordered\_iteration, lower ) );
1299                 \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
1300             \}
1301 \textcolor{preprocessor}{            #endif}
1302 \textcolor{preprocessor}{}
1303             test\_then\_inc< ST >( (\textcolor{keyword}{volatile} ST *) & sh->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.s.ordered\_iteration );
1304         \} \textcolor{comment}{// if}
1305     \} \textcolor{comment}{// if}
1306     \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_finish: T#%d returned\(\backslash\)n"}, gtid ) );
1307 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a0c219c6a43aa6c80e170c8baaa813de8}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-guided\-\_\-remaining@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-guided\-\_\-remaining}}
\index{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-guided\-\_\-remaining@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-guided\-\_\-remaining}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-guided\-\_\-remaining}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ static \-\_\-\-\_\-inline traits\-\_\-t$<$ T $>$\-::unsigned\-\_\-t \-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-guided\-\_\-remaining (
\begin{DoxyParamCaption}
\item[{T}]{tc, }
\item[{typename traits\-\_\-t$<$ T $>$\-::floating\-\_\-t}]{base, }
\item[{typename traits\-\_\-t$<$ T $>$\-::unsigned\-\_\-t}]{idx}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_a0c219c6a43aa6c80e170c8baaa813de8}


Definition at line 557 of file kmp\-\_\-dispatch.\-cpp.



Referenced by \-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-init().


\begin{DoxyCode}
561   \{
562     \textcolor{comment}{/* Note: On Windows* OS on IA-32 architecture and Intel(R) 64, at}
563 \textcolor{comment}{       least for ICL 8.1, long double arithmetic may not really have}
564 \textcolor{comment}{       long double precision, even with /Qlong\_double.  Currently, we}
565 \textcolor{comment}{       workaround that in the caller code, by manipulating the FPCW for}
566 \textcolor{comment}{       Windows* OS on IA-32 architecture.  The lack of precision is not}
567 \textcolor{comment}{       expected to be a correctness issue, though.}
568 \textcolor{comment}{    */}
569     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< T >::unsigned\_t  UT;
570 
571     \textcolor{keywordtype}{long} \textcolor{keywordtype}{double} \hyperlink{ittnotify__static_8h_a25eb27b280775b27a5ddc4d1673225aa}{x} = tc * \_\_kmp\_pow< UT >(base, idx);
572     UT r = (UT) x;
573     \textcolor{keywordflow}{if} ( x == r )
574         \textcolor{keywordflow}{return} r;
575     \textcolor{keywordflow}{return} r + 1;
576 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_ad604dd0d1db785e25c9a9c113ac3a166}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-init@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-init}}
\index{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-init@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-init}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ static {\bf void} \-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-init (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc, }
\item[{{\bf int}}]{gtid, }
\item[{enum {\bf sched\-\_\-type}}]{schedule, }
\item[{T}]{lb, }
\item[{T}]{ub, }
\item[{typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t}]{st, }
\item[{typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t}]{chunk, }
\item[{{\bf int}}]{push\-\_\-ws}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_ad604dd0d1db785e25c9a9c113ac3a166}


Definition at line 590 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
599   \{
600     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< T >::unsigned\_t  UT;
601     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< T >::signed\_t    ST;
602     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< T >::floating\_t  DBL;
603     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} \_\_\_kmp\_size\_type = \textcolor{keyword}{sizeof}( UT );
604 
605     \textcolor{keywordtype}{int}                                            active;
606     T                                              tc;
607     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *                                   th;
608     \hyperlink{unionkmp__team}{kmp\_team\_t} *                                   team;
609     kmp\_uint32                                     my\_buffer\_index;
610     \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< T >}          * pr;
611     \hyperlink{structdispatch__shared__info__template}{dispatch\_shared\_info\_template< UT >} \textcolor{keyword}{volatile} * sh;
612 
613     \hyperlink{kmp__debug_8h_a8766cd4f53ff2e833daf59919c8d04ff}{KMP\_BUILD\_ASSERT}( \textcolor{keyword}{sizeof}( 
      \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< T >} ) == \textcolor{keyword}{sizeof}( 
      \hyperlink{structdispatch__private__info}{dispatch\_private\_info} ) );
614     \hyperlink{kmp__debug_8h_a8766cd4f53ff2e833daf59919c8d04ff}{KMP\_BUILD\_ASSERT}( \textcolor{keyword}{sizeof}( 
      \hyperlink{structdispatch__shared__info__template}{dispatch\_shared\_info\_template< UT >} ) == \textcolor{keyword}{sizeof}( 
      \hyperlink{structdispatch__shared__info}{dispatch\_shared\_info} ) );
615 
616     \textcolor{keywordflow}{if} ( ! \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}( \hyperlink{kmp_8h_aa23ece0d05f38387c8a8441aaad368df}{\_\_kmp\_init\_parallel} ) )
617         \hyperlink{kmp_8h_a9c18846c648d84276b9dd5a1d650ab04}{\_\_kmp\_parallel\_initialize}();
618 
619 \textcolor{preprocessor}{#if INCLUDE\_SSC\_MARKS}
620 \textcolor{preprocessor}{}    SSC\_MARK\_DISPATCH\_INIT();
621 \textcolor{preprocessor}{#endif}
622 \textcolor{preprocessor}{}\textcolor{preprocessor}{    #ifdef KMP\_DEBUG}
623 \textcolor{preprocessor}{}    \{
624         \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
625         \textcolor{comment}{// create format specifiers before the debug output}
626         buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
627             \textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%%d called: schedule:%%d chunk:%%%s lb:%%%s ub:%%%s st:%%%s\(\backslash\)n"},
628             traits\_t< ST >::spec, traits\_t< T >::spec, traits\_t< T >::spec, traits\_t< ST >::spec );
629         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(10, ( buff, gtid, schedule, chunk, lb, ub, st ) );
630         \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
631     \}
632 \textcolor{preprocessor}{    #endif}
633 \textcolor{preprocessor}{}    \textcolor{comment}{/* setup data */}
634     th     = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
635     team   = th -> th.th\_team;
636     active = ! team -> t.t\_serialized;
637     th->th.th\_ident = loc;
638 
639 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
640 \textcolor{preprocessor}{}    kmp\_uint64 cur\_chunk = chunk;
641     \textcolor{keywordtype}{int} itt\_need\_metadata\_reporting = \_\_itt\_metadata\_add\_ptr && \_\_kmp\_forkjoin\_frames\_mode == 3 &&
642         \hyperlink{kmp_8h_a996fe75425730b06ff88477bf72b8134}{KMP\_MASTER\_GTID}(gtid) &&
643 \textcolor{preprocessor}{#if OMP\_40\_ENABLED}
644 \textcolor{preprocessor}{}        th->th.th\_teams\_microtask == NULL &&
645 \textcolor{preprocessor}{#endif}
646 \textcolor{preprocessor}{}        team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_active\_level == 1;
647 \textcolor{preprocessor}{#endif}
648 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} ( ! active ) \{
649         pr = \textcolor{keyword}{reinterpret\_cast<} \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< T >}* \textcolor{keyword}{>}
650             ( th -> th.th\_dispatch -> th\_disp\_buffer ); \textcolor{comment}{/* top of the stack */}
651     \} \textcolor{keywordflow}{else} \{
652         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( th->th.th\_dispatch ==
653                 &th->th.th\_team->t.t\_dispatch[th->th.th\_info.ds.ds\_tid] );
654 
655         my\_buffer\_index = th->th.th\_dispatch->th\_disp\_index ++;
656 
657         \textcolor{comment}{/* What happens when number of threads changes, need to resize buffer? */}
658         pr = \textcolor{keyword}{reinterpret\_cast<} \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< T >}  * \textcolor{keyword}{>}
659             ( &th -> th.th\_dispatch -> th\_disp\_buffer[ my\_buffer\_index % 
      \hyperlink{kmp_8h_a7d5c6777861c49affd8d4ff04cde845a}{KMP\_MAX\_DISP\_BUF} ] );
660         sh = \textcolor{keyword}{reinterpret\_cast<} \hyperlink{structdispatch__shared__info__template}{dispatch\_shared\_info\_template< UT >} \textcolor{keyword}{
      volatile }* \textcolor{keyword}{>}
661             ( &team -> t.t\_disp\_buffer[ my\_buffer\_index % \hyperlink{kmp_8h_a7d5c6777861c49affd8d4ff04cde845a}{KMP\_MAX\_DISP\_BUF} ] );
662     \}
663 
664     \textcolor{comment}{/* Currently just ignore the monotonic and non-monotonic modifiers (the compiler isn't producing them}
665 \textcolor{comment}{     * yet anyway).}
666 \textcolor{comment}{     * When it is we'll want to look at them somewhere here and use that information to add to our}
667 \textcolor{comment}{     * schedule choice. We shouldn't need to pass them on, they merely affect which schedule we can}
668 \textcolor{comment}{     * legally choose for various dynamic cases. (In paritcular, whether or not a stealing scheme is
       legal).}
669 \textcolor{comment}{     */}
670     schedule = \hyperlink{kmp_8h_a94668cc2f95d0cf3d02801dc645b8642}{SCHEDULE\_WITHOUT\_MODIFIERS}(schedule);
671 
672     \textcolor{comment}{/* Pick up the nomerge/ordered bits from the scheduling type */}
673     \textcolor{keywordflow}{if} ( (schedule >= \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81beac30b06c765f4623efb929a141ff9457e}{kmp\_nm\_lower}) && (schedule < \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea9a30ec9215efb0a584597aeda2c03e19}{kmp\_nm\_upper}) ) \{
674         pr->\hyperlink{structdispatch__private__info__template_a173b2536a5a9e9dc1945f77dc0497683}{nomerge} = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
675         schedule = (\textcolor{keyword}{enum} \hyperlink{group__WORK__SHARING_gadcaf200537aaa0218a60c398438f81be}{sched\_type})(((\textcolor{keywordtype}{int})schedule) - (\hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81beac30b06c765f4623efb929a141ff9457e}{kmp\_nm\_lower} - 
      \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea7ed3535e3c97c9c2ce299addd74b4a01}{kmp\_sch\_lower}));
676     \} \textcolor{keywordflow}{else} \{
677         pr->\hyperlink{structdispatch__private__info__template_a173b2536a5a9e9dc1945f77dc0497683}{nomerge} = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
678     \}
679     pr->\hyperlink{structdispatch__private__info__template_a34d33703aed7b118cffb529ec6ec49e3}{type\_size} = \_\_\_kmp\_size\_type; \textcolor{comment}{// remember the size of variables}
680     \textcolor{keywordflow}{if} ( \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea9a4a0dce1e919688bcd27411746b7ad8}{kmp\_ord\_lower} & schedule ) \{
681         pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
682         schedule = (\textcolor{keyword}{enum} \hyperlink{group__WORK__SHARING_gadcaf200537aaa0218a60c398438f81be}{sched\_type})(((\textcolor{keywordtype}{int})schedule) - (\hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea9a4a0dce1e919688bcd27411746b7ad8}{kmp\_ord\_lower} - 
      \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea7ed3535e3c97c9c2ce299addd74b4a01}{kmp\_sch\_lower}));
683     \} \textcolor{keywordflow}{else} \{
684         pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
685     \}
686 
687     \textcolor{keywordflow}{if} ( schedule == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea2a987351b9605b918693a17d4dd90772}{kmp\_sch\_static} ) \{
688         schedule = \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static};
689     \} \textcolor{keywordflow}{else} \{
690         \textcolor{keywordflow}{if} ( schedule == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea2cae9ebb984349b75fe470cc6aa4cd19}{kmp\_sch\_runtime} ) \{
691             \textcolor{comment}{// Use the scheduling specified by OMP\_SCHEDULE (or \_\_kmp\_sch\_default if not specified)}
692             schedule = team -> t.t\_sched.r\_sched\_type;
693             \textcolor{comment}{// Detail the schedule if needed (global controls are differentiated appropriately)}
694             \textcolor{keywordflow}{if} ( schedule == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea52b66fc7ba82beb3d6fbdb82a6ef045d}{kmp\_sch\_guided\_chunked} ) \{
695                 schedule = \hyperlink{kmp_8h_ad5661902aa5eb6cb8644cc0e3f559a8c}{\_\_kmp\_guided};
696             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( schedule == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea2a987351b9605b918693a17d4dd90772}{kmp\_sch\_static} ) \{
697                 schedule = \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static};
698             \}
699             \textcolor{comment}{// Use the chunk size specified by OMP\_SCHEDULE (or default if not specified)}
700             chunk = team -> t.t\_sched.chunk;
701 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
702 \textcolor{preprocessor}{}            cur\_chunk = chunk;
703 \textcolor{preprocessor}{#endif}
704 \textcolor{preprocessor}{}\textcolor{preprocessor}{            #ifdef KMP\_DEBUG}
705 \textcolor{preprocessor}{}            \{
706                 \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
707                 \textcolor{comment}{// create format specifiers before the debug output}
708                 buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
709                     \textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%%d new: schedule:%%d chunk:%%%s\(\backslash\)n"},
710                     traits\_t< ST >::spec );
711                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(10, ( buff, gtid, schedule, chunk ) );
712                 \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
713             \}
714 \textcolor{preprocessor}{            #endif}
715 \textcolor{preprocessor}{}        \} \textcolor{keywordflow}{else} \{
716             \textcolor{keywordflow}{if} ( schedule == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea52b66fc7ba82beb3d6fbdb82a6ef045d}{kmp\_sch\_guided\_chunked} ) \{
717                 schedule = \hyperlink{kmp_8h_ad5661902aa5eb6cb8644cc0e3f559a8c}{\_\_kmp\_guided};
718             \}
719             \textcolor{keywordflow}{if} ( chunk <= 0 ) \{
720                 chunk = \hyperlink{kmp_8h_a0b753aac7a3d6af072f31243cdab6d5f}{KMP\_DEFAULT\_CHUNK};
721             \}
722         \}
723 
724         \textcolor{keywordflow}{if} ( schedule == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea270b6b98ec2f9ec4832f7a59b0a0d532}{kmp\_sch\_auto} ) \{
725             \textcolor{comment}{// mapping and differentiation: in the \_\_kmp\_do\_serial\_initialize()}
726             schedule = \hyperlink{kmp_8h_a6055149352f6c46415bdfdf68a950f33}{\_\_kmp\_auto};
727 \textcolor{preprocessor}{            #ifdef KMP\_DEBUG}
728 \textcolor{preprocessor}{}            \{
729                 \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
730                 \textcolor{comment}{// create format specifiers before the debug output}
731                 buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
732                     \textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: kmp\_sch\_auto: T#%%d new: schedule:%%d chunk:%%%s\(\backslash\)n"},
733                     traits\_t< ST >::spec );
734                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(10, ( buff, gtid, schedule, chunk ) );
735                 \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
736             \}
737 \textcolor{preprocessor}{            #endif}
738 \textcolor{preprocessor}{}        \}
739 
740         \textcolor{comment}{/* guided analytical not safe for too many threads */}
741         \textcolor{keywordflow}{if} ( team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc > 1<<20 && schedule == 
      \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea569ad1692047e89645f19bca3f2c26af}{kmp\_sch\_guided\_analytical\_chunked} ) \{
742             schedule = \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81beaa6177807dac327b1240c43ab9f2d1f12}{kmp\_sch\_guided\_iterative\_chunked};
743             \hyperlink{kmp__i18n_8h_a5aeb48e92a07c52661a33ec3fcee938f}{KMP\_WARNING}( DispatchManyThreads );
744         \}
745         pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1 = chunk;
746     \}
747     \hyperlink{kmp__debug_8h_afa985a577299cb10dafe8d3bd462d635}{KMP\_ASSERT2}( (\hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea7ed3535e3c97c9c2ce299addd74b4a01}{kmp\_sch\_lower} < schedule && schedule < 
      \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81beab1e0332cc09c1f3ee029b9fcc1c40ba0}{kmp\_sch\_upper}),
748                 \textcolor{stringliteral}{"unknown scheduling type"} );
749 
750     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count = 0;
751 
752     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
753         \textcolor{keywordflow}{if} ( st == 0 ) \{
754             \hyperlink{kmp__error_8c_aa91d3ecb565b21ade2e4156254f9941e}{\_\_kmp\_error\_construct}(
755                 kmp\_i18n\_msg\_CnsLoopIncrZeroProhibited,
756                 ( pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} ? \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a82fb20f0b137c6de6929ba3b064a7863}{ct\_pdo\_ordered} : \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315aef2b45cd9b1ab8d75031c716a27adce9}{ct\_pdo} ), loc
757             );
758         \}
759     \}
760 
761     tc = ( ub - lb + st );
762     \textcolor{keywordflow}{if} ( st != 1 ) \{
763         \textcolor{keywordflow}{if} ( st < 0 ) \{
764             \textcolor{keywordflow}{if} ( lb < ub ) \{
765                 tc = 0;            \textcolor{comment}{// zero-trip}
766             \} \textcolor{keywordflow}{else} \{   \textcolor{comment}{// lb >= ub}
767                 tc = (ST)tc / st;  \textcolor{comment}{// convert to signed division}
768             \}
769         \} \textcolor{keywordflow}{else} \{       \textcolor{comment}{// st > 0}
770             \textcolor{keywordflow}{if} ( ub < lb ) \{
771                 tc = 0;            \textcolor{comment}{// zero-trip}
772             \} \textcolor{keywordflow}{else} \{   \textcolor{comment}{// lb >= ub}
773                 tc /= st;
774             \}
775         \}
776     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ub < lb ) \{        \textcolor{comment}{// st == 1}
777         tc = 0;                    \textcolor{comment}{// zero-trip}
778     \}
779 
780     \textcolor{comment}{// Any half-decent optimizer will remove this test when the blocks are empty since the macros expand to
       nothing}
781     \textcolor{comment}{// when statistics are disabled.}
782     \textcolor{keywordflow}{if} (schedule == \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static})
783     \{
784         \hyperlink{group__STATS__GATHERING_ga7fa64ec62947bf0b97f3f4778dd22196}{KMP\_COUNT\_BLOCK}(OMP\_FOR\_static);
785         \hyperlink{group__STATS__GATHERING_ga7691000a7864b475046ae62fcf0536ac}{KMP\_COUNT\_VALUE}(FOR\_static\_iterations, tc);
786     \}
787     \textcolor{keywordflow}{else}
788     \{
789         \hyperlink{group__STATS__GATHERING_ga7fa64ec62947bf0b97f3f4778dd22196}{KMP\_COUNT\_BLOCK}(OMP\_FOR\_dynamic);
790         \hyperlink{group__STATS__GATHERING_ga7691000a7864b475046ae62fcf0536ac}{KMP\_COUNT\_VALUE}(FOR\_dynamic\_iterations, tc);
791     \}
792 
793     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.lb = lb;
794     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ub = ub;
795     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.st = st;
796     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.tc = tc;
797 
798 \textcolor{preprocessor}{    #if KMP\_OS\_WINDOWS}
799 \textcolor{preprocessor}{}    pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.last\_upper = ub + st;
800 \textcolor{preprocessor}{    #endif }\textcolor{comment}{/* KMP\_OS\_WINDOWS */}\textcolor{preprocessor}{}
801 \textcolor{preprocessor}{}
802     \textcolor{comment}{/* NOTE: only the active parallel region(s) has active ordered sections */}
803 
804     \textcolor{keywordflow}{if} ( active ) \{
805         \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} == 0 ) \{
806             th -> th.th\_dispatch -> th\_deo\_fcn = \hyperlink{kmp__dispatch_8cpp_ab1d683d42af758adcb691a6c5386f955}{\_\_kmp\_dispatch\_deo\_error};
807             th -> th.th\_dispatch -> th\_dxo\_fcn = \hyperlink{kmp__dispatch_8cpp_ac5d9718495f3304a6d04de7bf4b86309}{\_\_kmp\_dispatch\_dxo\_error};
808         \} \textcolor{keywordflow}{else} \{
809             pr->\hyperlink{structdispatch__private__info__template_ac04a2f8dd76f45d3103abd5b070c9924}{ordered\_bumped} = 0;
810 
811             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower = 1;
812             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper = 0;
813 
814             th -> th.th\_dispatch -> th\_deo\_fcn = \_\_kmp\_dispatch\_deo< UT >;
815             th -> th.th\_dispatch -> th\_dxo\_fcn = \_\_kmp\_dispatch\_dxo< UT >;
816         \}
817     \}
818 
819     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
820         \textcolor{keyword}{enum} \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315}{cons\_type} ws = pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} ? \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a82fb20f0b137c6de6929ba3b064a7863}{ct\_pdo\_ordered} : 
      \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315aef2b45cd9b1ab8d75031c716a27adce9}{ct\_pdo};
821         \textcolor{keywordflow}{if} ( push\_ws ) \{
822             \hyperlink{kmp__error_8c_a66a32e32866271e32187760f4a9d4e3e}{\_\_kmp\_push\_workshare}( gtid, ws, loc );
823             pr->\hyperlink{structdispatch__private__info__template_aae7f21fbe2cebe26a14031af3bf17285}{pushed\_ws} = ws;
824         \} \textcolor{keywordflow}{else} \{
825             \hyperlink{kmp__error_8c_a464ed6bb20c9a38ab90bb491babe68ad}{\_\_kmp\_check\_workshare}( gtid, ws, loc );
826             pr->\hyperlink{structdispatch__private__info__template_aae7f21fbe2cebe26a14031af3bf17285}{pushed\_ws} = \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a3eea97b407ad5cbc5f8707a949722738}{ct\_none};
827         \}
828     \}
829 
830     \textcolor{keywordflow}{switch} ( schedule ) \{
831 \textcolor{preprocessor}{    #if  ( KMP\_STATIC\_STEAL\_ENABLED && KMP\_ARCH\_X86\_64 )}
832 \textcolor{preprocessor}{}    \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81beae4b8e84801f56fdb39472c45762bd051}{kmp\_sch\_static\_steal}:
833         \{
834             T nproc = team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc;
835             T ntc, init;
836 
837             \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%d kmp\_sch\_static\_steal case\(\backslash\)n"}, gtid ) );
838 
839             ntc = (tc % chunk ? 1 : 0) + tc / chunk;
840             \textcolor{keywordflow}{if} ( nproc > 1 && ntc >= nproc ) \{
841                 T \textcolor{keywordtype}{id} = \hyperlink{kmp_8h_afb8f84fff9682417eb1c484ffbfdc6ee}{\_\_kmp\_tid\_from\_gtid}(gtid);
842                 T small\_chunk, extras;
843 
844                 small\_chunk = ntc / nproc;
845                 extras = ntc % nproc;
846 
847                 init = \textcolor{keywordtype}{id} * small\_chunk + ( \textcolor{keywordtype}{id} < extras ? \textcolor{keywordtype}{id} : extras );
848                 pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count = init;
849                 pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ub = init + small\_chunk + ( \textcolor{keywordtype}{id} < extras ? 1 : 0 );
850 
851                 pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm2 = lb;
852                 \textcolor{comment}{//pr->pfields.parm3 = 0; // it's not used in static\_steal}
853                 pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm4 = \hyperlink{ittnotify__static_8h_a9ebeaf6e841ab2e3ed2f92a8850e0c3d}{id};
854                 pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.st = st;
855                 \textcolor{keywordflow}{break};
856             \} \textcolor{keywordflow}{else} \{
857                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%d falling-through to
       kmp\_sch\_static\_balanced\(\backslash\)n"},
858                                gtid ) );
859                 schedule = \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea5869a7f3c202fef826c9368fa155dcdb}{kmp\_sch\_static\_balanced};
860                 \textcolor{comment}{/* too few iterations: fall-through to kmp\_sch\_static\_balanced */}
861             \} \textcolor{comment}{// if}
862             \textcolor{comment}{/* FALL-THROUGH to static balanced */}
863         \} \textcolor{comment}{// case}
864 \textcolor{preprocessor}{    #endif}
865 \textcolor{preprocessor}{}    \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea5869a7f3c202fef826c9368fa155dcdb}{kmp\_sch\_static\_balanced}:
866         \{
867             T nproc = team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc;
868             T init, limit;
869 
870             \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%d kmp\_sch\_static\_balanced case\(\backslash\)n"},
871                             gtid ) );
872 
873             \textcolor{keywordflow}{if} ( nproc > 1 ) \{
874                 T \textcolor{keywordtype}{id} = \hyperlink{kmp_8h_afb8f84fff9682417eb1c484ffbfdc6ee}{\_\_kmp\_tid\_from\_gtid}(gtid);
875 
876                 \textcolor{keywordflow}{if} ( tc < nproc ) \{
877                     \textcolor{keywordflow}{if} ( \textcolor{keywordtype}{id} < tc ) \{
878                         init = \hyperlink{ittnotify__static_8h_a9ebeaf6e841ab2e3ed2f92a8850e0c3d}{id};
879                         limit = \hyperlink{ittnotify__static_8h_a9ebeaf6e841ab2e3ed2f92a8850e0c3d}{id};
880                         pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1 = (\textcolor{keywordtype}{id} == tc - 1);  \textcolor{comment}{/* parm1 stores *plastiter */}
881                     \} \textcolor{keywordflow}{else} \{
882                         pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count = 1;  \textcolor{comment}{/* means no more chunks to execute */}
883                         pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1 = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
884                         \textcolor{keywordflow}{break};
885                     \}
886                 \} \textcolor{keywordflow}{else} \{
887                     T small\_chunk = tc / nproc;
888                     T extras = tc % nproc;
889                     init = \textcolor{keywordtype}{id} * small\_chunk + (\textcolor{keywordtype}{id} < extras ? \textcolor{keywordtype}{id} : extras);
890                     limit = init + small\_chunk - (\textcolor{keywordtype}{id} < extras ? 0 : 1);
891                     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1 = (\textcolor{keywordtype}{id} == nproc - 1);
892                 \}
893             \} \textcolor{keywordflow}{else} \{
894                 \textcolor{keywordflow}{if} ( tc > 0 ) \{
895                     init = 0;
896                     limit = tc - 1;
897                     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1 = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
898                 \} \textcolor{keywordflow}{else} \{
899                     \textcolor{comment}{// zero trip count}
900                     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count = 1;  \textcolor{comment}{/* means no more chunks to execute */}
901                     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1 = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
902                     \textcolor{keywordflow}{break};
903                 \}
904             \}
905 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
906 \textcolor{preprocessor}{}            \textcolor{comment}{// Calculate chunk for metadata report}
907             \textcolor{keywordflow}{if} ( itt\_need\_metadata\_reporting )
908                 cur\_chunk = limit - init + 1;
909 \textcolor{preprocessor}{#endif}
910 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} ( st == 1 ) \{
911                 pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.lb = lb + init;
912                 pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ub = lb + limit;
913             \} \textcolor{keywordflow}{else} \{
914                 T ub\_tmp = lb + limit * st;   \textcolor{comment}{// calculated upper bound, "ub" is user-defined upper bound}
915                 pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.lb = lb + init * st;
916                 \textcolor{comment}{// adjust upper bound to "ub" if needed, so that MS lastprivate will match it exactly}
917                 \textcolor{keywordflow}{if} ( st > 0 ) \{
918                     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ub = ( ub\_tmp + st > ub ? ub : ub\_tmp );
919                 \} \textcolor{keywordflow}{else} \{
920                     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ub = ( ub\_tmp + st < ub ? ub : ub\_tmp );
921                 \}
922             \}
923             \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} ) \{
924                 pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower = init;
925                 pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper = limit;
926             \}
927             \textcolor{keywordflow}{break};
928         \} \textcolor{comment}{// case}
929     \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81beaa6177807dac327b1240c43ab9f2d1f12}{kmp\_sch\_guided\_iterative\_chunked} :
930         \{
931             T nproc = team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc;
932             \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100,(\textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%d kmp\_sch\_guided\_iterative\_chunked case\(\backslash\)n"},gtid)
      );
933 
934             \textcolor{keywordflow}{if} ( nproc > 1 ) \{
935                 \textcolor{keywordflow}{if} ( (2L * chunk + 1 ) * nproc >= tc ) \{
936                     \textcolor{comment}{/* chunk size too large, switch to dynamic */}
937                     schedule = \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea55ec779ed16f7959a24e65feadcbdbeb}{kmp\_sch\_dynamic\_chunked};
938                 \} \textcolor{keywordflow}{else} \{
939                     \textcolor{comment}{// when remaining iters become less than parm2 - switch to dynamic}
940                     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm2 = \hyperlink{kmp__dispatch_8cpp_a35e3a4cac3976f6194b63fa6552afbc7}{guided\_int\_param} * nproc * ( chunk + 1 );
941                     *(\textcolor{keywordtype}{double}*)&pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm3 = \hyperlink{kmp__dispatch_8cpp_a966593cb61a9833fa94a07b9f6ecaaba}{guided\_flt\_param} / nproc;   \textcolor{comment}{// may occupy
       parm3 and parm4}
942                 \}
943             \} \textcolor{keywordflow}{else} \{
944                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100,(\textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%d falling-through to kmp\_sch\_static\_greedy\(\backslash\)n
      "},gtid));
945                 schedule = \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea67c1b7c70c012361c0218269ac063606}{kmp\_sch\_static\_greedy};
946                 \textcolor{comment}{/* team->t.t\_nproc == 1: fall-through to kmp\_sch\_static\_greedy */}
947                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100,(\textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%d kmp\_sch\_static\_greedy case\(\backslash\)n"},gtid));
948                 pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1 = tc;
949             \} \textcolor{comment}{// if}
950         \} \textcolor{comment}{// case}
951         \textcolor{keywordflow}{break};
952     \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea569ad1692047e89645f19bca3f2c26af}{kmp\_sch\_guided\_analytical\_chunked}:
953         \{
954             T nproc = team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc;
955             \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%d kmp\_sch\_guided\_analytical\_chunked case\(\backslash\)n"}, 
      gtid));
956 
957             \textcolor{keywordflow}{if} ( nproc > 1 ) \{
958                 \textcolor{keywordflow}{if} ( (2L * chunk + 1 ) * nproc >= tc ) \{
959                     \textcolor{comment}{/* chunk size too large, switch to dynamic */}
960                     schedule = \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea55ec779ed16f7959a24e65feadcbdbeb}{kmp\_sch\_dynamic\_chunked};
961                 \} \textcolor{keywordflow}{else} \{
962                     \textcolor{comment}{/* commonly used term: (2 nproc - 1)/(2 nproc) */}
963                     DBL \hyperlink{ittnotify__static_8h_a25eb27b280775b27a5ddc4d1673225aa}{x};
964 
965 \textcolor{preprocessor}{                    #if KMP\_OS\_WINDOWS && KMP\_ARCH\_X86}
966 \textcolor{preprocessor}{}                    \textcolor{comment}{/* Linux* OS already has 64-bit computation by default for}
967 \textcolor{comment}{                       long double, and on Windows* OS on Intel(R) 64,}
968 \textcolor{comment}{                       /Qlong\_double doesn't work.  On Windows* OS}
969 \textcolor{comment}{                       on IA-32 architecture, we need to set precision to}
970 \textcolor{comment}{                       64-bit instead of the default 53-bit. Even though long}
971 \textcolor{comment}{                       double doesn't work on Windows* OS on Intel(R) 64, the}
972 \textcolor{comment}{                       resulting lack of precision is not expected to impact}
973 \textcolor{comment}{                       the correctness of the algorithm, but this has not been}
974 \textcolor{comment}{                       mathematically proven.}
975 \textcolor{comment}{                    */}
976                     \textcolor{comment}{// save original FPCW and set precision to 64-bit, as}
977                     \textcolor{comment}{// Windows* OS on IA-32 architecture defaults to 53-bit}
978                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} oldFpcw = \_control87(0,0);
979                     \_control87(\_PC\_64,\_MCW\_PC); \textcolor{comment}{// 0,0x30000}
980 \textcolor{preprocessor}{                    #endif}
981 \textcolor{preprocessor}{}                    \textcolor{comment}{/* value used for comparison in solver for cross-over point */}
982                     \textcolor{keywordtype}{long} \textcolor{keywordtype}{double} target = ((\textcolor{keywordtype}{long} double)chunk * 2 + 1) * nproc / tc;
983 
984                     \textcolor{comment}{/* crossover point--chunk indexes equal to or greater than}
985 \textcolor{comment}{                       this point switch to dynamic-style scheduling */}
986                     UT   cross;
987 
988                     \textcolor{comment}{/* commonly used term: (2 nproc - 1)/(2 nproc) */}
989                     x = (\textcolor{keywordtype}{long} double)1.0 - (\textcolor{keywordtype}{long} \textcolor{keywordtype}{double})0.5 / nproc;
990 
991 \textcolor{preprocessor}{                    #ifdef KMP\_DEBUG}
992 \textcolor{preprocessor}{}                    \{ \textcolor{comment}{// test natural alignment}
993                         \textcolor{keyword}{struct }\_test\_a \{
994                             \textcolor{keywordtype}{char} a;
995                             \textcolor{keyword}{union }\{
996                                 \textcolor{keywordtype}{char} b;
997                                 DBL  \hyperlink{ittnotify__static_8h_a6b8793c3e5dd8bb67b04141713a65d2d}{d};
998                             \};
999                         \} t;
1000                         ptrdiff\_t natural\_alignment = (ptrdiff\_t)&t.b - (ptrdiff\_t)&t - (ptrdiff\_t)1;
1001                         \textcolor{comment}{//\_\_kmp\_warn( " %llx %llx %lld", (long long)&t.d, (long long)&t, (long
       long)natural\_alignment );}
1002                         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( ( ( (ptrdiff\_t)&pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.
      \hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm3 ) & ( natural\_alignment ) ) == 0 );
1003                     \}
1004 \textcolor{preprocessor}{                    #endif // KMP\_DEBUG}
1005 \textcolor{preprocessor}{}
1006                     \textcolor{comment}{/* save the term in thread private dispatch structure */}
1007                     *(DBL*)&pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm3 = x;
1008 
1009                     \textcolor{comment}{/* solve for the crossover point to the nearest integer i for which C\_i <= chunk */}
1010                     \{
1011                         UT          left, right, mid;
1012                         \textcolor{keywordtype}{long} \textcolor{keywordtype}{double} \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p};
1013 
1014                         \textcolor{comment}{/* estimate initial upper and lower bound */}
1015 
1016                         \textcolor{comment}{/* doesn't matter what value right is as long as it is positive, but}
1017 \textcolor{comment}{                           it affects performance of the solver}
1018 \textcolor{comment}{                        */}
1019                         right = 229;
1020                         \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p} = \_\_kmp\_pow< UT >(x,right);
1021                         \textcolor{keywordflow}{if} ( \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p} > target ) \{
1022                             \textcolor{keywordflow}{do}\{
1023                                 \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p} *= \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p};
1024                                 right <<= 1;
1025                             \} \textcolor{keywordflow}{while}(\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p}>target && right < (1<<27));
1026                             left = right >> 1; \textcolor{comment}{/* lower bound is previous (failed) estimate of upper bound 
      */}
1027                         \} \textcolor{keywordflow}{else} \{
1028                             left = 0;
1029                         \}
1030 
1031                         \textcolor{comment}{/* bisection root-finding method */}
1032                         \textcolor{keywordflow}{while} ( left + 1 < right ) \{
1033                             mid = (left + right) / 2;
1034                             \textcolor{keywordflow}{if} ( \_\_kmp\_pow< UT >(x,mid) > target ) \{
1035                                 left = mid;
1036                             \} \textcolor{keywordflow}{else} \{
1037                                 right = mid;
1038                             \}
1039                         \} \textcolor{comment}{// while}
1040                         cross = right;
1041                     \}
1042                     \textcolor{comment}{/* assert sanity of computed crossover point */}
1043                     \hyperlink{kmp__debug_8h_a5323a368e8ba273b17c46906dd9ec78c}{KMP\_ASSERT}(cross && \_\_kmp\_pow< UT >(x, cross - 1) > target && \_\_kmp\_pow< UT >
      (x, cross) <= target);
1044 
1045                     \textcolor{comment}{/* save the crossover point in thread private dispatch structure */}
1046                     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm2 = cross;
1047 
1048                     \textcolor{comment}{// C75803}
1049 \textcolor{preprocessor}{                    #if ( ( KMP\_OS\_LINUX || KMP\_OS\_WINDOWS ) && KMP\_ARCH\_X86 ) && ( ! defined( KMP\_I8 ) )}
1050 \textcolor{preprocessor}{}\textcolor{preprocessor}{                        #define GUIDED\_ANALYTICAL\_WORKAROUND (*( DBL * )&pr->u.p.parm3)}
1051 \textcolor{preprocessor}{}\textcolor{preprocessor}{                    #else}
1052 \textcolor{preprocessor}{}\textcolor{preprocessor}{                        #define GUIDED\_ANALYTICAL\_WORKAROUND (x)}
1053 \textcolor{preprocessor}{}\textcolor{preprocessor}{                    #endif}
1054 \textcolor{preprocessor}{}                    \textcolor{comment}{/* dynamic-style scheduling offset */}
1055                     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count = tc - \hyperlink{kmp__dispatch_8cpp_a0c219c6a43aa6c80e170c8baaa813de8}{\_\_kmp\_dispatch\_guided\_remaining}(
      tc, \hyperlink{kmp__dispatch_8cpp_a0fae686f1908344ce3f13a95bea3f242}{GUIDED\_ANALYTICAL\_WORKAROUND}, cross) - cross * chunk;
1056 \textcolor{preprocessor}{                    #if KMP\_OS\_WINDOWS && KMP\_ARCH\_X86}
1057 \textcolor{preprocessor}{}                        \textcolor{comment}{// restore FPCW}
1058                         \_control87(oldFpcw,\_MCW\_PC);
1059 \textcolor{preprocessor}{                    #endif}
1060 \textcolor{preprocessor}{}                \} \textcolor{comment}{// if}
1061             \} \textcolor{keywordflow}{else} \{
1062                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%d falling-through to kmp\_sch\_static\_greedy
      \(\backslash\)n"},
1063                                gtid ) );
1064                 schedule = \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea67c1b7c70c012361c0218269ac063606}{kmp\_sch\_static\_greedy};
1065                 \textcolor{comment}{/* team->t.t\_nproc == 1: fall-through to kmp\_sch\_static\_greedy */}
1066                 pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1 = tc;
1067             \} \textcolor{comment}{// if}
1068         \} \textcolor{comment}{// case}
1069         \textcolor{keywordflow}{break};
1070     \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea67c1b7c70c012361c0218269ac063606}{kmp\_sch\_static\_greedy}:
1071         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100,(\textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%d kmp\_sch\_static\_greedy case\(\backslash\)n"},gtid));
1072             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1 = ( team -> t.t\_nproc > 1 ) ?
1073                 ( tc + team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc - 1 ) / team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc :
1074                 tc;
1075         \textcolor{keywordflow}{break};
1076     \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea8521b598e4c2014936813c104adfab4b}{kmp\_sch\_static\_chunked} :
1077     \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea55ec779ed16f7959a24e65feadcbdbeb}{kmp\_sch\_dynamic\_chunked} :
1078         \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1 <= 0 ) \{
1079             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1 = \hyperlink{kmp_8h_a0b753aac7a3d6af072f31243cdab6d5f}{KMP\_DEFAULT\_CHUNK};
1080         \}
1081         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100,(\textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%d kmp\_sch\_static\_chunked/kmp\_sch\_dynamic\_chunked
       cases\(\backslash\)n"}, gtid));
1082         \textcolor{keywordflow}{break};
1083     \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea904631666318a8490fc48df394616dbd}{kmp\_sch\_trapezoidal} :
1084         \{
1085             \textcolor{comment}{/* TSS: trapezoid self-scheduling, minimum chunk\_size = parm1 */}
1086 
1087             T parm1, parm2, parm3, parm4;
1088             \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%d kmp\_sch\_trapezoidal case\(\backslash\)n"}, gtid ) );
1089 
1090             parm1 = chunk;
1091 
1092             \textcolor{comment}{/* F : size of the first cycle */}
1093             parm2 = ( tc / (2 * team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc) );
1094 
1095             \textcolor{keywordflow}{if} ( parm2 < 1 ) \{
1096                 parm2 = 1;
1097             \}
1098 
1099             \textcolor{comment}{/* L : size of the last cycle.  Make sure the last cycle}
1100 \textcolor{comment}{             *     is not larger than the first cycle.}
1101 \textcolor{comment}{             */}
1102             \textcolor{keywordflow}{if} ( parm1 < 1 ) \{
1103                 parm1 = 1;
1104             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( parm1 > parm2 ) \{
1105                 parm1 = parm2;
1106             \}
1107 
1108             \textcolor{comment}{/* N : number of cycles */}
1109             parm3 = ( parm2 + parm1 );
1110             parm3 = ( 2 * tc + parm3 - 1) / parm3;
1111 
1112             \textcolor{keywordflow}{if} ( parm3 < 2 ) \{
1113                 parm3 = 2;
1114             \}
1115 
1116             \textcolor{comment}{/* sigma : decreasing incr of the trapezoid */}
1117             parm4 = ( parm3 - 1 );
1118             parm4 = ( parm2 - parm1 ) / parm4;
1119 
1120             \textcolor{comment}{// pointless check, because parm4 >= 0 always}
1121             \textcolor{comment}{//if ( parm4 < 0 ) \{}
1122             \textcolor{comment}{//    parm4 = 0;}
1123             \textcolor{comment}{//\}}
1124 
1125             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1 = parm1;
1126             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm2 = parm2;
1127             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm3 = parm3;
1128             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm4 = parm4;
1129         \} \textcolor{comment}{// case}
1130         \textcolor{keywordflow}{break};
1131 
1132     \textcolor{keywordflow}{default}:
1133         \{
1134             \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1135                 \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},                        \textcolor{comment}{// Severity}
1136                 \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( UnknownSchedTypeDetected ), \textcolor{comment}{// Primary message}
1137                 \hyperlink{kmp__i18n_8h_ac5fe3f32cfaa3b9268776d372a0f09c4}{KMP\_HNT}( GetNewerLibrary ),          \textcolor{comment}{// Hint}
1138                 \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}                       \textcolor{comment}{// Variadic argument list terminator}
1139             );
1140         \}
1141         \textcolor{keywordflow}{break};
1142     \} \textcolor{comment}{// switch}
1143     pr->\hyperlink{structdispatch__private__info__template_afc7085a386a2b7b867aad26bbe8dfea7}{schedule} = schedule;
1144     \textcolor{keywordflow}{if} ( active ) \{
1145         \textcolor{comment}{/* The name of this buffer should be my\_buffer\_index when it's free to use it */}
1146 
1147         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%d before wait: my\_buffer\_index:%d
       sh->buffer\_index:%d\(\backslash\)n"},
1148                         gtid, my\_buffer\_index, sh->\hyperlink{structdispatch__shared__info__template_adbb52e9b93edf55cee184b9b44a6e77a}{buffer\_index}) );
1149         \_\_kmp\_wait\_yield< kmp\_uint32 >( & sh->\hyperlink{structdispatch__shared__info__template_adbb52e9b93edf55cee184b9b44a6e77a}{buffer\_index}, my\_buffer\_index, \_\_kmp\_eq<
       kmp\_uint32 >
1150                                         \hyperlink{kmp__itt_8h_ac31864b9b5b30f5dcac5ab285ee97ae0}{USE\_ITT\_BUILD\_ARG}( NULL )
1151                                         );
1152             \textcolor{comment}{// Note: KMP\_WAIT\_YIELD() cannot be used there: buffer index and my\_buffer\_index are}
1153             \textcolor{comment}{// *always* 32-bit integers.}
1154         \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();  \textcolor{comment}{/* is this necessary? */}
1155         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%d after wait: my\_buffer\_index:%d
       sh->buffer\_index:%d\(\backslash\)n"},
1156                         gtid, my\_buffer\_index, sh->\hyperlink{structdispatch__shared__info__template_adbb52e9b93edf55cee184b9b44a6e77a}{buffer\_index}) );
1157 
1158         th -> th.th\_dispatch -> th\_dispatch\_pr\_current = (
      \hyperlink{kmp_8h_a39b4260bfb46eb4f113a70e0a8ac26ea}{dispatch\_private\_info\_t}*) pr;
1159         th -> th.th\_dispatch -> th\_dispatch\_sh\_current = (\hyperlink{structdispatch__shared__info}{dispatch\_shared\_info\_t}*)  
      sh;
1160 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
1161 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} ) \{
1162             \_\_kmp\_itt\_ordered\_init( gtid );
1163         \}; \textcolor{comment}{// if}
1164         \textcolor{comment}{// Report loop metadata}
1165         \textcolor{keywordflow}{if} ( itt\_need\_metadata\_reporting ) \{
1166             \textcolor{comment}{// Only report metadata by master of active team at level 1}
1167             kmp\_uint64 schedtype = 0;
1168             \textcolor{keywordflow}{switch} ( schedule ) \{
1169             \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea8521b598e4c2014936813c104adfab4b}{kmp\_sch\_static\_chunked}:
1170             \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea5869a7f3c202fef826c9368fa155dcdb}{kmp\_sch\_static\_balanced}:\textcolor{comment}{// Chunk is calculated in the switch above}
1171                 \textcolor{keywordflow}{break};
1172             \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea67c1b7c70c012361c0218269ac063606}{kmp\_sch\_static\_greedy}:
1173                 cur\_chunk = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1;
1174                 \textcolor{keywordflow}{break};
1175             \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea55ec779ed16f7959a24e65feadcbdbeb}{kmp\_sch\_dynamic\_chunked}:
1176                 schedtype = 1;
1177                 \textcolor{keywordflow}{break};
1178             \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81beaa6177807dac327b1240c43ab9f2d1f12}{kmp\_sch\_guided\_iterative\_chunked}:
1179             \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea569ad1692047e89645f19bca3f2c26af}{kmp\_sch\_guided\_analytical\_chunked}:
1180                 schedtype = 2;
1181                 \textcolor{keywordflow}{break};
1182             \textcolor{keywordflow}{default}:
1183 \textcolor{comment}{//            Should we put this case under "static"?}
1184 \textcolor{comment}{//            case kmp\_sch\_static\_steal:}
1185                 schedtype = 3;
1186                 \textcolor{keywordflow}{break};
1187             \}
1188             \_\_kmp\_itt\_metadata\_loop(loc, schedtype, tc, cur\_chunk);
1189         \}
1190 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
1191 \textcolor{preprocessor}{}    \}; \textcolor{comment}{// if}
1192 
1193 \textcolor{preprocessor}{    #ifdef KMP\_DEBUG}
1194 \textcolor{preprocessor}{}    \{
1195         \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
1196         \textcolor{comment}{// create format specifiers before the debug output}
1197         buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
1198             \textcolor{stringliteral}{"\_\_kmp\_dispatch\_init: T#%%d returning: schedule:%%d ordered:%%%s lb:%%%s ub:%%%s"} \(\backslash\)
1199             \textcolor{stringliteral}{" st:%%%s tc:%%%s count:%%%s\(\backslash\)n\(\backslash\)tordered\_lower:%%%s ordered\_upper:%%%s"} \(\backslash\)
1200             \textcolor{stringliteral}{" parm1:%%%s parm2:%%%s parm3:%%%s parm4:%%%s\(\backslash\)n"},
1201             traits\_t< UT >::spec, traits\_t< T >::spec, traits\_t< T >::spec,
1202             traits\_t< ST >::spec, traits\_t< UT >::spec, traits\_t< UT >::spec,
1203             traits\_t< UT >::spec, traits\_t< UT >::spec, traits\_t< T >::spec,
1204             traits\_t< T >::spec, traits\_t< T >::spec, traits\_t< T >::spec );
1205         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(10, ( buff,
1206             gtid, pr->\hyperlink{structdispatch__private__info__template_afc7085a386a2b7b867aad26bbe8dfea7}{schedule}, pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered}, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.lb, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.
      \hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ub,
1207             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.st, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.tc, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count,
1208             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1,
1209             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm2, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm3, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm4 ) );
1210         \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
1211     \}
1212 \textcolor{preprocessor}{    #endif}
1213 \textcolor{preprocessor}{}\textcolor{preprocessor}{    #if ( KMP\_STATIC\_STEAL\_ENABLED )}
1214 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} ( \_\_\_kmp\_size\_type < 8 ) \{
1215       \textcolor{comment}{// It cannot be guaranteed that after execution of a loop with some other schedule kind}
1216       \textcolor{comment}{// all the parm3 variables will contain the same value.}
1217       \textcolor{comment}{// Even if all parm3 will be the same, it still exists a bad case like using 0 and 1}
1218       \textcolor{comment}{// rather than program life-time increment.}
1219       \textcolor{comment}{// So the dedicated variable is required. The 'static\_steal\_counter' is used.}
1220       \textcolor{keywordflow}{if}( schedule == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81beae4b8e84801f56fdb39472c45762bd051}{kmp\_sch\_static\_steal} ) \{
1221         \textcolor{comment}{// Other threads will inspect this variable when searching for a victim.}
1222         \textcolor{comment}{// This is a flag showing that other threads may steal from this thread since then.}
1223         \textcolor{keyword}{volatile} T * \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p} = &pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.static\_steal\_counter;
1224         *p = *p + 1;
1225       \}
1226     \}
1227 \textcolor{preprocessor}{    #endif // ( KMP\_STATIC\_STEAL\_ENABLED && USE\_STEALING )}
1228 \textcolor{preprocessor}{}
1229 \textcolor{preprocessor}{#if OMPT\_SUPPORT && OMPT\_TRACE}
1230 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (\hyperlink{ompt-general_8c_a966b31b6d05f79f5495f8d8e71732f68}{ompt\_enabled} &&
1231         \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_loop\_begin)) \{
1232         \hyperlink{structompt__team__info__t}{ompt\_team\_info\_t} *team\_info = \hyperlink{ompt-specific_8c_a89edd4fa7a424dfc144f73cedde5116c}{\_\_ompt\_get\_teaminfo}(0, NULL);
1233         \hyperlink{structompt__task__info__t}{ompt\_task\_info\_t} *task\_info = \hyperlink{ompt-specific_8c_a31168da811886ba5fef353af949900b3}{\_\_ompt\_get\_taskinfo}(0);
1234         \hyperlink{ompt-general_8c_a84a29d89cef82c7c38e1ee1f70ec994f}{ompt\_callbacks}.ompt\_callback(ompt\_event\_loop\_begin)(
1235             team\_info->\hyperlink{structompt__team__info__t_aea8969d8ca37577c35b466c675a7a241}{parallel\_id}, task\_info->\hyperlink{structompt__task__info__t_a9b45ec47bd1086973892108a3a71e6fe}{task\_id}, team\_info->
      \hyperlink{structompt__team__info__t_a8fa76f60a770055c3f0bed45a7120cd6}{microtask});
1236     \}
1237 \textcolor{preprocessor}{#endif}
1238 \textcolor{preprocessor}{}\}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a4bd3681186a30c88e2f1da0242c4e69d}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-next@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-next}}
\index{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-next@{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-next}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-next}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ static {\bf int} \-\_\-\-\_\-kmp\-\_\-dispatch\-\_\-next (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc, }
\item[{{\bf int}}]{gtid, }
\item[{kmp\-\_\-int32 $\ast$}]{p\-\_\-last, }
\item[{T $\ast$}]{p\-\_\-lb, }
\item[{T $\ast$}]{p\-\_\-ub, }
\item[{typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t $\ast$}]{p\-\_\-st}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_a4bd3681186a30c88e2f1da0242c4e69d}


Definition at line 1408 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
1410   \{
1411 
1412     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< T >::unsigned\_t  UT;
1413     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< T >::signed\_t    ST;
1414     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< T >::floating\_t  DBL;
1415 \textcolor{preprocessor}{#if ( KMP\_STATIC\_STEAL\_ENABLED && KMP\_ARCH\_X86\_64 )}
1416 \textcolor{preprocessor}{}    \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} \_\_\_kmp\_size\_type = \textcolor{keyword}{sizeof}( UT );
1417 \textcolor{preprocessor}{#endif}
1418 \textcolor{preprocessor}{}
1419     \textcolor{comment}{// This is potentially slightly misleading, schedule(runtime) will appear here even if the actual
       runtme schedule}
1420     \textcolor{comment}{// is static. (Which points out a disadavantage of schedule(runtime): even when static scheduling is
       used it costs}
1421     \textcolor{comment}{// more than a compile time choice to use static scheduling would.)}
1422     \hyperlink{group__STATS__GATHERING_ga62f4b6e3a4ba48c04b172b97df137839}{KMP\_TIME\_BLOCK}(FOR\_dynamic\_scheduling);
1423 
1424     \textcolor{keywordtype}{int}                                   \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1425     \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< T >} * pr;
1426     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}                          * th   = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
1427     \hyperlink{unionkmp__team}{kmp\_team\_t}                          * team = th -> th.th\_team;
1428 
1429     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( p\_lb && p\_ub && p\_st ); \textcolor{comment}{// AC: these cannot be NULL}
1430 \textcolor{preprocessor}{    #ifdef KMP\_DEBUG}
1431 \textcolor{preprocessor}{}    \{
1432         \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
1433         \textcolor{comment}{// create format specifiers before the debug output}
1434         buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
1435             \textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%%d called p\_lb:%%%s p\_ub:%%%s p\_st:%%%s p\_last: %%p\(\backslash\)n"},
1436             traits\_t< T >::spec, traits\_t< T >::spec, traits\_t< ST >::spec );
1437         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(1000, ( buff, gtid, *p\_lb, *p\_ub, p\_st ? *p\_st : 0, p\_last ) );
1438         \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
1439     \}
1440 \textcolor{preprocessor}{    #endif}
1441 \textcolor{preprocessor}{}
1442     \textcolor{keywordflow}{if} ( team -> t.t\_serialized ) \{
1443         \textcolor{comment}{/* NOTE: serialize this dispatch becase we are not at the active level */}
1444         pr = \textcolor{keyword}{reinterpret\_cast<} \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< T >}* \textcolor{keyword}{>}
1445             ( th -> th.th\_dispatch -> th\_disp\_buffer ); \textcolor{comment}{/* top of the stack */}
1446         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( pr );
1447 
1448         \textcolor{keywordflow}{if} ( (status = (pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.tc != 0)) == 0 ) \{
1449             *p\_lb = 0;
1450             *p\_ub = 0;
1451 \textcolor{comment}{//            if ( p\_last != NULL )}
1452 \textcolor{comment}{//                *p\_last = 0;}
1453             \textcolor{keywordflow}{if} ( p\_st != NULL )
1454                 *p\_st = 0;
1455             \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
1456                 \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_aae7f21fbe2cebe26a14031af3bf17285}{pushed\_ws} != \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a3eea97b407ad5cbc5f8707a949722738}{ct\_none} ) \{
1457                     pr->\hyperlink{structdispatch__private__info__template_aae7f21fbe2cebe26a14031af3bf17285}{pushed\_ws} = \hyperlink{kmp__error_8c_a93d9c89e2629352b4db28263a95b80f4}{\_\_kmp\_pop\_workshare}( gtid, pr->
      \hyperlink{structdispatch__private__info__template_aae7f21fbe2cebe26a14031af3bf17285}{pushed\_ws}, loc );
1458                 \}
1459             \}
1460         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_a173b2536a5a9e9dc1945f77dc0497683}{nomerge} ) \{
1461             kmp\_int32 last;
1462             T         start;
1463             UT        limit, trip, init;
1464             ST        incr;
1465             T         chunk = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1;
1466 
1467             \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%d kmp\_sch\_dynamic\_chunked case\(\backslash\)n"}, gtid ) );
1468 
1469             init = chunk * pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count++;
1470             trip = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.tc - 1;
1471 
1472             \textcolor{keywordflow}{if} ( (status = (init <= trip)) == 0 ) \{
1473                 *p\_lb = 0;
1474                 *p\_ub = 0;
1475 \textcolor{comment}{//                if ( p\_last != NULL )}
1476 \textcolor{comment}{//                    *p\_last = 0;}
1477                 \textcolor{keywordflow}{if} ( p\_st != NULL )
1478                     *p\_st = 0;
1479                 \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
1480                     \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_aae7f21fbe2cebe26a14031af3bf17285}{pushed\_ws} != \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a3eea97b407ad5cbc5f8707a949722738}{ct\_none} ) \{
1481                         pr->\hyperlink{structdispatch__private__info__template_aae7f21fbe2cebe26a14031af3bf17285}{pushed\_ws} = \hyperlink{kmp__error_8c_a93d9c89e2629352b4db28263a95b80f4}{\_\_kmp\_pop\_workshare}( gtid, pr->
      \hyperlink{structdispatch__private__info__template_aae7f21fbe2cebe26a14031af3bf17285}{pushed\_ws}, loc );
1482                     \}
1483                 \}
1484             \} \textcolor{keywordflow}{else} \{
1485                 start = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.lb;
1486                 limit = chunk + init - 1;
1487                 incr  = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.st;
1488 
1489                 \textcolor{keywordflow}{if} ( (last = (limit >= trip)) != 0 ) \{
1490                     limit = trip;
1491 \textcolor{preprocessor}{                    #if KMP\_OS\_WINDOWS}
1492 \textcolor{preprocessor}{}                    pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.last\_upper = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ub;
1493 \textcolor{preprocessor}{                    #endif }\textcolor{comment}{/* KMP\_OS\_WINDOWS */}\textcolor{preprocessor}{}
1494 \textcolor{preprocessor}{}                \}
1495                 \textcolor{keywordflow}{if} ( p\_last != NULL )
1496                     *p\_last = last;
1497                 \textcolor{keywordflow}{if} ( p\_st != NULL )
1498                     *p\_st = incr;
1499                 \textcolor{keywordflow}{if} ( incr == 1 ) \{
1500                     *p\_lb = start + init;
1501                     *p\_ub = start + limit;
1502                 \} \textcolor{keywordflow}{else} \{
1503                     *p\_lb = start + init * incr;
1504                     *p\_ub = start + limit * incr;
1505                 \}
1506 
1507                 \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} ) \{
1508                     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower = init;
1509                     pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper = limit;
1510 \textcolor{preprocessor}{                    #ifdef KMP\_DEBUG}
1511 \textcolor{preprocessor}{}                    \{
1512                         \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
1513                         \textcolor{comment}{// create format specifiers before the debug output}
1514                         buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
1515                             \textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%%d ordered\_lower:%%%s ordered\_upper:%%%s\(\backslash\)n"},
1516                             traits\_t< UT >::spec, traits\_t< UT >::spec );
1517                         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(1000, ( buff, gtid, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower, pr->
      \hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper ) );
1518                         \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
1519                     \}
1520 \textcolor{preprocessor}{                    #endif}
1521 \textcolor{preprocessor}{}                \} \textcolor{comment}{// if}
1522             \} \textcolor{comment}{// if}
1523         \} \textcolor{keywordflow}{else} \{
1524             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.tc = 0;
1525             *p\_lb = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.lb;
1526             *p\_ub = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ub;
1527 \textcolor{preprocessor}{            #if KMP\_OS\_WINDOWS}
1528 \textcolor{preprocessor}{}            pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.last\_upper = *p\_ub;
1529 \textcolor{preprocessor}{            #endif }\textcolor{comment}{/* KMP\_OS\_WINDOWS */}\textcolor{preprocessor}{}
1530 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} ( p\_last != NULL )
1531                 *p\_last = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1532             \textcolor{keywordflow}{if} ( p\_st != NULL )
1533                 *p\_st = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.st;
1534         \} \textcolor{comment}{// if}
1535 \textcolor{preprocessor}{        #ifdef KMP\_DEBUG}
1536 \textcolor{preprocessor}{}        \{
1537             \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
1538             \textcolor{comment}{// create format specifiers before the debug output}
1539             buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
1540                 \textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%%d serialized case: p\_lb:%%%s "} \(\backslash\)
1541                 \textcolor{stringliteral}{"p\_ub:%%%s p\_st:%%%s p\_last:%%p %%d  returning:%%d\(\backslash\)n"},
1542                 traits\_t< T >::spec, traits\_t< T >::spec, traits\_t< ST >::spec );
1543             \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(10, ( buff, gtid, *p\_lb, *p\_ub, *p\_st, p\_last, *p\_last, status) );
1544             \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
1545         \}
1546 \textcolor{preprocessor}{        #endif}
1547 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if INCLUDE\_SSC\_MARKS}
1548 \textcolor{preprocessor}{}        SSC\_MARK\_DISPATCH\_NEXT();
1549 \textcolor{preprocessor}{#endif}
1550 \textcolor{preprocessor}{}        \hyperlink{kmp__dispatch_8cpp_a11568d85642b5813503752538a5a9c73}{OMPT\_LOOP\_END};
1551         \textcolor{keywordflow}{return} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1552     \} \textcolor{keywordflow}{else} \{
1553         kmp\_int32 last = 0;
1554         \hyperlink{structdispatch__shared__info__template}{dispatch\_shared\_info\_template< UT >} *sh;
1555         T         start;
1556         ST        incr;
1557         UT        limit, trip, init;
1558 
1559         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( th->th.th\_dispatch ==
1560                 &th->th.th\_team->t.t\_dispatch[th->th.th\_info.ds.ds\_tid] );
1561 
1562         pr = \textcolor{keyword}{reinterpret\_cast<} \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< T >}* \textcolor{keyword}{>}
1563             ( th->th.th\_dispatch->th\_dispatch\_pr\_current );
1564         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( pr );
1565         sh = \textcolor{keyword}{reinterpret\_cast<} \hyperlink{structdispatch__shared__info__template}{dispatch\_shared\_info\_template< UT >}* \textcolor{keyword}{>}
1566             ( th->th.th\_dispatch->th\_dispatch\_sh\_current );
1567         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( sh );
1568 
1569         \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.tc == 0 ) \{
1570             \textcolor{comment}{// zero trip count}
1571             status = 0;
1572         \} \textcolor{keywordflow}{else} \{
1573             \textcolor{keywordflow}{switch} (pr->\hyperlink{structdispatch__private__info__template_afc7085a386a2b7b867aad26bbe8dfea7}{schedule}) \{
1574 \textcolor{preprocessor}{            #if ( KMP\_STATIC\_STEAL\_ENABLED && KMP\_ARCH\_X86\_64 )}
1575 \textcolor{preprocessor}{}            \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81beae4b8e84801f56fdb39472c45762bd051}{kmp\_sch\_static\_steal}:
1576                 \{
1577                     T chunk = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1;
1578 
1579                     \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%d kmp\_sch\_static\_steal case\(\backslash\)n"}, gtid) )
      ;
1580 
1581                     trip = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.tc - 1;
1582 
1583                     \textcolor{keywordflow}{if} ( \_\_\_kmp\_size\_type > 4 ) \{
1584                         \textcolor{comment}{// Other threads do not look into the data of this thread,}
1585                         \textcolor{comment}{//  so it's not necessary to make volatile casting.}
1586                         init   = ( pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count )++;
1587                         status = ( init < (UT)pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ub );
1588                     \} \textcolor{keywordflow}{else} \{
1589                         \textcolor{keyword}{typedef} \textcolor{keyword}{union }\{
1590                             \textcolor{keyword}{struct }\{
1591                                 UT \hyperlink{ittnotify__static_8h_a9da14338c9c3be6f21c41cf4ec79eaf1}{count};
1592                                 T  ub;
1593                             \} \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p};
1594                             kmp\_int64 b;
1595                         \} union\_i4;
1596                         \textcolor{comment}{// All operations on 'count' or 'ub' must be combined atomically together.}
1597                         \textcolor{comment}{// stealing implemented only for 4-byte indexes}
1598                         \{
1599                             union\_i4 vold, vnew;
1600                             vold.b = *( \textcolor{keyword}{volatile} kmp\_int64 * )(&pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count);
1601                             vnew = vold;
1602                             vnew.p.count++;
1603                             \textcolor{keywordflow}{while}( ! \hyperlink{kmp__os_8h_a530a2ef10afdb7b7f5dcf2ac226e80ba}{KMP\_COMPARE\_AND\_STORE\_ACQ64}(
1604                                         ( \textcolor{keyword}{volatile} kmp\_int64* )&pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count,
1605                                         *\hyperlink{kmp__os_8h_aaa9e2fb88f003bd3a22795aadf723e53}{VOLATILE\_CAST}(kmp\_int64 *)&vold.b,
1606                                         *\hyperlink{kmp__os_8h_aaa9e2fb88f003bd3a22795aadf723e53}{VOLATILE\_CAST}(kmp\_int64 *)&vnew.b ) ) \{
1607                                 \hyperlink{kmp_8h_a0ae7084deafcd923a77e45e93058c459}{KMP\_CPU\_PAUSE}();
1608                                 vold.b = *( \textcolor{keyword}{volatile} kmp\_int64 * )(&pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count);
1609                                 vnew = vold;
1610                                 vnew.p.count++;
1611                             \}
1612                             vnew = vold;
1613                             init   = vnew.p.count;
1614                             status = ( init < (UT)vnew.p.ub ) ;
1615                         \}
1616 
1617                         \textcolor{keywordflow}{if}( !status ) \{
1618                             \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}   **other\_threads = team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_threads;
1619                             \textcolor{keywordtype}{int}          while\_limit = 10;
1620                             \textcolor{keywordtype}{int}          while\_index = 0;
1621 
1622                             \textcolor{comment}{// TODO: algorithm of searching for a victim}
1623                             \textcolor{comment}{// should be cleaned up and measured}
1624                             \textcolor{keywordflow}{while} ( ( !status ) && ( while\_limit != ++while\_index ) ) \{
1625                                 union\_i4  vold, vnew;
1626                                 kmp\_int32 remaining; \textcolor{comment}{// kmp\_int32 because KMP\_I4 only}
1627                                 T         victimIdx    = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm4;
1628                                 T         oldVictimIdx = victimIdx;
1629                                 \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< T >} * 
      victim;
1630 
1631                                 \textcolor{keywordflow}{do} \{
1632                                     \textcolor{keywordflow}{if}( !victimIdx ) \{
1633                                         victimIdx = team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc - 1;
1634                                     \} \textcolor{keywordflow}{else} \{
1635                                         --victimIdx;
1636                                     \}
1637                                     victim = \textcolor{keyword}{reinterpret\_cast<} 
      \hyperlink{structdispatch__private__info__template}{dispatch\_private\_info\_template< T >}* \textcolor{keyword}{>}
1638                                         ( other\_threads[victimIdx]->th.th\_dispatch->th\_dispatch\_pr\_current 
      );
1639                                 \} \textcolor{keywordflow}{while} ( (victim == NULL || victim == pr) && oldVictimIdx != victimIdx );
1640                                 \textcolor{comment}{// TODO: think about a proper place of this test}
1641                                 \textcolor{keywordflow}{if} ( ( !victim ) ||
1642                                    ( (*( \textcolor{keyword}{volatile} T * )&victim->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.static\_steal\_counter) !=
1643                                      (*( \textcolor{keyword}{volatile} T * )&pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.static\_steal\_counter) ) ) \{
1644                                     \textcolor{comment}{// TODO: delay would be nice}
1645                                     \textcolor{keywordflow}{continue};
1646                                     \textcolor{comment}{// the victim is not ready yet to participate in stealing}
1647                                     \textcolor{comment}{// because the victim is still in kmp\_init\_dispatch}
1648                                 \}
1649                                 \textcolor{keywordflow}{if} ( oldVictimIdx == victimIdx ) \{
1650                                     \textcolor{keywordflow}{break};
1651                                 \}
1652                                 pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm4 = victimIdx;
1653 
1654                                 \textcolor{keywordflow}{while}( 1 ) \{
1655                                     vold.b = *( \textcolor{keyword}{volatile} kmp\_int64 * )( &victim->
      \hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count );
1656                                     vnew = vold;
1657 
1658                                     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( (vnew.p.ub - 1) * (UT)chunk <= trip )
      ;
1659                                     \textcolor{keywordflow}{if} ( vnew.p.count >= (UT)vnew.p.ub || (remaining = vnew.p.ub - vnew.p.
      count) < 4 ) \{
1660                                         \textcolor{keywordflow}{break};
1661                                     \}
1662                                     vnew.p.ub -= (remaining >> 2);
1663                                     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}((vnew.p.ub - 1) * (UT)chunk <= trip);
1664 \textcolor{preprocessor}{                                    #pragma warning( push )}
1665 \textcolor{preprocessor}{}                                    \textcolor{comment}{// disable warning on pointless comparison of unsigned with 0}
1666 \textcolor{preprocessor}{                                    #pragma warning( disable: 186 )}
1667 \textcolor{preprocessor}{}                                        \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(vnew.p.ub >= 0);
1668 \textcolor{preprocessor}{                                    #pragma warning( pop )}
1669 \textcolor{preprocessor}{}                                    \textcolor{comment}{// TODO: Should this be acquire or release?}
1670                                     \textcolor{keywordflow}{if} ( \hyperlink{kmp__os_8h_a530a2ef10afdb7b7f5dcf2ac226e80ba}{KMP\_COMPARE\_AND\_STORE\_ACQ64}(
1671                                             ( \textcolor{keyword}{volatile} kmp\_int64 * )&victim->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.
      \hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count,
1672                                             *\hyperlink{kmp__os_8h_aaa9e2fb88f003bd3a22795aadf723e53}{VOLATILE\_CAST}(kmp\_int64 *)&vold.b,
1673                                             *\hyperlink{kmp__os_8h_aaa9e2fb88f003bd3a22795aadf723e53}{VOLATILE\_CAST}(kmp\_int64 *)&vnew.b ) ) \{
1674                                         status = 1;
1675                                         while\_index = 0;
1676                                         \textcolor{comment}{// now update own count and ub}
1677 \textcolor{preprocessor}{                                        #if KMP\_ARCH\_X86}
1678 \textcolor{preprocessor}{}                                        \textcolor{comment}{// stealing executed on non-KMP\_ARCH\_X86 only}
1679                                             \textcolor{comment}{// Atomic 64-bit write on ia32 is}
1680                                             \textcolor{comment}{// unavailable, so we do this in steps.}
1681                                             \textcolor{comment}{//     This code is not tested.}
1682                                             init = vold.p.count;
1683                                             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ub = 0;
1684                                             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count = init + 1;
1685                                             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ub = vnew.p.count;
1686 \textcolor{preprocessor}{                                        #else}
1687 \textcolor{preprocessor}{}                                            init = vnew.p.ub;
1688                                             vold.p.count = init + 1;
1689                                             \textcolor{comment}{// TODO: is it safe and enough?}
1690                                             *( \textcolor{keyword}{volatile} kmp\_int64 * )(&pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count) = vold.b;
1691 \textcolor{preprocessor}{                                        #endif // KMP\_ARCH\_X86}
1692 \textcolor{preprocessor}{}                                        \textcolor{keywordflow}{break};
1693                                     \} \textcolor{comment}{// if}
1694                                 \hyperlink{kmp_8h_a0ae7084deafcd923a77e45e93058c459}{KMP\_CPU\_PAUSE}();
1695                                 \} \textcolor{comment}{// while (1)}
1696                             \} \textcolor{comment}{// while}
1697                         \} \textcolor{comment}{// if}
1698                     \} \textcolor{comment}{// if}
1699                     \textcolor{keywordflow}{if} ( !status ) \{
1700                         *p\_lb = 0;
1701                         *p\_ub = 0;
1702                         \textcolor{keywordflow}{if} ( p\_st != NULL ) *p\_st = 0;
1703                     \} \textcolor{keywordflow}{else} \{
1704                         start = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm2;
1705                         init *= chunk;
1706                         limit = chunk + init - 1;
1707                         incr  = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.st;
1708 
1709                         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(init <= trip);
1710                         \textcolor{keywordflow}{if} ( (last = (limit >= trip)) != 0 )
1711                             limit = trip;
1712                         \textcolor{keywordflow}{if} ( p\_st != NULL ) *p\_st = incr;
1713 
1714                         \textcolor{keywordflow}{if} ( incr == 1 ) \{
1715                             *p\_lb = start + init;
1716                             *p\_ub = start + limit;
1717                         \} \textcolor{keywordflow}{else} \{
1718                             *p\_lb = start + init * incr;
1719                             *p\_ub = start + limit * incr;
1720                         \}
1721 
1722                         \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} ) \{
1723                             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower = init;
1724                             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper = limit;
1725 \textcolor{preprocessor}{                            #ifdef KMP\_DEBUG}
1726 \textcolor{preprocessor}{}                            \{
1727                                 \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
1728                                 \textcolor{comment}{// create format specifiers before the debug output}
1729                                 buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
1730                                     \textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%%d ordered\_lower:%%%s ordered\_upper:%%%s\(\backslash\)n"},
1731                                     traits\_t< UT >::spec, traits\_t< UT >::spec );
1732                                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(1000, ( buff, gtid, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower, pr->
      \hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper ) );
1733                                 \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
1734                             \}
1735 \textcolor{preprocessor}{                            #endif}
1736 \textcolor{preprocessor}{}                        \} \textcolor{comment}{// if}
1737                     \} \textcolor{comment}{// if}
1738                     \textcolor{keywordflow}{break};
1739                 \} \textcolor{comment}{// case}
1740 \textcolor{preprocessor}{            #endif // ( KMP\_STATIC\_STEAL\_ENABLED && KMP\_ARCH\_X86\_64 )}
1741 \textcolor{preprocessor}{}            \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea5869a7f3c202fef826c9368fa155dcdb}{kmp\_sch\_static\_balanced}:
1742                 \{
1743                     \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%d kmp\_sch\_static\_balanced case\(\backslash\)n"}, gtid
      ) );
1744                     \textcolor{keywordflow}{if} ( (status = !pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count) != 0 ) \{  \textcolor{comment}{/* check if thread has any iteration to do 
      */}
1745                         pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count = 1;
1746                         *p\_lb = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.lb;
1747                         *p\_ub = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ub;
1748                         last = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1;
1749                         \textcolor{keywordflow}{if} ( p\_st != NULL )
1750                             *p\_st = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.st;
1751                     \} \textcolor{keywordflow}{else} \{  \textcolor{comment}{/* no iterations to do */}
1752                         pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.lb = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ub + pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.st;
1753                     \}
1754                     \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} ) \{
1755 \textcolor{preprocessor}{                        #ifdef KMP\_DEBUG}
1756 \textcolor{preprocessor}{}                        \{
1757                             \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
1758                             \textcolor{comment}{// create format specifiers before the debug output}
1759                             buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
1760                                 \textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%%d ordered\_lower:%%%s ordered\_upper:%%%s\(\backslash\)n"},
1761                                 traits\_t< UT >::spec, traits\_t< UT >::spec );
1762                             \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(1000, ( buff, gtid, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower, pr->
      \hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper ) );
1763                             \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
1764                         \}
1765 \textcolor{preprocessor}{                        #endif}
1766 \textcolor{preprocessor}{}                    \} \textcolor{comment}{// if}
1767                 \} \textcolor{comment}{// case}
1768                 \textcolor{keywordflow}{break};
1769             \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea67c1b7c70c012361c0218269ac063606}{kmp\_sch\_static\_greedy}:  \textcolor{comment}{/* original code for kmp\_sch\_static\_greedy
       was merged here */}
1770             \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea8521b598e4c2014936813c104adfab4b}{kmp\_sch\_static\_chunked}:
1771                 \{
1772                     T parm1;
1773 
1774                     \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%d kmp\_sch\_static\_[affinity|chunked]
       case\(\backslash\)n"},
1775                                    gtid ) );
1776                     parm1 = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1;
1777 
1778                     trip  = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.tc - 1;
1779                     init  = parm1 * (pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count + \hyperlink{kmp_8h_afb8f84fff9682417eb1c484ffbfdc6ee}{\_\_kmp\_tid\_from\_gtid}(gtid));
1780 
1781                     \textcolor{keywordflow}{if} ( (status = (init <= trip)) != 0 ) \{
1782                         start = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.lb;
1783                         incr  = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.st;
1784                         limit = parm1 + init - 1;
1785 
1786                         \textcolor{keywordflow}{if} ( (last = (limit >= trip)) != 0 )
1787                             limit = trip;
1788 
1789                         \textcolor{keywordflow}{if} ( p\_st != NULL ) *p\_st = incr;
1790 
1791                         pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count += team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc;
1792 
1793                         \textcolor{keywordflow}{if} ( incr == 1 ) \{
1794                             *p\_lb = start + init;
1795                             *p\_ub = start + limit;
1796                         \}
1797                         \textcolor{keywordflow}{else} \{
1798                             *p\_lb = start + init * incr;
1799                             *p\_ub = start + limit * incr;
1800                         \}
1801 
1802                         \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} ) \{
1803                             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower = init;
1804                             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper = limit;
1805 \textcolor{preprocessor}{                            #ifdef KMP\_DEBUG}
1806 \textcolor{preprocessor}{}                            \{
1807                                 \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
1808                                 \textcolor{comment}{// create format specifiers before the debug output}
1809                                 buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
1810                                     \textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%%d ordered\_lower:%%%s ordered\_upper:%%%s\(\backslash\)n"},
1811                                     traits\_t< UT >::spec, traits\_t< UT >::spec );
1812                                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(1000, ( buff, gtid, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower, pr->
      \hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper ) );
1813                                 \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
1814                             \}
1815 \textcolor{preprocessor}{                            #endif}
1816 \textcolor{preprocessor}{}                        \} \textcolor{comment}{// if}
1817                     \} \textcolor{comment}{// if}
1818                 \} \textcolor{comment}{// case}
1819                 \textcolor{keywordflow}{break};
1820 
1821             \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea55ec779ed16f7959a24e65feadcbdbeb}{kmp\_sch\_dynamic\_chunked}:
1822                 \{
1823                     T chunk = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1;
1824 
1825                     \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%d kmp\_sch\_dynamic\_chunked case\(\backslash\)n"},
1826                                    gtid ) );
1827 
1828                     init = chunk * test\_then\_inc\_acq< ST >((\textcolor{keyword}{volatile} ST *) & sh->
      \hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.iteration );
1829                     trip = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.tc - 1;
1830 
1831                     \textcolor{keywordflow}{if} ( (status = (init <= trip)) == 0 ) \{
1832                         *p\_lb = 0;
1833                         *p\_ub = 0;
1834                         \textcolor{keywordflow}{if} ( p\_st != NULL ) *p\_st = 0;
1835                     \} \textcolor{keywordflow}{else} \{
1836                         start = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.lb;
1837                         limit = chunk + init - 1;
1838                         incr  = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.st;
1839 
1840                         \textcolor{keywordflow}{if} ( (last = (limit >= trip)) != 0 )
1841                             limit = trip;
1842 
1843                         \textcolor{keywordflow}{if} ( p\_st != NULL ) *p\_st = incr;
1844 
1845                         \textcolor{keywordflow}{if} ( incr == 1 ) \{
1846                             *p\_lb = start + init;
1847                             *p\_ub = start + limit;
1848                         \} \textcolor{keywordflow}{else} \{
1849                             *p\_lb = start + init * incr;
1850                             *p\_ub = start + limit * incr;
1851                         \}
1852 
1853                         \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} ) \{
1854                             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower = init;
1855                             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper = limit;
1856 \textcolor{preprocessor}{                            #ifdef KMP\_DEBUG}
1857 \textcolor{preprocessor}{}                            \{
1858                                 \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
1859                                 \textcolor{comment}{// create format specifiers before the debug output}
1860                                 buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
1861                                     \textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%%d ordered\_lower:%%%s ordered\_upper:%%%s\(\backslash\)n"},
1862                                     traits\_t< UT >::spec, traits\_t< UT >::spec );
1863                                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(1000, ( buff, gtid, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower, pr->
      \hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper ) );
1864                                 \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
1865                             \}
1866 \textcolor{preprocessor}{                            #endif}
1867 \textcolor{preprocessor}{}                        \} \textcolor{comment}{// if}
1868                     \} \textcolor{comment}{// if}
1869                 \} \textcolor{comment}{// case}
1870                 \textcolor{keywordflow}{break};
1871 
1872             \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81beaa6177807dac327b1240c43ab9f2d1f12}{kmp\_sch\_guided\_iterative\_chunked}:
1873                 \{
1874                     T  chunkspec = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1;
1875                     \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100,
1876                         (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%d kmp\_sch\_guided\_chunked iterative case\(\backslash\)n"},gtid));
1877                     trip  = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.tc;
1878                     \textcolor{comment}{// Start atomic part of calculations}
1879                     \textcolor{keywordflow}{while}(1) \{
1880                         ST  remaining;             \textcolor{comment}{// signed, because can be < 0}
1881                         init = sh->\hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.iteration;  \textcolor{comment}{// shared value}
1882                         remaining = trip - init;
1883                         \textcolor{keywordflow}{if} ( remaining <= 0 ) \{    \textcolor{comment}{// AC: need to compare with 0 first}
1884                             \textcolor{comment}{// nothing to do, don't try atomic op}
1885                             status = 0;
1886                             \textcolor{keywordflow}{break};
1887                         \}
1888                         \textcolor{keywordflow}{if} ( (T)remaining < pr->u.p.parm2 ) \{ \textcolor{comment}{// compare with K*nproc*(chunk+1), K=2 by
       default}
1889                             \textcolor{comment}{// use dynamic-style shcedule}
1890                             \textcolor{comment}{// atomically inrement iterations, get old value}
1891                             init = test\_then\_add<ST>( (ST*)&sh->\hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.iteration, (ST)chunkspec );
1892                             remaining = trip - init;
1893                             \textcolor{keywordflow}{if} (remaining <= 0) \{
1894                                 status = 0;    \textcolor{comment}{// all iterations got by other threads}
1895                             \} \textcolor{keywordflow}{else} \{
1896                                 \textcolor{comment}{// got some iterations to work on}
1897                                 status = 1;
1898                                 \textcolor{keywordflow}{if} ( (T)remaining > chunkspec ) \{
1899                                     limit = init + chunkspec - 1;
1900                                 \} \textcolor{keywordflow}{else} \{
1901                                     last = 1;   \textcolor{comment}{// the last chunk}
1902                                     limit = init + remaining - 1;
1903                                 \} \textcolor{comment}{// if}
1904                             \} \textcolor{comment}{// if}
1905                             \textcolor{keywordflow}{break};
1906                         \} \textcolor{comment}{// if}
1907                         limit = init + (UT)( remaining * *(\textcolor{keywordtype}{double}*)&pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm3 ); \textcolor{comment}{// divide by K*nproc}
1908                         \textcolor{keywordflow}{if} ( compare\_and\_swap<ST>( (ST*)&sh->\hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.iteration, (ST)init, (ST)limit ) ) \{
1909                             \textcolor{comment}{// CAS was successful, chunk obtained}
1910                             status = 1;
1911                             --limit;
1912                             \textcolor{keywordflow}{break};
1913                         \} \textcolor{comment}{// if}
1914                     \} \textcolor{comment}{// while}
1915                     \textcolor{keywordflow}{if} ( status != 0 ) \{
1916                         start = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.lb;
1917                         incr = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.st;
1918                         \textcolor{keywordflow}{if} ( p\_st != NULL )
1919                             *p\_st = incr;
1920                         *p\_lb = start + init * incr;
1921                         *p\_ub = start + limit * incr;
1922                         \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} ) \{
1923                             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower = init;
1924                             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper = limit;
1925 \textcolor{preprocessor}{                            #ifdef KMP\_DEBUG}
1926 \textcolor{preprocessor}{}                            \{
1927                                 \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
1928                                 \textcolor{comment}{// create format specifiers before the debug output}
1929                                 buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
1930                                     \textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%%d ordered\_lower:%%%s ordered\_upper:%%%s\(\backslash\)n"},
1931                                     traits\_t< UT >::spec, traits\_t< UT >::spec );
1932                                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(1000, ( buff, gtid, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower, pr->
      \hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper ) );
1933                                 \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
1934                             \}
1935 \textcolor{preprocessor}{                            #endif}
1936 \textcolor{preprocessor}{}                        \} \textcolor{comment}{// if}
1937                     \} \textcolor{keywordflow}{else} \{
1938                         *p\_lb = 0;
1939                         *p\_ub = 0;
1940                         \textcolor{keywordflow}{if} ( p\_st != NULL )
1941                             *p\_st = 0;
1942                     \} \textcolor{comment}{// if}
1943                 \} \textcolor{comment}{// case}
1944                 \textcolor{keywordflow}{break};
1945 
1946             \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea569ad1692047e89645f19bca3f2c26af}{kmp\_sch\_guided\_analytical\_chunked}:
1947                 \{
1948                     T   chunkspec = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm1;
1949                     UT chunkIdx;
1950 \textcolor{preprocessor}{    #if KMP\_OS\_WINDOWS && KMP\_ARCH\_X86}
1951 \textcolor{preprocessor}{}                    \textcolor{comment}{/* for storing original FPCW value for Windows* OS on}
1952 \textcolor{comment}{                       IA-32 architecture 8-byte version */}
1953                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} oldFpcw;
1954                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} fpcwSet = 0;
1955 \textcolor{preprocessor}{    #endif}
1956 \textcolor{preprocessor}{}                    \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%d kmp\_sch\_guided\_chunked analytical
       case\(\backslash\)n"},
1957                                    gtid ) );
1958 
1959                     trip  = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.tc;
1960 
1961                     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc > 1);
1962                     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}((2UL * chunkspec + 1) * (UT)team->
      \hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc < trip);
1963 
1964                     \textcolor{keywordflow}{while}(1) \{ \textcolor{comment}{/* this while loop is a safeguard against unexpected zero chunk sizes */}
1965                         chunkIdx = test\_then\_inc\_acq< ST >((\textcolor{keyword}{volatile} ST *) & sh->
      \hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.iteration );
1966                         \textcolor{keywordflow}{if} ( chunkIdx >= (UT)pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm2 ) \{
1967                             --trip;
1968                             \textcolor{comment}{/* use dynamic-style scheduling */}
1969                             init = chunkIdx * chunkspec + pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.count;
1970                             \textcolor{comment}{/* need to verify init > 0 in case of overflow in the above calculation */}
1971                             \textcolor{keywordflow}{if} ( (status = (init > 0 && init <= trip)) != 0 ) \{
1972                                 limit = init + chunkspec -1;
1973 
1974                                 \textcolor{keywordflow}{if} ( (last = (limit >= trip)) != 0 )
1975                                     limit = trip;
1976                             \}
1977                             \textcolor{keywordflow}{break};
1978                         \} \textcolor{keywordflow}{else} \{
1979                             \textcolor{comment}{/* use exponential-style scheduling */}
1980                             \textcolor{comment}{/* The following check is to workaround the lack of long double precision on
       Windows* OS.}
1981 \textcolor{comment}{                               This check works around the possible effect that init != 0 for chunkIdx ==
       0.}
1982 \textcolor{comment}{                             */}
1983 \textcolor{preprocessor}{    #if KMP\_OS\_WINDOWS && KMP\_ARCH\_X86}
1984 \textcolor{preprocessor}{}                            \textcolor{comment}{/* If we haven't already done so, save original}
1985 \textcolor{comment}{                               FPCW and set precision to 64-bit, as Windows* OS}
1986 \textcolor{comment}{                               on IA-32 architecture defaults to 53-bit */}
1987                             \textcolor{keywordflow}{if} ( !fpcwSet ) \{
1988                                 oldFpcw = \_control87(0,0);
1989                                 \_control87(\_PC\_64,\_MCW\_PC);
1990                                 fpcwSet = 0x30000;
1991                             \}
1992 \textcolor{preprocessor}{    #endif}
1993 \textcolor{preprocessor}{}                            \textcolor{keywordflow}{if} ( chunkIdx ) \{
1994                                 init = \_\_kmp\_dispatch\_guided\_remaining< T >(
1995                                            trip, *( DBL * )&pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm3, chunkIdx );
1996                                 \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(init);
1997                                 init = trip - init;
1998                             \} \textcolor{keywordflow}{else}
1999                                 init = 0;
2000                             limit = trip - \_\_kmp\_dispatch\_guided\_remaining< T >(
2001                                                trip, *( DBL * )&pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm3, chunkIdx + 1 );
2002                             \hyperlink{kmp__debug_8h_a5323a368e8ba273b17c46906dd9ec78c}{KMP\_ASSERT}(init <= limit);
2003                             \textcolor{keywordflow}{if} ( init < limit ) \{
2004                                 \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(limit <= trip);
2005                                 --limit;
2006                                 status = 1;
2007                                 \textcolor{keywordflow}{break};
2008                             \} \textcolor{comment}{// if}
2009                         \} \textcolor{comment}{// if}
2010                     \} \textcolor{comment}{// while (1)}
2011 \textcolor{preprocessor}{    #if KMP\_OS\_WINDOWS && KMP\_ARCH\_X86}
2012 \textcolor{preprocessor}{}                    \textcolor{comment}{/* restore FPCW if necessary}
2013 \textcolor{comment}{                       AC: check fpcwSet flag first because oldFpcw can be uninitialized here}
2014 \textcolor{comment}{                    */}
2015                     \textcolor{keywordflow}{if} ( fpcwSet && ( oldFpcw & fpcwSet ) )
2016                         \_control87(oldFpcw,\_MCW\_PC);
2017 \textcolor{preprocessor}{    #endif}
2018 \textcolor{preprocessor}{}                    \textcolor{keywordflow}{if} ( status != 0 ) \{
2019                         start = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.lb;
2020                         incr = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.st;
2021                         \textcolor{keywordflow}{if} ( p\_st != NULL )
2022                             *p\_st = incr;
2023                         *p\_lb = start + init * incr;
2024                         *p\_ub = start + limit * incr;
2025                         \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} ) \{
2026                             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower = init;
2027                             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper = limit;
2028 \textcolor{preprocessor}{                            #ifdef KMP\_DEBUG}
2029 \textcolor{preprocessor}{}                            \{
2030                                 \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
2031                                 \textcolor{comment}{// create format specifiers before the debug output}
2032                                 buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
2033                                     \textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%%d ordered\_lower:%%%s ordered\_upper:%%%s\(\backslash\)n"},
2034                                     traits\_t< UT >::spec, traits\_t< UT >::spec );
2035                                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(1000, ( buff, gtid, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower, pr->
      \hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper ) );
2036                                 \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
2037                             \}
2038 \textcolor{preprocessor}{                            #endif}
2039 \textcolor{preprocessor}{}                        \}
2040                     \} \textcolor{keywordflow}{else} \{
2041                         *p\_lb = 0;
2042                         *p\_ub = 0;
2043                         \textcolor{keywordflow}{if} ( p\_st != NULL )
2044                             *p\_st = 0;
2045                     \}
2046                 \} \textcolor{comment}{// case}
2047                 \textcolor{keywordflow}{break};
2048 
2049             \textcolor{keywordflow}{case} \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea904631666318a8490fc48df394616dbd}{kmp\_sch\_trapezoidal}:
2050                 \{
2051                     UT   index;
2052                     T    parm2 = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm2;
2053                     T    parm3 = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm3;
2054                     T    parm4 = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.parm4;
2055                     \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%d kmp\_sch\_trapezoidal case\(\backslash\)n"},
2056                                    gtid ) );
2057 
2058                     index = test\_then\_inc< ST >( (\textcolor{keyword}{volatile} ST *) & sh->\hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.iteration );
2059 
2060                     init = ( index * ( (2*parm2) - (index-1)*parm4 ) ) / 2;
2061                     trip = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.tc - 1;
2062 
2063                     \textcolor{keywordflow}{if} ( (status = ((T)index < parm3 && init <= trip)) == 0 ) \{
2064                         *p\_lb = 0;
2065                         *p\_ub = 0;
2066                         \textcolor{keywordflow}{if} ( p\_st != NULL ) *p\_st = 0;
2067                     \} \textcolor{keywordflow}{else} \{
2068                         start = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.lb;
2069                         limit = ( (index+1) * ( 2*parm2 - index*parm4 ) ) / 2 - 1;
2070                         incr  = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.st;
2071 
2072                         \textcolor{keywordflow}{if} ( (last = (limit >= trip)) != 0 )
2073                             limit = trip;
2074 
2075                         \textcolor{keywordflow}{if} ( p\_st != NULL ) *p\_st = incr;
2076 
2077                         \textcolor{keywordflow}{if} ( incr == 1 ) \{
2078                             *p\_lb = start + init;
2079                             *p\_ub = start + limit;
2080                         \} \textcolor{keywordflow}{else} \{
2081                             *p\_lb = start + init * incr;
2082                             *p\_ub = start + limit * incr;
2083                         \}
2084 
2085                         \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} ) \{
2086                             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower = init;
2087                             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper = limit;
2088 \textcolor{preprocessor}{                            #ifdef KMP\_DEBUG}
2089 \textcolor{preprocessor}{}                            \{
2090                                 \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
2091                                 \textcolor{comment}{// create format specifiers before the debug output}
2092                                 buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
2093                                     \textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%%d ordered\_lower:%%%s ordered\_upper:%%%s\(\backslash\)n"},
2094                                     traits\_t< UT >::spec, traits\_t< UT >::spec );
2095                                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(1000, ( buff, gtid, pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_lower, pr->
      \hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ordered\_upper ) );
2096                                 \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
2097                             \}
2098 \textcolor{preprocessor}{                            #endif}
2099 \textcolor{preprocessor}{}                        \} \textcolor{comment}{// if}
2100                     \} \textcolor{comment}{// if}
2101                 \} \textcolor{comment}{// case}
2102                 \textcolor{keywordflow}{break};
2103             \textcolor{keywordflow}{default}:
2104                 \{
2105                     status = 0; \textcolor{comment}{// to avoid complaints on uninitialized variable use}
2106                     \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
2107                         \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},                        \textcolor{comment}{// Severity}
2108                         \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( UnknownSchedTypeDetected ), \textcolor{comment}{// Primary message}
2109                         \hyperlink{kmp__i18n_8h_ac5fe3f32cfaa3b9268776d372a0f09c4}{KMP\_HNT}( GetNewerLibrary ),          \textcolor{comment}{// Hint}
2110                         \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}                       \textcolor{comment}{// Variadic argument list
       terminator}
2111                     );
2112                 \}
2113                 \textcolor{keywordflow}{break};
2114             \} \textcolor{comment}{// switch}
2115         \} \textcolor{comment}{// if tc == 0;}
2116 
2117         \textcolor{keywordflow}{if} ( status == 0 ) \{
2118             UT   num\_done;
2119 
2120             num\_done = test\_then\_inc< ST >( (\textcolor{keyword}{volatile} ST *) & sh->\hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.num\_done );
2121 \textcolor{preprocessor}{            #ifdef KMP\_DEBUG}
2122 \textcolor{preprocessor}{}            \{
2123                 \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
2124                 \textcolor{comment}{// create format specifiers before the debug output}
2125                 buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
2126                     \textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%%d increment num\_done:%%%s\(\backslash\)n"},
2127                     traits\_t< UT >::spec );
2128                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, ( buff, gtid, sh->\hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.num\_done ) );
2129                 \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
2130             \}
2131 \textcolor{preprocessor}{            #endif}
2132 \textcolor{preprocessor}{}
2133             \textcolor{keywordflow}{if} ( (ST)num\_done == team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_nproc-1 ) \{
2134                 \textcolor{comment}{/* NOTE: release this buffer to be reused */}
2135 
2136                 \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
2137 
2138                 sh->\hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.num\_done = 0;
2139                 sh->\hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.iteration = 0;
2140 
2141                 \textcolor{comment}{/* TODO replace with general release procedure? */}
2142                 \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_a2ab5d627f0ac9025d516a358a1da0101}{ordered} ) \{
2143                     sh->\hyperlink{structdispatch__shared__info__template_addc37a0a7602f461c2be5840b5fbea23}{u}.\hyperlink{uniondispatch__shared__info__template_1_1shared__info__tmpl_ad685051b57b2ee1fd685f627a04621ef}{s}.ordered\_iteration = 0;
2144                 \}
2145 
2146                 \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
2147 
2148                 sh -> buffer\_index += \hyperlink{kmp_8h_a7d5c6777861c49affd8d4ff04cde845a}{KMP\_MAX\_DISP\_BUF};
2149                 \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, (\textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%d change buffer\_index:%d\(\backslash\)n"},
2150                                 gtid, sh->\hyperlink{structdispatch__shared__info__template_adbb52e9b93edf55cee184b9b44a6e77a}{buffer\_index}) );
2151 
2152                 \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
2153 
2154             \} \textcolor{comment}{// if}
2155             \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
2156                 \textcolor{keywordflow}{if} ( pr->\hyperlink{structdispatch__private__info__template_aae7f21fbe2cebe26a14031af3bf17285}{pushed\_ws} != \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315a3eea97b407ad5cbc5f8707a949722738}{ct\_none} ) \{
2157                     pr->\hyperlink{structdispatch__private__info__template_aae7f21fbe2cebe26a14031af3bf17285}{pushed\_ws} = \hyperlink{kmp__error_8c_a93d9c89e2629352b4db28263a95b80f4}{\_\_kmp\_pop\_workshare}( gtid, pr->
      \hyperlink{structdispatch__private__info__template_aae7f21fbe2cebe26a14031af3bf17285}{pushed\_ws}, loc );
2158                 \}
2159             \}
2160 
2161             th -> th.th\_dispatch -> th\_deo\_fcn = NULL;
2162             th -> th.th\_dispatch -> th\_dxo\_fcn = NULL;
2163             th -> th.th\_dispatch -> th\_dispatch\_sh\_current = NULL;
2164             th -> th.th\_dispatch -> th\_dispatch\_pr\_current = NULL;
2165         \} \textcolor{comment}{// if (status == 0)}
2166 \textcolor{preprocessor}{#if KMP\_OS\_WINDOWS}
2167 \textcolor{preprocessor}{}        \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( last ) \{
2168             pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.last\_upper = pr->\hyperlink{structdispatch__private__info__template_af9721ce0273cf9cfe4674af244007e7b}{u}.\hyperlink{uniondispatch__private__info__template_1_1private__info__tmpl_a3524d72db291bfb9465ece3b2f8fd9af}{p}.ub;
2169         \}
2170 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_OS\_WINDOWS */}\textcolor{preprocessor}{}
2171 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( p\_last != NULL && status != 0 )
2172             *p\_last = last;
2173     \} \textcolor{comment}{// if}
2174 
2175 \textcolor{preprocessor}{    #ifdef KMP\_DEBUG}
2176 \textcolor{preprocessor}{}    \{
2177         \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
2178         \textcolor{comment}{// create format specifiers before the debug output}
2179         buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}(
2180             \textcolor{stringliteral}{"\_\_kmp\_dispatch\_next: T#%%d normal case: "} \(\backslash\)
2181             \textcolor{stringliteral}{"p\_lb:%%%s p\_ub:%%%s p\_st:%%%s p\_last:%%p  returning:%%d\(\backslash\)n"},
2182             traits\_t< T >::spec, traits\_t< T >::spec, traits\_t< ST >::spec );
2183         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(10, ( buff, gtid, *p\_lb, *p\_ub, p\_st ? *p\_st : 0, p\_last, status ) );
2184         \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
2185     \}
2186 \textcolor{preprocessor}{    #endif}
2187 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if INCLUDE\_SSC\_MARKS}
2188 \textcolor{preprocessor}{}    SSC\_MARK\_DISPATCH\_NEXT();
2189 \textcolor{preprocessor}{#endif}
2190 \textcolor{preprocessor}{}    \hyperlink{kmp__dispatch_8cpp_a11568d85642b5813503752538a5a9c73}{OMPT\_LOOP\_END};
2191     \textcolor{keywordflow}{return} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
2192 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_ac05d836d7cfe4e63e04fe8002ce58b8f}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-dist\-\_\-get\-\_\-bounds@{\-\_\-\-\_\-kmp\-\_\-dist\-\_\-get\-\_\-bounds}}
\index{\-\_\-\-\_\-kmp\-\_\-dist\-\_\-get\-\_\-bounds@{\-\_\-\-\_\-kmp\-\_\-dist\-\_\-get\-\_\-bounds}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-dist\-\_\-get\-\_\-bounds}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ static {\bf void} \-\_\-\-\_\-kmp\-\_\-dist\-\_\-get\-\_\-bounds (
\begin{DoxyParamCaption}
\item[{{\bf ident\-\_\-t} $\ast$}]{loc, }
\item[{kmp\-\_\-int32}]{gtid, }
\item[{kmp\-\_\-int32 $\ast$}]{plastiter, }
\item[{T $\ast$}]{plower, }
\item[{T $\ast$}]{pupper, }
\item[{typename traits\-\_\-t$<$ T $>$\-::signed\-\_\-t}]{incr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_ac05d836d7cfe4e63e04fe8002ce58b8f}


Definition at line 2196 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
2203   \{
2204     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< T >::unsigned\_t  UT;
2205     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} traits\_t< T >::signed\_t    ST;
2206     \textcolor{keyword}{register} kmp\_uint32  team\_id;
2207     \textcolor{keyword}{register} kmp\_uint32  nteams;
2208     \textcolor{keyword}{register} UT          trip\_count;
2209     \textcolor{keyword}{register} \hyperlink{unionkmp__team}{kmp\_team\_t} *team;
2210     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} * th;
2211 
2212     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( plastiter && plower && pupper );
2213     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmpc\_dist\_get\_bounds called (%d)\(\backslash\)n"}, gtid));
2214 \textcolor{preprocessor}{    #ifdef KMP\_DEBUG}
2215 \textcolor{preprocessor}{}    \{
2216         \textcolor{keyword}{const} \textcolor{keywordtype}{char} * buff;
2217         \textcolor{comment}{// create format specifiers before the debug output}
2218         buff = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}( \textcolor{stringliteral}{"\_\_kmpc\_dist\_get\_bounds: T#%%d liter=%%d "}\(\backslash\)
2219             \textcolor{stringliteral}{"iter=(%%%s, %%%s, %%%s) signed?<%s>\(\backslash\)n"},
2220             traits\_t< T >::spec, traits\_t< T >::spec, traits\_t< ST >::spec,
2221             traits\_t< T >::spec );
2222         \hyperlink{kmp__debug_8h_ab36654bdefb7cf295069bacc38f7ed84}{KD\_TRACE}(100, ( buff, gtid, *plastiter, *plower, *pupper, incr ) );
2223         \hyperlink{kmp__str_8c_a701e3d316cb77f886f2132477b20a413}{\_\_kmp\_str\_free}( &buff );
2224     \}
2225 \textcolor{preprocessor}{    #endif}
2226 \textcolor{preprocessor}{}
2227     \textcolor{keywordflow}{if}( \hyperlink{kmp_8h_ab4062d4f566c901230e51490a8819ba0}{\_\_kmp\_env\_consistency\_check} ) \{
2228         \textcolor{keywordflow}{if}( incr == 0 ) \{
2229             \hyperlink{kmp__error_8c_aa91d3ecb565b21ade2e4156254f9941e}{\_\_kmp\_error\_construct}( kmp\_i18n\_msg\_CnsLoopIncrZeroProhibited, 
      \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315aef2b45cd9b1ab8d75031c716a27adce9}{ct\_pdo}, loc );
2230         \}
2231         \textcolor{keywordflow}{if}( incr > 0 ? (*pupper < *plower) : (*plower < *pupper) ) \{
2232             \textcolor{comment}{// The loop is illegal.}
2233             \textcolor{comment}{// Some zero-trip loops maintained by compiler, e.g.:}
2234             \textcolor{comment}{//   for(i=10;i<0;++i) // lower >= upper - run-time check}
2235             \textcolor{comment}{//   for(i=0;i>10;--i) // lower <= upper - run-time check}
2236             \textcolor{comment}{//   for(i=0;i>10;++i) // incr > 0       - compile-time check}
2237             \textcolor{comment}{//   for(i=10;i<0;--i) // incr < 0       - compile-time check}
2238             \textcolor{comment}{// Compiler does not check the following illegal loops:}
2239             \textcolor{comment}{//   for(i=0;i<10;i+=incr) // where incr<0}
2240             \textcolor{comment}{//   for(i=10;i>0;i-=incr) // where incr<0}
2241             \hyperlink{kmp__error_8c_aa91d3ecb565b21ade2e4156254f9941e}{\_\_kmp\_error\_construct}( kmp\_i18n\_msg\_CnsLoopIncrIllegal, 
      \hyperlink{kmp_8h_a1582e7ddc609220a660d10244ef3e315aef2b45cd9b1ab8d75031c716a27adce9}{ct\_pdo}, loc );
2242         \}
2243     \}
2244     th = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[gtid];
2245     team = th->th.th\_team;
2246 \textcolor{preprocessor}{    #if OMP\_40\_ENABLED}
2247 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(th->th.th\_teams\_microtask);   \textcolor{comment}{// we are in the teams construct}
2248     nteams = th->th.th\_teams\_size.nteams;
2249 \textcolor{preprocessor}{    #endif}
2250 \textcolor{preprocessor}{}    team\_id = team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_master\_tid;
2251     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(nteams == team->\hyperlink{unionkmp__team_a87cf4571108a61b446e809094f8c0362}{t}.t\_parent->t.t\_nproc);
2252 
2253     \textcolor{comment}{// compute global trip count}
2254     \textcolor{keywordflow}{if}( incr == 1 ) \{
2255         trip\_count = *pupper - *plower + 1;
2256     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(incr == -1) \{
2257         trip\_count = *plower - *pupper + 1;
2258     \} \textcolor{keywordflow}{else} \{
2259         trip\_count = (ST)(*pupper - *plower) / incr + 1; \textcolor{comment}{// cast to signed to cover incr<0 case}
2260     \}
2261 
2262     \textcolor{keywordflow}{if}( trip\_count <= nteams ) \{
2263         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(
2264             \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea67c1b7c70c012361c0218269ac063606}{kmp\_sch\_static\_greedy} || \(\backslash\)
2265             \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea5869a7f3c202fef826c9368fa155dcdb}{kmp\_sch\_static\_balanced}
2266         ); \textcolor{comment}{// Unknown static scheduling type.}
2267         \textcolor{comment}{// only some teams get single iteration, others get nothing}
2268         \textcolor{keywordflow}{if}( team\_id < trip\_count ) \{
2269             *pupper = *plower = *plower + team\_id * incr;
2270         \} \textcolor{keywordflow}{else} \{
2271             *plower = *pupper + incr; \textcolor{comment}{// zero-trip loop}
2272         \}
2273         \textcolor{keywordflow}{if}( plastiter != NULL )
2274             *plastiter = ( team\_id == trip\_count - 1 );
2275     \} \textcolor{keywordflow}{else} \{
2276         \textcolor{keywordflow}{if}( \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea5869a7f3c202fef826c9368fa155dcdb}{kmp\_sch\_static\_balanced} ) \{
2277             \textcolor{keyword}{register} UT chunk = trip\_count / nteams;
2278             \textcolor{keyword}{register} UT extras = trip\_count % nteams;
2279             *plower += incr * ( team\_id * chunk + ( team\_id < extras ? team\_id : extras ) );
2280             *pupper = *plower + chunk * incr - ( team\_id < extras ? 0 : incr );
2281             \textcolor{keywordflow}{if}( plastiter != NULL )
2282                 *plastiter = ( team\_id == nteams - 1 );
2283         \} \textcolor{keywordflow}{else} \{
2284             \textcolor{keyword}{register} T chunk\_inc\_count =
2285                 ( trip\_count / nteams + ( ( trip\_count % nteams ) ? 1 : 0) ) * incr;
2286             \textcolor{keyword}{register} T upper = *pupper;
2287             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp_8h_a7520297e68a11d20d86df78cf53442c1}{\_\_kmp\_static} == 
      \hyperlink{group__WORK__SHARING_ggadcaf200537aaa0218a60c398438f81bea67c1b7c70c012361c0218269ac063606}{kmp\_sch\_static\_greedy} );
2288                 \textcolor{comment}{// Unknown static scheduling type.}
2289             *plower += team\_id * chunk\_inc\_count;
2290             *pupper = *plower + chunk\_inc\_count - incr;
2291             \textcolor{comment}{// Check/correct bounds if needed}
2292             \textcolor{keywordflow}{if}( incr > 0 ) \{
2293                 \textcolor{keywordflow}{if}( *pupper < *plower )
2294                     *pupper = \hyperlink{structi__maxmin}{i\_maxmin< T >::mx};
2295                 \textcolor{keywordflow}{if}( plastiter != NULL )
2296                     *plastiter = *plower <= upper && *pupper > upper - incr;
2297                 \textcolor{keywordflow}{if}( *pupper > upper )
2298                     *pupper = upper; \textcolor{comment}{// tracker C73258}
2299             \} \textcolor{keywordflow}{else} \{
2300                 \textcolor{keywordflow}{if}( *pupper > *plower )
2301                     *pupper = \hyperlink{structi__maxmin}{i\_maxmin< T >::mn};
2302                 \textcolor{keywordflow}{if}( plastiter != NULL )
2303                     *plastiter = *plower >= upper && *pupper < upper - incr;
2304                 \textcolor{keywordflow}{if}( *pupper < upper )
2305                     *pupper = upper; \textcolor{comment}{// tracker C73258}
2306             \}
2307         \}
2308     \}
2309 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a8538de09370075eaa1616cb7ddaa67e0}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-eq@{\-\_\-\-\_\-kmp\-\_\-eq}}
\index{\-\_\-\-\_\-kmp\-\_\-eq@{\-\_\-\-\_\-kmp\-\_\-eq}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-eq}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename U\-T $>$ static kmp\-\_\-uint32 \-\_\-\-\_\-kmp\-\_\-eq (
\begin{DoxyParamCaption}
\item[{U\-T}]{value, }
\item[{U\-T}]{checker}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_a8538de09370075eaa1616cb7ddaa67e0}


Definition at line 329 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
329                                                   \{
330     \textcolor{keywordflow}{return} value == checker;
331 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a4fdf7443cbc5230889201c7cb83f5cfc}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-eq\-\_\-4@{\-\_\-\-\_\-kmp\-\_\-eq\-\_\-4}}
\index{\-\_\-\-\_\-kmp\-\_\-eq\-\_\-4@{\-\_\-\-\_\-kmp\-\_\-eq\-\_\-4}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-eq\-\_\-4}]{\setlength{\rightskip}{0pt plus 5cm}kmp\-\_\-uint32 \-\_\-\-\_\-kmp\-\_\-eq\-\_\-4 (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-uint32}]{value, }
\item[{kmp\-\_\-uint32}]{checker}
\end{DoxyParamCaption}
)}}\label{kmp__dispatch_8cpp_a4fdf7443cbc5230889201c7cb83f5cfc}


Definition at line 2512 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
2512                                                              \{
2513     \textcolor{keywordflow}{return} value == checker;
2514 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_ab3d3d8387d89a8425420e1f4f79ca605}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-ge@{\-\_\-\-\_\-kmp\-\_\-ge}}
\index{\-\_\-\-\_\-kmp\-\_\-ge@{\-\_\-\-\_\-kmp\-\_\-ge}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-ge}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename U\-T $>$ static kmp\-\_\-uint32 \-\_\-\-\_\-kmp\-\_\-ge (
\begin{DoxyParamCaption}
\item[{U\-T}]{value, }
\item[{U\-T}]{checker}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_ab3d3d8387d89a8425420e1f4f79ca605}


Definition at line 344 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
344                                                   \{
345     \textcolor{keywordflow}{return} value >= checker;
346 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a0c247de17cd15138135bfd171d1f0765}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-ge\-\_\-4@{\-\_\-\-\_\-kmp\-\_\-ge\-\_\-4}}
\index{\-\_\-\-\_\-kmp\-\_\-ge\-\_\-4@{\-\_\-\-\_\-kmp\-\_\-ge\-\_\-4}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-ge\-\_\-4}]{\setlength{\rightskip}{0pt plus 5cm}kmp\-\_\-uint32 \-\_\-\-\_\-kmp\-\_\-ge\-\_\-4 (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-uint32}]{value, }
\item[{kmp\-\_\-uint32}]{checker}
\end{DoxyParamCaption}
)}}\label{kmp__dispatch_8cpp_a0c247de17cd15138135bfd171d1f0765}


Definition at line 2524 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
2524                                                              \{
2525     \textcolor{keywordflow}{return} value >= checker;
2526 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_adcf2413c78ef466a9382b9d2a1deb1b0}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-le@{\-\_\-\-\_\-kmp\-\_\-le}}
\index{\-\_\-\-\_\-kmp\-\_\-le@{\-\_\-\-\_\-kmp\-\_\-le}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-le}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename U\-T $>$ static kmp\-\_\-uint32 \-\_\-\-\_\-kmp\-\_\-le (
\begin{DoxyParamCaption}
\item[{U\-T}]{value, }
\item[{U\-T}]{checker}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_adcf2413c78ef466a9382b9d2a1deb1b0}


Definition at line 349 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
349                                                   \{
350     \textcolor{keywordflow}{return} value <= checker;
351 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_acba4cc83a5ab80e907946dc5e9813142}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-le\-\_\-4@{\-\_\-\-\_\-kmp\-\_\-le\-\_\-4}}
\index{\-\_\-\-\_\-kmp\-\_\-le\-\_\-4@{\-\_\-\-\_\-kmp\-\_\-le\-\_\-4}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-le\-\_\-4}]{\setlength{\rightskip}{0pt plus 5cm}kmp\-\_\-uint32 \-\_\-\-\_\-kmp\-\_\-le\-\_\-4 (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-uint32}]{value, }
\item[{kmp\-\_\-uint32}]{checker}
\end{DoxyParamCaption}
)}}\label{kmp__dispatch_8cpp_acba4cc83a5ab80e907946dc5e9813142}


Definition at line 2528 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
2528                                                              \{
2529     \textcolor{keywordflow}{return} value <= checker;
2530 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a1d5a1fe3473189d2d72f53448b7fb5af}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-lt@{\-\_\-\-\_\-kmp\-\_\-lt}}
\index{\-\_\-\-\_\-kmp\-\_\-lt@{\-\_\-\-\_\-kmp\-\_\-lt}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-lt}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename U\-T $>$ static kmp\-\_\-uint32 \-\_\-\-\_\-kmp\-\_\-lt (
\begin{DoxyParamCaption}
\item[{U\-T}]{value, }
\item[{U\-T}]{checker}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_a1d5a1fe3473189d2d72f53448b7fb5af}


Definition at line 339 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
339                                                   \{
340     \textcolor{keywordflow}{return} value < checker;
341 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a7b9c106e652273ae3ace02e5cf54f652}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-lt\-\_\-4@{\-\_\-\-\_\-kmp\-\_\-lt\-\_\-4}}
\index{\-\_\-\-\_\-kmp\-\_\-lt\-\_\-4@{\-\_\-\-\_\-kmp\-\_\-lt\-\_\-4}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-lt\-\_\-4}]{\setlength{\rightskip}{0pt plus 5cm}kmp\-\_\-uint32 \-\_\-\-\_\-kmp\-\_\-lt\-\_\-4 (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-uint32}]{value, }
\item[{kmp\-\_\-uint32}]{checker}
\end{DoxyParamCaption}
)}}\label{kmp__dispatch_8cpp_a7b9c106e652273ae3ace02e5cf54f652}


Definition at line 2520 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
2520                                                              \{
2521     \textcolor{keywordflow}{return} value < checker;
2522 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a39b40e43c3b1b7162e1118e420c778b9}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-neq@{\-\_\-\-\_\-kmp\-\_\-neq}}
\index{\-\_\-\-\_\-kmp\-\_\-neq@{\-\_\-\-\_\-kmp\-\_\-neq}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-neq}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename U\-T $>$ static kmp\-\_\-uint32 \-\_\-\-\_\-kmp\-\_\-neq (
\begin{DoxyParamCaption}
\item[{U\-T}]{value, }
\item[{U\-T}]{checker}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_a39b40e43c3b1b7162e1118e420c778b9}


Definition at line 334 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
334                                                    \{
335     \textcolor{keywordflow}{return} value != checker;
336 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_ab9e91c3377af2c1678dbd5e2dbd21aaa}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-neq\-\_\-4@{\-\_\-\-\_\-kmp\-\_\-neq\-\_\-4}}
\index{\-\_\-\-\_\-kmp\-\_\-neq\-\_\-4@{\-\_\-\-\_\-kmp\-\_\-neq\-\_\-4}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-neq\-\_\-4}]{\setlength{\rightskip}{0pt plus 5cm}kmp\-\_\-uint32 \-\_\-\-\_\-kmp\-\_\-neq\-\_\-4 (
\begin{DoxyParamCaption}
\item[{kmp\-\_\-uint32}]{value, }
\item[{kmp\-\_\-uint32}]{checker}
\end{DoxyParamCaption}
)}}\label{kmp__dispatch_8cpp_ab9e91c3377af2c1678dbd5e2dbd21aaa}


Definition at line 2516 of file kmp\-\_\-dispatch.\-cpp.



Referenced by \-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor().


\begin{DoxyCode}
2516                                                               \{
2517     \textcolor{keywordflow}{return} value != checker;
2518 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_ac08bc90a1f5a11934bcaf5760bf307f1}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-pow@{\-\_\-\-\_\-kmp\-\_\-pow}}
\index{\-\_\-\-\_\-kmp\-\_\-pow@{\-\_\-\-\_\-kmp\-\_\-pow}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-pow}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename U\-T $>$ static \-\_\-\-\_\-forceinline long double \-\_\-\-\_\-kmp\-\_\-pow (
\begin{DoxyParamCaption}
\item[{long double}]{x, }
\item[{U\-T}]{y}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_ac08bc90a1f5a11934bcaf5760bf307f1}


Definition at line 536 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
536                                \{
537     \textcolor{keywordtype}{long} \textcolor{keywordtype}{double} \hyperlink{ittnotify__static_8h_a110bd9ede250f97ce56d81bb3c7b171d}{s}=1.0L;
538 
539     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(\hyperlink{ittnotify__static_8h_a25eb27b280775b27a5ddc4d1673225aa}{x} > 0.0 && \hyperlink{ittnotify__static_8h_a25eb27b280775b27a5ddc4d1673225aa}{x} < 1.0);
540     \textcolor{comment}{//KMP\_DEBUG\_ASSERT(y >= 0); // y is unsigned}
541     \textcolor{keywordflow}{while}(y) \{
542         \textcolor{keywordflow}{if} ( y & 1 )
543             s *= \hyperlink{ittnotify__static_8h_a25eb27b280775b27a5ddc4d1673225aa}{x};
544         \hyperlink{ittnotify__static_8h_a25eb27b280775b27a5ddc4d1673225aa}{x} *= \hyperlink{ittnotify__static_8h_a25eb27b280775b27a5ddc4d1673225aa}{x};
545         y >>= 1;
546     \}
547     \textcolor{keywordflow}{return} \hyperlink{ittnotify__static_8h_a110bd9ede250f97ce56d81bb3c7b171d}{s};
548 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_aef9590be7463f2f7dd1261f024e2e778}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-wait\-\_\-yield@{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-yield}}
\index{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-yield@{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-yield}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-yield}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename U\-T $>$ static U\-T \-\_\-\-\_\-kmp\-\_\-wait\-\_\-yield (
\begin{DoxyParamCaption}
\item[{volatile U\-T $\ast$}]{spinner, }
\item[{U\-T}]{checker, }
\item[{kmp\-\_\-uint32($\ast$)(U\-T, U\-T) {\bf U\-S\-E\-\_\-\-I\-T\-T\-\_\-\-B\-U\-I\-L\-D\-\_\-\-A\-R\-G} pred({\bf void} $\ast$obj)}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_aef9590be7463f2f7dd1261f024e2e778}


Definition at line 294 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
299 \{
300     \textcolor{comment}{// note: we may not belong to a team at this point}
301     \textcolor{keyword}{register} \textcolor{keyword}{volatile} UT         * spin          = spinner;
302     \textcolor{keyword}{register}          UT           check         = checker;
303     \textcolor{keyword}{register}          kmp\_uint32   spins;
304     \textcolor{keyword}{register}          kmp\_uint32 (*f) ( UT, UT ) = pred;
305     \textcolor{keyword}{register}          UT           r;
306 
307     \hyperlink{kmp__itt_8h_ae9ed9a1ec697c0049760eee81cf6521a}{KMP\_FSYNC\_SPIN\_INIT}( obj, (\textcolor{keywordtype}{void}*) spin );
308     \hyperlink{kmp_8h_a98cb21bfd34ebd451007a151f135b31c}{KMP\_INIT\_YIELD}( spins );
309     \textcolor{comment}{// main wait spin loop}
310     \textcolor{keywordflow}{while}(!f(r = *spin, check))
311     \{
312         \hyperlink{kmp__itt_8h_aadbbcf10e55850897e6d495729925851}{KMP\_FSYNC\_SPIN\_PREPARE}( obj );
313         \textcolor{comment}{/* GEH - remove this since it was accidentally introduced when kmp\_wait was split.}
314 \textcolor{comment}{           It causes problems with infinite recursion because of exit lock */}
315         \textcolor{comment}{/* if ( TCR\_4(\_\_kmp\_global.g.g\_done) && \_\_kmp\_global.g.g\_abort)}
316 \textcolor{comment}{            \_\_kmp\_abort\_thread(); */}
317 
318         \textcolor{comment}{// if we are oversubscribed,}
319         \textcolor{comment}{// or have waited a bit (and KMP\_LIBRARY=throughput, then yield}
320         \textcolor{comment}{// pause is in the following code}
321         \hyperlink{kmp_8h_a9f0d88d1970adda4ad38d272e65d7844}{KMP\_YIELD}( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(\hyperlink{kmp_8h_a774ce85ac109df119feaca45ed4e69b1}{\_\_kmp\_nth}) > \hyperlink{kmp_8h_adc73a89e0c77c9b0a3233f9fde48a5b2}{\_\_kmp\_avail\_proc} );
322         \hyperlink{kmp_8h_a0b31ac108fea7d8034ea5145d74a7a77}{KMP\_YIELD\_SPIN}( spins );
323     \}
324     \hyperlink{kmp__itt_8h_a580841033d05175a7d1d36d91bdb9267}{KMP\_FSYNC\_SPIN\_ACQUIRED}( obj );
325     \textcolor{keywordflow}{return} r;
326 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a1e3aca5b5d46360422f901c4e3c0e6fd}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!\-\_\-\-\_\-kmp\-\_\-wait\-\_\-yield\-\_\-4@{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-yield\-\_\-4}}
\index{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-yield\-\_\-4@{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-yield\-\_\-4}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-yield\-\_\-4}]{\setlength{\rightskip}{0pt plus 5cm}kmp\-\_\-uint32 \-\_\-\-\_\-kmp\-\_\-wait\-\_\-yield\-\_\-4 (
\begin{DoxyParamCaption}
\item[{volatile kmp\-\_\-uint32 $\ast$}]{spinner, }
\item[{kmp\-\_\-uint32}]{checker, }
\item[{kmp\-\_\-uint32($\ast$)(kmp\-\_\-uint32, kmp\-\_\-uint32)}]{pred, }
\item[{{\bf void} $\ast$}]{obj}
\end{DoxyParamCaption}
)}}\label{kmp__dispatch_8cpp_a1e3aca5b5d46360422f901c4e3c0e6fd}


Definition at line 2533 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
2538 \{
2539     \textcolor{comment}{// note: we may not belong to a team at this point}
2540     \textcolor{keyword}{register} \textcolor{keyword}{volatile} kmp\_uint32         * spin          = spinner;
2541     \textcolor{keyword}{register}          kmp\_uint32           check         = checker;
2542     \textcolor{keyword}{register}          kmp\_uint32   spins;
2543     \textcolor{keyword}{register}          kmp\_uint32 (*f) ( kmp\_uint32, kmp\_uint32 ) = pred;
2544     \textcolor{keyword}{register}          kmp\_uint32           r;
2545 
2546     \hyperlink{kmp__itt_8h_ae9ed9a1ec697c0049760eee81cf6521a}{KMP\_FSYNC\_SPIN\_INIT}( obj, (\textcolor{keywordtype}{void}*) spin );
2547     \hyperlink{kmp_8h_a98cb21bfd34ebd451007a151f135b31c}{KMP\_INIT\_YIELD}( spins );
2548     \textcolor{comment}{// main wait spin loop}
2549     \textcolor{keywordflow}{while}(!f(r = \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(*spin), check)) \{
2550         \hyperlink{kmp__itt_8h_aadbbcf10e55850897e6d495729925851}{KMP\_FSYNC\_SPIN\_PREPARE}( obj );
2551         \textcolor{comment}{/* GEH - remove this since it was accidentally introduced when kmp\_wait was split.}
2552 \textcolor{comment}{           It causes problems with infinite recursion because of exit lock */}
2553         \textcolor{comment}{/* if ( TCR\_4(\_\_kmp\_global.g.g\_done) && \_\_kmp\_global.g.g\_abort)}
2554 \textcolor{comment}{            \_\_kmp\_abort\_thread(); */}
2555 
2556         \textcolor{comment}{/* if we have waited a bit, or are oversubscribed, yield */}
2557         \textcolor{comment}{/* pause is in the following code */}
2558         \hyperlink{kmp_8h_a9f0d88d1970adda4ad38d272e65d7844}{KMP\_YIELD}( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(\hyperlink{kmp_8h_a774ce85ac109df119feaca45ed4e69b1}{\_\_kmp\_nth}) > \hyperlink{kmp_8h_adc73a89e0c77c9b0a3233f9fde48a5b2}{\_\_kmp\_avail\_proc} );
2559         \hyperlink{kmp_8h_a0b31ac108fea7d8034ea5145d74a7a77}{KMP\_YIELD\_SPIN}( spins );
2560     \}
2561     \hyperlink{kmp__itt_8h_a580841033d05175a7d1d36d91bdb9267}{KMP\_FSYNC\_SPIN\_ACQUIRED}( obj );
2562     \textcolor{keywordflow}{return} r;
2563 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a91d1e5b674d9e07f4ea98645fb37a9e4}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!compare\-\_\-and\-\_\-swap@{compare\-\_\-and\-\_\-swap}}
\index{compare\-\_\-and\-\_\-swap@{compare\-\_\-and\-\_\-swap}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{compare\-\_\-and\-\_\-swap}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ static \-\_\-\-\_\-forceinline kmp\-\_\-int32 compare\-\_\-and\-\_\-swap (
\begin{DoxyParamCaption}
\item[{volatile T $\ast$}]{p, }
\item[{T}]{c, }
\item[{T}]{s}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_a91d1e5b674d9e07f4ea98645fb37a9e4}


Definition at line 262 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
262 \{ \hyperlink{kmp__debug_8h_a5323a368e8ba273b17c46906dd9ec78c}{KMP\_ASSERT}(0); \};
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_ae95aeef3a0c2ca9c42a645a3fdc5f999}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!compare\-\_\-and\-\_\-swap$<$ kmp\-\_\-int32 $>$@{compare\-\_\-and\-\_\-swap$<$ kmp\-\_\-int32 $>$}}
\index{compare\-\_\-and\-\_\-swap$<$ kmp\-\_\-int32 $>$@{compare\-\_\-and\-\_\-swap$<$ kmp\-\_\-int32 $>$}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{compare\-\_\-and\-\_\-swap$<$ kmp\-\_\-int32 $>$}]{\setlength{\rightskip}{0pt plus 5cm}template$<$$>$ \-\_\-\-\_\-forceinline kmp\-\_\-int32 {\bf compare\-\_\-and\-\_\-swap}$<$ kmp\-\_\-int32 $>$ (
\begin{DoxyParamCaption}
\item[{volatile kmp\-\_\-int32 $\ast$}]{p, }
\item[{kmp\-\_\-int32}]{c, }
\item[{kmp\-\_\-int32}]{s}
\end{DoxyParamCaption}
)}}\label{kmp__dispatch_8cpp_ae95aeef3a0c2ca9c42a645a3fdc5f999}


Definition at line 266 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
267 \{
268     \textcolor{keywordflow}{return} \hyperlink{kmp__os_8h_a33fc76d0887ff2c7ad9ca1c206dd945b}{KMP\_COMPARE\_AND\_STORE\_REL32}( \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p}, c, \hyperlink{ittnotify__static_8h_a110bd9ede250f97ce56d81bb3c7b171d}{s} );
269 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_ab9ac8baea0c47de636ea7ae008688ffc}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!compare\-\_\-and\-\_\-swap$<$ kmp\-\_\-int64 $>$@{compare\-\_\-and\-\_\-swap$<$ kmp\-\_\-int64 $>$}}
\index{compare\-\_\-and\-\_\-swap$<$ kmp\-\_\-int64 $>$@{compare\-\_\-and\-\_\-swap$<$ kmp\-\_\-int64 $>$}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{compare\-\_\-and\-\_\-swap$<$ kmp\-\_\-int64 $>$}]{\setlength{\rightskip}{0pt plus 5cm}template$<$$>$ \-\_\-\-\_\-forceinline kmp\-\_\-int32 {\bf compare\-\_\-and\-\_\-swap}$<$ kmp\-\_\-int64 $>$ (
\begin{DoxyParamCaption}
\item[{volatile kmp\-\_\-int64 $\ast$}]{p, }
\item[{kmp\-\_\-int64}]{c, }
\item[{kmp\-\_\-int64}]{s}
\end{DoxyParamCaption}
)}}\label{kmp__dispatch_8cpp_ab9ac8baea0c47de636ea7ae008688ffc}


Definition at line 273 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
274 \{
275     \textcolor{keywordflow}{return} \hyperlink{kmp__os_8h_a25a9aff801444fe9e735e0a5cf7b0ad8}{KMP\_COMPARE\_AND\_STORE\_REL64}( \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p}, c, \hyperlink{ittnotify__static_8h_a110bd9ede250f97ce56d81bb3c7b171d}{s} );
276 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_ac83edd517b2d8882fce640b5040efcab}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!test\-\_\-then\-\_\-add@{test\-\_\-then\-\_\-add}}
\index{test\-\_\-then\-\_\-add@{test\-\_\-then\-\_\-add}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{test\-\_\-then\-\_\-add}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ static \-\_\-\-\_\-forceinline T test\-\_\-then\-\_\-add (
\begin{DoxyParamCaption}
\item[{volatile T $\ast$}]{p, }
\item[{T}]{d}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_ac83edd517b2d8882fce640b5040efcab}


Definition at line 193 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
193 \{ \hyperlink{kmp__debug_8h_a5323a368e8ba273b17c46906dd9ec78c}{KMP\_ASSERT}(0); \};
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_ad1ef2bfd50602d9adeff01ea7579afc3}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!test\-\_\-then\-\_\-add$<$ kmp\-\_\-int32 $>$@{test\-\_\-then\-\_\-add$<$ kmp\-\_\-int32 $>$}}
\index{test\-\_\-then\-\_\-add$<$ kmp\-\_\-int32 $>$@{test\-\_\-then\-\_\-add$<$ kmp\-\_\-int32 $>$}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{test\-\_\-then\-\_\-add$<$ kmp\-\_\-int32 $>$}]{\setlength{\rightskip}{0pt plus 5cm}template$<$$>$ \-\_\-\-\_\-forceinline kmp\-\_\-int32 {\bf test\-\_\-then\-\_\-add}$<$ kmp\-\_\-int32 $>$ (
\begin{DoxyParamCaption}
\item[{volatile kmp\-\_\-int32 $\ast$}]{p, }
\item[{kmp\-\_\-int32}]{d}
\end{DoxyParamCaption}
)}}\label{kmp__dispatch_8cpp_ad1ef2bfd50602d9adeff01ea7579afc3}


Definition at line 197 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
198 \{
199     kmp\_int32 r;
200     r = \hyperlink{kmp__os_8h_a009e079b11c506ce9b753668a38af7ff}{KMP\_TEST\_THEN\_ADD32}( \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p}, \hyperlink{ittnotify__static_8h_a6b8793c3e5dd8bb67b04141713a65d2d}{d} );
201     \textcolor{keywordflow}{return} r;
202 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a66f960eba9cdec2919b779d4b407ceb9}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!test\-\_\-then\-\_\-add$<$ kmp\-\_\-int64 $>$@{test\-\_\-then\-\_\-add$<$ kmp\-\_\-int64 $>$}}
\index{test\-\_\-then\-\_\-add$<$ kmp\-\_\-int64 $>$@{test\-\_\-then\-\_\-add$<$ kmp\-\_\-int64 $>$}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{test\-\_\-then\-\_\-add$<$ kmp\-\_\-int64 $>$}]{\setlength{\rightskip}{0pt plus 5cm}template$<$$>$ \-\_\-\-\_\-forceinline kmp\-\_\-int64 {\bf test\-\_\-then\-\_\-add}$<$ kmp\-\_\-int64 $>$ (
\begin{DoxyParamCaption}
\item[{volatile kmp\-\_\-int64 $\ast$}]{p, }
\item[{kmp\-\_\-int64}]{d}
\end{DoxyParamCaption}
)}}\label{kmp__dispatch_8cpp_a66f960eba9cdec2919b779d4b407ceb9}


Definition at line 206 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
207 \{
208     kmp\_int64 r;
209     r = \hyperlink{kmp__os_8h_a09b15748cdd462bc2f71c4efd49e36cc}{KMP\_TEST\_THEN\_ADD64}( \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p}, \hyperlink{ittnotify__static_8h_a6b8793c3e5dd8bb67b04141713a65d2d}{d} );
210     \textcolor{keywordflow}{return} r;
211 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_aa5246687602dcad8f78f649f404f03dc}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!test\-\_\-then\-\_\-inc@{test\-\_\-then\-\_\-inc}}
\index{test\-\_\-then\-\_\-inc@{test\-\_\-then\-\_\-inc}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{test\-\_\-then\-\_\-inc}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ static \-\_\-\-\_\-forceinline T test\-\_\-then\-\_\-inc (
\begin{DoxyParamCaption}
\item[{volatile T $\ast$}]{p}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_aa5246687602dcad8f78f649f404f03dc}


Definition at line 239 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
239 \{ \hyperlink{kmp__debug_8h_a5323a368e8ba273b17c46906dd9ec78c}{KMP\_ASSERT}(0); \};
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a325e8f0eb4c8fb5629f1c4420cc5a3b6}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!test\-\_\-then\-\_\-inc$<$ kmp\-\_\-int32 $>$@{test\-\_\-then\-\_\-inc$<$ kmp\-\_\-int32 $>$}}
\index{test\-\_\-then\-\_\-inc$<$ kmp\-\_\-int32 $>$@{test\-\_\-then\-\_\-inc$<$ kmp\-\_\-int32 $>$}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{test\-\_\-then\-\_\-inc$<$ kmp\-\_\-int32 $>$}]{\setlength{\rightskip}{0pt plus 5cm}template$<$$>$ \-\_\-\-\_\-forceinline kmp\-\_\-int32 {\bf test\-\_\-then\-\_\-inc}$<$ kmp\-\_\-int32 $>$ (
\begin{DoxyParamCaption}
\item[{volatile kmp\-\_\-int32 $\ast$}]{p}
\end{DoxyParamCaption}
)}}\label{kmp__dispatch_8cpp_a325e8f0eb4c8fb5629f1c4420cc5a3b6}


Definition at line 243 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
244 \{
245     kmp\_int32 r;
246     r = \hyperlink{kmp__os_8h_a201982f51ff23ad84ae6781ad4265e3a}{KMP\_TEST\_THEN\_INC32}( \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p} );
247     \textcolor{keywordflow}{return} r;
248 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a7adb4c762be99b08465c6686cd004000}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!test\-\_\-then\-\_\-inc$<$ kmp\-\_\-int64 $>$@{test\-\_\-then\-\_\-inc$<$ kmp\-\_\-int64 $>$}}
\index{test\-\_\-then\-\_\-inc$<$ kmp\-\_\-int64 $>$@{test\-\_\-then\-\_\-inc$<$ kmp\-\_\-int64 $>$}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{test\-\_\-then\-\_\-inc$<$ kmp\-\_\-int64 $>$}]{\setlength{\rightskip}{0pt plus 5cm}template$<$$>$ \-\_\-\-\_\-forceinline kmp\-\_\-int64 {\bf test\-\_\-then\-\_\-inc}$<$ kmp\-\_\-int64 $>$ (
\begin{DoxyParamCaption}
\item[{volatile kmp\-\_\-int64 $\ast$}]{p}
\end{DoxyParamCaption}
)}}\label{kmp__dispatch_8cpp_a7adb4c762be99b08465c6686cd004000}


Definition at line 252 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
253 \{
254     kmp\_int64 r;
255     r = \hyperlink{kmp__os_8h_aee7d2212f088bf506be1b14d6d41de36}{KMP\_TEST\_THEN\_INC64}( \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p} );
256     \textcolor{keywordflow}{return} r;
257 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a60cf9ec235a5f35ab58e55bd5645c836}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!test\-\_\-then\-\_\-inc\-\_\-acq@{test\-\_\-then\-\_\-inc\-\_\-acq}}
\index{test\-\_\-then\-\_\-inc\-\_\-acq@{test\-\_\-then\-\_\-inc\-\_\-acq}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{test\-\_\-then\-\_\-inc\-\_\-acq}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ static \-\_\-\-\_\-forceinline T test\-\_\-then\-\_\-inc\-\_\-acq (
\begin{DoxyParamCaption}
\item[{volatile T $\ast$}]{p}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_a60cf9ec235a5f35ab58e55bd5645c836}


Definition at line 216 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
216 \{ \hyperlink{kmp__debug_8h_a5323a368e8ba273b17c46906dd9ec78c}{KMP\_ASSERT}(0); \};
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a99b3d841f800545b571be6a7840406c9}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!test\-\_\-then\-\_\-inc\-\_\-acq$<$ kmp\-\_\-int32 $>$@{test\-\_\-then\-\_\-inc\-\_\-acq$<$ kmp\-\_\-int32 $>$}}
\index{test\-\_\-then\-\_\-inc\-\_\-acq$<$ kmp\-\_\-int32 $>$@{test\-\_\-then\-\_\-inc\-\_\-acq$<$ kmp\-\_\-int32 $>$}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{test\-\_\-then\-\_\-inc\-\_\-acq$<$ kmp\-\_\-int32 $>$}]{\setlength{\rightskip}{0pt plus 5cm}template$<$$>$ \-\_\-\-\_\-forceinline kmp\-\_\-int32 {\bf test\-\_\-then\-\_\-inc\-\_\-acq}$<$ kmp\-\_\-int32 $>$ (
\begin{DoxyParamCaption}
\item[{volatile kmp\-\_\-int32 $\ast$}]{p}
\end{DoxyParamCaption}
)}}\label{kmp__dispatch_8cpp_a99b3d841f800545b571be6a7840406c9}


Definition at line 220 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
221 \{
222     kmp\_int32 r;
223     r = \hyperlink{kmp__os_8h_aea8d6361b43dc2785e6b2c6f9b4cef29}{KMP\_TEST\_THEN\_INC\_ACQ32}( \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p} );
224     \textcolor{keywordflow}{return} r;
225 \}
\end{DoxyCode}
\hypertarget{kmp__dispatch_8cpp_a1c6ce0de613a6b31caa6ff95337e13a4}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!test\-\_\-then\-\_\-inc\-\_\-acq$<$ kmp\-\_\-int64 $>$@{test\-\_\-then\-\_\-inc\-\_\-acq$<$ kmp\-\_\-int64 $>$}}
\index{test\-\_\-then\-\_\-inc\-\_\-acq$<$ kmp\-\_\-int64 $>$@{test\-\_\-then\-\_\-inc\-\_\-acq$<$ kmp\-\_\-int64 $>$}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{test\-\_\-then\-\_\-inc\-\_\-acq$<$ kmp\-\_\-int64 $>$}]{\setlength{\rightskip}{0pt plus 5cm}template$<$$>$ \-\_\-\-\_\-forceinline kmp\-\_\-int64 {\bf test\-\_\-then\-\_\-inc\-\_\-acq}$<$ kmp\-\_\-int64 $>$ (
\begin{DoxyParamCaption}
\item[{volatile kmp\-\_\-int64 $\ast$}]{p}
\end{DoxyParamCaption}
)}}\label{kmp__dispatch_8cpp_a1c6ce0de613a6b31caa6ff95337e13a4}


Definition at line 229 of file kmp\-\_\-dispatch.\-cpp.


\begin{DoxyCode}
230 \{
231     kmp\_int64 r;
232     r = \hyperlink{kmp__os_8h_a7f9764a658b5d000279a19bf4dd83f92}{KMP\_TEST\_THEN\_INC\_ACQ64}( \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p} );
233     \textcolor{keywordflow}{return} r;
234 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{kmp__dispatch_8cpp_a966593cb61a9833fa94a07b9f6ecaaba}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!guided\-\_\-flt\-\_\-param@{guided\-\_\-flt\-\_\-param}}
\index{guided\-\_\-flt\-\_\-param@{guided\-\_\-flt\-\_\-param}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{guided\-\_\-flt\-\_\-param}]{\setlength{\rightskip}{0pt plus 5cm}double guided\-\_\-flt\-\_\-param = 0.\-5\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_a966593cb61a9833fa94a07b9f6ecaaba}


Definition at line 584 of file kmp\-\_\-dispatch.\-cpp.

\hypertarget{kmp__dispatch_8cpp_a35e3a4cac3976f6194b63fa6552afbc7}{\index{kmp\-\_\-dispatch.\-cpp@{kmp\-\_\-dispatch.\-cpp}!guided\-\_\-int\-\_\-param@{guided\-\_\-int\-\_\-param}}
\index{guided\-\_\-int\-\_\-param@{guided\-\_\-int\-\_\-param}!kmp_dispatch.cpp@{kmp\-\_\-dispatch.\-cpp}}
\subsubsection[{guided\-\_\-int\-\_\-param}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} guided\-\_\-int\-\_\-param = 2\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__dispatch_8cpp_a35e3a4cac3976f6194b63fa6552afbc7}


Definition at line 583 of file kmp\-\_\-dispatch.\-cpp.

