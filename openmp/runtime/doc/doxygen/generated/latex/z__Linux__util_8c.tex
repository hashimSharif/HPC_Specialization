\hypertarget{z__Linux__util_8c}{\section{z\-\_\-\-Linux\-\_\-util.\-c File Reference}
\label{z__Linux__util_8c}\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}}
}
{\ttfamily \#include \char`\"{}kmp.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-wrapper\-\_\-getpid.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-itt.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-str.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-i18n.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-io.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-stats.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-wait\-\_\-release.\-h\char`\"{}}\\*
{\ttfamily \#include $<$alloca.\-h$>$}\\*
{\ttfamily \#include $<$unistd.\-h$>$}\\*
{\ttfamily \#include $<$math.\-h$>$}\\*
{\ttfamily \#include $<$sys/time.\-h$>$}\\*
{\ttfamily \#include $<$sys/times.\-h$>$}\\*
{\ttfamily \#include $<$sys/resource.\-h$>$}\\*
{\ttfamily \#include $<$sys/syscall.\-h$>$}\\*
{\ttfamily \#include $<$dirent.\-h$>$}\\*
{\ttfamily \#include $<$ctype.\-h$>$}\\*
{\ttfamily \#include $<$fcntl.\-h$>$}\\*
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structkmp__sys__timer}{kmp\-\_\-sys\-\_\-timer}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{z__Linux__util_8c_a4ca908ff7f720a3a00baf177b457f408}{T\-S2\-N\-S}(timespec)~(((timespec).tv\-\_\-sec $\ast$ 1e9) + (timespec).\-tv\-\_\-nsec)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a9c1e0ffcb1e7c87e5429269dc6c6c0bf}{\-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} gtid)
\item 
static kmp\-\_\-int32 \hyperlink{z__Linux__util_8c_a42d3fd592b93c484b9ce6713be9e5b3c}{\-\_\-\-\_\-kmp\-\_\-set\-\_\-stack\-\_\-info} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} gtid, \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ \hyperlink{z__Linux__util_8c_a100bbf4669165114bff15c8fd381af02}{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$thr)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ \hyperlink{z__Linux__util_8c_a2cd45ed219dcbe765d40f360d0d5d118}{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$thr)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_aa0827020920859540910bfb0f89e2584}{\-\_\-\-\_\-kmp\-\_\-create\-\_\-worker} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} gtid, \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, size\-\_\-t stack\-\_\-size)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a54a5fa38300ab3405a01195544ae4609}{\-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_af0505501baee87e21f7dbb2993891051}{\-\_\-\-\_\-kmp\-\_\-exit\-\_\-thread} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} exit\-\_\-status)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a768ed47b2f9c76cee082b8c7781e7ac9}{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-monitor} ()
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a6f1cbadac27343041f6bb97e0ab76c69}{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_af9e43e476cd1e6220df32409d2025761}{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-worker} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a2e5848b9f3322bf665ddc53ac090b69b}{\-\_\-\-\_\-kmp\-\_\-enable} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} new\-\_\-state)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a6662ea431f75e592a8202c1af0637aff}{\-\_\-\-\_\-kmp\-\_\-disable} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} $\ast$old\-\_\-state)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_aa0c58b40828c203c6475cfe8f08044f9}{\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-prepare} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a4929ca46709bff076801c264583922f0}{\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-parent} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a1192a4bee643eadefdcfc41e984cad42}{\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-child} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_af7249dd2326a4f4c91810e8e6d7b9544}{\-\_\-\-\_\-kmp\-\_\-register\-\_\-atfork} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a4b300606c79ebf03aaee1fdc9b9c141d}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a3cbd436ba7abef35400b2939a597025e}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a8da648a8950059fa34eeca0f54b437a6}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
{\footnotesize template$<$class C $>$ }\\static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a2a0487d25d42b2af4af0571afcd405e8}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} th\-\_\-gtid, C $\ast$flag)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_aba3964e854aa376fc15165064cf5eff7}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} th\-\_\-gtid, \hyperlink{classkmp__flag__32}{kmp\-\_\-flag\-\_\-32} $\ast$flag)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_aa691a7515df09e540efa307af193ebcf}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} th\-\_\-gtid, \hyperlink{classkmp__flag__64}{kmp\-\_\-flag\-\_\-64} $\ast$flag)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a984c4dfb0b0c1966f7f2839107b6bd80}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} th\-\_\-gtid, \hyperlink{classkmp__flag__oncore}{kmp\-\_\-flag\-\_\-oncore} $\ast$flag)
\item 
{\footnotesize template$<$class C $>$ }\\static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_ab156558ea905954294188d1395cb2848}{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-template} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} target\-\_\-gtid, C $\ast$flag)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_acfe9e02a35d4e38951a53bd689ca2141}{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-32} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} target\-\_\-gtid, \hyperlink{classkmp__flag__32}{kmp\-\_\-flag\-\_\-32} $\ast$flag)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a6d3052650a7678516a888600044b6d63}{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-64} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} target\-\_\-gtid, \hyperlink{classkmp__flag__64}{kmp\-\_\-flag\-\_\-64} $\ast$flag)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_ace5ec17d5fee86980dead25d07a595d9}{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} target\-\_\-gtid, \hyperlink{classkmp__flag__oncore}{kmp\-\_\-flag\-\_\-oncore} $\ast$flag)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a699f282bc4bbcf04222893192f568e91}{\-\_\-\-\_\-kmp\-\_\-yield} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} cond)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_ae3492f3ab3c30ed2c204dc10e93c8471}{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-set\-\_\-specific} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} gtid)
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Linux__util_8c_a81e40765e4057689a8d5fa27b62ed76e}{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-get\-\_\-specific} ()
\item 
double \hyperlink{z__Linux__util_8c_a59bfe9c94177c19907c3f28bf3daf4a3}{\-\_\-\-\_\-kmp\-\_\-read\-\_\-cpu\-\_\-time} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Linux__util_8c_ab8f6d039c9b836fa9a1ec3b3987817a7}{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-info} (struct \hyperlink{structkmp__sys__info}{kmp\-\_\-sys\-\_\-info} $\ast$info)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a1f49d8ebe9ab3485ce41c35d80d202d5}{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time} (double $\ast$delta)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_aabfba67685e1a77399b30e235ef64c43}{\-\_\-\-\_\-kmp\-\_\-clear\-\_\-system\-\_\-time} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
static \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Linux__util_8c_ae39a99b218d0a4540b2023f49ad38b7a}{\-\_\-\-\_\-kmp\-\_\-get\-\_\-xproc} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Linux__util_8c_aa3abcb7ce4b58402699ab90f721e0578}{\-\_\-\-\_\-kmp\-\_\-read\-\_\-from\-\_\-file} (char const $\ast$path, char const $\ast$format,...)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_ad0680d5e6d1872f505775e7bf61c91f6}{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_ab5834eff1e783726ba2a6a32133617cc}{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_a397d2a9aa5fd59cab056b8aed69fef29}{\-\_\-\-\_\-kmp\-\_\-thread\-\_\-sleep} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} millis)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_aa8475a433d18b95fcfaf4543146e2607}{\-\_\-\-\_\-kmp\-\_\-elapsed} (double $\ast$t)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{z__Linux__util_8c_ae03839bc0108d7b046aeab29b3700fe0}{\-\_\-\-\_\-kmp\-\_\-elapsed\-\_\-tick} (double $\ast$t)
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Linux__util_8c_a5676bfae90caed2d037a605382449d2c}{\-\_\-\-\_\-kmp\-\_\-is\-\_\-address\-\_\-mapped} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$\hyperlink{ittnotify__static_8h_a7e21c61c16fffcc27199a9d66ff39ab8}{addr})
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Linux__util_8c_a8b9eeb09f657cfedf1710611f8f778e6}{\-\_\-\-\_\-kmp\-\_\-invoke\-\_\-microtask} (\hyperlink{kmp__os_8h_a390eabec74d95ed005fb6979992598c8}{microtask\-\_\-t} pkfn, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} gtid, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} tid, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} argc, \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$p\-\_\-argv\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static struct \hyperlink{structkmp__sys__timer}{kmp\-\_\-sys\-\_\-timer} \hyperlink{z__Linux__util_8c_a896323e702eca2ab9e9cadd0babccb6c}{\-\_\-\-\_\-kmp\-\_\-sys\-\_\-timer\-\_\-data}
\item 
static \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Linux__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\-\_\-\-\_\-kmp\-\_\-init\-\_\-runtime} = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{F\-A\-L\-S\-E}
\item 
static \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{z__Linux__util_8c_a95d647f877d12f7486e0f53cccadc7e5}{\-\_\-\-\_\-kmp\-\_\-fork\-\_\-count} = 0
\item 
static pthread\-\_\-condattr\-\_\-t \hyperlink{z__Linux__util_8c_a6c478e674b147c738cc07462a660f8da}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-cond\-\_\-attr}
\item 
static pthread\-\_\-mutexattr\-\_\-t \hyperlink{z__Linux__util_8c_a3836edc5d4bf91aaa64b0360f0cb91ae}{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-mutex\-\_\-attr}
\item 
static kmp\-\_\-cond\-\_\-align\-\_\-t \hyperlink{z__Linux__util_8c_adf8bd06136520a941aa1db9078d080d3}{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-cv}
\item 
static kmp\-\_\-mutex\-\_\-align\-\_\-t \hyperlink{z__Linux__util_8c_a1d77743294d51eefed86a29081e1dcfe}{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-mx}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{z__Linux__util_8c_a4ca908ff7f720a3a00baf177b457f408}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!T\-S2\-N\-S@{T\-S2\-N\-S}}
\index{T\-S2\-N\-S@{T\-S2\-N\-S}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{T\-S2\-N\-S}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\-S2\-N\-S(
\begin{DoxyParamCaption}
\item[{}]{timespec}
\end{DoxyParamCaption}
)~(((timespec).tv\-\_\-sec $\ast$ 1e9) + (timespec).\-tv\-\_\-nsec)}}\label{z__Linux__util_8c_a4ca908ff7f720a3a00baf177b457f408}


Definition at line 69 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time().



\subsection{Function Documentation}
\hypertarget{z__Linux__util_8c_a1192a4bee643eadefdcfc41e984cad42}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-child@{\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-child}}
\index{\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-child@{\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-child}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-child}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-atfork\-\_\-child (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Linux__util_8c_a1192a4bee643eadefdcfc41e984cad42}


Definition at line 1528 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-register\-\_\-atfork().


\begin{DoxyCode}
1529 \{
1530     \textcolor{comment}{/* TODO make sure this is done right for nested/sibling */}
1531     \textcolor{comment}{// ATT:  Memory leaks are here? TODO: Check it and fix.}
1532     \textcolor{comment}{/* KMP\_ASSERT( 0 ); */}
1533 
1534     ++\hyperlink{z__Linux__util_8c_a95d647f877d12f7486e0f53cccadc7e5}{\_\_kmp\_fork\_count};
1535 
1536     \hyperlink{z__Linux__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime} = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1537     \hyperlink{kmp_8h_a7837f92b7bc9827769108bb115d180e8}{\_\_kmp\_init\_monitor} = 0;
1538     \hyperlink{kmp_8h_aa23ece0d05f38387c8a8441aaad368df}{\_\_kmp\_init\_parallel} = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1539     \hyperlink{kmp_8h_a70576d967f407af9d2ecb6174c1c7add}{\_\_kmp\_init\_middle} = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1540     \hyperlink{kmp_8h_aee22cd19970207e05e9c86cc0a802f9c}{\_\_kmp\_init\_serial} = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1541     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(\hyperlink{kmp_8h_a3f91f5b94048484e40c6caeb66c60f27}{\_\_kmp\_init\_gtid}, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1542     \hyperlink{kmp_8h_a5f3438a34f9250663bc10f78b727dc1a}{\_\_kmp\_init\_common} = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1543 
1544     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(\hyperlink{kmp_8h_a06dca6ee024848d88e7a69d5df512e65}{\_\_kmp\_init\_user\_locks}, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
1545 \textcolor{preprocessor}{#if ! KMP\_USE\_DYNAMIC\_LOCK}
1546 \textcolor{preprocessor}{}    \hyperlink{kmp__lock_8cpp_a71ca798d77f420b73d7f788913a44a4e}{\_\_kmp\_user\_lock\_table}.\hyperlink{structkmp__lock__table_a92f49bd4acf0bbe4548629b8010bcc3b}{used} = 1;
1547     \hyperlink{kmp__lock_8cpp_a71ca798d77f420b73d7f788913a44a4e}{\_\_kmp\_user\_lock\_table}.\hyperlink{structkmp__lock__table_a39d3ce64fcbf71b41c2b3ac1dccbb05a}{allocated} = 0;
1548     \hyperlink{kmp__lock_8cpp_a71ca798d77f420b73d7f788913a44a4e}{\_\_kmp\_user\_lock\_table}.\hyperlink{structkmp__lock__table_a89b0c01b5aebf4417258655f6d55ff16}{table} = NULL;
1549     \hyperlink{kmp__lock_8cpp_a4700fce2ae21cd87f85fd99bb7edc37f}{\_\_kmp\_lock\_blocks} = NULL;
1550 \textcolor{preprocessor}{#endif}
1551 \textcolor{preprocessor}{}
1552     \hyperlink{kmp_8h_a521a7c7af6217ee75a79b5abd627779c}{\_\_kmp\_all\_nth} = 0;
1553     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(\hyperlink{kmp_8h_a774ce85ac109df119feaca45ed4e69b1}{\_\_kmp\_nth}, 0);
1554 
1555     \textcolor{comment}{/* Must actually zero all the *cache arguments passed to \_\_kmpc\_threadprivate here}
1556 \textcolor{comment}{       so threadprivate doesn't use stale data */}
1557     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_atfork\_child: checking cache address list %p\(\backslash\)n"},
1558                  \hyperlink{kmp_8h_a4ffa887cdb59674790ac14ee4a8228e9}{\_\_kmp\_threadpriv\_cache\_list} ) );
1559 
1560     \textcolor{keywordflow}{while} ( \hyperlink{kmp_8h_a4ffa887cdb59674790ac14ee4a8228e9}{\_\_kmp\_threadpriv\_cache\_list} != NULL ) \{
1561 
1562         \textcolor{keywordflow}{if} ( *\hyperlink{kmp_8h_a4ffa887cdb59674790ac14ee4a8228e9}{\_\_kmp\_threadpriv\_cache\_list} -> \hyperlink{ittnotify__static_8h_a7e21c61c16fffcc27199a9d66ff39ab8}{addr} != NULL ) \{
1563             \hyperlink{kmp__debug_8h_ab49eefbf8c74cfe98a90ce7ec8864add}{KC\_TRACE}( 50, ( \textcolor{stringliteral}{"\_\_kmp\_atfork\_child: zeroing cache at address %p\(\backslash\)n"},
1564                         &(*\hyperlink{kmp_8h_a4ffa887cdb59674790ac14ee4a8228e9}{\_\_kmp\_threadpriv\_cache\_list} -> 
      \hyperlink{ittnotify__static_8h_a7e21c61c16fffcc27199a9d66ff39ab8}{addr}) ) );
1565 
1566             *\hyperlink{kmp_8h_a4ffa887cdb59674790ac14ee4a8228e9}{\_\_kmp\_threadpriv\_cache\_list} -> \hyperlink{ittnotify__static_8h_a7e21c61c16fffcc27199a9d66ff39ab8}{addr} = NULL;
1567         \}
1568         \hyperlink{kmp_8h_a4ffa887cdb59674790ac14ee4a8228e9}{\_\_kmp\_threadpriv\_cache\_list} = 
      \hyperlink{kmp_8h_a4ffa887cdb59674790ac14ee4a8228e9}{\_\_kmp\_threadpriv\_cache\_list} -> \hyperlink{structshared__common_aa54da923f39ba340f472b4a62205b967}{next};
1569     \}
1570 
1571     \hyperlink{z__Linux__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime} = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1572 
1573     \textcolor{comment}{/* reset statically initialized locks */}
1574     \hyperlink{kmp__lock_8h_ad0724dc0da849eb1ed970306cbf96e7b}{\_\_kmp\_init\_bootstrap\_lock}( &\hyperlink{kmp_8h_a0e6256b159476ca7409660e01d49b556}{\_\_kmp\_initz\_lock} );
1575     \hyperlink{kmp__lock_8h_ad0724dc0da849eb1ed970306cbf96e7b}{\_\_kmp\_init\_bootstrap\_lock}( &\hyperlink{kmp__io_8c_a49e60c011739f46589bb4fae4ad737cc}{\_\_kmp\_stdio\_lock} );
1576     \hyperlink{kmp__lock_8h_ad0724dc0da849eb1ed970306cbf96e7b}{\_\_kmp\_init\_bootstrap\_lock}( &\hyperlink{kmp__io_8c_a271301bc32a074d1d51ea7a03530e0d3}{\_\_kmp\_console\_lock} );
1577 
1578     \textcolor{comment}{/* This is necessary to make sure no stale data is left around */}
1579     \textcolor{comment}{/* AC: customers complain that we use unsafe routines in the atfork}
1580 \textcolor{comment}{       handler. Mathworks: dlsym() is unsafe. We call dlsym and dlopen}
1581 \textcolor{comment}{       in dynamic\_link when check the presence of shared tbbmalloc library.}
1582 \textcolor{comment}{       Suggestion is to make the library initialization lazier, similar}
1583 \textcolor{comment}{       to what done for \_\_kmpc\_begin(). */}
1584     \textcolor{comment}{// TODO: synchronize all static initializations with regular library}
1585     \textcolor{comment}{//       startup; look at kmp\_global.c and etc.}
1586     \textcolor{comment}{//\_\_kmp\_internal\_begin ();}
1587 
1588 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a4929ca46709bff076801c264583922f0}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-parent@{\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-parent}}
\index{\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-parent@{\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-parent}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-parent}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-atfork\-\_\-parent (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Linux__util_8c_a4929ca46709bff076801c264583922f0}


Definition at line 1517 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-register\-\_\-atfork().


\begin{DoxyCode}
1518 \{
1519     \textcolor{comment}{/*  nothing to do  */}
1520 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_aa0c58b40828c203c6475cfe8f08044f9}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-prepare@{\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-prepare}}
\index{\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-prepare@{\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-prepare}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-atfork\-\_\-prepare}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-atfork\-\_\-prepare (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Linux__util_8c_aa0c58b40828c203c6475cfe8f08044f9}


Definition at line 1511 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-register\-\_\-atfork().


\begin{DoxyCode}
1512 \{
1513     \textcolor{comment}{/*  nothing to do  */}
1514 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_aabfba67685e1a77399b30e235ef64c43}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-clear\-\_\-system\-\_\-time@{\-\_\-\-\_\-kmp\-\_\-clear\-\_\-system\-\_\-time}}
\index{\-\_\-\-\_\-kmp\-\_\-clear\-\_\-system\-\_\-time@{\-\_\-\-\_\-kmp\-\_\-clear\-\_\-system\-\_\-time}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-clear\-\_\-system\-\_\-time}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-clear\-\_\-system\-\_\-time (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_aabfba67685e1a77399b30e235ef64c43}


Definition at line 1984 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1985 \{
1986     \textcolor{keyword}{struct }timeval tval;
1987     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1988     status = gettimeofday( &tval, NULL );
1989     \hyperlink{kmp__i18n_8h_a8c4d6cebf68c7b886a511c86aeef0439}{KMP\_CHECK\_SYSFAIL\_ERRNO}( \textcolor{stringliteral}{"gettimeofday"}, status );
1990     TIMEVAL\_TO\_TIMESPEC( &tval, &\hyperlink{z__Linux__util_8c_a896323e702eca2ab9e9cadd0babccb6c}{\_\_kmp\_sys\_timer\_data}.\hyperlink{structkmp__sys__timer_ae9f66812fe3c116738ebc985ab6f66f2}{start} );
1991 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a54a5fa38300ab3405a01195544ae4609}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor@{\-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor}}
\index{\-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor@{\-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a54a5fa38300ab3405a01195544ae4609}


Definition at line 1076 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1077 \{
1078     pthread\_t           handle;
1079     pthread\_attr\_t      thread\_attr;
1080     \textcolor{keywordtype}{size\_t}              \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size};
1081     \textcolor{keywordtype}{int}                 \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1082     \textcolor{keywordtype}{int}                 auto\_adj\_size = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1083 
1084     \textcolor{keywordflow}{if}( \hyperlink{kmp_8h_a3b56e2e90e1539c0b794e4137724bc1c}{\_\_kmp\_dflt\_blocktime} == \hyperlink{kmp_8h_a1ca6c6ce04115f143dc5df627de57958}{KMP\_MAX\_BLOCKTIME} ) \{
1085         \textcolor{comment}{// We don't need monitor thread in case of MAX\_BLOCKTIME}
1086         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_create\_monitor: skipping monitor thread because of MAX blocktime\(\backslash\)n"} )
       );
1087         th->th.th\_info.ds.ds\_tid  = 0; \textcolor{comment}{// this makes reap\_monitor no-op}
1088         th->th.th\_info.ds.ds\_gtid = 0;
1089         \textcolor{keywordflow}{return};
1090     \}
1091     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_create\_monitor: try to create monitor\(\backslash\)n"} ) );
1092 
1093     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1094 
1095     th->th.th\_info.ds.ds\_tid  = \hyperlink{kmp_8h_a5eb958603bc237a3484be5bd2b0de39a}{KMP\_GTID\_MONITOR};
1096     th->th.th\_info.ds.ds\_gtid = \hyperlink{kmp_8h_a5eb958603bc237a3484be5bd2b0de39a}{KMP\_GTID\_MONITOR};
1097 \textcolor{preprocessor}{    #if KMP\_REAL\_TIME\_FIX}
1098 \textcolor{preprocessor}{}        \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_time.dt.t\_value, -1 ); \textcolor{comment}{// Will use it for synchronization
       a bit later.}
1099 \textcolor{preprocessor}{    #else}
1100 \textcolor{preprocessor}{}        \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_time.dt.t\_value, 0 );
1101 \textcolor{preprocessor}{    #endif // KMP\_REAL\_TIME\_FIX}
1102 \textcolor{preprocessor}{}
1103 \textcolor{preprocessor}{    #ifdef KMP\_THREAD\_ATTR}
1104 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} == 0 ) \{
1105             \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} = 
      \hyperlink{kmp_8h_ad9e61183792948e75cf30b7d1f08299a}{KMP\_DEFAULT\_MONITOR\_STKSIZE};
1106             auto\_adj\_size = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1107         \}
1108         status = pthread\_attr\_init( &thread\_attr );
1109         \textcolor{keywordflow}{if} ( status != 0 ) \{
1110             \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1111                 \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
1112                 \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantInitThreadAttrs ),
1113                 \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ),
1114                 \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1115             );
1116         \}; \textcolor{comment}{// if}
1117         status = pthread\_attr\_setdetachstate( & thread\_attr, PTHREAD\_CREATE\_JOINABLE );
1118         \textcolor{keywordflow}{if} ( status != 0 ) \{
1119             \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1120                 \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
1121                 \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantSetMonitorState ),
1122                 \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ),
1123                 \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1124             );
1125         \}; \textcolor{comment}{// if}
1126 
1127 \textcolor{preprocessor}{        #ifdef \_POSIX\_THREAD\_ATTR\_STACKSIZE}
1128 \textcolor{preprocessor}{}            status = pthread\_attr\_getstacksize( & thread\_attr, & size );
1129             \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_attr\_getstacksize"}, status );
1130 \textcolor{preprocessor}{        #else}
1131 \textcolor{preprocessor}{}            size = \hyperlink{kmp_8h_ac11734b715f1e9aec17fc0eda9cba87c}{\_\_kmp\_sys\_min\_stksize};
1132 \textcolor{preprocessor}{        #endif }\textcolor{comment}{/* \_POSIX\_THREAD\_ATTR\_STACKSIZE */}\textcolor{preprocessor}{}
1133 \textcolor{preprocessor}{}\textcolor{preprocessor}{    #endif }\textcolor{comment}{/* KMP\_THREAD\_ATTR */}\textcolor{preprocessor}{}
1134 \textcolor{preprocessor}{}
1135     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} == 0 ) \{
1136         \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} = \hyperlink{kmp_8h_ad9e61183792948e75cf30b7d1f08299a}{KMP\_DEFAULT\_MONITOR\_STKSIZE}
      ;
1137     \}
1138     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} < \hyperlink{kmp_8h_ac11734b715f1e9aec17fc0eda9cba87c}{\_\_kmp\_sys\_min\_stksize} ) \{
1139         \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} = \hyperlink{kmp_8h_ac11734b715f1e9aec17fc0eda9cba87c}{\_\_kmp\_sys\_min\_stksize};
1140     \}
1141 
1142     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_create\_monitor: default stacksize = %lu bytes,"}
1143                     \textcolor{stringliteral}{"requested stacksize = %lu bytes\(\backslash\)n"},
1144                     size, \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} ) );
1145 
1146     retry:
1147 
1148     \textcolor{comment}{/* Set stack size for this thread now. */}
1149 
1150 \textcolor{preprocessor}{    #ifdef \_POSIX\_THREAD\_ATTR\_STACKSIZE}
1151 \textcolor{preprocessor}{}        \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_create\_monitor: setting stacksize = %lu bytes,"},
1152                         \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} ) );
1153         status = pthread\_attr\_setstacksize( & thread\_attr, \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} );
1154         \textcolor{keywordflow}{if} ( status != 0 ) \{
1155             \textcolor{keywordflow}{if} ( auto\_adj\_size ) \{
1156                 \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} *= 2;
1157                 \textcolor{keywordflow}{goto} retry;
1158             \}
1159             \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1160                 \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060af43a3e02113c5b36d94c603bad0cd807}{kmp\_ms\_warning},  \textcolor{comment}{// should this be fatal?  BB}
1161                 \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantSetMonitorStackSize, (\textcolor{keywordtype}{long} \textcolor{keywordtype}{int}) 
      \hyperlink{kmp_8h_a0dfe083716c706c3b8ea872623fad7c7}{\_\_kmp\_monitor\_stksize} ),
1162                 \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ),
1163                 \hyperlink{kmp__i18n_8h_ac5fe3f32cfaa3b9268776d372a0f09c4}{KMP\_HNT}( ChangeMonitorStackSize ),
1164                 \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1165             );
1166         \}; \textcolor{comment}{// if}
1167 \textcolor{preprocessor}{    #endif }\textcolor{comment}{/* \_POSIX\_THREAD\_ATTR\_STACKSIZE */}\textcolor{preprocessor}{}
1168 \textcolor{preprocessor}{}
1169     status = pthread\_create( &handle, & thread\_attr, \hyperlink{z__Linux__util_8c_a2cd45ed219dcbe765d40f360d0d5d118}{\_\_kmp\_launch\_monitor}, (\textcolor{keywordtype}{void} *) th 
      );
1170 
1171     \textcolor{keywordflow}{if} ( status != 0 ) \{
1172 \textcolor{preprocessor}{        #ifdef \_POSIX\_THREAD\_ATTR\_STACKSIZE}
1173 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} ( status == EINVAL ) \{
1174                 \textcolor{keywordflow}{if} ( auto\_adj\_size  && ( \_\_kmp\_monitor\_stksize < (\textcolor{keywordtype}{size\_t})0x40000000 ) ) \{
1175                     \_\_kmp\_monitor\_stksize *= 2;
1176                     \textcolor{keywordflow}{goto} retry;
1177                 \}
1178                 \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1179                     \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
1180                     \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantSetMonitorStackSize, \_\_kmp\_monitor\_stksize ),
1181                     \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ),
1182                     \hyperlink{kmp__i18n_8h_ac5fe3f32cfaa3b9268776d372a0f09c4}{KMP\_HNT}( IncreaseMonitorStackSize ),
1183                     \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1184                 );
1185             \}; \textcolor{comment}{// if}
1186             \textcolor{keywordflow}{if} ( status == ENOMEM ) \{
1187                 \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1188                     \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
1189                     \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantSetMonitorStackSize, \_\_kmp\_monitor\_stksize ),
1190                     \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ),
1191                     \hyperlink{kmp__i18n_8h_ac5fe3f32cfaa3b9268776d372a0f09c4}{KMP\_HNT}( DecreaseMonitorStackSize ),
1192                     \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1193                 );
1194             \}; \textcolor{comment}{// if}
1195 \textcolor{preprocessor}{        #endif }\textcolor{comment}{/* \_POSIX\_THREAD\_ATTR\_STACKSIZE */}\textcolor{preprocessor}{}
1196 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( status == EAGAIN ) \{
1197             \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1198                 \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
1199                 \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( NoResourcesForMonitorThread ),
1200                 \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ),
1201                 \hyperlink{kmp__i18n_8h_ac5fe3f32cfaa3b9268776d372a0f09c4}{KMP\_HNT}( DecreaseNumberOfThreadsInUse ),
1202                 \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1203             );
1204         \}; \textcolor{comment}{// if}
1205         \hyperlink{kmp__i18n_8h_aab99fba7f170866ead9c59379f73115b}{KMP\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_create"}, status );
1206     \}; \textcolor{comment}{// if}
1207 
1208     th->th.th\_info.ds.ds\_thread = handle;
1209 
1210 \textcolor{preprocessor}{    #if KMP\_REAL\_TIME\_FIX}
1211 \textcolor{preprocessor}{}        \textcolor{comment}{// Wait for the monitor thread is really started and set its *priority*.}
1212         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \textcolor{keyword}{sizeof}( kmp\_uint32 ) == \textcolor{keyword}{sizeof}( 
      \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_time.dt.t\_value ) );
1213         \hyperlink{kmp_8h_a27b5dfa29e47adffbfa0d9369787f4a1}{\_\_kmp\_wait\_yield\_4}(
1214             (kmp\_uint32 \textcolor{keyword}{volatile} *) & \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_time.dt.t\_value, -1, & 
      \hyperlink{kmp_8h_ab9e91c3377af2c1678dbd5e2dbd21aaa}{\_\_kmp\_neq\_4}, NULL
1215         );
1216 \textcolor{preprocessor}{    #endif // KMP\_REAL\_TIME\_FIX}
1217 \textcolor{preprocessor}{}
1218 \textcolor{preprocessor}{    #ifdef KMP\_THREAD\_ATTR}
1219 \textcolor{preprocessor}{}        status = pthread\_attr\_destroy( & thread\_attr );
1220         \textcolor{keywordflow}{if} ( status != 0 ) \{
1221             \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(    \textcolor{comment}{//}
1222                 \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060af43a3e02113c5b36d94c603bad0cd807}{kmp\_ms\_warning},
1223                 \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantDestroyThreadAttrs ),
1224                 \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ),
1225                 \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1226             );
1227         \}; \textcolor{comment}{// if}
1228 \textcolor{preprocessor}{    #endif}
1229 \textcolor{preprocessor}{}
1230     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1231 
1232     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_create\_monitor: monitor created %#.8lx\(\backslash\)n"}, th->th.th\_info.ds.ds\_thread )
       );
1233 
1234 \} \textcolor{comment}{// \_\_kmp\_create\_monitor}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_aa0827020920859540910bfb0f89e2584}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-create\-\_\-worker@{\-\_\-\-\_\-kmp\-\_\-create\-\_\-worker}}
\index{\-\_\-\-\_\-kmp\-\_\-create\-\_\-worker@{\-\_\-\-\_\-kmp\-\_\-create\-\_\-worker}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-create\-\_\-worker}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-create\-\_\-worker (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{gtid, }
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{size\-\_\-t}]{stack\-\_\-size}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_aa0827020920859540910bfb0f89e2584}


Definition at line 954 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
955 \{
956     pthread\_t      handle;
957     pthread\_attr\_t thread\_attr;
958     \textcolor{keywordtype}{int}            \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
959 
960 
961     th->th.th\_info.ds.ds\_gtid = gtid;
962 
963 \textcolor{preprocessor}{#if KMP\_STATS\_ENABLED}
964 \textcolor{preprocessor}{}    \textcolor{comment}{// sets up worker thread stats}
965     \hyperlink{kmp__lock_8cpp_a1081f214daf0024f610101a119a755c3}{\_\_kmp\_acquire\_tas\_lock}(&\hyperlink{kmp__global_8c_a42262d8acf08f12f7bea6affc1673068}{\_\_kmp\_stats\_lock}, gtid);
966 
967     \textcolor{comment}{// th->th.th\_stats is used to transfer thread specific stats-pointer to \_\_kmp\_launch\_worker}
968     \textcolor{comment}{// So when thread is created (goes into \_\_kmp\_launch\_worker) it will}
969     \textcolor{comment}{// set it's \_\_thread local pointer to th->th.th\_stats}
970     th->th.th\_stats = \hyperlink{kmp__global_8c_a4ce412fd3335747984f4b5d8fa62cb98}{\_\_kmp\_stats\_list}.\hyperlink{classkmp__stats__list_a5c9c2bae3aee4483d1a1a6119752687e}{push\_back}(gtid);
971     \textcolor{keywordflow}{if}(\hyperlink{kmp_8h_a1ad5b094aa539d78ab4155b10b0ced21}{KMP\_UBER\_GTID}(gtid)) \{
972         \hyperlink{kmp__global_8c_a12d1cf26d9330e0eb6361b6d67086d1d}{\_\_kmp\_stats\_start\_time} = \hyperlink{classtsc__tick__count_a0caca1efab64714976683134bcdd99b4}{tsc\_tick\_count::now}();
973         \hyperlink{kmp__global_8c_ae8b6bdb1368ab875fdb8322ba2de5803}{\_\_kmp\_stats\_thread\_ptr} = th->th.th\_stats;
974         \hyperlink{kmp__stats_8cpp_a09d4c024310a94eb1f5953c600ad8672}{\_\_kmp\_stats\_init}();
975         \hyperlink{group__STATS__GATHERING_ga8b26485fe6ad4f74b63e54c42fcfd875}{KMP\_START\_EXPLICIT\_TIMER}(OMP\_serial);
976         \hyperlink{group__STATS__GATHERING_ga8b26485fe6ad4f74b63e54c42fcfd875}{KMP\_START\_EXPLICIT\_TIMER}(OMP\_start\_end);
977     \}
978     \hyperlink{kmp__lock_8cpp_a70ab5cc7e70192354a19bd8e988633de}{\_\_kmp\_release\_tas\_lock}(&\hyperlink{kmp__global_8c_a42262d8acf08f12f7bea6affc1673068}{\_\_kmp\_stats\_lock}, gtid);
979 
980 \textcolor{preprocessor}{#endif // KMP\_STATS\_ENABLED}
981 \textcolor{preprocessor}{}
982     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a1ad5b094aa539d78ab4155b10b0ced21}{KMP\_UBER\_GTID}(gtid) ) \{
983         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_create\_worker: uber thread (%d)\(\backslash\)n"}, gtid ) );
984         th -> th.th\_info.ds.ds\_thread = pthread\_self();
985         \hyperlink{z__Linux__util_8c_a42d3fd592b93c484b9ce6713be9e5b3c}{\_\_kmp\_set\_stack\_info}( gtid, th );
986         \hyperlink{kmp_8h_a21152135e5447d443b8f803bb6437639}{\_\_kmp\_check\_stack\_overlap}( th );
987         \textcolor{keywordflow}{return};
988     \}; \textcolor{comment}{// if}
989 
990     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_create\_worker: try to create thread (%d)\(\backslash\)n"}, gtid ) );
991 
992     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
993 
994 \textcolor{preprocessor}{#ifdef KMP\_THREAD\_ATTR}
995 \textcolor{preprocessor}{}    status = pthread\_attr\_init( &thread\_attr );
996     \textcolor{keywordflow}{if} ( status != 0 ) \{
997         \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(\hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal}, \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantInitThreadAttrs ), 
      \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ), \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null});
998     \}; \textcolor{comment}{// if}
999     status = pthread\_attr\_setdetachstate( & thread\_attr, PTHREAD\_CREATE\_JOINABLE );
1000     \textcolor{keywordflow}{if} ( status != 0 ) \{
1001         \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(\hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal}, \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantSetWorkerState ), 
      \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ), \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null});
1002     \}; \textcolor{comment}{// if}
1003 
1004     \textcolor{comment}{/* Set stack size for this thread now. }
1005 \textcolor{comment}{     * The multiple of 2 is there because on some machines, requesting an unusual stacksize}
1006 \textcolor{comment}{     * causes the thread to have an offset before the dummy alloca() takes place to create the}
1007 \textcolor{comment}{     * offset.  Since we want the user to have a sufficient stacksize AND support a stack offset, we }
1008 \textcolor{comment}{     * alloca() twice the offset so that the upcoming alloca() does not eliminate any premade}
1009 \textcolor{comment}{     * offset, and also gives the user the stack space they requested for all threads */}
1010     stack\_size += gtid * \hyperlink{kmp_8h_ac841e4743aeceae5d3667bc8511ba1c4}{\_\_kmp\_stkoffset} * 2;
1011 
1012     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_create\_worker: T#%d, default stacksize = %lu bytes, "}
1013                     \textcolor{stringliteral}{"\_\_kmp\_stksize = %lu bytes, final stacksize = %lu bytes\(\backslash\)n"},
1014                     gtid, \hyperlink{kmp_8h_a6c7fa39148ea938d84c2f61895b7009c}{KMP\_DEFAULT\_STKSIZE}, \hyperlink{kmp_8h_a4524fc3a41e208a6cf6d7cad17f028c7}{\_\_kmp\_stksize}, stack\_size ) 
      );
1015 
1016 \textcolor{preprocessor}{# ifdef \_POSIX\_THREAD\_ATTR\_STACKSIZE}
1017 \textcolor{preprocessor}{}    status = pthread\_attr\_setstacksize( & thread\_attr, stack\_size );
1018 \textcolor{preprocessor}{#  ifdef KMP\_BACKUP\_STKSIZE}
1019 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} ( status != 0 ) \{
1020         \textcolor{keywordflow}{if} ( ! \hyperlink{kmp_8h_afa33d0664a4c46cd1affefab89548901}{\_\_kmp\_env\_stksize} ) \{
1021             stack\_size = KMP\_BACKUP\_STKSIZE + gtid * \hyperlink{kmp_8h_ac841e4743aeceae5d3667bc8511ba1c4}{\_\_kmp\_stkoffset};
1022             \hyperlink{kmp_8h_a4524fc3a41e208a6cf6d7cad17f028c7}{\_\_kmp\_stksize} = KMP\_BACKUP\_STKSIZE;
1023             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_create\_worker: T#%d, default stacksize = %lu bytes, "}
1024                            \textcolor{stringliteral}{"\_\_kmp\_stksize = %lu bytes, (backup) final stacksize = %lu "}
1025                            \textcolor{stringliteral}{"bytes\(\backslash\)n"},
1026                            gtid, \hyperlink{kmp_8h_a6c7fa39148ea938d84c2f61895b7009c}{KMP\_DEFAULT\_STKSIZE}, 
      \hyperlink{kmp_8h_a4524fc3a41e208a6cf6d7cad17f028c7}{\_\_kmp\_stksize}, stack\_size )
1027                       );
1028             status = pthread\_attr\_setstacksize( &thread\_attr, stack\_size );
1029         \}; \textcolor{comment}{// if}
1030     \}; \textcolor{comment}{// if}
1031 \textcolor{preprocessor}{#  endif }\textcolor{comment}{/* KMP\_BACKUP\_STKSIZE */}\textcolor{preprocessor}{}
1032 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} ( status != 0 ) \{
1033         \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(\hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal}, \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantSetWorkerStackSize, stack\_size ), 
      \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ),
1034                   \hyperlink{kmp__i18n_8h_ac5fe3f32cfaa3b9268776d372a0f09c4}{KMP\_HNT}( ChangeWorkerStackSize  ), \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null});
1035     \}; \textcolor{comment}{// if}
1036 \textcolor{preprocessor}{# endif }\textcolor{comment}{/* \_POSIX\_THREAD\_ATTR\_STACKSIZE */}\textcolor{preprocessor}{}
1037 \textcolor{preprocessor}{}
1038 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_THREAD\_ATTR */}\textcolor{preprocessor}{}
1039 \textcolor{preprocessor}{}
1040     status = pthread\_create( & handle, & thread\_attr, \hyperlink{z__Linux__util_8c_a100bbf4669165114bff15c8fd381af02}{\_\_kmp\_launch\_worker}, (\textcolor{keywordtype}{void} *) th )
      ;
1041     \textcolor{keywordflow}{if} ( status != 0 || ! handle ) \{ \textcolor{comment}{// ??? Why do we check handle??}
1042 \textcolor{preprocessor}{#ifdef \_POSIX\_THREAD\_ATTR\_STACKSIZE}
1043 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( status == EINVAL ) \{
1044             \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(\hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal}, \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantSetWorkerStackSize, stack\_size
       ), \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ),
1045                       \hyperlink{kmp__i18n_8h_ac5fe3f32cfaa3b9268776d372a0f09c4}{KMP\_HNT}( IncreaseWorkerStackSize ), \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null});
1046         \};
1047         \textcolor{keywordflow}{if} ( status == ENOMEM ) \{
1048             \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(\hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal}, \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantSetWorkerStackSize, stack\_size
       ), \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ),
1049                       \hyperlink{kmp__i18n_8h_ac5fe3f32cfaa3b9268776d372a0f09c4}{KMP\_HNT}( DecreaseWorkerStackSize ), \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null});
1050         \};
1051 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* \_POSIX\_THREAD\_ATTR\_STACKSIZE */}\textcolor{preprocessor}{}
1052 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( status == EAGAIN ) \{
1053             \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(\hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal}, \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( NoResourcesForWorkerThread ), 
      \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ),
1054                       \hyperlink{kmp__i18n_8h_ac5fe3f32cfaa3b9268776d372a0f09c4}{KMP\_HNT}( Decrease\_NUM\_THREADS ), \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null});
1055         \}; \textcolor{comment}{// if}
1056         \hyperlink{kmp__i18n_8h_aab99fba7f170866ead9c59379f73115b}{KMP\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_create"}, status );
1057     \}; \textcolor{comment}{// if}
1058 
1059     th->th.th\_info.ds.ds\_thread = handle;
1060 
1061 \textcolor{preprocessor}{#ifdef KMP\_THREAD\_ATTR}
1062 \textcolor{preprocessor}{}    status = pthread\_attr\_destroy( & thread\_attr );
1063     \textcolor{keywordflow}{if} ( status ) \{
1064         \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(\hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060af43a3e02113c5b36d94c603bad0cd807}{kmp\_ms\_warning}, \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantDestroyThreadAttrs ), 
      \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ), \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null});
1065     \}; \textcolor{comment}{// if}
1066 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_THREAD\_ATTR */}\textcolor{preprocessor}{}
1067 \textcolor{preprocessor}{}
1068     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1069 
1070     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_create\_worker: done creating thread (%d)\(\backslash\)n"}, gtid ) );
1071 
1072 \} \textcolor{comment}{// \_\_kmp\_create\_worker}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a6662ea431f75e592a8202c1af0637aff}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-disable@{\-\_\-\-\_\-kmp\-\_\-disable}}
\index{\-\_\-\-\_\-kmp\-\_\-disable@{\-\_\-\-\_\-kmp\-\_\-disable}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-disable}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-disable (
\begin{DoxyParamCaption}
\item[{{\bf int} $\ast$}]{old\-\_\-state}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a6662ea431f75e592a8202c1af0637aff}


Definition at line 1498 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1499 \{
1500 \textcolor{preprocessor}{    #ifdef KMP\_CANCEL\_THREADS}
1501 \textcolor{preprocessor}{}        \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1502         status = pthread\_setcancelstate( PTHREAD\_CANCEL\_DISABLE, old\_state );
1503         \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_setcancelstate"}, status );
1504 \textcolor{preprocessor}{    #endif}
1505 \textcolor{preprocessor}{}\}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_aa8475a433d18b95fcfaf4543146e2607}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-elapsed@{\-\_\-\-\_\-kmp\-\_\-elapsed}}
\index{\-\_\-\-\_\-kmp\-\_\-elapsed@{\-\_\-\-\_\-kmp\-\_\-elapsed}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-elapsed}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-elapsed (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{t}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_aa8475a433d18b95fcfaf4543146e2607}


Definition at line 2189 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
2190 \{
2191     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
2192 \textcolor{preprocessor}{# ifdef FIX\_SGI\_CLOCK}
2193 \textcolor{preprocessor}{}    \textcolor{keyword}{struct }timespec ts;
2194 
2195     status = clock\_gettime( CLOCK\_PROCESS\_CPUTIME\_ID, &ts );
2196     \hyperlink{kmp__i18n_8h_a8c4d6cebf68c7b886a511c86aeef0439}{KMP\_CHECK\_SYSFAIL\_ERRNO}( \textcolor{stringliteral}{"clock\_gettime"}, status );
2197     *t = (double) ts.tv\_nsec * (1.0 / (\textcolor{keywordtype}{double}) \hyperlink{kmp_8h_ac64cdddad1dbb1452f49fa91f5b10931}{KMP\_NSEC\_PER\_SEC}) +
2198         (\textcolor{keywordtype}{double}) ts.tv\_sec;
2199 \textcolor{preprocessor}{# else}
2200 \textcolor{preprocessor}{}    \textcolor{keyword}{struct }timeval tv;
2201 
2202     status = gettimeofday( & tv, NULL );
2203     \hyperlink{kmp__i18n_8h_a8c4d6cebf68c7b886a511c86aeef0439}{KMP\_CHECK\_SYSFAIL\_ERRNO}( \textcolor{stringliteral}{"gettimeofday"}, status );
2204     *t = (double) tv.tv\_usec * (1.0 / (\textcolor{keywordtype}{double}) \hyperlink{kmp_8h_a40f99d6651eb66ec8c969f08d8e4c770}{KMP\_USEC\_PER\_SEC}) +
2205         (\textcolor{keywordtype}{double}) tv.tv\_sec;
2206 \textcolor{preprocessor}{# endif}
2207 \textcolor{preprocessor}{}\}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_ae03839bc0108d7b046aeab29b3700fe0}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-elapsed\-\_\-tick@{\-\_\-\-\_\-kmp\-\_\-elapsed\-\_\-tick}}
\index{\-\_\-\-\_\-kmp\-\_\-elapsed\-\_\-tick@{\-\_\-\-\_\-kmp\-\_\-elapsed\-\_\-tick}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-elapsed\-\_\-tick}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-elapsed\-\_\-tick (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{t}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_ae03839bc0108d7b046aeab29b3700fe0}


Definition at line 2211 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
2212 \{
2213     *t = 1 / (double) CLOCKS\_PER\_SEC;
2214 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a2e5848b9f3322bf665ddc53ac090b69b}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-enable@{\-\_\-\-\_\-kmp\-\_\-enable}}
\index{\-\_\-\-\_\-kmp\-\_\-enable@{\-\_\-\-\_\-kmp\-\_\-enable}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-enable}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-enable (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{new\-\_\-state}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a2e5848b9f3322bf665ddc53ac090b69b}


Definition at line 1487 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1488 \{
1489 \textcolor{preprocessor}{    #ifdef KMP\_CANCEL\_THREADS}
1490 \textcolor{preprocessor}{}        \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status}, old\_state;
1491         status = pthread\_setcancelstate( new\_state, & old\_state );
1492         \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_setcancelstate"}, status );
1493         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( old\_state == PTHREAD\_CANCEL\_DISABLE );
1494 \textcolor{preprocessor}{    #endif}
1495 \textcolor{preprocessor}{}\}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_af0505501baee87e21f7dbb2993891051}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-exit\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-exit\-\_\-thread}}
\index{\-\_\-\-\_\-kmp\-\_\-exit\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-exit\-\_\-thread}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-exit\-\_\-thread}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-exit\-\_\-thread (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{exit\-\_\-status}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_af0505501baee87e21f7dbb2993891051}


Definition at line 1237 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1239   \{
1240     pthread\_exit( (\textcolor{keywordtype}{void} *)(intptr\_t) exit\_status );
1241 \} \textcolor{comment}{// \_\_kmp\_exit\_thread}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_ae39a99b218d0a4540b2023f49ad38b7a}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-get\-\_\-xproc@{\-\_\-\-\_\-kmp\-\_\-get\-\_\-xproc}}
\index{\-\_\-\-\_\-kmp\-\_\-get\-\_\-xproc@{\-\_\-\-\_\-kmp\-\_\-get\-\_\-xproc}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-get\-\_\-xproc}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf int} \-\_\-\-\_\-kmp\-\_\-get\-\_\-xproc (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Linux__util_8c_ae39a99b218d0a4540b2023f49ad38b7a}


Definition at line 2025 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize().


\begin{DoxyCode}
2025                         \{
2026 
2027     \textcolor{keywordtype}{int} r = 0;
2028 
2029 \textcolor{preprocessor}{    #if KMP\_OS\_LINUX || KMP\_OS\_FREEBSD || KMP\_OS\_NETBSD}
2030 \textcolor{preprocessor}{}
2031         r = sysconf( \_SC\_NPROCESSORS\_ONLN );
2032 
2033 \textcolor{preprocessor}{    #elif KMP\_OS\_DARWIN}
2034 \textcolor{preprocessor}{}
2035         \textcolor{comment}{// Bug C77011 High "OpenMP Threads and number of active cores".}
2036 
2037         \textcolor{comment}{// Find the number of available CPUs.}
2038         kern\_return\_t          rc;
2039         host\_basic\_info\_data\_t info;
2040         mach\_msg\_type\_number\_t num = HOST\_BASIC\_INFO\_COUNT;
2041         rc = host\_info( mach\_host\_self(), HOST\_BASIC\_INFO, (host\_info\_t) & info, & num );
2042         \textcolor{keywordflow}{if} ( rc == 0 && num == HOST\_BASIC\_INFO\_COUNT ) \{
2043             \textcolor{comment}{// Cannot use KA\_TRACE() here because this code works before trace support is}
2044             \textcolor{comment}{// initialized.}
2045             r = info.avail\_cpus;
2046         \} \textcolor{keywordflow}{else} \{
2047             \hyperlink{kmp__i18n_8h_a5aeb48e92a07c52661a33ec3fcee938f}{KMP\_WARNING}( CantGetNumAvailCPU );
2048             \hyperlink{kmp__i18n_8h_a2147780dd5e68f541b11db421fe79e4c}{KMP\_INFORM}( AssumedNumCPU );
2049         \}; \textcolor{comment}{// if}
2050 
2051 \textcolor{preprocessor}{    #else}
2052 \textcolor{preprocessor}{}
2053 \textcolor{preprocessor}{        #error "Unknown or unsupported OS."}
2054 \textcolor{preprocessor}{}
2055 \textcolor{preprocessor}{    #endif}
2056 \textcolor{preprocessor}{}
2057     \textcolor{keywordflow}{return} r > 0 ? r : 2; \textcolor{comment}{/* guess value of 2 if OS told us 0 */}
2058 
2059 \} \textcolor{comment}{// \_\_kmp\_get\_xproc}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a81e40765e4057689a8d5fa27b62ed76e}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-get\-\_\-specific@{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-get\-\_\-specific}}
\index{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-get\-\_\-specific@{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-get\-\_\-specific}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-get\-\_\-specific}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-gtid\-\_\-get\-\_\-specific (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a81e40765e4057689a8d5fa27b62ed76e}


Definition at line 1909 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1910 \{
1911     \textcolor{keywordtype}{int} gtid;
1912     \textcolor{keywordflow}{if} ( !\hyperlink{z__Linux__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime} ) \{
1913         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 50, (\textcolor{stringliteral}{"\_\_kmp\_get\_specific: runtime shutdown, returning KMP\_GTID\_SHUTDOWN\(\backslash\)n"} ) );
1914         \textcolor{keywordflow}{return} \hyperlink{kmp_8h_a4f2fd385fbacda6b6de0ce54eb2dd028}{KMP\_GTID\_SHUTDOWN};
1915     \}
1916     gtid = (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int})(\textcolor{keywordtype}{size\_t})pthread\_getspecific( \hyperlink{kmp_8h_aae367e473107cb756f7f123b70d62efd}{\_\_kmp\_gtid\_threadprivate\_key} );
1917     \textcolor{keywordflow}{if} ( gtid == 0 ) \{
1918         gtid = \hyperlink{kmp_8h_afa6317d5d5bf13b0e47e5b8d2a04043d}{KMP\_GTID\_DNE};
1919     \}
1920     \textcolor{keywordflow}{else} \{
1921         gtid--;
1922     \}
1923     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 50, (\textcolor{stringliteral}{"\_\_kmp\_gtid\_get\_specific: key:%d gtid:%d\(\backslash\)n"},
1924                \hyperlink{kmp_8h_aae367e473107cb756f7f123b70d62efd}{\_\_kmp\_gtid\_threadprivate\_key}, gtid ));
1925     \textcolor{keywordflow}{return} gtid;
1926 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_ae3492f3ab3c30ed2c204dc10e93c8471}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-set\-\_\-specific@{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-set\-\_\-specific}}
\index{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-set\-\_\-specific@{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-set\-\_\-specific}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-gtid\-\_\-set\-\_\-specific}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-gtid\-\_\-set\-\_\-specific (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{gtid}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_ae3492f3ab3c30ed2c204dc10e93c8471}


Definition at line 1900 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor(), and \-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker().


\begin{DoxyCode}
1901 \{
1902     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1903     \hyperlink{kmp__debug_8h_a5323a368e8ba273b17c46906dd9ec78c}{KMP\_ASSERT}( \hyperlink{z__Linux__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime} );
1904     status = pthread\_setspecific( \hyperlink{kmp_8h_aae367e473107cb756f7f123b70d62efd}{\_\_kmp\_gtid\_threadprivate\_key}, (\textcolor{keywordtype}{void}*)(
      intptr\_t)(gtid+1) );
1905     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_setspecific"}, status );
1906 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a8b9eeb09f657cfedf1710611f8f778e6}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-invoke\-\_\-microtask@{\-\_\-\-\_\-kmp\-\_\-invoke\-\_\-microtask}}
\index{\-\_\-\-\_\-kmp\-\_\-invoke\-\_\-microtask@{\-\_\-\-\_\-kmp\-\_\-invoke\-\_\-microtask}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-invoke\-\_\-microtask}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-invoke\-\_\-microtask (
\begin{DoxyParamCaption}
\item[{{\bf microtask\-\_\-t}}]{pkfn, }
\item[{{\bf int}}]{gtid, }
\item[{{\bf int}}]{tid, }
\item[{{\bf int}}]{argc, }
\item[{{\bf void} $\ast$}]{p\-\_\-argv\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a8b9eeb09f657cfedf1710611f8f778e6}


Definition at line 2567 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-fork\-\_\-call(), and \-\_\-\-\_\-kmp\-\_\-invoke\-\_\-task\-\_\-func().


\begin{DoxyCode}
2574 \{
2575 \textcolor{preprocessor}{#if OMPT\_SUPPORT}
2576 \textcolor{preprocessor}{}  *exit\_frame\_ptr = \_\_builtin\_frame\_address(0);
2577 \textcolor{preprocessor}{#endif}
2578 \textcolor{preprocessor}{}
2579   \textcolor{keywordflow}{switch} (argc) \{
2580   \textcolor{keywordflow}{default}:
2581     fprintf(stderr, \textcolor{stringliteral}{"Too many args to microtask: %d!\(\backslash\)n"}, argc);
2582     fflush(stderr);
2583     exit(-1);
2584   \textcolor{keywordflow}{case} 0:
2585     (*pkfn)(&gtid, &tid);
2586     \textcolor{keywordflow}{break};
2587   \textcolor{keywordflow}{case} 1:
2588     (*pkfn)(&gtid, &tid, p\_argv[0]);
2589     \textcolor{keywordflow}{break};
2590   \textcolor{keywordflow}{case} 2:
2591     (*pkfn)(&gtid, &tid, p\_argv[0], p\_argv[1]);
2592     \textcolor{keywordflow}{break};
2593   \textcolor{keywordflow}{case} 3:
2594     (*pkfn)(&gtid, &tid, p\_argv[0], p\_argv[1], p\_argv[2]);
2595     \textcolor{keywordflow}{break};
2596   \textcolor{keywordflow}{case} 4:
2597     (*pkfn)(&gtid, &tid, p\_argv[0], p\_argv[1], p\_argv[2], p\_argv[3]);
2598     \textcolor{keywordflow}{break};
2599   \textcolor{keywordflow}{case} 5:
2600     (*pkfn)(&gtid, &tid, p\_argv[0], p\_argv[1], p\_argv[2], p\_argv[3], p\_argv[4]);
2601     \textcolor{keywordflow}{break};
2602   \textcolor{keywordflow}{case} 6:
2603     (*pkfn)(&gtid, &tid, p\_argv[0], p\_argv[1], p\_argv[2], p\_argv[3], p\_argv[4],
2604             p\_argv[5]);
2605     \textcolor{keywordflow}{break};
2606   \textcolor{keywordflow}{case} 7:
2607     (*pkfn)(&gtid, &tid, p\_argv[0], p\_argv[1], p\_argv[2], p\_argv[3], p\_argv[4],
2608             p\_argv[5], p\_argv[6]);
2609     \textcolor{keywordflow}{break};
2610   \textcolor{keywordflow}{case} 8:
2611     (*pkfn)(&gtid, &tid, p\_argv[0], p\_argv[1], p\_argv[2], p\_argv[3], p\_argv[4],
2612             p\_argv[5], p\_argv[6], p\_argv[7]);
2613     \textcolor{keywordflow}{break};
2614   \textcolor{keywordflow}{case} 9:
2615     (*pkfn)(&gtid, &tid, p\_argv[0], p\_argv[1], p\_argv[2], p\_argv[3], p\_argv[4],
2616             p\_argv[5], p\_argv[6], p\_argv[7], p\_argv[8]);
2617     \textcolor{keywordflow}{break};
2618   \textcolor{keywordflow}{case} 10:
2619     (*pkfn)(&gtid, &tid, p\_argv[0], p\_argv[1], p\_argv[2], p\_argv[3], p\_argv[4],
2620             p\_argv[5], p\_argv[6], p\_argv[7], p\_argv[8], p\_argv[9]);
2621     \textcolor{keywordflow}{break};
2622   \textcolor{keywordflow}{case} 11:
2623     (*pkfn)(&gtid, &tid, p\_argv[0], p\_argv[1], p\_argv[2], p\_argv[3], p\_argv[4],
2624             p\_argv[5], p\_argv[6], p\_argv[7], p\_argv[8], p\_argv[9], p\_argv[10]);
2625     \textcolor{keywordflow}{break};
2626   \textcolor{keywordflow}{case} 12:
2627     (*pkfn)(&gtid, &tid, p\_argv[0], p\_argv[1], p\_argv[2], p\_argv[3], p\_argv[4],
2628             p\_argv[5], p\_argv[6], p\_argv[7], p\_argv[8], p\_argv[9], p\_argv[10],
2629             p\_argv[11]);
2630     \textcolor{keywordflow}{break};
2631   \textcolor{keywordflow}{case} 13:
2632     (*pkfn)(&gtid, &tid, p\_argv[0], p\_argv[1], p\_argv[2], p\_argv[3], p\_argv[4],
2633             p\_argv[5], p\_argv[6], p\_argv[7], p\_argv[8], p\_argv[9], p\_argv[10],
2634             p\_argv[11], p\_argv[12]);
2635     \textcolor{keywordflow}{break};
2636   \textcolor{keywordflow}{case} 14:
2637     (*pkfn)(&gtid, &tid, p\_argv[0], p\_argv[1], p\_argv[2], p\_argv[3], p\_argv[4],
2638             p\_argv[5], p\_argv[6], p\_argv[7], p\_argv[8], p\_argv[9], p\_argv[10],
2639             p\_argv[11], p\_argv[12], p\_argv[13]);
2640     \textcolor{keywordflow}{break};
2641   \textcolor{keywordflow}{case} 15:
2642     (*pkfn)(&gtid, &tid, p\_argv[0], p\_argv[1], p\_argv[2], p\_argv[3], p\_argv[4],
2643             p\_argv[5], p\_argv[6], p\_argv[7], p\_argv[8], p\_argv[9], p\_argv[10],
2644             p\_argv[11], p\_argv[12], p\_argv[13], p\_argv[14]);
2645     \textcolor{keywordflow}{break};
2646   \}
2647 
2648 \textcolor{preprocessor}{#if OMPT\_SUPPORT}
2649 \textcolor{preprocessor}{}  *exit\_frame\_ptr = 0;
2650 \textcolor{preprocessor}{#endif}
2651 \textcolor{preprocessor}{}
2652   \textcolor{keywordflow}{return} 1;
2653 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a5676bfae90caed2d037a605382449d2c}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-is\-\_\-address\-\_\-mapped@{\-\_\-\-\_\-kmp\-\_\-is\-\_\-address\-\_\-mapped}}
\index{\-\_\-\-\_\-kmp\-\_\-is\-\_\-address\-\_\-mapped@{\-\_\-\-\_\-kmp\-\_\-is\-\_\-address\-\_\-mapped}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-is\-\_\-address\-\_\-mapped}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-is\-\_\-address\-\_\-mapped (
\begin{DoxyParamCaption}
\item[{{\bf void} $\ast$}]{addr}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a5676bfae90caed2d037a605382449d2c}


Definition at line 2221 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
2221                                        \{
2222 
2223     \textcolor{keywordtype}{int} found = 0;
2224     \textcolor{keywordtype}{int} rc;
2225 
2226 \textcolor{preprocessor}{    #if KMP\_OS\_LINUX || KMP\_OS\_FREEBSD}
2227 \textcolor{preprocessor}{}
2228         \textcolor{comment}{/*}
2229 \textcolor{comment}{            On Linux* OS, read the /proc/<pid>/maps pseudo-file to get all the address ranges mapped}
2230 \textcolor{comment}{            into the address space.}
2231 \textcolor{comment}{        */}
2232 
2233         \textcolor{keywordtype}{char} * \hyperlink{ittnotify__static_8h_a1c34b35a4952969fef60192313bba34a}{name} = \hyperlink{kmp__str_8c_ac396f8f8ac717893794e30821c1ec12e}{\_\_kmp\_str\_format}( \textcolor{stringliteral}{"/proc/%d/maps"}, getpid() );
2234         FILE * file  = NULL;
2235 
2236         file = fopen( name, \textcolor{stringliteral}{"r"} );
2237         \hyperlink{kmp__debug_8h_a5323a368e8ba273b17c46906dd9ec78c}{KMP\_ASSERT}( file != NULL );
2238 
2239         \textcolor{keywordflow}{for} ( ; ; ) \{
2240 
2241             \textcolor{keywordtype}{void} * beginning = NULL;
2242             \textcolor{keywordtype}{void} * ending    = NULL;
2243             \textcolor{keywordtype}{char}   perms[ 5 ];
2244 
2245             rc = fscanf( file, \textcolor{stringliteral}{"%p-%p %4s %*[^\(\backslash\)n]\(\backslash\)n"}, & beginning, & ending, perms );
2246             \textcolor{keywordflow}{if} ( rc == EOF ) \{
2247                 \textcolor{keywordflow}{break};
2248             \}; \textcolor{comment}{// if}
2249             \hyperlink{kmp__debug_8h_a5323a368e8ba273b17c46906dd9ec78c}{KMP\_ASSERT}( rc == 3 && \hyperlink{kmp__safe__c__api_8h_aed00d2e557c56addc50caedca2ae595c}{KMP\_STRLEN}( perms ) == 4 ); \textcolor{comment}{// Make sure all fields
       are read.}
2250 
2251             \textcolor{comment}{// Ending address is not included in the region, but beginning is.}
2252             \textcolor{keywordflow}{if} ( ( \hyperlink{ittnotify__static_8h_a7e21c61c16fffcc27199a9d66ff39ab8}{addr} >= beginning ) && ( \hyperlink{ittnotify__static_8h_a7e21c61c16fffcc27199a9d66ff39ab8}{addr} < ending ) ) \{
2253                 perms[ 2 ] = 0;    \textcolor{comment}{// 3th and 4th character does not matter.}
2254                 \textcolor{keywordflow}{if} ( strcmp( perms, \textcolor{stringliteral}{"rw"} ) == 0 ) \{
2255                     \textcolor{comment}{// Memory we are looking for should be readable and writable.}
2256                     found = 1;
2257                 \}; \textcolor{comment}{// if}
2258                 \textcolor{keywordflow}{break};
2259             \}; \textcolor{comment}{// if}
2260 
2261         \}; \textcolor{comment}{// forever}
2262 
2263         \textcolor{comment}{// Free resources.}
2264         fclose( file );
2265         \hyperlink{kmp_8h_ac9035c424aa6f5daac89143f720e3848}{KMP\_INTERNAL\_FREE}( name );
2266 
2267 \textcolor{preprocessor}{    #elif KMP\_OS\_DARWIN}
2268 \textcolor{preprocessor}{}
2269         \textcolor{comment}{/*}
2270 \textcolor{comment}{            On OS X*, /proc pseudo filesystem is not available. Try to read memory using vm}
2271 \textcolor{comment}{            interface.}
2272 \textcolor{comment}{        */}
2273 
2274         \textcolor{keywordtype}{int}       buffer;
2275         vm\_size\_t \hyperlink{ittnotify__static_8h_a9da14338c9c3be6f21c41cf4ec79eaf1}{count};
2276         rc =
2277             vm\_read\_overwrite(
2278                 mach\_task\_self(),           \textcolor{comment}{// Task to read memory of.}
2279                 (vm\_address\_t)( \hyperlink{ittnotify__static_8h_a7e21c61c16fffcc27199a9d66ff39ab8}{addr} ),     \textcolor{comment}{// Address to read from.}
2280                 1,                          \textcolor{comment}{// Number of bytes to be read.}
2281                 (vm\_address\_t)( & buffer ), \textcolor{comment}{// Address of buffer to save read bytes in.}
2282                 & count                     \textcolor{comment}{// Address of var to save number of read bytes in.}
2283             );
2284         \textcolor{keywordflow}{if} ( rc == 0 ) \{
2285             \textcolor{comment}{// Memory successfully read.}
2286             found = 1;
2287         \}; \textcolor{comment}{// if}
2288 
2289 \textcolor{preprocessor}{    #elif KMP\_OS\_FREEBSD || KMP\_OS\_NETBSD}
2290 \textcolor{preprocessor}{}
2291         \textcolor{comment}{// FIXME(FreeBSD, NetBSD): Implement this}
2292         found = 1;
2293 
2294 \textcolor{preprocessor}{    #else}
2295 \textcolor{preprocessor}{}
2296 \textcolor{preprocessor}{        #error "Unknown or unsupported OS"}
2297 \textcolor{preprocessor}{}
2298 \textcolor{preprocessor}{    #endif}
2299 \textcolor{preprocessor}{}
2300     \textcolor{keywordflow}{return} found;
2301 
2302 \} \textcolor{comment}{// \_\_kmp\_is\_address\_mapped}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a2cd45ed219dcbe765d40f360d0d5d118}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor@{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor}}
\index{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor@{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void}$\ast$ \-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor (
\begin{DoxyParamCaption}
\item[{{\bf void} $\ast$}]{thr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Linux__util_8c_a2cd45ed219dcbe765d40f360d0d5d118}


Definition at line 759 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-create\-\_\-monitor().


\begin{DoxyCode}
760 \{
761     \textcolor{keywordtype}{int}         \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status}, old\_type, old\_state;
762 \textcolor{preprocessor}{#ifdef KMP\_BLOCK\_SIGNALS}
763 \textcolor{preprocessor}{}    sigset\_t    new\_set;
764 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_BLOCK\_SIGNALS */}\textcolor{preprocessor}{}
765 \textcolor{preprocessor}{}    \textcolor{keyword}{struct }timespec  interval;
766     \textcolor{keywordtype}{int} yield\_count;
767     \textcolor{keywordtype}{int} yield\_cycles = 0;
768 
769     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
770 
771     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_launch\_monitor: #1 launched\(\backslash\)n"} ) );
772 
773     \textcolor{comment}{/* register us as the monitor thread */}
774     \hyperlink{z__Linux__util_8c_ae3492f3ab3c30ed2c204dc10e93c8471}{\_\_kmp\_gtid\_set\_specific}( \hyperlink{kmp_8h_a5eb958603bc237a3484be5bd2b0de39a}{KMP\_GTID\_MONITOR} );
775 \textcolor{preprocessor}{#ifdef KMP\_TDATA\_GTID}
776 \textcolor{preprocessor}{}    \_\_kmp\_gtid = \hyperlink{kmp_8h_a5eb958603bc237a3484be5bd2b0de39a}{KMP\_GTID\_MONITOR};
777 \textcolor{preprocessor}{#endif}
778 \textcolor{preprocessor}{}
779     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();
780 
781 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
782 \textcolor{preprocessor}{}    \_\_kmp\_itt\_thread\_ignore();    \textcolor{comment}{// Instruct Intel(R) Threading Tools to ignore monitor thread.}
783 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
784 \textcolor{preprocessor}{}
785     \hyperlink{z__Linux__util_8c_a42d3fd592b93c484b9ce6713be9e5b3c}{\_\_kmp\_set\_stack\_info}( ((\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}*)thr)->th.th\_info.ds.ds\_gtid, (
      \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}*)thr );
786 
787     \hyperlink{kmp_8h_a21152135e5447d443b8f803bb6437639}{\_\_kmp\_check\_stack\_overlap}( (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}*)thr );
788 
789 \textcolor{preprocessor}{#ifdef KMP\_CANCEL\_THREADS}
790 \textcolor{preprocessor}{}    status = pthread\_setcanceltype( PTHREAD\_CANCEL\_ASYNCHRONOUS, & old\_type );
791     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_setcanceltype"}, status );
792     \textcolor{comment}{/* josh todo: isn't PTHREAD\_CANCEL\_ENABLE default for newly-created threads? */}
793     status = pthread\_setcancelstate( PTHREAD\_CANCEL\_ENABLE, & old\_state );
794     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_setcancelstate"}, status );
795 \textcolor{preprocessor}{#endif}
796 \textcolor{preprocessor}{}
797 \textcolor{preprocessor}{    #if KMP\_REAL\_TIME\_FIX}
798 \textcolor{preprocessor}{}    \textcolor{comment}{// This is a potential fix which allows application with real-time scheduling policy work.}
799     \textcolor{comment}{// However, decision about the fix is not made yet, so it is disabled by default.}
800     \{ \textcolor{comment}{// Are program started with real-time scheduling policy?}
801         \textcolor{keywordtype}{int} sched = sched\_getscheduler( 0 );
802         \textcolor{keywordflow}{if} ( sched == SCHED\_FIFO || sched == SCHED\_RR ) \{
803             \textcolor{comment}{// Yes, we are a part of real-time application. Try to increase the priority of the}
804             \textcolor{comment}{// monitor.}
805             \textcolor{keyword}{struct }sched\_param param;
806             \textcolor{keywordtype}{int}    max\_priority = sched\_get\_priority\_max( sched );
807             \textcolor{keywordtype}{int}    rc;
808             \hyperlink{kmp__i18n_8h_a5aeb48e92a07c52661a33ec3fcee938f}{KMP\_WARNING}( RealTimeSchedNotSupported );
809             sched\_getparam( 0, & param );
810             \textcolor{keywordflow}{if} ( param.sched\_priority < max\_priority ) \{
811                 param.sched\_priority += 1;
812                 rc = sched\_setscheduler( 0, sched, & param );
813                 \textcolor{keywordflow}{if} ( rc != 0 ) \{
814                     \textcolor{keywordtype}{int} error = errno;
815                   \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
816                       \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060af43a3e02113c5b36d94c603bad0cd807}{kmp\_ms\_warning},
817                       \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantChangeMonitorPriority ),
818                       \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( error ),
819                       \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( MonitorWillStarve ),
820                       \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
821                   );
822                 \}; \textcolor{comment}{// if}
823             \} \textcolor{keywordflow}{else} \{
824                 \textcolor{comment}{// We cannot abort here, because number of CPUs may be enough for all the threads,}
825                 \textcolor{comment}{// including the monitor thread, so application could potentially work...}
826                 \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
827                     \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060af43a3e02113c5b36d94c603bad0cd807}{kmp\_ms\_warning},
828                     \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( RunningAtMaxPriority ),
829                     \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( MonitorWillStarve ),
830                     \hyperlink{kmp__i18n_8h_ac5fe3f32cfaa3b9268776d372a0f09c4}{KMP\_HNT}( RunningAtMaxPriority ),
831                     \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
832                 );
833             \}; \textcolor{comment}{// if}
834         \}; \textcolor{comment}{// if}
835         \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_time.dt.t\_value, 0 );  \textcolor{comment}{// AC: free thread that waits for
       monitor started}
836     \}
837 \textcolor{preprocessor}{    #endif // KMP\_REAL\_TIME\_FIX}
838 \textcolor{preprocessor}{}
839     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
840 
841     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a1171057a79f5a42e26d0bd84f6cd707b}{\_\_kmp\_monitor\_wakeups} == 1 ) \{
842         interval.tv\_sec  = 1;
843         interval.tv\_nsec = 0;
844     \} \textcolor{keywordflow}{else} \{
845         interval.tv\_sec  = 0;
846         interval.tv\_nsec = (\hyperlink{kmp_8h_ac64cdddad1dbb1452f49fa91f5b10931}{KMP\_NSEC\_PER\_SEC} / 
      \hyperlink{kmp_8h_a1171057a79f5a42e26d0bd84f6cd707b}{\_\_kmp\_monitor\_wakeups});
847     \}
848 
849     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_launch\_monitor: #2 monitor\(\backslash\)n"} ) );
850 
851     \textcolor{keywordflow}{if} (\hyperlink{kmp_8h_aecb28724e6731cb1d8402a9725574cfa}{\_\_kmp\_yield\_cycle}) \{
852         \hyperlink{kmp_8h_ad41fbe82f9fadf0aaf70237d90bc6146}{\_\_kmp\_yielding\_on} = 0;  \textcolor{comment}{/* Start out with yielding shut off */}
853         yield\_count = \hyperlink{kmp_8h_a6b243e407a71238e44adac9cc5248739}{\_\_kmp\_yield\_off\_count};
854     \} \textcolor{keywordflow}{else} \{
855         \hyperlink{kmp_8h_ad41fbe82f9fadf0aaf70237d90bc6146}{\_\_kmp\_yielding\_on} = 1;  \textcolor{comment}{/* Yielding is on permanently */}
856     \}
857 
858     \textcolor{keywordflow}{while}( ! \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}( \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_done ) ) \{
859         \textcolor{keyword}{struct }timespec  now;
860         \textcolor{keyword}{struct }timeval   tval;
861 
862         \textcolor{comment}{/*  This thread monitors the state of the system */}
863 
864         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 15, ( \textcolor{stringliteral}{"\_\_kmp\_launch\_monitor: update\(\backslash\)n"} ) );
865 
866         status = gettimeofday( &tval, NULL );
867         \hyperlink{kmp__i18n_8h_a8c4d6cebf68c7b886a511c86aeef0439}{KMP\_CHECK\_SYSFAIL\_ERRNO}( \textcolor{stringliteral}{"gettimeofday"}, status );
868         TIMEVAL\_TO\_TIMESPEC( &tval, &now );
869 
870         now.tv\_sec  += interval.tv\_sec;
871         now.tv\_nsec += interval.tv\_nsec;
872 
873         \textcolor{keywordflow}{if} (now.tv\_nsec >= \hyperlink{kmp_8h_ac64cdddad1dbb1452f49fa91f5b10931}{KMP\_NSEC\_PER\_SEC}) \{
874             now.tv\_sec  += 1;
875             now.tv\_nsec -= \hyperlink{kmp_8h_ac64cdddad1dbb1452f49fa91f5b10931}{KMP\_NSEC\_PER\_SEC};
876         \}
877 
878         status = pthread\_mutex\_lock( & \hyperlink{z__Linux__util_8c_a1d77743294d51eefed86a29081e1dcfe}{\_\_kmp\_wait\_mx}.m\_mutex );
879         \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutex\_lock"}, status );
880         \textcolor{comment}{// AC: the monitor should not fall asleep if g\_done has been set}
881         \textcolor{keywordflow}{if} ( !\hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(\hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_done) ) \{  \textcolor{comment}{// check once more under mutex}
882             status = pthread\_cond\_timedwait( &\hyperlink{z__Linux__util_8c_adf8bd06136520a941aa1db9078d080d3}{\_\_kmp\_wait\_cv}.c\_cond, &
      \hyperlink{z__Linux__util_8c_a1d77743294d51eefed86a29081e1dcfe}{\_\_kmp\_wait\_mx}.m\_mutex, &now );
883             \textcolor{keywordflow}{if} ( status != 0 ) \{
884                 \textcolor{keywordflow}{if} ( status != ETIMEDOUT && status != EINTR ) \{
885                     \hyperlink{kmp__i18n_8h_aab99fba7f170866ead9c59379f73115b}{KMP\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_cond\_timedwait"}, status );
886                 \};
887             \};
888         \};
889         status = pthread\_mutex\_unlock( & \hyperlink{z__Linux__util_8c_a1d77743294d51eefed86a29081e1dcfe}{\_\_kmp\_wait\_mx}.m\_mutex );
890         \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutex\_unlock"}, status );
891 
892         \textcolor{keywordflow}{if} (\hyperlink{kmp_8h_aecb28724e6731cb1d8402a9725574cfa}{\_\_kmp\_yield\_cycle}) \{
893             yield\_cycles++;
894             \textcolor{keywordflow}{if} ( (yield\_cycles % yield\_count) == 0 ) \{
895                 \textcolor{keywordflow}{if} (\hyperlink{kmp_8h_ad41fbe82f9fadf0aaf70237d90bc6146}{\_\_kmp\_yielding\_on}) \{
896                     \hyperlink{kmp_8h_ad41fbe82f9fadf0aaf70237d90bc6146}{\_\_kmp\_yielding\_on} = 0;   \textcolor{comment}{/* Turn it off now */}
897                     yield\_count = \hyperlink{kmp_8h_a6b243e407a71238e44adac9cc5248739}{\_\_kmp\_yield\_off\_count};
898                 \} \textcolor{keywordflow}{else} \{
899                     \hyperlink{kmp_8h_ad41fbe82f9fadf0aaf70237d90bc6146}{\_\_kmp\_yielding\_on} = 1;   \textcolor{comment}{/* Turn it on now */}
900                     yield\_count = \hyperlink{kmp_8h_ab056e2418f59f84020b2e7be6378d37d}{\_\_kmp\_yield\_on\_count};
901                 \}
902                 yield\_cycles = 0;
903             \}
904         \} \textcolor{keywordflow}{else} \{
905             \hyperlink{kmp_8h_ad41fbe82f9fadf0aaf70237d90bc6146}{\_\_kmp\_yielding\_on} = 1;
906         \}
907 
908         \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}( \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_time.dt.t\_value,
909           \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}( \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_time.dt.t\_value ) + 1 );
910 
911         \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
912     \}
913 
914     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_launch\_monitor: #3 cleanup\(\backslash\)n"} ) );
915 
916 \textcolor{preprocessor}{#ifdef KMP\_BLOCK\_SIGNALS}
917 \textcolor{preprocessor}{}    status = sigfillset( & new\_set );
918     \hyperlink{kmp__i18n_8h_a8c4d6cebf68c7b886a511c86aeef0439}{KMP\_CHECK\_SYSFAIL\_ERRNO}( \textcolor{stringliteral}{"sigfillset"}, status );
919     status = pthread\_sigmask( SIG\_UNBLOCK, & new\_set, NULL );
920     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_sigmask"}, status );
921 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_BLOCK\_SIGNALS */}\textcolor{preprocessor}{}
922 \textcolor{preprocessor}{}
923     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_launch\_monitor: #4 finished\(\backslash\)n"} ) );
924 
925     \textcolor{keywordflow}{if}( \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_abort != 0 ) \{
926         \textcolor{comment}{/* now we need to terminate the worker threads  */}
927         \textcolor{comment}{/* the value of t\_abort is the signal we caught */}
928 
929         \textcolor{keywordtype}{int} gtid;
930 
931         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_launch\_monitor: #5 terminate sig=%d\(\backslash\)n"}, 
      \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_abort ) );
932 
933         \textcolor{comment}{/* terminate the OpenMP worker threads */}
934         \textcolor{comment}{/* TODO this is not valid for sibling threads!!}
935 \textcolor{comment}{         * the uber master might not be 0 anymore.. */}
936         \textcolor{keywordflow}{for} (gtid = 1; gtid < \hyperlink{kmp_8h_acae0af8cf6e8a8367b389986b372ab0a}{\_\_kmp\_threads\_capacity}; ++gtid)
937             \hyperlink{z__Linux__util_8c_a9c1e0ffcb1e7c87e5429269dc6c6c0bf}{\_\_kmp\_terminate\_thread}( gtid );
938 
939         \hyperlink{kmp_8h_afb0978e7a9bd0e5f91d089c4571e618f}{\_\_kmp\_cleanup}();
940 
941         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_launch\_monitor: #6 raise sig=%d\(\backslash\)n"}, 
      \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_abort ) );
942 
943         \textcolor{keywordflow}{if} (\hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_abort > 0)
944             \textcolor{keyword}{raise}( \hyperlink{kmp_8h_a11b71922a4df46ff9e8dbc68693e8d67}{\_\_kmp\_global}.g.g\_abort );
945 
946     \}
947 
948     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_launch\_monitor: #7 exit\(\backslash\)n"} ) );
949 
950     \textcolor{keywordflow}{return} thr;
951 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a100bbf4669165114bff15c8fd381af02}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker@{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker}}
\index{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker@{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void}$\ast$ \-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker (
\begin{DoxyParamCaption}
\item[{{\bf void} $\ast$}]{thr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Linux__util_8c_a100bbf4669165114bff15c8fd381af02}


Definition at line 680 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-create\-\_\-worker().


\begin{DoxyCode}
681 \{
682     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status}, old\_type, old\_state;
683 \textcolor{preprocessor}{#ifdef KMP\_BLOCK\_SIGNALS}
684 \textcolor{preprocessor}{}    sigset\_t    new\_set, old\_set;
685 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_BLOCK\_SIGNALS */}\textcolor{preprocessor}{}
686 \textcolor{preprocessor}{}    \textcolor{keywordtype}{void} *exit\_val;
687 \textcolor{preprocessor}{#if KMP\_OS\_LINUX || KMP\_OS\_FREEBSD || KMP\_OS\_NETBSD}
688 \textcolor{preprocessor}{}    \textcolor{keywordtype}{void} * \textcolor{keyword}{volatile} padding = 0;
689 \textcolor{preprocessor}{#endif}
690 \textcolor{preprocessor}{}    \textcolor{keywordtype}{int} gtid;
691 
692     gtid = ((\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}*)thr) -> th.th\_info.ds.ds\_gtid;
693     \hyperlink{z__Linux__util_8c_ae3492f3ab3c30ed2c204dc10e93c8471}{\_\_kmp\_gtid\_set\_specific}( gtid );
694 \textcolor{preprocessor}{#ifdef KMP\_TDATA\_GTID}
695 \textcolor{preprocessor}{}    \_\_kmp\_gtid = gtid;
696 \textcolor{preprocessor}{#endif}
697 \textcolor{preprocessor}{}\textcolor{preprocessor}{#if KMP\_STATS\_ENABLED}
698 \textcolor{preprocessor}{}    \textcolor{comment}{// set \_\_thread local index to point to thread-specific stats}
699     \hyperlink{kmp__global_8c_ae8b6bdb1368ab875fdb8322ba2de5803}{\_\_kmp\_stats\_thread\_ptr} = ((\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}*)thr)->th.th\_stats;
700 \textcolor{preprocessor}{#endif}
701 \textcolor{preprocessor}{}
702 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
703 \textcolor{preprocessor}{}    \_\_kmp\_itt\_thread\_name( gtid );
704 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
705 \textcolor{preprocessor}{}
706 \textcolor{preprocessor}{#if KMP\_AFFINITY\_SUPPORTED}
707 \textcolor{preprocessor}{}    \_\_kmp\_affinity\_set\_init\_mask( gtid, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE} );
708 \textcolor{preprocessor}{#endif}
709 \textcolor{preprocessor}{}
710 \textcolor{preprocessor}{#ifdef KMP\_CANCEL\_THREADS}
711 \textcolor{preprocessor}{}    status = pthread\_setcanceltype( PTHREAD\_CANCEL\_ASYNCHRONOUS, & old\_type );
712     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_setcanceltype"}, status );
713     \textcolor{comment}{/* josh todo: isn't PTHREAD\_CANCEL\_ENABLE default for newly-created threads? */}
714     status = pthread\_setcancelstate( PTHREAD\_CANCEL\_ENABLE, & old\_state );
715     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_setcancelstate"}, status );
716 \textcolor{preprocessor}{#endif}
717 \textcolor{preprocessor}{}
718 \textcolor{preprocessor}{#if KMP\_ARCH\_X86 || KMP\_ARCH\_X86\_64}
719 \textcolor{preprocessor}{}    \textcolor{comment}{//}
720     \textcolor{comment}{// Set the FP control regs to be a copy of}
721     \textcolor{comment}{// the parallel initialization thread's.}
722     \textcolor{comment}{//}
723     \_\_kmp\_clear\_x87\_fpu\_status\_word();
724     \_\_kmp\_load\_x87\_fpu\_control\_word( &\_\_kmp\_init\_x87\_fpu\_control\_word );
725     \_\_kmp\_load\_mxcsr( &\_\_kmp\_init\_mxcsr );
726 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_ARCH\_X86 || KMP\_ARCH\_X86\_64 */}\textcolor{preprocessor}{}
727 \textcolor{preprocessor}{}
728 \textcolor{preprocessor}{#ifdef KMP\_BLOCK\_SIGNALS}
729 \textcolor{preprocessor}{}    status = sigfillset( & new\_set );
730     \hyperlink{kmp__i18n_8h_a8c4d6cebf68c7b886a511c86aeef0439}{KMP\_CHECK\_SYSFAIL\_ERRNO}( \textcolor{stringliteral}{"sigfillset"}, status );
731     status = pthread\_sigmask( SIG\_BLOCK, & new\_set, & old\_set );
732     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_sigmask"}, status );
733 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_BLOCK\_SIGNALS */}\textcolor{preprocessor}{}
734 \textcolor{preprocessor}{}
735 \textcolor{preprocessor}{#if KMP\_OS\_LINUX || KMP\_OS\_FREEBSD || KMP\_OS\_NETBSD}
736 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ac841e4743aeceae5d3667bc8511ba1c4}{\_\_kmp\_stkoffset} > 0 && gtid > 0 ) \{
737         padding = KMP\_oALLOCA( gtid * \hyperlink{kmp_8h_ac841e4743aeceae5d3667bc8511ba1c4}{\_\_kmp\_stkoffset} );
738     \}
739 \textcolor{preprocessor}{#endif}
740 \textcolor{preprocessor}{}
741     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();
742     \hyperlink{z__Linux__util_8c_a42d3fd592b93c484b9ce6713be9e5b3c}{\_\_kmp\_set\_stack\_info}( gtid, (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}*)thr );
743 
744     \hyperlink{kmp_8h_a21152135e5447d443b8f803bb6437639}{\_\_kmp\_check\_stack\_overlap}( (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}*)thr );
745 
746     exit\_val = \hyperlink{kmp_8h_ac88c1daa6b7e9e9b51a3a1510dca73ca}{\_\_kmp\_launch\_thread}( (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *) thr );
747 
748 \textcolor{preprocessor}{#ifdef KMP\_BLOCK\_SIGNALS}
749 \textcolor{preprocessor}{}    status = pthread\_sigmask( SIG\_SETMASK, & old\_set, NULL );
750     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_sigmask"}, status );
751 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_BLOCK\_SIGNALS */}\textcolor{preprocessor}{}
752 \textcolor{preprocessor}{}
753     \textcolor{keywordflow}{return} exit\_val;
754 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a59bfe9c94177c19907c3f28bf3daf4a3}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-read\-\_\-cpu\-\_\-time@{\-\_\-\-\_\-kmp\-\_\-read\-\_\-cpu\-\_\-time}}
\index{\-\_\-\-\_\-kmp\-\_\-read\-\_\-cpu\-\_\-time@{\-\_\-\-\_\-kmp\-\_\-read\-\_\-cpu\-\_\-time}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-read\-\_\-cpu\-\_\-time}]{\setlength{\rightskip}{0pt plus 5cm}double \-\_\-\-\_\-kmp\-\_\-read\-\_\-cpu\-\_\-time (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a59bfe9c94177c19907c3f28bf3daf4a3}


Definition at line 1932 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1933 \{
1934     \textcolor{comment}{/*clock\_t   t;*/}
1935     \textcolor{keyword}{struct }tms  buffer;
1936 
1937     \textcolor{comment}{/*t =*/}  times( & buffer );
1938 
1939     \textcolor{keywordflow}{return} (buffer.tms\_utime + buffer.tms\_cutime) / (double) CLOCKS\_PER\_SEC;
1940 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_aa3abcb7ce4b58402699ab90f721e0578}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-read\-\_\-from\-\_\-file@{\-\_\-\-\_\-kmp\-\_\-read\-\_\-from\-\_\-file}}
\index{\-\_\-\-\_\-kmp\-\_\-read\-\_\-from\-\_\-file@{\-\_\-\-\_\-kmp\-\_\-read\-\_\-from\-\_\-file}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-read\-\_\-from\-\_\-file}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-read\-\_\-from\-\_\-file (
\begin{DoxyParamCaption}
\item[{char const $\ast$}]{path, }
\item[{char const $\ast$}]{format, }
\item[{}]{...}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_aa3abcb7ce4b58402699ab90f721e0578}


Definition at line 2062 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
2063 \{
2064     \textcolor{keywordtype}{int} result;
2065     va\_list \hyperlink{kmp__str_8c_acd08a6295eccfeb30c79985f047e4be5}{args};
2066 
2067     va\_start(args, format);
2068     FILE *f = fopen(path, \textcolor{stringliteral}{"rb"});
2069     \textcolor{keywordflow}{if} ( f == NULL )
2070         \textcolor{keywordflow}{return} 0;
2071     result = vfscanf(f, format, args);
2072     fclose(f);
2073 
2074     \textcolor{keywordflow}{return} result;
2075 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_ab8f6d039c9b836fa9a1ec3b3987817a7}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-info@{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-info}}
\index{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-info@{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-info}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-info}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-info (
\begin{DoxyParamCaption}
\item[{struct {\bf kmp\-\_\-sys\-\_\-info} $\ast$}]{info}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_ab8f6d039c9b836fa9a1ec3b3987817a7}


Definition at line 1943 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1944 \{
1945     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1946     \textcolor{keyword}{struct }rusage r\_usage;
1947 
1948     memset( info, 0, \textcolor{keyword}{sizeof}( *info ) );
1949 
1950     status = getrusage( RUSAGE\_SELF, &r\_usage);
1951     \hyperlink{kmp__i18n_8h_a8c4d6cebf68c7b886a511c86aeef0439}{KMP\_CHECK\_SYSFAIL\_ERRNO}( \textcolor{stringliteral}{"getrusage"}, status );
1952 
1953     info->\hyperlink{structkmp__sys__info_af2816624ab3d81d5955b91761aa533fa}{maxrss}  = r\_usage.ru\_maxrss;  \textcolor{comment}{/* the maximum resident set size utilized (in kilobytes)     
      */}
1954     info->\hyperlink{structkmp__sys__info_a02a36302bc462405fae7b4d7309a7370}{minflt}  = r\_usage.ru\_minflt;  \textcolor{comment}{/* the number of page faults serviced without any I/O        
      */}
1955     info->\hyperlink{structkmp__sys__info_a2831ec7e3cd6546b2e04cfc9afe2c2cf}{majflt}  = r\_usage.ru\_majflt;  \textcolor{comment}{/* the number of page faults serviced that required I/O      
      */}
1956     info->\hyperlink{structkmp__sys__info_aba9c0c66063cc7bdba0b84d87f90b25b}{nswap}   = r\_usage.ru\_nswap;   \textcolor{comment}{/* the number of times a process was "swapped" out of memory 
      */}
1957     info->\hyperlink{structkmp__sys__info_a0ce85c6a66e6805ed1a8948e7f19d79f}{inblock} = r\_usage.ru\_inblock; \textcolor{comment}{/* the number of times the file system had to perform input 
       */}
1958     info->\hyperlink{structkmp__sys__info_ab55bb38f87dbda622851940106f8a1c0}{oublock} = r\_usage.ru\_oublock; \textcolor{comment}{/* the number of times the file system had to perform output
       */}
1959     info->\hyperlink{structkmp__sys__info_a82b3d7c37a16144f173a69624ef27057}{nvcsw}   = r\_usage.ru\_nvcsw;   \textcolor{comment}{/* the number of times a context switch was voluntarily      
      */}
1960     info->\hyperlink{structkmp__sys__info_ac7e30691b19415226d39bd4ed92af7a6}{nivcsw}  = r\_usage.ru\_nivcsw;  \textcolor{comment}{/* the number of times a context switch was forced           
      */}
1961 
1962     \textcolor{keywordflow}{return} (status != 0);
1963 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a1f49d8ebe9ab3485ce41c35d80d202d5}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time@{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time}}
\index{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time@{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{delta}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a1f49d8ebe9ab3485ce41c35d80d202d5}


Definition at line 1969 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1970 \{
1971     \textcolor{keywordtype}{double}              t\_ns;
1972     \textcolor{keyword}{struct }timeval      tval;
1973     \textcolor{keyword}{struct }timespec     \hyperlink{extractExternal_8cpp_aaabd632593ae454ee6ac33cc02d1d215}{stop};
1974     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1975 
1976     status = gettimeofday( &tval, NULL );
1977     \hyperlink{kmp__i18n_8h_a8c4d6cebf68c7b886a511c86aeef0439}{KMP\_CHECK\_SYSFAIL\_ERRNO}( \textcolor{stringliteral}{"gettimeofday"}, status );
1978     TIMEVAL\_TO\_TIMESPEC( &tval, &\hyperlink{extractExternal_8cpp_aaabd632593ae454ee6ac33cc02d1d215}{stop} );
1979     t\_ns = \hyperlink{z__Linux__util_8c_a4ca908ff7f720a3a00baf177b457f408}{TS2NS}(\hyperlink{extractExternal_8cpp_aaabd632593ae454ee6ac33cc02d1d215}{stop}) - \hyperlink{z__Linux__util_8c_a4ca908ff7f720a3a00baf177b457f408}{TS2NS}(\hyperlink{z__Linux__util_8c_a896323e702eca2ab9e9cadd0babccb6c}{\_\_kmp\_sys\_timer\_data}.
      \hyperlink{structkmp__sys__timer_ae9f66812fe3c116738ebc985ab6f66f2}{start});
1980     *delta = (t\_ns * 1e-9);
1981 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a6f1cbadac27343041f6bb97e0ab76c69}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor@{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor}}
\index{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor@{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a6f1cbadac27343041f6bb97e0ab76c69}


Definition at line 1246 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1247 \{
1248     \textcolor{keywordtype}{int}          \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1249     \textcolor{keywordtype}{void}        *exit\_val;
1250 
1251     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_reap\_monitor: try to reap monitor thread with handle %#.8lx\(\backslash\)n"},
1252                    th->th.th\_info.ds.ds\_thread ) );
1253 
1254     \textcolor{comment}{// If monitor has been created, its tid and gtid should be KMP\_GTID\_MONITOR.}
1255     \textcolor{comment}{// If both tid and gtid are 0, it means the monitor did not ever start.}
1256     \textcolor{comment}{// If both tid and gtid are KMP\_GTID\_DNE, the monitor has been shut down.}
1257     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( th->th.th\_info.ds.ds\_tid == th->th.th\_info.ds.ds\_gtid );
1258     \textcolor{keywordflow}{if} ( th->th.th\_info.ds.ds\_gtid != \hyperlink{kmp_8h_a5eb958603bc237a3484be5bd2b0de39a}{KMP\_GTID\_MONITOR} ) \{
1259         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_reap\_monitor: monitor did not start, returning\(\backslash\)n"}) );
1260         \textcolor{keywordflow}{return};
1261     \}; \textcolor{comment}{// if}
1262 
1263     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1264 
1265 
1266     \textcolor{comment}{/* First, check to see whether the monitor thread exists.  This could prevent a hang,}
1267 \textcolor{comment}{       but if the monitor dies after the pthread\_kill call and before the pthread\_join}
1268 \textcolor{comment}{       call, it will still hang. */}
1269 
1270     status = pthread\_kill( th->th.th\_info.ds.ds\_thread, 0 );
1271     \textcolor{keywordflow}{if} (status == ESRCH) \{
1272 
1273         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_reap\_monitor: monitor does not exist, returning\(\backslash\)n"}) );
1274 
1275     \} \textcolor{keywordflow}{else}
1276     \{
1277         \hyperlink{z__Linux__util_8c_a768ed47b2f9c76cee082b8c7781e7ac9}{\_\_kmp\_resume\_monitor}();   \textcolor{comment}{// Wake up the monitor thread}
1278         status = pthread\_join( th->th.th\_info.ds.ds\_thread, & exit\_val);
1279         \textcolor{keywordflow}{if} (exit\_val != th) \{
1280             \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
1281                 \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
1282                 \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( ReapMonitorError ),
1283                 \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ),
1284                 \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
1285             );
1286         \}
1287     \}
1288 
1289     th->th.th\_info.ds.ds\_tid  = \hyperlink{kmp_8h_afa6317d5d5bf13b0e47e5b8d2a04043d}{KMP\_GTID\_DNE};
1290     th->th.th\_info.ds.ds\_gtid = \hyperlink{kmp_8h_afa6317d5d5bf13b0e47e5b8d2a04043d}{KMP\_GTID\_DNE};
1291 
1292     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_reap\_monitor: done reaping monitor thread with handle %#.8lx\(\backslash\)n"},
1293                    th->th.th\_info.ds.ds\_thread ) );
1294 
1295     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1296 
1297 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_af9e43e476cd1e6220df32409d2025761}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-reap\-\_\-worker@{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-worker}}
\index{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-worker@{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-worker}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-reap\-\_\-worker}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-reap\-\_\-worker (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_af9e43e476cd1e6220df32409d2025761}


Definition at line 1300 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1301 \{
1302     \textcolor{keywordtype}{int}          \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1303     \textcolor{keywordtype}{void}        *exit\_val;
1304 
1305     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1306 
1307     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_reap\_worker: try to reap T#%d\(\backslash\)n"}, th->th.th\_info.ds.ds\_gtid ) );
1308 
1309     \textcolor{comment}{/* First, check to see whether the worker thread exists.  This could prevent a hang,}
1310 \textcolor{comment}{       but if the worker dies after the pthread\_kill call and before the pthread\_join}
1311 \textcolor{comment}{       call, it will still hang. */}
1312 
1313     status = pthread\_kill( th->th.th\_info.ds.ds\_thread, 0 );
1314     \textcolor{keywordflow}{if} (status == ESRCH) \{
1315         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_reap\_worker: worker T#%d does not exist, returning\(\backslash\)n"}, th->th.th\_info
      .ds.ds\_gtid ) );
1316     \}
1317     \textcolor{keywordflow}{else} \{
1318         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_reap\_worker: try to join with worker T#%d\(\backslash\)n"}, th->th.th\_info.ds.
      ds\_gtid ) );
1319         status = pthread\_join( th->th.th\_info.ds.ds\_thread, & exit\_val);
1320 \textcolor{preprocessor}{#ifdef KMP\_DEBUG}
1321 \textcolor{preprocessor}{}        \textcolor{comment}{/* Don't expose these to the user until we understand when they trigger */}
1322         \textcolor{keywordflow}{if} ( status != 0 ) \{
1323             \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(\hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal}, \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( ReapWorkerError ), 
      \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ), \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null});
1324         \}
1325         \textcolor{keywordflow}{if} ( exit\_val != th ) \{
1326             \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_reap\_worker: worker T#%d did not reap properly, exit\_val = %p\(\backslash\)n"}
      ,
1327                             th->th.th\_info.ds.ds\_gtid, exit\_val ) );
1328         \}
1329 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_DEBUG */}\textcolor{preprocessor}{}
1330 \textcolor{preprocessor}{}    \}
1331 
1332     \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_reap\_worker: done reaping T#%d\(\backslash\)n"}, th->th.th\_info.ds.ds\_gtid ) );
1333 
1334     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();       \textcolor{comment}{/* Flush all pending memory write invalidates.  */}
1335 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_af7249dd2326a4f4c91810e8e6d7b9544}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-register\-\_\-atfork@{\-\_\-\-\_\-kmp\-\_\-register\-\_\-atfork}}
\index{\-\_\-\-\_\-kmp\-\_\-register\-\_\-atfork@{\-\_\-\-\_\-kmp\-\_\-register\-\_\-atfork}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-register\-\_\-atfork}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-register\-\_\-atfork (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_af7249dd2326a4f4c91810e8e6d7b9544}


Definition at line 1591 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-do\-\_\-serial\-\_\-initialize().


\begin{DoxyCode}
1591                             \{
1592     \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_a926160e3034cba452f28f9af6c365348}{\_\_kmp\_need\_register\_atfork} ) \{
1593         \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status} = pthread\_atfork( \hyperlink{z__Linux__util_8c_aa0c58b40828c203c6475cfe8f08044f9}{\_\_kmp\_atfork\_prepare}, 
      \hyperlink{z__Linux__util_8c_a4929ca46709bff076801c264583922f0}{\_\_kmp\_atfork\_parent}, \hyperlink{z__Linux__util_8c_a1192a4bee643eadefdcfc41e984cad42}{\_\_kmp\_atfork\_child} );
1594         \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_atfork"}, status );
1595         \hyperlink{kmp_8h_a926160e3034cba452f28f9af6c365348}{\_\_kmp\_need\_register\_atfork} = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1596     \}
1597 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_acfe9e02a35d4e38951a53bd689ca2141}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-resume\-\_\-32@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-32}}
\index{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-32@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-32}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-32}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-resume\-\_\-32 (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{target\-\_\-gtid, }
\item[{{\bf kmp\-\_\-flag\-\_\-32} $\ast$}]{flag}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_acfe9e02a35d4e38951a53bd689ca2141}


Definition at line 1848 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1848                                                          \{
1849     \hyperlink{z__Linux__util_8c_ab156558ea905954294188d1395cb2848}{\_\_kmp\_resume\_template}(target\_gtid, flag);
1850 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a6d3052650a7678516a888600044b6d63}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-resume\-\_\-64@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-64}}
\index{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-64@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-64}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-64}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-resume\-\_\-64 (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{target\-\_\-gtid, }
\item[{{\bf kmp\-\_\-flag\-\_\-64} $\ast$}]{flag}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a6d3052650a7678516a888600044b6d63}


Definition at line 1851 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1851                                                          \{
1852     \hyperlink{z__Linux__util_8c_ab156558ea905954294188d1395cb2848}{\_\_kmp\_resume\_template}(target\_gtid, flag);
1853 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a768ed47b2f9c76cee082b8c7781e7ac9}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-resume\-\_\-monitor@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-monitor}}
\index{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-monitor@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-monitor}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-monitor}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-resume\-\_\-monitor (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a768ed47b2f9c76cee082b8c7781e7ac9}


Definition at line 1859 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-reap\-\_\-monitor().


\begin{DoxyCode}
1860 \{
1861     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1862 \textcolor{preprocessor}{#ifdef KMP\_DEBUG}
1863 \textcolor{preprocessor}{}    \textcolor{keywordtype}{int} gtid = \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(\hyperlink{kmp_8h_a3f91f5b94048484e40c6caeb66c60f27}{\_\_kmp\_init\_gtid}) ? \hyperlink{kmp_8h_ad9b4e1a8a911f57a29a75f7536e5200c}{\_\_kmp\_get\_gtid}() : -1;
1864     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 30, ( \textcolor{stringliteral}{"\_\_kmp\_resume\_monitor: T#%d wants to wakeup T#%d enter\(\backslash\)n"},
1865                     gtid, \hyperlink{kmp_8h_a5eb958603bc237a3484be5bd2b0de39a}{KMP\_GTID\_MONITOR} ) );
1866     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( gtid != \hyperlink{kmp_8h_a5eb958603bc237a3484be5bd2b0de39a}{KMP\_GTID\_MONITOR} );
1867 \textcolor{preprocessor}{#endif}
1868 \textcolor{preprocessor}{}    status = pthread\_mutex\_lock( &\hyperlink{z__Linux__util_8c_a1d77743294d51eefed86a29081e1dcfe}{\_\_kmp\_wait\_mx}.m\_mutex );
1869     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutex\_lock"}, status );
1870 \textcolor{preprocessor}{#ifdef DEBUG\_SUSPEND}
1871 \textcolor{preprocessor}{}    \{
1872         \textcolor{keywordtype}{char} buffer[128];
1873         \_\_kmp\_print\_cond( buffer, &\hyperlink{z__Linux__util_8c_adf8bd06136520a941aa1db9078d080d3}{\_\_kmp\_wait\_cv}.c\_cond );
1874         \hyperlink{kmp__io_8c_ac0b96ed999ee9819c544e6f24057da91}{\_\_kmp\_printf}( \textcolor{stringliteral}{"\_\_kmp\_resume\_monitor: T#%d resuming T#%d: %s\(\backslash\)n"}, gtid, 
      \hyperlink{kmp_8h_a5eb958603bc237a3484be5bd2b0de39a}{KMP\_GTID\_MONITOR}, buffer );
1875     \}
1876 \textcolor{preprocessor}{#endif}
1877 \textcolor{preprocessor}{}    status = pthread\_cond\_signal( &\hyperlink{z__Linux__util_8c_adf8bd06136520a941aa1db9078d080d3}{\_\_kmp\_wait\_cv}.c\_cond );
1878     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_cond\_signal"}, status );
1879     status = pthread\_mutex\_unlock( &\hyperlink{z__Linux__util_8c_a1d77743294d51eefed86a29081e1dcfe}{\_\_kmp\_wait\_mx}.m\_mutex );
1880     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutex\_unlock"}, status );
1881     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 30, ( \textcolor{stringliteral}{"\_\_kmp\_resume\_monitor: T#%d exiting after signaling wake up for T#%d\(\backslash\)n"},
1882                     gtid, \hyperlink{kmp_8h_a5eb958603bc237a3484be5bd2b0de39a}{KMP\_GTID\_MONITOR} ) );
1883 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_ace5ec17d5fee86980dead25d07a595d9}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore}}
\index{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{target\-\_\-gtid, }
\item[{{\bf kmp\-\_\-flag\-\_\-oncore} $\ast$}]{flag}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_ace5ec17d5fee86980dead25d07a595d9}


Definition at line 1854 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1854                                                                  \{
1855     \hyperlink{z__Linux__util_8c_ab156558ea905954294188d1395cb2848}{\_\_kmp\_resume\_template}(target\_gtid, flag);
1856 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_ab156558ea905954294188d1395cb2848}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-resume\-\_\-template@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-template}}
\index{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-template@{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-template}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-resume\-\_\-template}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class C $>$ static {\bf void} \-\_\-\-\_\-kmp\-\_\-resume\-\_\-template (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{target\-\_\-gtid, }
\item[{C $\ast$}]{flag}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{z__Linux__util_8c_ab156558ea905954294188d1395cb2848}


Definition at line 1785 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-resume\-\_\-32(), \-\_\-\-\_\-kmp\-\_\-resume\-\_\-64(), and \-\_\-\-\_\-kmp\-\_\-resume\-\_\-oncore().


\begin{DoxyCode}
1786 \{
1787     \hyperlink{kmp__stats_8h_a340afca3214165ed1920481f0e8fa67c}{KMP\_TIME\_DEVELOPER\_BLOCK}(USER\_resume);
1788     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *th = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[target\_gtid];
1789     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1790 
1791 \textcolor{preprocessor}{#ifdef KMP\_DEBUG}
1792 \textcolor{preprocessor}{}    \textcolor{keywordtype}{int} gtid = \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(\hyperlink{kmp_8h_a3f91f5b94048484e40c6caeb66c60f27}{\_\_kmp\_init\_gtid}) ? \hyperlink{kmp_8h_ad9b4e1a8a911f57a29a75f7536e5200c}{\_\_kmp\_get\_gtid}() : -1;
1793 \textcolor{preprocessor}{#endif}
1794 \textcolor{preprocessor}{}
1795     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 30, ( \textcolor{stringliteral}{"\_\_kmp\_resume\_template: T#%d wants to wakeup T#%d enter\(\backslash\)n"}, gtid, target\_gtid )
       );
1796     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( gtid != target\_gtid );
1797 
1798     \hyperlink{z__Linux__util_8c_a3cbd436ba7abef35400b2939a597025e}{\_\_kmp\_suspend\_initialize\_thread}( th );
1799 
1800     status = pthread\_mutex\_lock( &th->th.th\_suspend\_mx.m\_mutex );
1801     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutex\_lock"}, status );
1802 
1803     \textcolor{keywordflow}{if} (!flag) \{ \textcolor{comment}{// coming from \_\_kmp\_null\_resume\_wrapper}
1804         flag = (C *)th->th.th\_sleep\_loc;
1805     \}
1806 
1807     \textcolor{comment}{// First, check if the flag is null or its type has changed. If so, someone else woke it up.}
1808     \textcolor{keywordflow}{if} (!flag || flag->get\_type() != flag->get\_ptr\_type()) \{ \textcolor{comment}{// get\_ptr\_type simply shows what flag was
       cast to}
1809         \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 5, ( \textcolor{stringliteral}{"\_\_kmp\_resume\_template: T#%d exiting, thread T#%d already awake: flag(%p)\(\backslash\)n"}
      ,
1810                        gtid, target\_gtid, NULL ) );
1811         status = pthread\_mutex\_unlock( &th->th.th\_suspend\_mx.m\_mutex );
1812         \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutex\_unlock"}, status );
1813         \textcolor{keywordflow}{return};
1814     \}
1815     \textcolor{keywordflow}{else} \{ \textcolor{comment}{// if multiple threads are sleeping, flag should be internally referring to a specific thread
       here}
1816         \textcolor{keyword}{typename} C::flag\_t old\_spin = flag->unset\_sleeping();
1817         \textcolor{keywordflow}{if} ( ! flag->is\_sleeping\_val(old\_spin) ) \{
1818             \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 5, ( \textcolor{stringliteral}{"\_\_kmp\_resume\_template: T#%d exiting, thread T#%d already awake:
       flag(%p): "}
1819                            \textcolor{stringliteral}{"%u => %u\(\backslash\)n"},
1820                            gtid, target\_gtid, flag->get(), old\_spin, *flag->get() ) );
1821             status = pthread\_mutex\_unlock( &th->th.th\_suspend\_mx.m\_mutex );
1822             \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutex\_unlock"}, status );
1823             \textcolor{keywordflow}{return};
1824         \}
1825         \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 5, ( \textcolor{stringliteral}{"\_\_kmp\_resume\_template: T#%d about to wakeup T#%d, reset sleep bit for
       flag's loc(%p): "}
1826                        \textcolor{stringliteral}{"%u => %u\(\backslash\)n"},
1827                        gtid, target\_gtid, flag->get(), old\_spin, *flag->get() ) );
1828     \}
1829     \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(th->th.th\_sleep\_loc, NULL);
1830 
1831 
1832 \textcolor{preprocessor}{#ifdef DEBUG\_SUSPEND}
1833 \textcolor{preprocessor}{}    \{
1834         \textcolor{keywordtype}{char} buffer[128];
1835         \_\_kmp\_print\_cond( buffer, &th->th.th\_suspend\_cv );
1836         \hyperlink{kmp__io_8c_ac0b96ed999ee9819c544e6f24057da91}{\_\_kmp\_printf}( \textcolor{stringliteral}{"\_\_kmp\_resume\_template: T#%d resuming T#%d: %s\(\backslash\)n"}, gtid, target\_gtid, 
      buffer );
1837     \}
1838 \textcolor{preprocessor}{#endif}
1839 \textcolor{preprocessor}{}
1840     status = pthread\_cond\_signal( &th->th.th\_suspend\_cv.c\_cond );
1841     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_cond\_signal"}, status );
1842     status = pthread\_mutex\_unlock( &th->th.th\_suspend\_mx.m\_mutex );
1843     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutex\_unlock"}, status );
1844     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 30, ( \textcolor{stringliteral}{"\_\_kmp\_resume\_template: T#%d exiting after signaling wake up for T#%d\(\backslash\)n"},
1845                     gtid, target\_gtid ) );
1846 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_ab5834eff1e783726ba2a6a32133617cc}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy@{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy}}
\index{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy@{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_ab5834eff1e783726ba2a6a32133617cc}


Definition at line 2144 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
2145 \{
2146     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
2147 
2148     \textcolor{keywordflow}{if} ( ! \hyperlink{z__Linux__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime} ) \{
2149         \textcolor{keywordflow}{return}; \textcolor{comment}{// Nothing to do.}
2150     \};
2151 
2152 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
2153 \textcolor{preprocessor}{}    \_\_kmp\_itt\_destroy();
2154 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
2155 \textcolor{preprocessor}{}
2156     status = pthread\_key\_delete( \hyperlink{kmp_8h_aae367e473107cb756f7f123b70d62efd}{\_\_kmp\_gtid\_threadprivate\_key} );
2157     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_key\_delete"}, status );
2158 \textcolor{preprocessor}{    #ifdef BUILD\_TV}
2159 \textcolor{preprocessor}{}        status = pthread\_key\_delete( \_\_kmp\_tv\_key );
2160         \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_key\_delete"}, status );
2161 \textcolor{preprocessor}{    #endif}
2162 \textcolor{preprocessor}{}
2163     status = pthread\_mutex\_destroy( & \hyperlink{z__Linux__util_8c_a1d77743294d51eefed86a29081e1dcfe}{\_\_kmp\_wait\_mx}.m\_mutex );
2164     \textcolor{keywordflow}{if} ( status != 0 && status != EBUSY ) \{
2165         \hyperlink{kmp__i18n_8h_aab99fba7f170866ead9c59379f73115b}{KMP\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutex\_destroy"}, status );
2166     \}
2167     status = pthread\_cond\_destroy( & \hyperlink{z__Linux__util_8c_adf8bd06136520a941aa1db9078d080d3}{\_\_kmp\_wait\_cv}.c\_cond );
2168     \textcolor{keywordflow}{if} ( status != 0 && status != EBUSY ) \{
2169         \hyperlink{kmp__i18n_8h_aab99fba7f170866ead9c59379f73115b}{KMP\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_cond\_destroy"}, status );
2170     \}
2171 \textcolor{preprocessor}{    #if KMP\_AFFINITY\_SUPPORTED}
2172 \textcolor{preprocessor}{}        \_\_kmp\_affinity\_uninitialize();
2173 \textcolor{preprocessor}{    #endif}
2174 \textcolor{preprocessor}{}
2175     \hyperlink{z__Linux__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime} = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
2176 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_ad0680d5e6d1872f505775e7bf61c91f6}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize@{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize}}
\index{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize@{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_ad0680d5e6d1872f505775e7bf61c91f6}


Definition at line 2078 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
2079 \{
2080     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
2081     pthread\_mutexattr\_t mutex\_attr;
2082     pthread\_condattr\_t  cond\_attr;
2083 
2084     \textcolor{keywordflow}{if} ( \hyperlink{z__Linux__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime} ) \{
2085         \textcolor{keywordflow}{return};
2086     \}; \textcolor{comment}{// if}
2087 
2088 \textcolor{preprocessor}{    #if ( KMP\_ARCH\_X86 || KMP\_ARCH\_X86\_64 )}
2089 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ( ! \hyperlink{kmp_8h_a9f43d4488c8be0593700cc5b778726b9}{\_\_kmp\_cpuinfo}.\hyperlink{structkmp__cpuinfo_a340553795a3c12f5f72d3333027dc1ef}{initialized} ) \{
2090             \_\_kmp\_query\_cpuid( &\hyperlink{kmp_8h_a9f43d4488c8be0593700cc5b778726b9}{\_\_kmp\_cpuinfo} );
2091         \}; \textcolor{comment}{// if}
2092 \textcolor{preprocessor}{    #endif }\textcolor{comment}{/* KMP\_ARCH\_X86 || KMP\_ARCH\_X86\_64 */}\textcolor{preprocessor}{}
2093 \textcolor{preprocessor}{}
2094     \hyperlink{kmp_8h_a3469a7dffedccf219ec6b8a0e4ec8ed2}{\_\_kmp\_xproc} = \hyperlink{z__Linux__util_8c_ae39a99b218d0a4540b2023f49ad38b7a}{\_\_kmp\_get\_xproc}();
2095 
2096     \textcolor{keywordflow}{if} ( sysconf( \_SC\_THREADS ) ) \{
2097 
2098         \textcolor{comment}{/* Query the maximum number of threads */}
2099         \hyperlink{kmp_8h_aa34f380bb9845773e26d2f6f894cfd26}{\_\_kmp\_sys\_max\_nth} = sysconf( \_SC\_THREAD\_THREADS\_MAX );
2100         \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_aa34f380bb9845773e26d2f6f894cfd26}{\_\_kmp\_sys\_max\_nth} == -1 ) \{
2101             \textcolor{comment}{/* Unlimited threads for NPTL */}
2102             \hyperlink{kmp_8h_aa34f380bb9845773e26d2f6f894cfd26}{\_\_kmp\_sys\_max\_nth} = INT\_MAX;
2103         \}
2104         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_aa34f380bb9845773e26d2f6f894cfd26}{\_\_kmp\_sys\_max\_nth} <= 1 ) \{
2105             \textcolor{comment}{/* Can't tell, just use PTHREAD\_THREADS\_MAX */}
2106             \hyperlink{kmp_8h_aa34f380bb9845773e26d2f6f894cfd26}{\_\_kmp\_sys\_max\_nth} = \hyperlink{kmp_8h_a39c5ef60c2d07e928adebba0d2598a1f}{KMP\_MAX\_NTH};
2107         \}
2108 
2109         \textcolor{comment}{/* Query the minimum stack size */}
2110         \hyperlink{kmp_8h_ac11734b715f1e9aec17fc0eda9cba87c}{\_\_kmp\_sys\_min\_stksize} = sysconf( \_SC\_THREAD\_STACK\_MIN );
2111         \textcolor{keywordflow}{if} ( \hyperlink{kmp_8h_ac11734b715f1e9aec17fc0eda9cba87c}{\_\_kmp\_sys\_min\_stksize} <= 1 ) \{
2112             \hyperlink{kmp_8h_ac11734b715f1e9aec17fc0eda9cba87c}{\_\_kmp\_sys\_min\_stksize} = \hyperlink{kmp_8h_ac103fc3a7e2b0639661b18ec3d0c5243}{KMP\_MIN\_STKSIZE};
2113         \}
2114     \}
2115 
2116     \textcolor{comment}{/* Set up minimum number of threads to switch to TLS gtid */}
2117     \hyperlink{kmp_8h_afce1a0df7f7512062fd0494459776dae}{\_\_kmp\_tls\_gtid\_min} = \hyperlink{kmp_8h_a8d7fad5225acf607ab14d49bd853d1f6}{KMP\_TLS\_GTID\_MIN};
2118 
2119 \textcolor{preprocessor}{    #ifdef BUILD\_TV}
2120 \textcolor{preprocessor}{}        \{
2121             \textcolor{keywordtype}{int} rc = pthread\_key\_create( & \_\_kmp\_tv\_key, 0 );
2122             \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_key\_create"}, rc );
2123         \}
2124 \textcolor{preprocessor}{    #endif}
2125 \textcolor{preprocessor}{}
2126     status = pthread\_key\_create( &\hyperlink{kmp_8h_aae367e473107cb756f7f123b70d62efd}{\_\_kmp\_gtid\_threadprivate\_key}, 
      \hyperlink{kmp_8h_a95057f0ba945a5e6076976952fb80573}{\_\_kmp\_internal\_end\_dest} );
2127     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_key\_create"}, status );
2128     status = pthread\_mutexattr\_init( & mutex\_attr );
2129     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutexattr\_init"}, status );
2130     status = pthread\_mutex\_init( & \hyperlink{z__Linux__util_8c_a1d77743294d51eefed86a29081e1dcfe}{\_\_kmp\_wait\_mx}.m\_mutex, & mutex\_attr );
2131     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutex\_init"}, status );
2132     status = pthread\_condattr\_init( & cond\_attr );
2133     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_condattr\_init"}, status );
2134     status = pthread\_cond\_init( & \hyperlink{z__Linux__util_8c_adf8bd06136520a941aa1db9078d080d3}{\_\_kmp\_wait\_cv}.c\_cond, & cond\_attr );
2135     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_cond\_init"}, status );
2136 \textcolor{preprocessor}{#if USE\_ITT\_BUILD}
2137 \textcolor{preprocessor}{}    \_\_kmp\_itt\_initialize();
2138 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_ITT\_BUILD */}\textcolor{preprocessor}{}
2139 \textcolor{preprocessor}{}
2140     \hyperlink{z__Linux__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\_\_kmp\_init\_runtime} = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
2141 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a42d3fd592b93c484b9ce6713be9e5b3c}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-set\-\_\-stack\-\_\-info@{\-\_\-\-\_\-kmp\-\_\-set\-\_\-stack\-\_\-info}}
\index{\-\_\-\-\_\-kmp\-\_\-set\-\_\-stack\-\_\-info@{\-\_\-\-\_\-kmp\-\_\-set\-\_\-stack\-\_\-info}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-set\-\_\-stack\-\_\-info}]{\setlength{\rightskip}{0pt plus 5cm}static kmp\-\_\-int32 \-\_\-\-\_\-kmp\-\_\-set\-\_\-stack\-\_\-info (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{gtid, }
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Linux__util_8c_a42d3fd592b93c484b9ce6713be9e5b3c}


Definition at line 629 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-create\-\_\-worker(), \-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor(), and \-\_\-\-\_\-kmp\-\_\-launch\-\_\-worker().


\begin{DoxyCode}
630 \{
631     \textcolor{keywordtype}{int}            stack\_data;
632 \textcolor{preprocessor}{#if KMP\_OS\_LINUX || KMP\_OS\_FREEBSD || KMP\_OS\_NETBSD}
633 \textcolor{preprocessor}{}    \textcolor{comment}{/* Linux* OS only -- no pthread\_getattr\_np support on OS X* */}
634     pthread\_attr\_t attr;
635     \textcolor{keywordtype}{int}            \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
636     \textcolor{keywordtype}{size\_t}         \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} = 0;
637     \textcolor{keywordtype}{void} *         \hyperlink{ittnotify__static_8h_a7e21c61c16fffcc27199a9d66ff39ab8}{addr} = 0;
638 
639     \textcolor{comment}{/* Always do incremental stack refinement for ubermaster threads since the initial}
640 \textcolor{comment}{       thread stack range can be reduced by sibling thread creation so pthread\_attr\_getstack}
641 \textcolor{comment}{       may cause thread gtid aliasing */}
642     \textcolor{keywordflow}{if} ( ! \hyperlink{kmp_8h_a1ad5b094aa539d78ab4155b10b0ced21}{KMP\_UBER\_GTID}(gtid) ) \{
643 
644         \textcolor{comment}{/* Fetch the real thread attributes */}
645         status = pthread\_attr\_init( &attr );
646         \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_attr\_init"}, status );
647 \textcolor{preprocessor}{#if KMP\_OS\_FREEBSD || KMP\_OS\_NETBSD}
648 \textcolor{preprocessor}{}        status = pthread\_attr\_get\_np( pthread\_self(), &attr );
649         \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_attr\_get\_np"}, status );
650 \textcolor{preprocessor}{#else}
651 \textcolor{preprocessor}{}        status = pthread\_getattr\_np( pthread\_self(), &attr );
652         \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_getattr\_np"}, status );
653 \textcolor{preprocessor}{#endif}
654 \textcolor{preprocessor}{}        status = pthread\_attr\_getstack( &attr, &addr, &size );
655         \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_attr\_getstack"}, status );
656         \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 60, ( \textcolor{stringliteral}{"\_\_kmp\_set\_stack\_info: T#%d pthread\_attr\_getstack returned size: %lu, "}
657                         \textcolor{stringliteral}{"low addr: %p\(\backslash\)n"},
658                         gtid, size, addr ));
659 
660         status = pthread\_attr\_destroy( &attr );
661         \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_attr\_destroy"}, status );
662     \}
663 
664     \textcolor{keywordflow}{if} ( size != 0 && addr != 0 ) \{     \textcolor{comment}{/* was stack parameter determination successful? */}
665         \textcolor{comment}{/* Store the correct base and size */}
666         \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(th->th.th\_info.ds.ds\_stackbase, (((\textcolor{keywordtype}{char} *)addr) + size));
667         \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(th->th.th\_info.ds.ds\_stacksize, size);
668         \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(th->th.th\_info.ds.ds\_stackgrow, \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
669         \textcolor{keywordflow}{return} \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
670     \}
671 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* KMP\_OS\_LINUX || KMP\_OS\_FREEBSD || KMP\_OS\_NETBSD */}\textcolor{preprocessor}{}
672 \textcolor{preprocessor}{}    \textcolor{comment}{/* Use incremental refinement starting from initial conservative estimate */}
673     \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(th->th.th\_info.ds.ds\_stacksize, 0);
674     \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(th -> th.th\_info.ds.ds\_stackbase, &stack\_data);
675     \hyperlink{kmp__os_8h_ae67779cc7794b5dd7eee4c7f2c7789d4}{TCW\_4}(th->th.th\_info.ds.ds\_stackgrow, \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
676     \textcolor{keywordflow}{return} \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
677 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_aba3964e854aa376fc15165064cf5eff7}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32 (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{th\-\_\-gtid, }
\item[{{\bf kmp\-\_\-flag\-\_\-32} $\ast$}]{flag}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_aba3964e854aa376fc15165064cf5eff7}


Definition at line 1769 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1769                                                       \{
1770     \hyperlink{z__Linux__util_8c_a2a0487d25d42b2af4af0571afcd405e8}{\_\_kmp\_suspend\_template}(th\_gtid, flag);
1771 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_aa691a7515df09e540efa307af193ebcf}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64 (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{th\-\_\-gtid, }
\item[{{\bf kmp\-\_\-flag\-\_\-64} $\ast$}]{flag}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_aa691a7515df09e540efa307af193ebcf}


Definition at line 1772 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1772                                                       \{
1773     \hyperlink{z__Linux__util_8c_a2a0487d25d42b2af4af0571afcd405e8}{\_\_kmp\_suspend\_template}(th\_gtid, flag);
1774 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a4b300606c79ebf03aaee1fdc9b9c141d}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a4b300606c79ebf03aaee1fdc9b9c141d}


Definition at line 1600 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1601 \{
1602     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1603     status = pthread\_mutexattr\_init( &\hyperlink{z__Linux__util_8c_a3836edc5d4bf91aaa64b0360f0cb91ae}{\_\_kmp\_suspend\_mutex\_attr} );
1604     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutexattr\_init"}, status );
1605     status = pthread\_condattr\_init( &\hyperlink{z__Linux__util_8c_a6c478e674b147c738cc07462a660f8da}{\_\_kmp\_suspend\_cond\_attr} );
1606     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_condattr\_init"}, status );
1607 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a3cbd436ba7abef35400b2939a597025e}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Linux__util_8c_a3cbd436ba7abef35400b2939a597025e}


Definition at line 1610 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-resume\-\_\-template(), and \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template().


\begin{DoxyCode}
1611 \{
1612     \textcolor{keywordflow}{if} ( th->th.th\_suspend\_init\_count <= \hyperlink{z__Linux__util_8c_a95d647f877d12f7486e0f53cccadc7e5}{\_\_kmp\_fork\_count} ) \{
1613         \textcolor{comment}{/* this means we haven't initialized the suspension pthread objects for this thread}
1614 \textcolor{comment}{           in this instance of the process */}
1615         \textcolor{keywordtype}{int}     \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1616         status = pthread\_cond\_init( &th->th.th\_suspend\_cv.c\_cond, &
      \hyperlink{z__Linux__util_8c_a6c478e674b147c738cc07462a660f8da}{\_\_kmp\_suspend\_cond\_attr} );
1617         \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_cond\_init"}, status );
1618         status = pthread\_mutex\_init( &th->th.th\_suspend\_mx.m\_mutex, & 
      \hyperlink{z__Linux__util_8c_a3836edc5d4bf91aaa64b0360f0cb91ae}{\_\_kmp\_suspend\_mutex\_attr} );
1619         \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutex\_init"}, status );
1620         *(\textcolor{keyword}{volatile} \textcolor{keywordtype}{int}*)&th->th.th\_suspend\_init\_count = \hyperlink{z__Linux__util_8c_a95d647f877d12f7486e0f53cccadc7e5}{\_\_kmp\_fork\_count} + 1;
1621     \};
1622 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a984c4dfb0b0c1966f7f2839107b6bd80}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{th\-\_\-gtid, }
\item[{{\bf kmp\-\_\-flag\-\_\-oncore} $\ast$}]{flag}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a984c4dfb0b0c1966f7f2839107b6bd80}


Definition at line 1775 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1775                                                               \{
1776     \hyperlink{z__Linux__util_8c_a2a0487d25d42b2af4af0571afcd405e8}{\_\_kmp\_suspend\_template}(th\_gtid, flag);
1777 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a2a0487d25d42b2af4af0571afcd405e8}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class C $>$ static {\bf void} \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-template (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{th\-\_\-gtid, }
\item[{C $\ast$}]{flag}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{z__Linux__util_8c_a2a0487d25d42b2af4af0571afcd405e8}


Definition at line 1649 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-32(), \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-64(), and \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-oncore().


\begin{DoxyCode}
1650 \{
1651     \hyperlink{kmp__stats_8h_a340afca3214165ed1920481f0e8fa67c}{KMP\_TIME\_DEVELOPER\_BLOCK}(USER\_suspend);
1652     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *th = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[th\_gtid];
1653     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1654     \textcolor{keyword}{typename} C::flag\_t old\_spin;
1655 
1656     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 30, (\textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d enter for flag = %p\(\backslash\)n"}, th\_gtid, flag->get() ) );
1657 
1658     \hyperlink{z__Linux__util_8c_a3cbd436ba7abef35400b2939a597025e}{\_\_kmp\_suspend\_initialize\_thread}( th );
1659 
1660     status = pthread\_mutex\_lock( &th->th.th\_suspend\_mx.m\_mutex );
1661     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutex\_lock"}, status );
1662 
1663     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d setting sleep bit for spin(%p)\(\backslash\)n"},
1664                     th\_gtid, flag->get() ) );
1665 
1666     \textcolor{comment}{/* TODO: shouldn't this use release semantics to ensure that \_\_kmp\_suspend\_initialize\_thread}
1667 \textcolor{comment}{       gets called first?}
1668 \textcolor{comment}{    */}
1669 
1670     \textcolor{comment}{//hash: where else is the sleep bit used?}
1671     old\_spin = flag->set\_sleeping();
1672 
1673     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 5, ( \textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d set sleep bit for spin(%p)==%x, was %x\(\backslash\)n"},
1674                    th\_gtid, flag->get(), *(flag->get()), old\_spin ) );
1675 
1676     \textcolor{keywordflow}{if} ( flag->done\_check\_val(old\_spin) ) \{
1677         old\_spin = flag->unset\_sleeping();
1678         \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 5, ( \textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d false alarm, reset sleep bit for spin(%p)\(\backslash\)n"},
1679                        th\_gtid, flag->get()) );
1680     \} \textcolor{keywordflow}{else} \{
1681         \textcolor{comment}{/* Encapsulate in a loop as the documentation states that this may}
1682 \textcolor{comment}{         * "with low probability" return when the condition variable has}
1683 \textcolor{comment}{         * not been signaled or broadcast}
1684 \textcolor{comment}{         */}
1685         \textcolor{keywordtype}{int} deactivated = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1686         \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(th->th.th\_sleep\_loc, (\textcolor{keywordtype}{void} *)flag);
1687         \textcolor{keywordflow}{while} ( flag->is\_sleeping() ) \{
1688 \textcolor{preprocessor}{#ifdef DEBUG\_SUSPEND}
1689 \textcolor{preprocessor}{}            \textcolor{keywordtype}{char} buffer[128];
1690             \_\_kmp\_suspend\_count++;
1691             \_\_kmp\_print\_cond( buffer, &th->th.th\_suspend\_cv );
1692             \hyperlink{kmp__io_8c_ac0b96ed999ee9819c544e6f24057da91}{\_\_kmp\_printf}( \textcolor{stringliteral}{"\_\_kmp\_suspend\_template: suspending T#%d: %s\(\backslash\)n"}, th\_gtid, buffer );
1693 \textcolor{preprocessor}{#endif}
1694 \textcolor{preprocessor}{}            \textcolor{comment}{// Mark the thread as no longer active (only in the first iteration of the loop).}
1695             \textcolor{keywordflow}{if} ( ! deactivated ) \{
1696                 th->th.th\_active = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1697                 \textcolor{keywordflow}{if} ( th->th.th\_active\_in\_pool ) \{
1698                     th->th.th\_active\_in\_pool = \hyperlink{kmp_8h_aa93f0eb578d23995850d61f7d61c55c1}{FALSE};
1699                     \hyperlink{kmp__os_8h_a5b23523b95ee4b2307a8f344cbbe8050}{KMP\_TEST\_THEN\_DEC32}(
1700                       (kmp\_int32 *) &\hyperlink{kmp_8h_adeeafca09cd1560dcc9bc78ee1df217d}{\_\_kmp\_thread\_pool\_active\_nth} );
1701                     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(
      \hyperlink{kmp_8h_adeeafca09cd1560dcc9bc78ee1df217d}{\_\_kmp\_thread\_pool\_active\_nth}) >= 0 );
1702                 \}
1703                 deactivated = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1704             \}
1705 
1706 \textcolor{preprocessor}{#if USE\_SUSPEND\_TIMEOUT}
1707 \textcolor{preprocessor}{}            \textcolor{keyword}{struct }timespec  now;
1708             \textcolor{keyword}{struct }timeval   tval;
1709             \textcolor{keywordtype}{int} msecs;
1710 
1711             status = gettimeofday( &tval, NULL );
1712             \hyperlink{kmp__i18n_8h_a8c4d6cebf68c7b886a511c86aeef0439}{KMP\_CHECK\_SYSFAIL\_ERRNO}( \textcolor{stringliteral}{"gettimeofday"}, status );
1713             TIMEVAL\_TO\_TIMESPEC( &tval, &now );
1714 
1715             msecs = (4*\hyperlink{kmp_8h_a3b56e2e90e1539c0b794e4137724bc1c}{\_\_kmp\_dflt\_blocktime}) + 200;
1716             now.tv\_sec  += msecs / 1000;
1717             now.tv\_nsec += (msecs % 1000)*1000;
1718 
1719             \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 15, ( \textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d about to perform pthread\_cond\_timedwait\(\backslash\)n
      "},
1720                             th\_gtid ) );
1721             status = pthread\_cond\_timedwait( &th->th.th\_suspend\_cv.c\_cond, &th->th.th\_suspend\_mx.m\_mutex, &
       now );
1722 \textcolor{preprocessor}{#else}
1723 \textcolor{preprocessor}{}            \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 15, ( \textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d about to perform pthread\_cond\_wait\(\backslash\)n"},
1724                             th\_gtid ) );
1725             status = pthread\_cond\_wait( &th->th.th\_suspend\_cv.c\_cond, &th->th.th\_suspend\_mx.m\_mutex );
1726 \textcolor{preprocessor}{#endif}
1727 \textcolor{preprocessor}{}
1728             \textcolor{keywordflow}{if} ( (status != 0) && (status != EINTR) && (status != ETIMEDOUT) ) \{
1729                 \hyperlink{kmp__i18n_8h_aab99fba7f170866ead9c59379f73115b}{KMP\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_cond\_wait"}, status );
1730             \}
1731 \textcolor{preprocessor}{#ifdef KMP\_DEBUG}
1732 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} (status == ETIMEDOUT) \{
1733                 \textcolor{keywordflow}{if} ( flag->is\_sleeping() ) \{
1734                     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 100, ( \textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d timeout wakeup\(\backslash\)n"}, th\_gtid ) );
1735                 \} \textcolor{keywordflow}{else} \{
1736                     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 2, ( \textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d timeout wakeup, sleep bit not set!
      \(\backslash\)n"},
1737                                    th\_gtid ) );
1738                 \}
1739             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( flag->is\_sleeping() ) \{
1740                 \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 100, ( \textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d spurious wakeup\(\backslash\)n"}, th\_gtid ) );
1741             \}
1742 \textcolor{preprocessor}{#endif}
1743 \textcolor{preprocessor}{}        \} \textcolor{comment}{// while}
1744 
1745         \textcolor{comment}{// Mark the thread as active again (if it was previous marked as inactive)}
1746         \textcolor{keywordflow}{if} ( deactivated ) \{
1747             th->th.th\_active = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1748             \textcolor{keywordflow}{if} ( \hyperlink{kmp__os_8h_acd6256e4afba32d90997235fc0a38a74}{TCR\_4}(th->th.th\_in\_pool) ) \{
1749                 \hyperlink{kmp__os_8h_a201982f51ff23ad84ae6781ad4265e3a}{KMP\_TEST\_THEN\_INC32}( (kmp\_int32 *) &
      \hyperlink{kmp_8h_adeeafca09cd1560dcc9bc78ee1df217d}{\_\_kmp\_thread\_pool\_active\_nth} );
1750                 th->th.th\_active\_in\_pool = \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE};
1751             \}
1752         \}
1753     \}
1754 
1755 \textcolor{preprocessor}{#ifdef DEBUG\_SUSPEND}
1756 \textcolor{preprocessor}{}    \{
1757         \textcolor{keywordtype}{char} buffer[128];
1758         \_\_kmp\_print\_cond( buffer, &th->th.th\_suspend\_cv);
1759         \hyperlink{kmp__io_8c_ac0b96ed999ee9819c544e6f24057da91}{\_\_kmp\_printf}( \textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d has awakened: %s\(\backslash\)n"}, th\_gtid, buffer );
1760     \}
1761 \textcolor{preprocessor}{#endif}
1762 \textcolor{preprocessor}{}
1763     status = pthread\_mutex\_unlock( &th->th.th\_suspend\_mx.m\_mutex );
1764     \hyperlink{kmp__i18n_8h_a4daa17e296aa68b31dee534d0f505282}{KMP\_CHECK\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutex\_unlock"}, status );
1765 
1766     \hyperlink{kmp__debug_8h_aa77d06a01f304e7b70fe1f4b052a1b57}{KF\_TRACE}( 30, (\textcolor{stringliteral}{"\_\_kmp\_suspend\_template: T#%d exit\(\backslash\)n"}, th\_gtid ) );
1767 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a8da648a8950059fa34eeca0f54b437a6}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a8da648a8950059fa34eeca0f54b437a6}


Definition at line 1625 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
1626 \{
1627     \textcolor{keywordflow}{if}(th->th.th\_suspend\_init\_count > \hyperlink{z__Linux__util_8c_a95d647f877d12f7486e0f53cccadc7e5}{\_\_kmp\_fork\_count}) \{
1628         \textcolor{comment}{/* this means we have initialize the suspension pthread objects for this thread}
1629 \textcolor{comment}{           in this instance of the process */}
1630         \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
1631 
1632         status = pthread\_cond\_destroy( &th->th.th\_suspend\_cv.c\_cond );
1633         \textcolor{keywordflow}{if} ( status != 0 && status != EBUSY ) \{
1634             \hyperlink{kmp__i18n_8h_aab99fba7f170866ead9c59379f73115b}{KMP\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_cond\_destroy"}, status );
1635         \};
1636         status = pthread\_mutex\_destroy( &th->th.th\_suspend\_mx.m\_mutex );
1637         \textcolor{keywordflow}{if} ( status != 0 && status != EBUSY ) \{
1638             \hyperlink{kmp__i18n_8h_aab99fba7f170866ead9c59379f73115b}{KMP\_SYSFAIL}( \textcolor{stringliteral}{"pthread\_mutex\_destroy"}, status );
1639         \};
1640         --th->th.th\_suspend\_init\_count;
1641         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(th->th.th\_suspend\_init\_count == 
      \hyperlink{z__Linux__util_8c_a95d647f877d12f7486e0f53cccadc7e5}{\_\_kmp\_fork\_count});
1642     \}
1643 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a9c1e0ffcb1e7c87e5429269dc6c6c0bf}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread}}
\index{\-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread@{\-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{gtid}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a9c1e0ffcb1e7c87e5429269dc6c6c0bf}


Definition at line 592 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor().


\begin{DoxyCode}
593 \{
594     \textcolor{keywordtype}{int} \hyperlink{kmp__i18n_8c_a43c2a109a79fef7e46a0836cdac679ff}{status};
595     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}  *th = \hyperlink{kmp_8h_a8ba907eb5a2568ff55a49a1504cd3624}{\_\_kmp\_threads}[ gtid ];
596 
597     \textcolor{keywordflow}{if} ( !th ) \textcolor{keywordflow}{return};
598 
599 \textcolor{preprocessor}{    #ifdef KMP\_CANCEL\_THREADS}
600 \textcolor{preprocessor}{}        \hyperlink{kmp__debug_8h_a21d51f37cb197aca5ffe737531678830}{KA\_TRACE}( 10, (\textcolor{stringliteral}{"\_\_kmp\_terminate\_thread: kill (%d)\(\backslash\)n"}, gtid ) );
601         status = pthread\_cancel( th->th.th\_info.ds.ds\_thread );
602         \textcolor{keywordflow}{if} ( status != 0 && status != ESRCH ) \{
603             \hyperlink{kmp__i18n_8c_adeba56c5fec6ef3d5a6eae2c8785dd01}{\_\_kmp\_msg}(
604                 \hyperlink{kmp__i18n_8h_a7c4bb6100d3330d1491644b331ed8060aac29006d355ede42e04f48ccd9c23f98}{kmp\_ms\_fatal},
605                 \hyperlink{kmp__i18n_8h_a6e819105ffc76141b666a1c784e6b5ab}{KMP\_MSG}( CantTerminateWorkerThread ),
606                 \hyperlink{kmp__i18n_8h_afcd232d6d16e604027d95243c6211e95}{KMP\_ERR}( status ),
607                 \hyperlink{kmp__i18n_8c_a4b36bb61ac53271694e7e36bd166a600}{\_\_kmp\_msg\_null}
608             );
609         \}; \textcolor{comment}{// if}
610 \textcolor{preprocessor}{    #endif}
611 \textcolor{preprocessor}{}    \hyperlink{z__Linux__util_8c_a699f282bc4bbcf04222893192f568e91}{\_\_kmp\_yield}( \hyperlink{kmp_8h_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE} );
612 \} \textcolor{comment}{//}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a397d2a9aa5fd59cab056b8aed69fef29}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-thread\-\_\-sleep@{\-\_\-\-\_\-kmp\-\_\-thread\-\_\-sleep}}
\index{\-\_\-\-\_\-kmp\-\_\-thread\-\_\-sleep@{\-\_\-\-\_\-kmp\-\_\-thread\-\_\-sleep}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-thread\-\_\-sleep}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-thread\-\_\-sleep (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{millis}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a397d2a9aa5fd59cab056b8aed69fef29}


Definition at line 2182 of file z\-\_\-\-Linux\-\_\-util.\-c.


\begin{DoxyCode}
2183 \{
2184     sleep(  ( millis + 500 ) / 1000 );
2185 \}
\end{DoxyCode}
\hypertarget{z__Linux__util_8c_a699f282bc4bbcf04222893192f568e91}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-yield@{\-\_\-\-\_\-kmp\-\_\-yield}}
\index{\-\_\-\-\_\-kmp\-\_\-yield@{\-\_\-\-\_\-kmp\-\_\-yield}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-yield}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-yield (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{cond}
\end{DoxyParamCaption}
)}}\label{z__Linux__util_8c_a699f282bc4bbcf04222893192f568e91}


Definition at line 1889 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-terminate\-\_\-thread().


\begin{DoxyCode}
1890 \{
1891     \textcolor{keywordflow}{if} (cond && \hyperlink{kmp_8h_ad41fbe82f9fadf0aaf70237d90bc6146}{\_\_kmp\_yielding\_on}) \{
1892         sched\_yield();
1893     \}
1894 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{z__Linux__util_8c_a95d647f877d12f7486e0f53cccadc7e5}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-fork\-\_\-count@{\-\_\-\-\_\-kmp\-\_\-fork\-\_\-count}}
\index{\-\_\-\-\_\-kmp\-\_\-fork\-\_\-count@{\-\_\-\-\_\-kmp\-\_\-fork\-\_\-count}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-fork\-\_\-count}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-fork\-\_\-count = 0\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Linux__util_8c_a95d647f877d12f7486e0f53cccadc7e5}


Definition at line 81 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-atfork\-\_\-child(), \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread(), and \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-uninitialize\-\_\-thread().

\hypertarget{z__Linux__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-init\-\_\-runtime@{\-\_\-\-\_\-kmp\-\_\-init\-\_\-runtime}}
\index{\-\_\-\-\_\-kmp\-\_\-init\-\_\-runtime@{\-\_\-\-\_\-kmp\-\_\-init\-\_\-runtime}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-init\-\_\-runtime}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} \-\_\-\-\_\-kmp\-\_\-init\-\_\-runtime = {\bf F\-A\-L\-S\-E}\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Linux__util_8c_a4835c7f447eed9409043d1ee2d6f9fe5}


Definition at line 79 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-atfork\-\_\-child(), \-\_\-\-\_\-kmp\-\_\-gtid\-\_\-get\-\_\-specific(), \-\_\-\-\_\-kmp\-\_\-gtid\-\_\-set\-\_\-specific(), \-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy(), and \-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize().

\hypertarget{z__Linux__util_8c_a6c478e674b147c738cc07462a660f8da}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-cond\-\_\-attr@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-cond\-\_\-attr}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-cond\-\_\-attr@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-cond\-\_\-attr}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-cond\-\_\-attr}]{\setlength{\rightskip}{0pt plus 5cm}pthread\-\_\-condattr\-\_\-t \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-cond\-\_\-attr\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Linux__util_8c_a6c478e674b147c738cc07462a660f8da}


Definition at line 83 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize(), and \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread().

\hypertarget{z__Linux__util_8c_a3836edc5d4bf91aaa64b0360f0cb91ae}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-mutex\-\_\-attr@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-mutex\-\_\-attr}}
\index{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-mutex\-\_\-attr@{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-mutex\-\_\-attr}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-suspend\-\_\-mutex\-\_\-attr}]{\setlength{\rightskip}{0pt plus 5cm}pthread\-\_\-mutexattr\-\_\-t \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-mutex\-\_\-attr\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Linux__util_8c_a3836edc5d4bf91aaa64b0360f0cb91ae}


Definition at line 84 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize(), and \-\_\-\-\_\-kmp\-\_\-suspend\-\_\-initialize\-\_\-thread().

\hypertarget{z__Linux__util_8c_a896323e702eca2ab9e9cadd0babccb6c}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-sys\-\_\-timer\-\_\-data@{\-\_\-\-\_\-kmp\-\_\-sys\-\_\-timer\-\_\-data}}
\index{\-\_\-\-\_\-kmp\-\_\-sys\-\_\-timer\-\_\-data@{\-\_\-\-\_\-kmp\-\_\-sys\-\_\-timer\-\_\-data}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-sys\-\_\-timer\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf kmp\-\_\-sys\-\_\-timer} \-\_\-\-\_\-kmp\-\_\-sys\-\_\-timer\-\_\-data\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Linux__util_8c_a896323e702eca2ab9e9cadd0babccb6c}


Definition at line 71 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-clear\-\_\-system\-\_\-time(), and \-\_\-\-\_\-kmp\-\_\-read\-\_\-system\-\_\-time().

\hypertarget{z__Linux__util_8c_adf8bd06136520a941aa1db9078d080d3}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-wait\-\_\-cv@{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-cv}}
\index{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-cv@{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-cv}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-cv}]{\setlength{\rightskip}{0pt plus 5cm}kmp\-\_\-cond\-\_\-align\-\_\-t \-\_\-\-\_\-kmp\-\_\-wait\-\_\-cv\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Linux__util_8c_adf8bd06136520a941aa1db9078d080d3}


Definition at line 86 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor(), \-\_\-\-\_\-kmp\-\_\-resume\-\_\-monitor(), \-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy(), and \-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize().

\hypertarget{z__Linux__util_8c_a1d77743294d51eefed86a29081e1dcfe}{\index{z\-\_\-\-Linux\-\_\-util.\-c@{z\-\_\-\-Linux\-\_\-util.\-c}!\-\_\-\-\_\-kmp\-\_\-wait\-\_\-mx@{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-mx}}
\index{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-mx@{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-mx}!z_Linux_util.c@{z\-\_\-\-Linux\-\_\-util.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-wait\-\_\-mx}]{\setlength{\rightskip}{0pt plus 5cm}kmp\-\_\-mutex\-\_\-align\-\_\-t \-\_\-\-\_\-kmp\-\_\-wait\-\_\-mx\hspace{0.3cm}{\ttfamily [static]}}}\label{z__Linux__util_8c_a1d77743294d51eefed86a29081e1dcfe}


Definition at line 87 of file z\-\_\-\-Linux\-\_\-util.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-launch\-\_\-monitor(), \-\_\-\-\_\-kmp\-\_\-resume\-\_\-monitor(), \-\_\-\-\_\-kmp\-\_\-runtime\-\_\-destroy(), and \-\_\-\-\_\-kmp\-\_\-runtime\-\_\-initialize().

