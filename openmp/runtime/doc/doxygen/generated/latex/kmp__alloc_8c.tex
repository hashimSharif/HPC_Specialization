\hypertarget{kmp__alloc_8c}{\section{kmp\-\_\-alloc.\-c File Reference}
\label{kmp__alloc_8c}\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}}
}
{\ttfamily \#include \char`\"{}kmp.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-wrapper\-\_\-malloc.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}kmp\-\_\-io.\-h\char`\"{}}\\*
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structqlinks}{qlinks}
\item 
struct \hyperlink{structbhead2}{bhead2}
\item 
union \hyperlink{unionbhead}{bhead}
\item 
struct \hyperlink{structbdhead}{bdhead}
\item 
struct \hyperlink{structbfhead}{bfhead}
\item 
struct \hyperlink{structthr__data}{thr\-\_\-data}
\item 
struct \hyperlink{structkmp__mem__descr}{kmp\-\_\-mem\-\_\-descr}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{Size\-Quant}~8
\item 
\#define \hyperlink{kmp__alloc_8c_adaab326653e74716055fed800f3797e7}{Align\-Type}~double
\item 
\#define \hyperlink{kmp__alloc_8c_ad59d9edb4f96928c5bcc0a0dce93f183}{Buf\-Stats}
\item 
\#define \hyperlink{kmp__alloc_8c_af312994da10c636eaa83074b49b44b0a}{M\-A\-X\-\_\-\-B\-G\-E\-T\-\_\-\-B\-I\-N\-S}~(\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int})(sizeof(\hyperlink{kmp__alloc_8c_ac3c6b00e9fbae316fdd0c11f2b8d50b7}{bget\-\_\-bin\-\_\-size}) / sizeof(\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}))
\item 
\#define \hyperlink{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}{B\-H}(\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p})~((\hyperlink{kmp__alloc_8c_af1de790fdc3ba84111ab8cd6730510bd}{bhead\-\_\-t} $\ast$) (\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p}))
\item 
\#define \hyperlink{kmp__alloc_8c_a67a71fd38b2b8aaaa6e9da54bb652b7b}{B\-D\-H}(\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p})~((\hyperlink{kmp__alloc_8c_a76704c34eb0e5bd1bc01a7635661213a}{bdhead\-\_\-t} $\ast$) (\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p}))
\item 
\#define \hyperlink{kmp__alloc_8c_af6ff720178dbca05767d51fd5c087228}{B\-F\-H}(\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p})~((\hyperlink{kmp__alloc_8c_abd11e50b08fcad0d4fbfdce33582213c}{bfhead\-\_\-t} $\ast$) (\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p}))
\item 
\#define \hyperlink{kmp__alloc_8c_abcbfda7b0f9d0f67003977804e87354a}{Q\-L\-Size}~(sizeof(\hyperlink{kmp__alloc_8c_a9059958aafec0d30537fe432f36b6665}{qlinks\-\_\-t}))
\item 
\#define \hyperlink{kmp__alloc_8c_a8a8beeffc163eabffc840e0d1ca7be0b}{Size\-Q}~((\hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{Size\-Quant} $>$ \hyperlink{kmp__alloc_8c_abcbfda7b0f9d0f67003977804e87354a}{Q\-L\-Size}) ? \hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{Size\-Quant} \-: \hyperlink{kmp__alloc_8c_abcbfda7b0f9d0f67003977804e87354a}{Q\-L\-Size})
\item 
\#define \hyperlink{kmp__alloc_8c_a85633b531a313eee6f1f31eeed4a12ea}{Max\-Size}~(\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize})( $\sim$ ( ( (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize})( 1 ) $<$$<$ ( sizeof( \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} ) $\ast$ C\-H\-A\-R\-\_\-\-B\-I\-T -\/ 1 ) ) $\vert$ ( \hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{Size\-Quant} -\/ 1 ) ) )
\item 
\#define \hyperlink{kmp__alloc_8c_a7dcc8bddb70936db7d4f3f34ed635543}{E\-Sent}~((\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) (-\/(((((\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize})1)$<$$<$((\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int})sizeof(\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize})$\ast$8-\/2))-\/1)$\ast$2)-\/2))
\item 
\#define \hyperlink{kmp__alloc_8c_afc0f3f88612de20c4a5510b549c7c73f}{K\-M\-P\-\_\-\-F\-R\-E\-E\-\_\-\-L\-I\-S\-T\-\_\-\-L\-I\-M\-I\-T}~16
\item 
\#define \hyperlink{kmp__alloc_8c_ac36927727a551119780161c1e25f9287}{D\-C\-A\-C\-H\-E\-\_\-\-L\-I\-N\-E}~128
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int}($\ast$ \hyperlink{kmp__alloc_8c_a97451db29023098b5723ad1ba00f944f}{bget\-\_\-compact\-\_\-t} )(size\-\_\-t, \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int})
\item 
typedef \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$($\ast$ \hyperlink{kmp__alloc_8c_a21f03e368c4e90d00ed20a2b01985ecd}{bget\-\_\-acquire\-\_\-t} )(size\-\_\-t)
\item 
typedef \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void}($\ast$ \hyperlink{kmp__alloc_8c_ad26e5d39dca5e04fbcfb74a022e2fcdb}{bget\-\_\-release\-\_\-t} )(\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$)
\item 
typedef ssize\-\_\-t \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}
\item 
typedef enum \hyperlink{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981}{bget\-\_\-mode} \hyperlink{kmp__alloc_8c_a625b1696056adee9c191ae4c8fc05f69}{bget\-\_\-mode\-\_\-t}
\item 
typedef struct \hyperlink{structqlinks}{qlinks} \hyperlink{kmp__alloc_8c_a9059958aafec0d30537fe432f36b6665}{qlinks\-\_\-t}
\item 
typedef struct \hyperlink{structbhead2}{bhead2} \hyperlink{kmp__alloc_8c_a9651d02bd00b58901a4d1d9af7df824d}{bhead2\-\_\-t}
\item 
typedef union \hyperlink{unionbhead}{bhead} \hyperlink{kmp__alloc_8c_af1de790fdc3ba84111ab8cd6730510bd}{bhead\-\_\-t}
\item 
typedef struct \hyperlink{structbdhead}{bdhead} \hyperlink{kmp__alloc_8c_a76704c34eb0e5bd1bc01a7635661213a}{bdhead\-\_\-t}
\item 
typedef struct \hyperlink{structbfhead}{bfhead} \hyperlink{kmp__alloc_8c_abd11e50b08fcad0d4fbfdce33582213c}{bfhead\-\_\-t}
\item 
typedef struct \hyperlink{structthr__data}{thr\-\_\-data} \hyperlink{kmp__alloc_8c_a1ad7ab39fc834f6749281ea4c3657b95}{thr\-\_\-data\-\_\-t}
\item 
typedef struct \hyperlink{structkmp__mem__descr}{kmp\-\_\-mem\-\_\-descr} \hyperlink{kmp__alloc_8c_a75b107f3256a7ef2373baada8e39a61e}{kmp\-\_\-mem\-\_\-descr\-\_\-t}
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981}{bget\-\_\-mode} \{ \hyperlink{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a8432b2f804c3780ca534a4f56e0bf274}{bget\-\_\-mode\-\_\-fifo} = 0, 
\hyperlink{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a0cc8593912b5aa9bdac96f437b65e3ea}{bget\-\_\-mode\-\_\-lifo} = 1, 
\hyperlink{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a0c883f0544468f73a8cc6606c2ac6b84}{bget\-\_\-mode\-\_\-best} = 2
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_a0c8a7122de0a6bfb0a3f56a2b92c607d}{bpool} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$buffer, \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} \hyperlink{ittnotify__static_8h_a607b6bb4c1ebd6e828c6a54ec9bd1411}{len})
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ \hyperlink{kmp__alloc_8c_ae0f1683e77919d466cf2ea6f7b00ba91}{bget} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size})
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ \hyperlink{kmp__alloc_8c_a9dd8baceae832aef6e56a510f40d7f2b}{bgetz} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size})
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ \hyperlink{kmp__alloc_8c_aba99d2a2a6154f7f8c1f957755bcbb48}{bgetr} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$buffer, \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} newsize)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_abebcbe8d8488d54668527825b2663666}{brel} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$buf)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_a5e152d4831a1e7143be739db589c9c3e}{bectl} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, \hyperlink{kmp__alloc_8c_a97451db29023098b5723ad1ba00f944f}{bget\-\_\-compact\-\_\-t} compact, \hyperlink{kmp__alloc_8c_a21f03e368c4e90d00ed20a2b01985ecd}{bget\-\_\-acquire\-\_\-t} acquire, \hyperlink{kmp__alloc_8c_ad26e5d39dca5e04fbcfb74a022e2fcdb}{bget\-\_\-release\-\_\-t} release, \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} pool\-\_\-incr)
\item 
static \hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{kmp__alloc_8c_adf61a5be00012037243154c36d331eff}{bget\-\_\-get\-\_\-bin} (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size})
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_a4fa2d764a1fb227783e00a6a8d60bb46}{set\-\_\-thr\-\_\-data} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
static \hyperlink{kmp__alloc_8c_a1ad7ab39fc834f6749281ea4c3657b95}{thr\-\_\-data\-\_\-t} $\ast$ \hyperlink{kmp__alloc_8c_ab99069e0ca8b8f4334f3d952f14ea967}{get\-\_\-thr\-\_\-data} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_a2051eee971259559ffd8406822786ab2}{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-dequeue} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_a2bf0c38164ca2a6de8b52558386141bc}{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-enqueue} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$buf)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_a6f80c5ae5feca086c056b4b9b0f8d30c}{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-insert\-\_\-into\-\_\-freelist} (\hyperlink{kmp__alloc_8c_a1ad7ab39fc834f6749281ea4c3657b95}{thr\-\_\-data\-\_\-t} $\ast$thr, \hyperlink{kmp__alloc_8c_abd11e50b08fcad0d4fbfdce33582213c}{bfhead\-\_\-t} $\ast$b)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_a2a12a9c925f14056c5bdc6c7726485cb}{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-remove\-\_\-from\-\_\-freelist} (\hyperlink{kmp__alloc_8c_abd11e50b08fcad0d4fbfdce33582213c}{bfhead\-\_\-t} $\ast$b)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_aae7687b0fc52108956d191aac6582a92}{bcheck} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} $\ast$max\-\_\-free, \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} $\ast$total\-\_\-free)
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_a77abb6a46b7d952625f54d2d506dce69}{bfreed} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_adf0ede820c2a58e37d06987be170dde4}{\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-bget} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_a9013b6561b0953fae3f61d09d418602b}{\-\_\-\-\_\-kmp\-\_\-finalize\-\_\-bget} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_a9c0855cf39dfbe2b8ed63020a99dcd90}{kmpc\-\_\-set\-\_\-poolsize} (size\-\_\-t \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size})
\item 
size\-\_\-t \hyperlink{kmp__alloc_8c_a4151653ed23d78edfd7f70820855aeb0}{kmpc\-\_\-get\-\_\-poolsize} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_afbc4aacdb05f12b01ed7482fbd7a0a00}{kmpc\-\_\-set\-\_\-poolmode} (\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{ittnotify__static_8h_aaa96ee29dca0e28ad6edad4c36f62080}{mode})
\item 
\hyperlink{ittnotify__static_8h_a8b8dcd723308a8cb5d84277c7a3fff70}{int} \hyperlink{kmp__alloc_8c_aeab82d477ff7bc5d00c52635f1a390f0}{kmpc\-\_\-get\-\_\-poolmode} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_a5fbfa0989e8c9d41df603346a57058a6}{kmpc\-\_\-get\-\_\-poolstat} (size\-\_\-t $\ast$maxmem, size\-\_\-t $\ast$allmem)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_aa45af19ce0fda88c36ba109457728495}{kmpc\-\_\-poolprint} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ \hyperlink{kmp__alloc_8c_aaab12aaa8a587464c9490323fdbec216}{kmpc\-\_\-malloc} (size\-\_\-t \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ \hyperlink{kmp__alloc_8c_aaff1b5800d2d73bb4af47dcbfd195f47}{kmpc\-\_\-calloc} (size\-\_\-t nelem, size\-\_\-t elsize)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ \hyperlink{kmp__alloc_8c_a338e1287ffbce17edcfb69f1b15a5b7b}{kmpc\-\_\-realloc} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ptr, size\-\_\-t \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_a2ef2b82a6d376c70d7bf35498207e0fc}{kmpc\-\_\-free} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ptr)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ \hyperlink{kmp__alloc_8c_af77f5b6cf8034f5c85bf9f2b2d062f64}{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-malloc} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, size\-\_\-t \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} \hyperlink{kmp__wrapper__malloc_8h_a2804cf36edfb2286c011a0360626569a}{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ \hyperlink{kmp__alloc_8c_a7a0ca945818a041ebac977dfe81b1aa4}{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-calloc} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, size\-\_\-t nelem, size\-\_\-t elsize \hyperlink{kmp__wrapper__malloc_8h_a2804cf36edfb2286c011a0360626569a}{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ \hyperlink{kmp__alloc_8c_a61189ab93e8180bc69c1181c3ed1786d}{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-realloc} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ptr, size\-\_\-t \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} \hyperlink{kmp__wrapper__malloc_8h_a2804cf36edfb2286c011a0360626569a}{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_a0523a918f8baa0f63606807121dc1448}{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-free} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th, \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ptr \hyperlink{kmp__wrapper__malloc_8h_a2804cf36edfb2286c011a0360626569a}{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L})
\item 
static \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ \hyperlink{kmp__alloc_8c_a822d4a52ca00e29ff21134620b32dd0f}{\-\_\-\-\_\-\-\_\-kmp\-\_\-allocate\-\_\-align} (size\-\_\-t \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size}, size\-\_\-t alignment \hyperlink{kmp__wrapper__malloc_8h_a2804cf36edfb2286c011a0360626569a}{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ \hyperlink{kmp__alloc_8c_a16ecb5ee9ac361484f422f36b99351b9}{\-\_\-\-\_\-\-\_\-kmp\-\_\-allocate} (size\-\_\-t \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} \hyperlink{kmp__wrapper__malloc_8h_a2804cf36edfb2286c011a0360626569a}{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ \hyperlink{kmp__alloc_8c_ae074d7b6f2575fa391a6754ef53f84db}{\-\_\-\-\_\-\-\_\-kmp\-\_\-page\-\_\-allocate} (size\-\_\-t \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} \hyperlink{kmp__wrapper__malloc_8h_a2804cf36edfb2286c011a0360626569a}{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_afdbadd7841e7011920a1dba5dcc0ff61}{\-\_\-\-\_\-\-\_\-kmp\-\_\-free} (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ptr \hyperlink{kmp__wrapper__malloc_8h_a2804cf36edfb2286c011a0360626569a}{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ \hyperlink{kmp__alloc_8c_a151a0fef62d6ede235dab41c5646dee9}{\-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-allocate} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$this\-\_\-thr, size\-\_\-t \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} \hyperlink{kmp__wrapper__malloc_8h_a2804cf36edfb2286c011a0360626569a}{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_aeee2b922beabc1af38a83c6302d4edb6}{\-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-free} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$this\-\_\-thr, \hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} $\ast$ptr \hyperlink{kmp__wrapper__malloc_8h_a2804cf36edfb2286c011a0360626569a}{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L})
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_a69fe87136a9efb3f397250ae7838f470}{\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-fast\-\_\-memory} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$this\-\_\-thr)
\item 
\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void} \hyperlink{kmp__alloc_8c_a9ef96955bf516ae561078adf0c75add4}{\-\_\-\-\_\-kmp\-\_\-free\-\_\-fast\-\_\-memory} (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\-\_\-info\-\_\-t} $\ast$th)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} \hyperlink{kmp__alloc_8c_ac3c6b00e9fbae316fdd0c11f2b8d50b7}{bget\-\_\-bin\-\_\-size} \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{kmp__alloc_8c_adaab326653e74716055fed800f3797e7}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!Align\-Type@{Align\-Type}}
\index{Align\-Type@{Align\-Type}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{Align\-Type}]{\setlength{\rightskip}{0pt plus 5cm}\#define Align\-Type~double}}\label{kmp__alloc_8c_adaab326653e74716055fed800f3797e7}


Definition at line 78 of file kmp\-\_\-alloc.\-c.

\hypertarget{kmp__alloc_8c_a67a71fd38b2b8aaaa6e9da54bb652b7b}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!B\-D\-H@{B\-D\-H}}
\index{B\-D\-H@{B\-D\-H}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{B\-D\-H}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-D\-H(
\begin{DoxyParamCaption}
\item[{}]{{\bf p}}
\end{DoxyParamCaption}
)~(({\bf bdhead\-\_\-t} $\ast$) ({\bf p}))}}\label{kmp__alloc_8c_a67a71fd38b2b8aaaa6e9da54bb652b7b}


Definition at line 190 of file kmp\-\_\-alloc.\-c.



Referenced by bget(), bgetr(), bgetz(), and brel().

\hypertarget{kmp__alloc_8c_af6ff720178dbca05767d51fd5c087228}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!B\-F\-H@{B\-F\-H}}
\index{B\-F\-H@{B\-F\-H}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{B\-F\-H}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-F\-H(
\begin{DoxyParamCaption}
\item[{}]{{\bf p}}
\end{DoxyParamCaption}
)~(({\bf bfhead\-\_\-t} $\ast$) ({\bf p}))}}\label{kmp__alloc_8c_af6ff720178dbca05767d51fd5c087228}


Definition at line 198 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-bget\-\_\-dequeue(), \-\_\-\-\_\-kmp\-\_\-bget\-\_\-enqueue(), bpool(), and brel().

\hypertarget{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!B\-H@{B\-H}}
\index{B\-H@{B\-H}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{B\-H}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-H(
\begin{DoxyParamCaption}
\item[{}]{{\bf p}}
\end{DoxyParamCaption}
)~(({\bf bhead\-\_\-t} $\ast$) ({\bf p}))}}\label{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}


Definition at line 181 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-finalize\-\_\-bget(), bget(), bgetr(), bgetz(), bpool(), and brel().

\hypertarget{kmp__alloc_8c_ad59d9edb4f96928c5bcc0a0dce93f183}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!Buf\-Stats@{Buf\-Stats}}
\index{Buf\-Stats@{Buf\-Stats}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{Buf\-Stats}]{\setlength{\rightskip}{0pt plus 5cm}\#define Buf\-Stats}}\label{kmp__alloc_8c_ad59d9edb4f96928c5bcc0a0dce93f183}
{\bfseries Value\-:}
\begin{DoxyCode}
1                 \textcolor{comment}{/* Define this symbol to enable the}
\textcolor{comment}{                                         bstats() function which calculates}
\textcolor{comment}{                                         the total free space in the buffer}
\textcolor{comment}{                                         pool, the largest available}
\textcolor{comment}{                                         buffer, and the total space}
\textcolor{comment}{                                         currently allocated. */}
\end{DoxyCode}


Definition at line 87 of file kmp\-\_\-alloc.\-c.

\hypertarget{kmp__alloc_8c_ac36927727a551119780161c1e25f9287}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!D\-C\-A\-C\-H\-E\-\_\-\-L\-I\-N\-E@{D\-C\-A\-C\-H\-E\-\_\-\-L\-I\-N\-E}}
\index{D\-C\-A\-C\-H\-E\-\_\-\-L\-I\-N\-E@{D\-C\-A\-C\-H\-E\-\_\-\-L\-I\-N\-E}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{D\-C\-A\-C\-H\-E\-\_\-\-L\-I\-N\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-C\-A\-C\-H\-E\-\_\-\-L\-I\-N\-E~128}}\label{kmp__alloc_8c_ac36927727a551119780161c1e25f9287}


Definition at line 1798 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-allocate(), and \-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-free().

\hypertarget{kmp__alloc_8c_a7dcc8bddb70936db7d4f3f34ed635543}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!E\-Sent@{E\-Sent}}
\index{E\-Sent@{E\-Sent}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{E\-Sent}]{\setlength{\rightskip}{0pt plus 5cm}\#define E\-Sent~(({\bf bufsize}) (-\/((((({\bf bufsize})1)$<$$<$(({\bf int})sizeof({\bf bufsize})$\ast$8-\/2))-\/1)$\ast$2)-\/2))}}\label{kmp__alloc_8c_a7dcc8bddb70936db7d4f3f34ed635543}


Definition at line 238 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-finalize\-\_\-bget(), bpool(), and brel().

\hypertarget{kmp__alloc_8c_afc0f3f88612de20c4a5510b549c7c73f}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!K\-M\-P\-\_\-\-F\-R\-E\-E\-\_\-\-L\-I\-S\-T\-\_\-\-L\-I\-M\-I\-T@{K\-M\-P\-\_\-\-F\-R\-E\-E\-\_\-\-L\-I\-S\-T\-\_\-\-L\-I\-M\-I\-T}}
\index{K\-M\-P\-\_\-\-F\-R\-E\-E\-\_\-\-L\-I\-S\-T\-\_\-\-L\-I\-M\-I\-T@{K\-M\-P\-\_\-\-F\-R\-E\-E\-\_\-\-L\-I\-S\-T\-\_\-\-L\-I\-M\-I\-T}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{K\-M\-P\-\_\-\-F\-R\-E\-E\-\_\-\-L\-I\-S\-T\-\_\-\-L\-I\-M\-I\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define K\-M\-P\-\_\-\-F\-R\-E\-E\-\_\-\-L\-I\-S\-T\-\_\-\-L\-I\-M\-I\-T~16}}\label{kmp__alloc_8c_afc0f3f88612de20c4a5510b549c7c73f}


Definition at line 1795 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-free().

\hypertarget{kmp__alloc_8c_af312994da10c636eaa83074b49b44b0a}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!M\-A\-X\-\_\-\-B\-G\-E\-T\-\_\-\-B\-I\-N\-S@{M\-A\-X\-\_\-\-B\-G\-E\-T\-\_\-\-B\-I\-N\-S}}
\index{M\-A\-X\-\_\-\-B\-G\-E\-T\-\_\-\-B\-I\-N\-S@{M\-A\-X\-\_\-\-B\-G\-E\-T\-\_\-\-B\-I\-N\-S}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{M\-A\-X\-\_\-\-B\-G\-E\-T\-\_\-\-B\-I\-N\-S}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\-A\-X\-\_\-\-B\-G\-E\-T\-\_\-\-B\-I\-N\-S~({\bf int})(sizeof({\bf bget\-\_\-bin\-\_\-size}) / sizeof({\bf bufsize}))}}\label{kmp__alloc_8c_af312994da10c636eaa83074b49b44b0a}


Definition at line 148 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-free\-\_\-fast\-\_\-memory(), bcheck(), bfreed(), bget(), bget\-\_\-get\-\_\-bin(), and set\-\_\-thr\-\_\-data().

\hypertarget{kmp__alloc_8c_a85633b531a313eee6f1f31eeed4a12ea}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!Max\-Size@{Max\-Size}}
\index{Max\-Size@{Max\-Size}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{Max\-Size}]{\setlength{\rightskip}{0pt plus 5cm}\#define Max\-Size~({\bf bufsize})( $\sim$ ( ( ({\bf bufsize})( 1 ) $<$$<$ ( sizeof( {\bf bufsize} ) $\ast$ C\-H\-A\-R\-\_\-\-B\-I\-T -\/ 1 ) ) $\vert$ ( {\bf Size\-Quant} -\/ 1 ) ) )}}\label{kmp__alloc_8c_a85633b531a313eee6f1f31eeed4a12ea}


Definition at line 231 of file kmp\-\_\-alloc.\-c.



Referenced by bget().

\hypertarget{kmp__alloc_8c_abcbfda7b0f9d0f67003977804e87354a}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!Q\-L\-Size@{Q\-L\-Size}}
\index{Q\-L\-Size@{Q\-L\-Size}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{Q\-L\-Size}]{\setlength{\rightskip}{0pt plus 5cm}\#define Q\-L\-Size~(sizeof({\bf qlinks\-\_\-t}))}}\label{kmp__alloc_8c_abcbfda7b0f9d0f67003977804e87354a}


Definition at line 229 of file kmp\-\_\-alloc.\-c.

\hypertarget{kmp__alloc_8c_a8a8beeffc163eabffc840e0d1ca7be0b}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!Size\-Q@{Size\-Q}}
\index{Size\-Q@{Size\-Q}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{Size\-Q}]{\setlength{\rightskip}{0pt plus 5cm}\#define Size\-Q~(({\bf Size\-Quant} $>$ {\bf Q\-L\-Size}) ? {\bf Size\-Quant} \-: {\bf Q\-L\-Size})}}\label{kmp__alloc_8c_a8a8beeffc163eabffc840e0d1ca7be0b}


Definition at line 230 of file kmp\-\_\-alloc.\-c.



Referenced by bget().

\hypertarget{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!Size\-Quant@{Size\-Quant}}
\index{Size\-Quant@{Size\-Quant}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{Size\-Quant}]{\setlength{\rightskip}{0pt plus 5cm}\#define Size\-Quant~8}}\label{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}


Definition at line 77 of file kmp\-\_\-alloc.\-c.



\subsection{Typedef Documentation}
\hypertarget{kmp__alloc_8c_a76704c34eb0e5bd1bc01a7635661213a}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bdhead\-\_\-t@{bdhead\-\_\-t}}
\index{bdhead\-\_\-t@{bdhead\-\_\-t}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bdhead\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf bdhead}  {\bf bdhead\-\_\-t}}}\label{kmp__alloc_8c_a76704c34eb0e5bd1bc01a7635661213a}
\hypertarget{kmp__alloc_8c_abd11e50b08fcad0d4fbfdce33582213c}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bfhead\-\_\-t@{bfhead\-\_\-t}}
\index{bfhead\-\_\-t@{bfhead\-\_\-t}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bfhead\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf bfhead}  {\bf bfhead\-\_\-t}}}\label{kmp__alloc_8c_abd11e50b08fcad0d4fbfdce33582213c}
\hypertarget{kmp__alloc_8c_a21f03e368c4e90d00ed20a2b01985ecd}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bget\-\_\-acquire\-\_\-t@{bget\-\_\-acquire\-\_\-t}}
\index{bget\-\_\-acquire\-\_\-t@{bget\-\_\-acquire\-\_\-t}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bget\-\_\-acquire\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf void}$\ast$($\ast$ bget\-\_\-acquire\-\_\-t)(size\-\_\-t)}}\label{kmp__alloc_8c_a21f03e368c4e90d00ed20a2b01985ecd}


Definition at line 26 of file kmp\-\_\-alloc.\-c.

\hypertarget{kmp__alloc_8c_a97451db29023098b5723ad1ba00f944f}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bget\-\_\-compact\-\_\-t@{bget\-\_\-compact\-\_\-t}}
\index{bget\-\_\-compact\-\_\-t@{bget\-\_\-compact\-\_\-t}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bget\-\_\-compact\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf int}($\ast$ bget\-\_\-compact\-\_\-t)(size\-\_\-t, {\bf int})}}\label{kmp__alloc_8c_a97451db29023098b5723ad1ba00f944f}


Definition at line 25 of file kmp\-\_\-alloc.\-c.

\hypertarget{kmp__alloc_8c_a625b1696056adee9c191ae4c8fc05f69}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bget\-\_\-mode\-\_\-t@{bget\-\_\-mode\-\_\-t}}
\index{bget\-\_\-mode\-\_\-t@{bget\-\_\-mode\-\_\-t}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bget\-\_\-mode\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef enum {\bf bget\-\_\-mode}  {\bf bget\-\_\-mode\-\_\-t}}}\label{kmp__alloc_8c_a625b1696056adee9c191ae4c8fc05f69}
\hypertarget{kmp__alloc_8c_ad26e5d39dca5e04fbcfb74a022e2fcdb}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bget\-\_\-release\-\_\-t@{bget\-\_\-release\-\_\-t}}
\index{bget\-\_\-release\-\_\-t@{bget\-\_\-release\-\_\-t}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bget\-\_\-release\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf void}($\ast$ bget\-\_\-release\-\_\-t)({\bf void} $\ast$)}}\label{kmp__alloc_8c_ad26e5d39dca5e04fbcfb74a022e2fcdb}


Definition at line 27 of file kmp\-\_\-alloc.\-c.

\hypertarget{kmp__alloc_8c_a9651d02bd00b58901a4d1d9af7df824d}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bhead2\-\_\-t@{bhead2\-\_\-t}}
\index{bhead2\-\_\-t@{bhead2\-\_\-t}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bhead2\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf bhead2}  {\bf bhead2\-\_\-t}}}\label{kmp__alloc_8c_a9651d02bd00b58901a4d1d9af7df824d}
\hypertarget{kmp__alloc_8c_af1de790fdc3ba84111ab8cd6730510bd}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bhead\-\_\-t@{bhead\-\_\-t}}
\index{bhead\-\_\-t@{bhead\-\_\-t}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bhead\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef union {\bf bhead}  {\bf bhead\-\_\-t}}}\label{kmp__alloc_8c_af1de790fdc3ba84111ab8cd6730510bd}
\hypertarget{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bufsize@{bufsize}}
\index{bufsize@{bufsize}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bufsize}]{\setlength{\rightskip}{0pt plus 5cm}typedef ssize\-\_\-t {\bf bufsize}}}\label{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}


Definition at line 38 of file kmp\-\_\-alloc.\-c.

\hypertarget{kmp__alloc_8c_a75b107f3256a7ef2373baada8e39a61e}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!kmp\-\_\-mem\-\_\-descr\-\_\-t@{kmp\-\_\-mem\-\_\-descr\-\_\-t}}
\index{kmp\-\_\-mem\-\_\-descr\-\_\-t@{kmp\-\_\-mem\-\_\-descr\-\_\-t}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{kmp\-\_\-mem\-\_\-descr\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf kmp\-\_\-mem\-\_\-descr} {\bf kmp\-\_\-mem\-\_\-descr\-\_\-t}}}\label{kmp__alloc_8c_a75b107f3256a7ef2373baada8e39a61e}


Definition at line 1558 of file kmp\-\_\-alloc.\-c.

\hypertarget{kmp__alloc_8c_a9059958aafec0d30537fe432f36b6665}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!qlinks\-\_\-t@{qlinks\-\_\-t}}
\index{qlinks\-\_\-t@{qlinks\-\_\-t}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{qlinks\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf qlinks}  {\bf qlinks\-\_\-t}}}\label{kmp__alloc_8c_a9059958aafec0d30537fe432f36b6665}
\hypertarget{kmp__alloc_8c_a1ad7ab39fc834f6749281ea4c3657b95}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!thr\-\_\-data\-\_\-t@{thr\-\_\-data\-\_\-t}}
\index{thr\-\_\-data\-\_\-t@{thr\-\_\-data\-\_\-t}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{thr\-\_\-data\-\_\-t}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf thr\-\_\-data}  {\bf thr\-\_\-data\-\_\-t}}}\label{kmp__alloc_8c_a1ad7ab39fc834f6749281ea4c3657b95}


\subsection{Enumeration Type Documentation}
\hypertarget{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bget\-\_\-mode@{bget\-\_\-mode}}
\index{bget\-\_\-mode@{bget\-\_\-mode}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bget\-\_\-mode}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf bget\-\_\-mode}}}\label{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{bget\-\_\-mode\-\_\-fifo@{bget\-\_\-mode\-\_\-fifo}!kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}}\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bget\-\_\-mode\-\_\-fifo@{bget\-\_\-mode\-\_\-fifo}}\item[{\em 
\hypertarget{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a8432b2f804c3780ca534a4f56e0bf274}{bget\-\_\-mode\-\_\-fifo}\label{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a8432b2f804c3780ca534a4f56e0bf274}
}]\index{bget\-\_\-mode\-\_\-lifo@{bget\-\_\-mode\-\_\-lifo}!kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}}\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bget\-\_\-mode\-\_\-lifo@{bget\-\_\-mode\-\_\-lifo}}\item[{\em 
\hypertarget{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a0cc8593912b5aa9bdac96f437b65e3ea}{bget\-\_\-mode\-\_\-lifo}\label{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a0cc8593912b5aa9bdac96f437b65e3ea}
}]\index{bget\-\_\-mode\-\_\-best@{bget\-\_\-mode\-\_\-best}!kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}}\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bget\-\_\-mode\-\_\-best@{bget\-\_\-mode\-\_\-best}}\item[{\em 
\hypertarget{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a0c883f0544468f73a8cc6606c2ac6b84}{bget\-\_\-mode\-\_\-best}\label{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a0c883f0544468f73a8cc6606c2ac6b84}
}]\end{description}
\end{Desc}


Definition at line 43 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
43                        \{
44     \hyperlink{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a8432b2f804c3780ca534a4f56e0bf274}{bget\_mode\_fifo} = 0,
45     \hyperlink{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a0cc8593912b5aa9bdac96f437b65e3ea}{bget\_mode\_lifo} = 1,
46     \hyperlink{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a0c883f0544468f73a8cc6606c2ac6b84}{bget\_mode\_best} = 2
47 \} \hyperlink{kmp__alloc_8c_a625b1696056adee9c191ae4c8fc05f69}{bget\_mode\_t};
\end{DoxyCode}


\subsection{Function Documentation}
\hypertarget{kmp__alloc_8c_a16ecb5ee9ac361484f422f36b99351b9}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-\-\_\-kmp\-\_\-allocate@{\-\_\-\-\_\-\-\_\-kmp\-\_\-allocate}}
\index{\-\_\-\-\_\-\-\_\-kmp\-\_\-allocate@{\-\_\-\-\_\-\-\_\-kmp\-\_\-allocate}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-\-\_\-kmp\-\_\-allocate}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}$\ast$ \-\_\-\-\_\-\-\_\-kmp\-\_\-allocate (
\begin{DoxyParamCaption}
\item[{size\-\_\-t {\bf size}}]{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_a16ecb5ee9ac361484f422f36b99351b9}


Definition at line 1667 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
1668 \{
1669 
1670     \textcolor{keywordtype}{void} * ptr;
1671     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 25, ( \textcolor{stringliteral}{"-> \_\_kmp\_allocate( %d ) called from %s:%d\(\backslash\)n"}, (\textcolor{keywordtype}{int}) 
      \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} \hyperlink{kmp__wrapper__malloc_8h_a8e8acf780d764886401cd6e1a79ced72}{KMP\_SRC\_LOC\_PARM} ) );
1672         ptr = \hyperlink{kmp__alloc_8c_a822d4a52ca00e29ff21134620b32dd0f}{\_\_\_kmp\_allocate\_align}( \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size}, 
      \hyperlink{kmp_8h_a1ac4cb4725fc46b0396c162e8f568299}{\_\_kmp\_align\_alloc} \hyperlink{kmp__wrapper__malloc_8h_a8e8acf780d764886401cd6e1a79ced72}{KMP\_SRC\_LOC\_PARM} );
1673     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 25, ( \textcolor{stringliteral}{"<- \_\_kmp\_allocate() returns %p\(\backslash\)n"}, ptr ) );
1674     \textcolor{keywordflow}{return} ptr;
1675 
1676 \} \textcolor{comment}{// func \_\_\_kmp\_allocate}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a822d4a52ca00e29ff21134620b32dd0f}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-\-\_\-kmp\-\_\-allocate\-\_\-align@{\-\_\-\-\_\-\-\_\-kmp\-\_\-allocate\-\_\-align}}
\index{\-\_\-\-\_\-\-\_\-kmp\-\_\-allocate\-\_\-align@{\-\_\-\-\_\-\-\_\-kmp\-\_\-allocate\-\_\-align}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-\-\_\-kmp\-\_\-allocate\-\_\-align}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void}$\ast$ \-\_\-\-\_\-\-\_\-kmp\-\_\-allocate\-\_\-align (
\begin{DoxyParamCaption}
\item[{size\-\_\-t}]{size, }
\item[{size\-\_\-t alignment}]{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_a822d4a52ca00e29ff21134620b32dd0f}


Definition at line 1567 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-\-\_\-kmp\-\_\-allocate(), and \-\_\-\-\_\-\-\_\-kmp\-\_\-page\-\_\-allocate().


\begin{DoxyCode}
1568 \{
1569     \textcolor{comment}{/*}
1570 \textcolor{comment}{            \_\_kmp\_allocate() allocates (by call to malloc()) bigger memory block than requested to}
1571 \textcolor{comment}{        return properly aligned pointer. Original pointer returned by malloc() and size of allocated}
1572 \textcolor{comment}{        block is saved in descriptor just before the aligned pointer. This information used by}
1573 \textcolor{comment}{        \_\_kmp\_free() -- it has to pass to free() original pointer, not aligned one.}
1574 \textcolor{comment}{}
1575 \textcolor{comment}{            +---------+------------+-----------------------------------+---------+}
1576 \textcolor{comment}{            | padding | descriptor |           aligned block           | padding |}
1577 \textcolor{comment}{            +---------+------------+-----------------------------------+---------+}
1578 \textcolor{comment}{            ^                      ^}
1579 \textcolor{comment}{            |                      |}
1580 \textcolor{comment}{            |                      +- Aligned pointer returned to caller}
1581 \textcolor{comment}{            +- Pointer returned by malloc()}
1582 \textcolor{comment}{}
1583 \textcolor{comment}{        Aligned block is filled with zeros, paddings are filled with 0xEF.}
1584 \textcolor{comment}{    */}
1585 
1586     \hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t}  descr;
1587     \hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t}    addr\_allocated;        \textcolor{comment}{// Address returned by malloc().}
1588     \hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t}    addr\_aligned;          \textcolor{comment}{// Aligned address to return to caller.}
1589     \hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t}    addr\_descr;            \textcolor{comment}{// Address of memory block descriptor.}
1590 
1591     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 25, (
1592         \textcolor{stringliteral}{"-> \_\_\_kmp\_allocate\_align( %d, %d ) called from %s:%d\(\backslash\)n"},
1593         (\textcolor{keywordtype}{int}) \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size},
1594         (\textcolor{keywordtype}{int}) alignment
1595         \hyperlink{kmp__wrapper__malloc_8h_a8e8acf780d764886401cd6e1a79ced72}{KMP\_SRC\_LOC\_PARM}
1596     ) );
1597 
1598     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( alignment < 32 * 1024 ); \textcolor{comment}{// Alignment should not be too}
1599     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \textcolor{keyword}{sizeof}( \textcolor{keywordtype}{void} * ) <= \textcolor{keyword}{sizeof}( \hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t} ) );
1600         \textcolor{comment}{// Make sure kmp\_uintptr\_t is enough to store addresses.}
1601 
1602     descr.\hyperlink{structkmp__mem__descr_a6050e2806a19c46a0df4418f4df57f9d}{size\_aligned} = \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size};
1603     descr.\hyperlink{structkmp__mem__descr_adaf988fb85d121839a32ce016312ba34}{size\_allocated} = descr.\hyperlink{structkmp__mem__descr_a6050e2806a19c46a0df4418f4df57f9d}{size\_aligned} + \textcolor{keyword}{sizeof}( 
      \hyperlink{kmp__alloc_8c_a75b107f3256a7ef2373baada8e39a61e}{kmp\_mem\_descr\_t} ) + alignment;
1604 
1605 \textcolor{preprocessor}{    #if KMP\_DEBUG}
1606 \textcolor{preprocessor}{}        descr.\hyperlink{structkmp__mem__descr_ad2113fb51705dca6a3f4b35a7842b1e6}{ptr\_allocated} = \hyperlink{kmp__wrapper__malloc_8h_a27f5b69e503839d67cfc06fba3a6d32d}{\_malloc\_src\_loc}( descr.
      \hyperlink{structkmp__mem__descr_adaf988fb85d121839a32ce016312ba34}{size\_allocated}, \_file\_, \_line\_ );
1607 \textcolor{preprocessor}{    #else}
1608 \textcolor{preprocessor}{}    descr.\hyperlink{structkmp__mem__descr_ad2113fb51705dca6a3f4b35a7842b1e6}{ptr\_allocated} = \hyperlink{kmp__wrapper__malloc_8h_a44ae5faab17c19d968713ee886145f18}{malloc\_src\_loc}( descr.
      \hyperlink{structkmp__mem__descr_adaf988fb85d121839a32ce016312ba34}{size\_allocated} \hyperlink{kmp__wrapper__malloc_8h_a8e8acf780d764886401cd6e1a79ced72}{KMP\_SRC\_LOC\_PARM} );
1609 \textcolor{preprocessor}{    #endif}
1610 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, (
1611         \textcolor{stringliteral}{"   malloc( %d ) returned %p\(\backslash\)n"},
1612         (\textcolor{keywordtype}{int}) descr.\hyperlink{structkmp__mem__descr_adaf988fb85d121839a32ce016312ba34}{size\_allocated},
1613         descr.\hyperlink{structkmp__mem__descr_ad2113fb51705dca6a3f4b35a7842b1e6}{ptr\_allocated}
1614     ) );
1615     \textcolor{keywordflow}{if} ( descr.\hyperlink{structkmp__mem__descr_ad2113fb51705dca6a3f4b35a7842b1e6}{ptr\_allocated} == NULL ) \{
1616         \hyperlink{kmp__i18n_8h_aaa06fec585285ef7883baea41bfd948f}{KMP\_FATAL}( OutOfHeapMemory );
1617     \};
1618 
1619     addr\_allocated = (\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t}) descr.\hyperlink{structkmp__mem__descr_ad2113fb51705dca6a3f4b35a7842b1e6}{ptr\_allocated};
1620     addr\_aligned =
1621         ( addr\_allocated + \textcolor{keyword}{sizeof}( \hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t} ) + alignment )
1622         & ~ ( alignment - 1 );
1623     addr\_descr = addr\_aligned - \textcolor{keyword}{sizeof}( \hyperlink{kmp__alloc_8c_a75b107f3256a7ef2373baada8e39a61e}{kmp\_mem\_descr\_t} );
1624 
1625     descr.\hyperlink{structkmp__mem__descr_a0db8f2651ee81d991e488b017a09ad31}{ptr\_aligned} = (\textcolor{keywordtype}{void} *) addr\_aligned;
1626 
1627     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 26, (
1628         \textcolor{stringliteral}{"   \_\_\_kmp\_allocate\_align: "}
1629             \textcolor{stringliteral}{"ptr\_allocated=%p, size\_allocated=%d, "}
1630             \textcolor{stringliteral}{"ptr\_aligned=%p, size\_aligned=%d\(\backslash\)n"},
1631         descr.\hyperlink{structkmp__mem__descr_ad2113fb51705dca6a3f4b35a7842b1e6}{ptr\_allocated},
1632         (\textcolor{keywordtype}{int}) descr.\hyperlink{structkmp__mem__descr_adaf988fb85d121839a32ce016312ba34}{size\_allocated},
1633         descr.\hyperlink{structkmp__mem__descr_a0db8f2651ee81d991e488b017a09ad31}{ptr\_aligned},
1634         (\textcolor{keywordtype}{int}) descr.\hyperlink{structkmp__mem__descr_a6050e2806a19c46a0df4418f4df57f9d}{size\_aligned}
1635     ) );
1636 
1637     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( addr\_allocated <= addr\_descr );
1638     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( addr\_descr + \textcolor{keyword}{sizeof}( \hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t} ) == addr\_aligned
       );
1639     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( addr\_aligned + descr.\hyperlink{structkmp__mem__descr_a6050e2806a19c46a0df4418f4df57f9d}{size\_aligned} <= addr\_allocated + 
      descr.\hyperlink{structkmp__mem__descr_adaf988fb85d121839a32ce016312ba34}{size\_allocated} );
1640     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( addr\_aligned % alignment == 0 );
1641 
1642 \textcolor{preprocessor}{    #ifdef KMP\_DEBUG}
1643 \textcolor{preprocessor}{}        memset( descr.\hyperlink{structkmp__mem__descr_ad2113fb51705dca6a3f4b35a7842b1e6}{ptr\_allocated}, 0xEF, descr.\hyperlink{structkmp__mem__descr_adaf988fb85d121839a32ce016312ba34}{size\_allocated} );
1644             \textcolor{comment}{// Fill allocated memory block with 0xEF.}
1645 \textcolor{preprocessor}{    #endif}
1646 \textcolor{preprocessor}{}    memset( descr.\hyperlink{structkmp__mem__descr_a0db8f2651ee81d991e488b017a09ad31}{ptr\_aligned}, 0x00, descr.\hyperlink{structkmp__mem__descr_a6050e2806a19c46a0df4418f4df57f9d}{size\_aligned} );
1647         \textcolor{comment}{// Fill the aligned memory block (which is intended for using by caller) with 0x00. Do not}
1648         \textcolor{comment}{// put this filling under KMP\_DEBUG condition! Many callers expect zeroed memory. (Padding}
1649         \textcolor{comment}{// bytes remain filled with 0xEF in debugging library.)}
1650     * ( (\hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t} *) addr\_descr ) = descr;
1651 
1652     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();
1653 
1654     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 25, ( \textcolor{stringliteral}{"<- \_\_\_kmp\_allocate\_align() returns %p\(\backslash\)n"}, descr.
      \hyperlink{structkmp__mem__descr_a0db8f2651ee81d991e488b017a09ad31}{ptr\_aligned} ) );
1655     \textcolor{keywordflow}{return} descr.\hyperlink{structkmp__mem__descr_a0db8f2651ee81d991e488b017a09ad31}{ptr\_aligned};
1656 
1657 \} \textcolor{comment}{// func \_\_\_kmp\_allocate\_align}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a151a0fef62d6ede235dab41c5646dee9}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-allocate@{\-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-allocate}}
\index{\-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-allocate@{\-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-allocate}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-allocate}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}$\ast$ \-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-allocate (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{this\-\_\-thr, }
\item[{size\-\_\-t {\bf size}}]{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_a151a0fef62d6ede235dab41c5646dee9}


Definition at line 1801 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
1802 \{
1803     \textcolor{keywordtype}{void}            * ptr;
1804     \textcolor{keywordtype}{int}               num\_lines;
1805     \textcolor{keywordtype}{int}               idx;
1806     \textcolor{keywordtype}{int}               index;
1807     \textcolor{keywordtype}{void}            * alloc\_ptr;
1808     \textcolor{keywordtype}{size\_t}            alloc\_size;
1809     \hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t} * descr;
1810 
1811     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 25, ( \textcolor{stringliteral}{"-> \_\_kmp\_fast\_allocate( T#%d, %d ) called from %s:%d\(\backslash\)n"},
1812       \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}(this\_thr), (\textcolor{keywordtype}{int}) \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} 
      \hyperlink{kmp__wrapper__malloc_8h_a8e8acf780d764886401cd6e1a79ced72}{KMP\_SRC\_LOC\_PARM} ) );
1813 
1814     num\_lines = ( \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} + \hyperlink{kmp__alloc_8c_ac36927727a551119780161c1e25f9287}{DCACHE\_LINE} - 1 ) / \hyperlink{kmp__alloc_8c_ac36927727a551119780161c1e25f9287}{DCACHE\_LINE};
1815     idx = num\_lines - 1;
1816     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( idx >= 0 );
1817     \textcolor{keywordflow}{if} ( idx < 2 ) \{
1818         index = 0;       \textcolor{comment}{// idx is [ 0, 1 ], use first free list}
1819         num\_lines = 2;   \textcolor{comment}{// 1, 2 cache lines or less than cache line}
1820     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ( idx >>= 2 ) == 0 ) \{
1821         index = 1;       \textcolor{comment}{// idx is [ 2, 3 ], use second free list}
1822         num\_lines = 4;   \textcolor{comment}{// 3, 4 cache lines}
1823     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ( idx >>= 2 ) == 0 ) \{
1824         index = 2;       \textcolor{comment}{// idx is [ 4, 15 ], use third free list}
1825         num\_lines = 16;  \textcolor{comment}{// 5, 6, ..., 16 cache lines}
1826     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ( idx >>= 2 ) == 0 ) \{
1827         index = 3;       \textcolor{comment}{// idx is [ 16, 63 ], use fourth free list}
1828         num\_lines = 64;  \textcolor{comment}{// 17, 18, ..., 64 cache lines}
1829     \} \textcolor{keywordflow}{else} \{
1830         \textcolor{keywordflow}{goto} alloc\_call; \textcolor{comment}{// 65 or more cache lines ( > 8KB ), don't use free lists}
1831     \}
1832 
1833     ptr = this\_thr->th.th\_free\_lists[index].th\_free\_list\_self;
1834     \textcolor{keywordflow}{if} ( ptr != NULL ) \{
1835         \textcolor{comment}{// pop the head of no-sync free list}
1836         this\_thr->th.th\_free\_lists[index].th\_free\_list\_self = *((\textcolor{keywordtype}{void} **)ptr);
1837         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( this\_thr ==
1838             ((\hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t} *)( (\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})ptr - \textcolor{keyword}{sizeof}(
      \hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t}) ))->ptr\_aligned );
1839         \textcolor{keywordflow}{goto} end;
1840     \};
1841     ptr = \hyperlink{kmp__os_8h_a4eff9c5e66d3fbb78577292c4c035ffe}{TCR\_SYNC\_PTR}( this\_thr->th.th\_free\_lists[index].th\_free\_list\_sync );
1842     \textcolor{keywordflow}{if} ( ptr != NULL ) \{
1843         \textcolor{comment}{// no-sync free list is empty, use sync free list (filled in by other threads only)}
1844         \textcolor{comment}{// pop the head of the sync free list, push NULL instead}
1845         \textcolor{keywordflow}{while} ( ! \hyperlink{kmp__os_8h_af92c76f93de0f7d6809bf8962ea04ca0}{KMP\_COMPARE\_AND\_STORE\_PTR}(
1846             &this\_thr->th.th\_free\_lists[index].th\_free\_list\_sync, ptr, NULL ) )
1847         \{
1848             \hyperlink{kmp_8h_a0ae7084deafcd923a77e45e93058c459}{KMP\_CPU\_PAUSE}();
1849             ptr = \hyperlink{kmp__os_8h_a4eff9c5e66d3fbb78577292c4c035ffe}{TCR\_SYNC\_PTR}( this\_thr->th.th\_free\_lists[index].th\_free\_list\_sync );
1850         \}
1851         \textcolor{comment}{// push the rest of chain into no-sync free list (can be NULL if there was the only block)}
1852         this\_thr->th.th\_free\_lists[index].th\_free\_list\_self = *((\textcolor{keywordtype}{void} **)ptr);
1853         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( this\_thr ==
1854             ((\hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t} *)( (\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})ptr - \textcolor{keyword}{sizeof}(
      \hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t}) ))->ptr\_aligned );
1855         \textcolor{keywordflow}{goto} end;
1856     \}
1857 
1858     alloc\_call:
1859     \textcolor{comment}{// haven't found block in the free lists, thus allocate it}
1860     \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} = num\_lines * \hyperlink{kmp__alloc_8c_ac36927727a551119780161c1e25f9287}{DCACHE\_LINE};
1861 
1862     alloc\_size = \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} + \textcolor{keyword}{sizeof}( \hyperlink{kmp__alloc_8c_a75b107f3256a7ef2373baada8e39a61e}{kmp\_mem\_descr\_t} ) + DCACHE\_LINE;
1863     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 25, ( \textcolor{stringliteral}{"\_\_kmp\_fast\_allocate: T#%d Calling \_\_kmp\_thread\_malloc with alloc\_size %d\(\backslash\)n"},
1864                    \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( this\_thr ), alloc\_size ) );
1865     alloc\_ptr = \hyperlink{kmp__alloc_8c_ae0f1683e77919d466cf2ea6f7b00ba91}{bget}( this\_thr, (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) alloc\_size );
1866 
1867     \textcolor{comment}{// align ptr to DCACHE\_LINE}
1868     ptr = (\textcolor{keywordtype}{void} *)(( ((\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})alloc\_ptr) + \textcolor{keyword}{sizeof}(
      \hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t}) + DCACHE\_LINE ) & ~( DCACHE\_LINE - 1 ));
1869     descr = (\hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t} *)( ((\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})ptr) - \textcolor{keyword}{sizeof}(
      \hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t}) );
1870 
1871     descr->\hyperlink{structkmp__mem__descr_ad2113fb51705dca6a3f4b35a7842b1e6}{ptr\_allocated} = alloc\_ptr;        \textcolor{comment}{// remember allocated pointer}
1872     \textcolor{comment}{// we don't need size\_allocated}
1873     descr->\hyperlink{structkmp__mem__descr_a0db8f2651ee81d991e488b017a09ad31}{ptr\_aligned}   = (\textcolor{keywordtype}{void} *)this\_thr; \textcolor{comment}{// remember allocating thread}
1874                                              \textcolor{comment}{// (it is already saved in bget buffer,}
1875                                              \textcolor{comment}{// but we may want to use another allocator in future)}
1876     descr->\hyperlink{structkmp__mem__descr_a6050e2806a19c46a0df4418f4df57f9d}{size\_aligned}  = \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size};
1877 
1878     end:
1879     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 25, ( \textcolor{stringliteral}{"<- \_\_kmp\_fast\_allocate( T#%d ) returns %p\(\backslash\)n"},
1880                     \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( this\_thr ), ptr ) );
1881     \textcolor{keywordflow}{return} ptr;
1882 \} \textcolor{comment}{// func \_\_kmp\_fast\_allocate}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_aeee2b922beabc1af38a83c6302d4edb6}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-free@{\-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-free}}
\index{\-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-free@{\-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-free}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-free}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-free (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{this\-\_\-thr, }
\item[{{\bf void} $\ast$ptr}]{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_aeee2b922beabc1af38a83c6302d4edb6}


Definition at line 1887 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
1888 \{
1889     \hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t} * descr;
1890     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}      * alloc\_thr;
1891     \textcolor{keywordtype}{size\_t}            \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size};
1892     \textcolor{keywordtype}{size\_t}            idx;
1893     \textcolor{keywordtype}{int}               index;
1894 
1895     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 25, ( \textcolor{stringliteral}{"-> \_\_kmp\_fast\_free( T#%d, %p ) called from %s:%d\(\backslash\)n"},
1896       \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}(this\_thr), ptr 
      \hyperlink{kmp__wrapper__malloc_8h_a8e8acf780d764886401cd6e1a79ced72}{KMP\_SRC\_LOC\_PARM} ) );
1897     \hyperlink{kmp__debug_8h_a5323a368e8ba273b17c46906dd9ec78c}{KMP\_ASSERT}( ptr != NULL );
1898 
1899     descr = (\hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t} *)( ((\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})ptr) - \textcolor{keyword}{sizeof}(
      \hyperlink{kmp__alloc_8c_a75b107f3256a7ef2373baada8e39a61e}{kmp\_mem\_descr\_t}) );
1900 
1901     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}(26, (\textcolor{stringliteral}{"   \_\_kmp\_fast\_free:     size\_aligned=%d\(\backslash\)n"},
1902                   (\textcolor{keywordtype}{int}) descr->\hyperlink{structkmp__mem__descr_a6050e2806a19c46a0df4418f4df57f9d}{size\_aligned} ) );
1903 
1904     size = descr->\hyperlink{structkmp__mem__descr_a6050e2806a19c46a0df4418f4df57f9d}{size\_aligned}; \textcolor{comment}{// 2, 4, 16, 64, 65, 66, ... cache lines}
1905 
1906     idx = \hyperlink{kmp__alloc_8c_ac36927727a551119780161c1e25f9287}{DCACHE\_LINE} * 2; \textcolor{comment}{// 2 cache lines is minimal size of block}
1907     \textcolor{keywordflow}{if} ( idx == size ) \{
1908         index = 0;       \textcolor{comment}{// 2 cache lines}
1909     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ( idx <<= 1 ) == size ) \{
1910         index = 1;       \textcolor{comment}{// 4 cache lines}
1911     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ( idx <<= 2 ) == size ) \{
1912         index = 2;       \textcolor{comment}{// 16 cache lines}
1913     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( ( idx <<= 2 ) == size ) \{
1914         index = 3;       \textcolor{comment}{// 64 cache lines}
1915     \} \textcolor{keywordflow}{else} \{
1916         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( size > \hyperlink{kmp__alloc_8c_ac36927727a551119780161c1e25f9287}{DCACHE\_LINE} * 64 );
1917         \textcolor{keywordflow}{goto} free\_call;  \textcolor{comment}{// 65 or more cache lines ( > 8KB )}
1918     \}
1919 
1920     alloc\_thr = (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *)descr->\hyperlink{structkmp__mem__descr_a0db8f2651ee81d991e488b017a09ad31}{ptr\_aligned}; \textcolor{comment}{// get thread owning the block}
1921     if ( alloc\_thr == this\_thr ) \{
1922         \textcolor{comment}{// push block to self no-sync free list, linking previous head (LIFO)}
1923         *((\textcolor{keywordtype}{void} **)ptr) = this\_thr->th.th\_free\_lists[index].th\_free\_list\_self;
1924         this\_thr->th.th\_free\_lists[index].th\_free\_list\_self = ptr;
1925     \} \textcolor{keywordflow}{else} \{
1926         \textcolor{keywordtype}{void} * \hyperlink{ittnotify__static_8h_ac73017ec329810f133ecdb16b66e5208}{head} = this\_thr->th.th\_free\_lists[index].th\_free\_list\_other;
1927         \textcolor{keywordflow}{if} ( head == NULL ) \{
1928             \textcolor{comment}{// Create new free list}
1929             this\_thr->th.th\_free\_lists[index].th\_free\_list\_other = ptr;
1930             *((\textcolor{keywordtype}{void} **)ptr) = NULL;             \textcolor{comment}{// mark the tail of the list}
1931             descr->\hyperlink{structkmp__mem__descr_adaf988fb85d121839a32ce016312ba34}{size\_allocated} = (size\_t)1;  \textcolor{comment}{// head of the list keeps its length}
1932         \} \textcolor{keywordflow}{else} \{
1933             \textcolor{comment}{// need to check existed "other" list's owner thread and size of queue}
1934             \hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t} * dsc  = (\hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t} *)( (\textcolor{keywordtype}{char}*)head - \textcolor{keyword}{
      sizeof}(\hyperlink{kmp__alloc_8c_a75b107f3256a7ef2373baada8e39a61e}{kmp\_mem\_descr\_t}) );
1935             \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}      * q\_th = (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *)(dsc->
      \hyperlink{structkmp__mem__descr_a0db8f2651ee81d991e488b017a09ad31}{ptr\_aligned}); \textcolor{comment}{// allocating thread, same for all queue nodes}
1936             \textcolor{keywordtype}{size\_t}            q\_sz = dsc->\hyperlink{structkmp__mem__descr_adaf988fb85d121839a32ce016312ba34}{size\_allocated} + 1;          \textcolor{comment}{// new size in case we
       add current task}
1937             \textcolor{keywordflow}{if} ( q\_th == alloc\_thr && q\_sz <= \hyperlink{kmp__alloc_8c_afc0f3f88612de20c4a5510b549c7c73f}{KMP\_FREE\_LIST\_LIMIT} ) \{
1938                 \textcolor{comment}{// we can add current task to "other" list, no sync needed}
1939                 *((\textcolor{keywordtype}{void} **)ptr) = \hyperlink{ittnotify__static_8h_ac73017ec329810f133ecdb16b66e5208}{head};
1940                 descr->\hyperlink{structkmp__mem__descr_adaf988fb85d121839a32ce016312ba34}{size\_allocated} = q\_sz;
1941                 this\_thr->th.th\_free\_lists[index].th\_free\_list\_other = ptr;
1942             \} \textcolor{keywordflow}{else} \{
1943                 \textcolor{comment}{// either queue blocks owner is changing or size limit exceeded}
1944                 \textcolor{comment}{// return old queue to allocating thread (q\_th) synchroneously,}
1945                 \textcolor{comment}{// and start new list for alloc\_thr's tasks}
1946                 \textcolor{keywordtype}{void} * old\_ptr;
1947                 \textcolor{keywordtype}{void} * \hyperlink{ittnotify__static_8h_a7205a2ef1da3b41743f40e66ffb8a1be}{tail} = \hyperlink{ittnotify__static_8h_ac73017ec329810f133ecdb16b66e5208}{head};
1948                 \textcolor{keywordtype}{void} * \hyperlink{structshared__common_aa54da923f39ba340f472b4a62205b967}{next} = *((\textcolor{keywordtype}{void} **)head);
1949                 \textcolor{keywordflow}{while} ( next != NULL ) \{
1950                     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(
1951                         \textcolor{comment}{// queue size should decrease by 1 each step through the list}
1952                         ((\hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t}*)((\textcolor{keywordtype}{char}*)next - \textcolor{keyword}{sizeof}(
      \hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t})))->size\_allocated + 1 ==
1953                         ((\hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t}*)((\textcolor{keywordtype}{char}*)tail - \textcolor{keyword}{sizeof}(
      \hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t})))->size\_allocated );
1954                     tail = \hyperlink{structshared__common_aa54da923f39ba340f472b4a62205b967}{next};   \textcolor{comment}{// remember tail node}
1955                     next = *((\textcolor{keywordtype}{void} **)next);
1956                 \}
1957                 \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( q\_th != NULL );
1958                 \textcolor{comment}{// push block to owner's sync free list}
1959                 old\_ptr = \hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}( q\_th->th.th\_free\_lists[index].th\_free\_list\_sync );
1960                 \textcolor{comment}{/* the next pointer must be set before setting free\_list to ptr to avoid}
1961 \textcolor{comment}{                   exposing a broken list to other threads, even for an instant. */}
1962                 *((\textcolor{keywordtype}{void} **)tail) = old\_ptr;
1963 
1964                 \textcolor{keywordflow}{while} ( ! \hyperlink{kmp__os_8h_af92c76f93de0f7d6809bf8962ea04ca0}{KMP\_COMPARE\_AND\_STORE\_PTR}(
1965                     &q\_th->th.th\_free\_lists[index].th\_free\_list\_sync,
1966                     old\_ptr,
1967                     head ) )
1968                 \{
1969                     \hyperlink{kmp_8h_a0ae7084deafcd923a77e45e93058c459}{KMP\_CPU\_PAUSE}();
1970                     old\_ptr = \hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}( q\_th->th.th\_free\_lists[index].th\_free\_list\_sync );
1971                     *((\textcolor{keywordtype}{void} **)tail) = old\_ptr;
1972                 \}
1973 
1974                 \textcolor{comment}{// start new list of not-selt tasks}
1975                 this\_thr->th.th\_free\_lists[index].th\_free\_list\_other = ptr;
1976                 *((\textcolor{keywordtype}{void} **)ptr) = NULL;
1977                 descr->\hyperlink{structkmp__mem__descr_adaf988fb85d121839a32ce016312ba34}{size\_allocated} = (size\_t)1;  \textcolor{comment}{// head of queue keeps its length}
1978             \}
1979         \}
1980     \}
1981     \textcolor{keywordflow}{goto} end;
1982 
1983     free\_call:
1984     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}(25, ( \textcolor{stringliteral}{"\_\_kmp\_fast\_free: T#%d Calling \_\_kmp\_thread\_free for size %d\(\backslash\)n"},
1985                    \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( this\_thr), size ) );
1986     \hyperlink{kmp__alloc_8c_a2051eee971259559ffd8406822786ab2}{\_\_kmp\_bget\_dequeue}( this\_thr );         \textcolor{comment}{/* Release any queued buffers */}
1987     \hyperlink{kmp__alloc_8c_abebcbe8d8488d54668527825b2663666}{brel}( this\_thr, descr->\hyperlink{structkmp__mem__descr_ad2113fb51705dca6a3f4b35a7842b1e6}{ptr\_allocated} );
1988 
1989     end:
1990     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 25, ( \textcolor{stringliteral}{"<- \_\_kmp\_fast\_free() returns\(\backslash\)n"} ) );
1991 
1992 \} \textcolor{comment}{// func \_\_kmp\_fast\_free}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_afdbadd7841e7011920a1dba5dcc0ff61}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-\-\_\-kmp\-\_\-free@{\-\_\-\-\_\-\-\_\-kmp\-\_\-free}}
\index{\-\_\-\-\_\-\-\_\-kmp\-\_\-free@{\-\_\-\-\_\-\-\_\-kmp\-\_\-free}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-\-\_\-kmp\-\_\-free}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-\-\_\-kmp\-\_\-free (
\begin{DoxyParamCaption}
\item[{{\bf void} $\ast$ptr}]{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_afdbadd7841e7011920a1dba5dcc0ff61}


Definition at line 1739 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
1740 \{
1741 
1742         \hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t} descr;
1743         \hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t}   addr\_allocated;        \textcolor{comment}{// Address returned by malloc().}
1744         \hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t}   addr\_aligned;          \textcolor{comment}{// Aligned address passed by caller.}
1745 
1746         \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 25, ( \textcolor{stringliteral}{"-> \_\_kmp\_free( %p ) called from %s:%d\(\backslash\)n"}, ptr 
      \hyperlink{kmp__wrapper__malloc_8h_a8e8acf780d764886401cd6e1a79ced72}{KMP\_SRC\_LOC\_PARM} ) );
1747         \hyperlink{kmp__debug_8h_a5323a368e8ba273b17c46906dd9ec78c}{KMP\_ASSERT}( ptr != NULL );
1748 
1749         descr = * ( \hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t} *) ( (\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t}) ptr - \textcolor{keyword}{sizeof}( 
      \hyperlink{kmp__alloc_8c_a75b107f3256a7ef2373baada8e39a61e}{kmp\_mem\_descr\_t} ) );
1750 
1751         \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 26, ( \textcolor{stringliteral}{"   \_\_kmp\_free:     "}
1752                         \textcolor{stringliteral}{"ptr\_allocated=%p, size\_allocated=%d, "}
1753                         \textcolor{stringliteral}{"ptr\_aligned=%p, size\_aligned=%d\(\backslash\)n"},
1754                         descr.\hyperlink{structkmp__mem__descr_ad2113fb51705dca6a3f4b35a7842b1e6}{ptr\_allocated}, (\textcolor{keywordtype}{int}) descr.
      \hyperlink{structkmp__mem__descr_adaf988fb85d121839a32ce016312ba34}{size\_allocated},
1755                         descr.\hyperlink{structkmp__mem__descr_a0db8f2651ee81d991e488b017a09ad31}{ptr\_aligned}, (\textcolor{keywordtype}{int}) descr.\hyperlink{structkmp__mem__descr_a6050e2806a19c46a0df4418f4df57f9d}{size\_aligned} ));
1756 
1757         addr\_allocated = (\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t}) descr.\hyperlink{structkmp__mem__descr_ad2113fb51705dca6a3f4b35a7842b1e6}{ptr\_allocated};
1758         addr\_aligned   = (\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t}) descr.\hyperlink{structkmp__mem__descr_a0db8f2651ee81d991e488b017a09ad31}{ptr\_aligned};
1759 
1760         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( addr\_aligned % \hyperlink{kmp__os_8h_a86194c659a2d795e5f5949d293ae4661}{CACHE\_LINE} == 0 );
1761         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( descr.\hyperlink{structkmp__mem__descr_a0db8f2651ee81d991e488b017a09ad31}{ptr\_aligned} == ptr );
1762         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( addr\_allocated + \textcolor{keyword}{sizeof}( 
      \hyperlink{structkmp__mem__descr}{kmp\_mem\_descr\_t} ) <= addr\_aligned );
1763         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( descr.\hyperlink{structkmp__mem__descr_a6050e2806a19c46a0df4418f4df57f9d}{size\_aligned} < descr.
      \hyperlink{structkmp__mem__descr_adaf988fb85d121839a32ce016312ba34}{size\_allocated} );
1764         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( addr\_aligned + descr.\hyperlink{structkmp__mem__descr_a6050e2806a19c46a0df4418f4df57f9d}{size\_aligned} <= addr\_allocated +
       descr.\hyperlink{structkmp__mem__descr_adaf988fb85d121839a32ce016312ba34}{size\_allocated} );
1765 
1766 \textcolor{preprocessor}{        #ifdef KMP\_DEBUG}
1767 \textcolor{preprocessor}{}            memset( descr.\hyperlink{structkmp__mem__descr_ad2113fb51705dca6a3f4b35a7842b1e6}{ptr\_allocated}, 0xEF, descr.\hyperlink{structkmp__mem__descr_adaf988fb85d121839a32ce016312ba34}{size\_allocated} );
1768                 \textcolor{comment}{// Fill memory block with 0xEF, it helps catch using freed memory.}
1769 \textcolor{preprocessor}{        #endif}
1770 \textcolor{preprocessor}{}
1771 \textcolor{preprocessor}{        #ifndef LEAK\_MEMORY}
1772 \textcolor{preprocessor}{}            \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, ( \textcolor{stringliteral}{"   free( %p )\(\backslash\)n"}, descr.\hyperlink{structkmp__mem__descr_ad2113fb51705dca6a3f4b35a7842b1e6}{ptr\_allocated} ) );
1773 \textcolor{preprocessor}{        # ifdef KMP\_DEBUG}
1774 \textcolor{preprocessor}{}            \hyperlink{kmp__wrapper__malloc_8h_a467fc47971dce13e483bba1c8b6127ed}{\_free\_src\_loc}( descr.\hyperlink{structkmp__mem__descr_ad2113fb51705dca6a3f4b35a7842b1e6}{ptr\_allocated}, \_file\_, \_line\_ );
1775 \textcolor{preprocessor}{        # else}
1776 \textcolor{preprocessor}{}            \hyperlink{kmp__wrapper__malloc_8h_af89060dc222d61b823313728b8cd0de3}{free\_src\_loc}( descr.\hyperlink{structkmp__mem__descr_ad2113fb51705dca6a3f4b35a7842b1e6}{ptr\_allocated} 
      \hyperlink{kmp__wrapper__malloc_8h_a8e8acf780d764886401cd6e1a79ced72}{KMP\_SRC\_LOC\_PARM} );
1777 \textcolor{preprocessor}{        # endif}
1778 \textcolor{preprocessor}{}\textcolor{preprocessor}{        #endif}
1779 \textcolor{preprocessor}{}
1780     \hyperlink{kmp__os_8h_ab19ae0836bf2f1ac24e5cfc97c6d7d41}{KMP\_MB}();
1781 
1782     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 25, ( \textcolor{stringliteral}{"<- \_\_kmp\_free() returns\(\backslash\)n"} ) );
1783 
1784 \} \textcolor{comment}{// func \_\_\_kmp\_free}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_ae074d7b6f2575fa391a6754ef53f84db}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-\-\_\-kmp\-\_\-page\-\_\-allocate@{\-\_\-\-\_\-\-\_\-kmp\-\_\-page\-\_\-allocate}}
\index{\-\_\-\-\_\-\-\_\-kmp\-\_\-page\-\_\-allocate@{\-\_\-\-\_\-\-\_\-kmp\-\_\-page\-\_\-allocate}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-\-\_\-kmp\-\_\-page\-\_\-allocate}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}$\ast$ \-\_\-\-\_\-\-\_\-kmp\-\_\-page\-\_\-allocate (
\begin{DoxyParamCaption}
\item[{size\-\_\-t {\bf size}}]{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_ae074d7b6f2575fa391a6754ef53f84db}


Definition at line 1719 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
1720 \{
1721     \textcolor{keywordtype}{int}    page\_size = 8 * 1024;
1722     \textcolor{keywordtype}{void} * ptr;
1723 
1724     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 25, (
1725         \textcolor{stringliteral}{"-> \_\_kmp\_page\_allocate( %d ) called from %s:%d\(\backslash\)n"},
1726         (\textcolor{keywordtype}{int}) \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size}
1727         \hyperlink{kmp__wrapper__malloc_8h_a8e8acf780d764886401cd6e1a79ced72}{KMP\_SRC\_LOC\_PARM}
1728     ) );
1729         ptr = \hyperlink{kmp__alloc_8c_a822d4a52ca00e29ff21134620b32dd0f}{\_\_\_kmp\_allocate\_align}( \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size}, page\_size 
      \hyperlink{kmp__wrapper__malloc_8h_a8e8acf780d764886401cd6e1a79ced72}{KMP\_SRC\_LOC\_PARM} );
1730     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 25, ( \textcolor{stringliteral}{"<- \_\_kmp\_page\_allocate( %d ) returns %p\(\backslash\)n"}, (\textcolor{keywordtype}{int}) 
      \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size}, ptr ) );
1731     \textcolor{keywordflow}{return} ptr;
1732 \} \textcolor{comment}{// \_\_\_kmp\_page\_allocate}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a7a0ca945818a041ebac977dfe81b1aa4}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-calloc@{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-calloc}}
\index{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-calloc@{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-calloc}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-calloc}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}$\ast$ \-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-calloc (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{size\-\_\-t}]{nelem, }
\item[{size\-\_\-t elsize}]{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_a7a0ca945818a041ebac977dfe81b1aa4}


Definition at line 1498 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
1499 \{
1500     \textcolor{keywordtype}{void} * ptr;
1501     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 30, (
1502         \textcolor{stringliteral}{"-> \_\_kmp\_thread\_calloc( %p, %d, %d ) called from %s:%d\(\backslash\)n"},
1503         th,
1504         (\textcolor{keywordtype}{int}) nelem,
1505         (\textcolor{keywordtype}{int}) elsize
1506         \hyperlink{kmp__wrapper__malloc_8h_a8e8acf780d764886401cd6e1a79ced72}{KMP\_SRC\_LOC\_PARM}
1507     ) );
1508         ptr = \hyperlink{kmp__alloc_8c_a9dd8baceae832aef6e56a510f40d7f2b}{bgetz}( th, (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) (nelem * elsize) );
1509     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 30, ( \textcolor{stringliteral}{"<- \_\_kmp\_thread\_calloc() returns %p\(\backslash\)n"}, ptr ) );
1510     \textcolor{keywordflow}{return} ptr;
1511 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a0523a918f8baa0f63606807121dc1448}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-free@{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-free}}
\index{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-free@{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-free}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-free}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-free (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{{\bf void} $\ast$ptr}]{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_a0523a918f8baa0f63606807121dc1448}


Definition at line 1529 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
1530 \{
1531     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 30, (
1532         \textcolor{stringliteral}{"-> \_\_kmp\_thread\_free( %p, %p ) called from %s:%d\(\backslash\)n"},
1533         th,
1534         ptr
1535         \hyperlink{kmp__wrapper__malloc_8h_a8e8acf780d764886401cd6e1a79ced72}{KMP\_SRC\_LOC\_PARM}
1536     ) );
1537     \textcolor{keywordflow}{if} ( ptr != NULL ) \{
1538             \hyperlink{kmp__alloc_8c_a2051eee971259559ffd8406822786ab2}{\_\_kmp\_bget\_dequeue}( th );         \textcolor{comment}{/* Release any queued buffers */}
1539             \hyperlink{kmp__alloc_8c_abebcbe8d8488d54668527825b2663666}{brel}( th, ptr );
1540     \}
1541     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 30, ( \textcolor{stringliteral}{"<- \_\_kmp\_thread\_free()\(\backslash\)n"} ) );
1542 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_af77f5b6cf8034f5c85bf9f2b2d062f64}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-malloc@{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-malloc}}
\index{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-malloc@{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-malloc}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-malloc}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}$\ast$ \-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-malloc (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{size\-\_\-t {\bf size}}]{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_af77f5b6cf8034f5c85bf9f2b2d062f64}


Definition at line 1483 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
1484 \{
1485     \textcolor{keywordtype}{void} * ptr;
1486     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 30, (
1487         \textcolor{stringliteral}{"-> \_\_kmp\_thread\_malloc( %p, %d ) called from %s:%d\(\backslash\)n"},
1488         th,
1489         (\textcolor{keywordtype}{int}) \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size}
1490         \hyperlink{kmp__wrapper__malloc_8h_a8e8acf780d764886401cd6e1a79ced72}{KMP\_SRC\_LOC\_PARM}
1491     ) );
1492         ptr = \hyperlink{kmp__alloc_8c_ae0f1683e77919d466cf2ea6f7b00ba91}{bget}( th, (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} );
1493     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 30, ( \textcolor{stringliteral}{"<- \_\_kmp\_thread\_malloc() returns %p\(\backslash\)n"}, ptr ) );
1494     \textcolor{keywordflow}{return} ptr;
1495 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a61189ab93e8180bc69c1181c3ed1786d}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-realloc@{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-realloc}}
\index{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-realloc@{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-realloc}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-realloc}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}$\ast$ \-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-realloc (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{{\bf void} $\ast$}]{ptr, }
\item[{size\-\_\-t {\bf size}}]{K\-M\-P\-\_\-\-S\-R\-C\-\_\-\-L\-O\-C\-\_\-\-D\-E\-C\-L}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_a61189ab93e8180bc69c1181c3ed1786d}


Definition at line 1514 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
1515 \{
1516     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 30, (
1517         \textcolor{stringliteral}{"-> \_\_kmp\_thread\_realloc( %p, %p, %d ) called from %s:%d\(\backslash\)n"},
1518         th,
1519         ptr,
1520         (\textcolor{keywordtype}{int}) \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size}
1521         \hyperlink{kmp__wrapper__malloc_8h_a8e8acf780d764886401cd6e1a79ced72}{KMP\_SRC\_LOC\_PARM}
1522     ) );
1523         ptr = \hyperlink{kmp__alloc_8c_aba99d2a2a6154f7f8c1f957755bcbb48}{bgetr}( th, ptr, (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} );
1524     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 30, ( \textcolor{stringliteral}{"<- \_\_kmp\_thread\_realloc() returns %p\(\backslash\)n"}, ptr ) );
1525     \textcolor{keywordflow}{return} ptr;
1526 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a2051eee971259559ffd8406822786ab2}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-kmp\-\_\-bget\-\_\-dequeue@{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-dequeue}}
\index{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-dequeue@{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-dequeue}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-dequeue}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-bget\-\_\-dequeue (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_a2051eee971259559ffd8406822786ab2}


Definition at line 329 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-free(), \-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-free(), \-\_\-\-\_\-kmp\-\_\-free\-\_\-fast\-\_\-memory(), bget(), bpool(), kmpc\-\_\-free(), kmpc\-\_\-get\-\_\-poolstat(), and kmpc\-\_\-poolprint().


\begin{DoxyCode}
330 \{
331     \textcolor{keywordtype}{void} *\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p} = \hyperlink{kmp__os_8h_a4eff9c5e66d3fbb78577292c4c035ffe}{TCR\_SYNC\_PTR}(th->th.th\_local.bget\_list);
332 
333     \textcolor{keywordflow}{if} (p != 0) \{
334 \textcolor{preprocessor}{        #if USE\_CMP\_XCHG\_FOR\_BGET}
335 \textcolor{preprocessor}{}            \{
336                 \textcolor{keyword}{volatile} \textcolor{keywordtype}{void} *old\_value = \hyperlink{kmp__os_8h_a4eff9c5e66d3fbb78577292c4c035ffe}{TCR\_SYNC\_PTR}(th->th.th\_local.bget\_list);
337                 \textcolor{keywordflow}{while} ( ! \hyperlink{kmp__os_8h_af92c76f93de0f7d6809bf8962ea04ca0}{KMP\_COMPARE\_AND\_STORE\_PTR}(
338                     & th->th.th\_local.bget\_list, old\_value, NULL ) )
339                 \{
340                     \hyperlink{kmp_8h_a0ae7084deafcd923a77e45e93058c459}{KMP\_CPU\_PAUSE}();
341                     old\_value = \hyperlink{kmp__os_8h_a4eff9c5e66d3fbb78577292c4c035ffe}{TCR\_SYNC\_PTR}(th->th.th\_local.bget\_list);
342                 \}
343                 p = (\textcolor{keywordtype}{void} *) old\_value;
344             \}
345 \textcolor{preprocessor}{        #else }\textcolor{comment}{/* ! USE\_CMP\_XCHG\_FOR\_BGET */}\textcolor{preprocessor}{}
346 \textcolor{preprocessor}{}\textcolor{preprocessor}{            #ifdef USE\_QUEUING\_LOCK\_FOR\_BGET}
347 \textcolor{preprocessor}{}                \hyperlink{kmp__lock_8h_a0eb3c836f2c88a4b8cad9535b53bafe0}{\_\_kmp\_acquire\_lock}( & th->th.th\_local.bget\_lock,
348                                     \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}(th) );
349 \textcolor{preprocessor}{            #else}
350 \textcolor{preprocessor}{}                \hyperlink{kmp__lock_8h_a85412da5c0d085bde951a77690cf1f74}{\_\_kmp\_acquire\_bootstrap\_lock}( & th->th.th\_local.bget\_lock );
351 \textcolor{preprocessor}{            #endif }\textcolor{comment}{/* USE\_QUEUING\_LOCK\_FOR\_BGET */}\textcolor{preprocessor}{}
352 \textcolor{preprocessor}{}
353              p = (\textcolor{keywordtype}{void} *) th->th.th\_local.bget\_list;
354              th->th.th\_local.bget\_list = 0;
355 
356             #ifdef USE\_QUEUING\_LOCK\_FOR\_BGET
357                 \hyperlink{kmp__lock_8h_ab32472fcbb6de6d99adb9fbbdaf5a39a}{\_\_kmp\_release\_lock}( & th->th.th\_local.bget\_lock,
358                                     \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}(th) );
359 \textcolor{preprocessor}{            #else}
360 \textcolor{preprocessor}{}                \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( & th->th.th\_local.bget\_lock );
361 \textcolor{preprocessor}{            #endif}
362 \textcolor{preprocessor}{}\textcolor{preprocessor}{        #endif }\textcolor{comment}{/* USE\_CMP\_XCHG\_FOR\_BGET */}\textcolor{preprocessor}{}
363 \textcolor{preprocessor}{}
364         \textcolor{comment}{/* Check again to make sure the list is not empty */}
365 
366         \textcolor{keywordflow}{while} (p != 0) \{
367             \textcolor{keywordtype}{void} *buf = \hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p};
368             \hyperlink{structbfhead}{bfhead\_t} *b = \hyperlink{kmp__alloc_8c_af6ff720178dbca05767d51fd5c087228}{BFH}(((\textcolor{keywordtype}{char} *) p) - \textcolor{keyword}{sizeof}(\hyperlink{unionbhead}{bhead\_t}));
369 
370             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} != 0 );
371             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( ( (\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})
      \hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}(b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a641b1866310f899813f98a52a287a32e}{bthr}) & ~1 ) ==
372                                 (\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})th ); \textcolor{comment}{// clear possible mark}
373             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink} == 0 );
374 
375             p = (\textcolor{keywordtype}{void} *) b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink};
376 
377             \hyperlink{kmp__alloc_8c_abebcbe8d8488d54668527825b2663666}{brel}( th, buf );
378         \}
379     \}
380 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a2bf0c38164ca2a6de8b52558386141bc}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-kmp\-\_\-bget\-\_\-enqueue@{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-enqueue}}
\index{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-enqueue@{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-enqueue}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-enqueue}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-bget\-\_\-enqueue (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{{\bf void} $\ast$}]{buf}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_a2bf0c38164ca2a6de8b52558386141bc}


Definition at line 385 of file kmp\-\_\-alloc.\-c.



Referenced by brel().


\begin{DoxyCode}
390 \{
391     \hyperlink{structbfhead}{bfhead\_t} *b = \hyperlink{kmp__alloc_8c_af6ff720178dbca05767d51fd5c087228}{BFH}(((\textcolor{keywordtype}{char} *) buf) - \textcolor{keyword}{sizeof}(\hyperlink{unionbhead}{bhead\_t}));
392 
393     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} != 0 );
394     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( ( (\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})\hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}(b->
      \hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a641b1866310f899813f98a52a287a32e}{bthr}) & ~1 ) ==
395                         (\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})th ); \textcolor{comment}{// clear possible mark}
396 
397     b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink} = 0;
398 
399     \hyperlink{kmp__debug_8h_ab49eefbf8c74cfe98a90ce7ec8864add}{KC\_TRACE}( 10, ( \textcolor{stringliteral}{"\_\_kmp\_bget\_enqueue: moving buffer to T#%d list\(\backslash\)n"},
400                     \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( th ) ) );
401 
402 \textcolor{preprocessor}{#if USE\_CMP\_XCHG\_FOR\_BGET}
403 \textcolor{preprocessor}{}    \{
404         \textcolor{keyword}{volatile} \textcolor{keywordtype}{void} *old\_value = \hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}(th->th.th\_local.bget\_list);
405         \textcolor{comment}{/* the next pointer must be set before setting bget\_list to buf to avoid}
406 \textcolor{comment}{           exposing a broken list to other threads, even for an instant. */}
407         b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink} = \hyperlink{kmp__alloc_8c_af6ff720178dbca05767d51fd5c087228}{BFH}( old\_value );
408 
409         \textcolor{keywordflow}{while} ( ! \hyperlink{kmp__os_8h_af92c76f93de0f7d6809bf8962ea04ca0}{KMP\_COMPARE\_AND\_STORE\_PTR}(
410             & th->th.th\_local.bget\_list, old\_value, buf ) )
411         \{
412             \hyperlink{kmp_8h_a0ae7084deafcd923a77e45e93058c459}{KMP\_CPU\_PAUSE}();
413             old\_value = \hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}(th->th.th\_local.bget\_list);
414             \textcolor{comment}{/* the next pointer must be set before setting bget\_list to buf to avoid}
415 \textcolor{comment}{               exposing a broken list to other threads, even for an instant. */}
416             b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink} = \hyperlink{kmp__alloc_8c_af6ff720178dbca05767d51fd5c087228}{BFH}( old\_value );
417         \}
418     \}
419 \textcolor{preprocessor}{#else }\textcolor{comment}{/* ! USE\_CMP\_XCHG\_FOR\_BGET */}\textcolor{preprocessor}{}
420 \textcolor{preprocessor}{}\textcolor{preprocessor}{# ifdef USE\_QUEUING\_LOCK\_FOR\_BGET}
421 \textcolor{preprocessor}{}    \hyperlink{kmp__lock_8h_a0eb3c836f2c88a4b8cad9535b53bafe0}{\_\_kmp\_acquire\_lock}( & th->th.th\_local.bget\_lock, rel\_gtid );
422 \textcolor{preprocessor}{# else}
423 \textcolor{preprocessor}{}    \hyperlink{kmp__lock_8h_a85412da5c0d085bde951a77690cf1f74}{\_\_kmp\_acquire\_bootstrap\_lock}( & th->th.th\_local.bget\_lock );
424 \textcolor{preprocessor}{ # endif}
425 \textcolor{preprocessor}{}
426     b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink} = \hyperlink{kmp__alloc_8c_af6ff720178dbca05767d51fd5c087228}{BFH}( th->th.th\_local.bget\_list );
427     th->th.th\_local.bget\_list = (\textcolor{keywordtype}{void} *) buf;
428 
429 \textcolor{preprocessor}{# ifdef USE\_QUEUING\_LOCK\_FOR\_BGET}
430 \textcolor{preprocessor}{}    \hyperlink{kmp__lock_8h_ab32472fcbb6de6d99adb9fbbdaf5a39a}{\_\_kmp\_release\_lock}( & th->th.th\_local.bget\_lock, rel\_gtid );
431 \textcolor{preprocessor}{# else}
432 \textcolor{preprocessor}{}    \hyperlink{kmp__lock_8h_a058b93e191c678dfe3e0b98bee82ff9b}{\_\_kmp\_release\_bootstrap\_lock}( & th->th.th\_local.bget\_lock );
433 \textcolor{preprocessor}{# endif}
434 \textcolor{preprocessor}{}\textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_CMP\_XCHG\_FOR\_BGET */}\textcolor{preprocessor}{}
435 \textcolor{preprocessor}{}\}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a6f80c5ae5feca086c056b4b9b0f8d30c}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-kmp\-\_\-bget\-\_\-insert\-\_\-into\-\_\-freelist@{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-insert\-\_\-into\-\_\-freelist}}
\index{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-insert\-\_\-into\-\_\-freelist@{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-insert\-\_\-into\-\_\-freelist}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-insert\-\_\-into\-\_\-freelist}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-bget\-\_\-insert\-\_\-into\-\_\-freelist (
\begin{DoxyParamCaption}
\item[{{\bf thr\-\_\-data\-\_\-t} $\ast$}]{thr, }
\item[{{\bf bfhead\-\_\-t} $\ast$}]{b}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_a6f80c5ae5feca086c056b4b9b0f8d30c}


Definition at line 440 of file kmp\-\_\-alloc.\-c.



Referenced by bget(), bpool(), and brel().


\begin{DoxyCode}
441 \{
442     \textcolor{keywordtype}{int} bin;
443 
444     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( ((\textcolor{keywordtype}{size\_t})b ) % \hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{SizeQuant} == 0 );
445     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} % \hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{SizeQuant} == 0 );
446 
447     bin = \hyperlink{kmp__alloc_8c_adf61a5be00012037243154c36d331eff}{bget\_get\_bin}( b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} );
448 
449     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ].\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink}->
      \hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink} == &thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ]);
450     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ].\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink}->
      \hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink} == &thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ]);
451 
452     b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink} = &thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ];
453     b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink} = thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ].\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink};
454 
455     thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ].\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink} = b;
456     b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink}->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink} = b;
457 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a2a12a9c925f14056c5bdc6c7726485cb}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-kmp\-\_\-bget\-\_\-remove\-\_\-from\-\_\-freelist@{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-remove\-\_\-from\-\_\-freelist}}
\index{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-remove\-\_\-from\-\_\-freelist@{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-remove\-\_\-from\-\_\-freelist}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-bget\-\_\-remove\-\_\-from\-\_\-freelist}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} \-\_\-\-\_\-kmp\-\_\-bget\-\_\-remove\-\_\-from\-\_\-freelist (
\begin{DoxyParamCaption}
\item[{{\bf bfhead\-\_\-t} $\ast$}]{b}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_a2a12a9c925f14056c5bdc6c7726485cb}


Definition at line 462 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-finalize\-\_\-bget(), bget(), and brel().


\begin{DoxyCode}
463 \{
464     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink}->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink} == b);
465     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink}->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink} == b);
466 
467     b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink}->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink} = b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink};
468     b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink}->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink} = b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink};
469 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a9013b6561b0953fae3f61d09d418602b}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-kmp\-\_\-finalize\-\_\-bget@{\-\_\-\-\_\-kmp\-\_\-finalize\-\_\-bget}}
\index{\-\_\-\-\_\-kmp\-\_\-finalize\-\_\-bget@{\-\_\-\-\_\-kmp\-\_\-finalize\-\_\-bget}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-finalize\-\_\-bget}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-finalize\-\_\-bget (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_a9013b6561b0953fae3f61d09d418602b}


Definition at line 1316 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-reap\-\_\-thread().


\begin{DoxyCode}
1317 \{
1318     \hyperlink{structthr__data}{thr\_data\_t} *thr;
1319     \hyperlink{structbfhead}{bfhead\_t} *b;
1320 
1321     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( th != 0 );
1322 
1323 \textcolor{preprocessor}{#if BufStats}
1324 \textcolor{preprocessor}{}    thr = (\hyperlink{structthr__data}{thr\_data\_t} *) th->th.th\_local.bget\_data;
1325     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( thr != NULL );
1326     b = thr->\hyperlink{structthr__data_aac5ddbd2e9047f283da46c5ae55686fe}{last\_pool};
1327 
1328     \textcolor{comment}{/*  If  a  block-release function is defined, and this free buffer}
1329 \textcolor{comment}{        constitutes the entire block, release it.  Note that  pool\_len}
1330 \textcolor{comment}{        is  defined  in  such a way that the test will fail unless all}
1331 \textcolor{comment}{        pool blocks are the same size.  */}
1332 
1333     \textcolor{comment}{/* Deallocate the last pool if one exists because we no longer do it in brel() */}
1334     \textcolor{keywordflow}{if} (thr->\hyperlink{structthr__data_ab94c9cee76c857baf0a3a3d887b47bd1}{relfcn} != 0 && b != 0 && thr->\hyperlink{structthr__data_ace2317a7c31b3b8ecb3b10ea1067fee0}{numpblk} != 0 &&
1335         b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} == (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize})(thr->\hyperlink{structthr__data_a614e5671e1497475cd564343d2a1cd3f}{pool\_len} - \textcolor{keyword}{sizeof}(
      \hyperlink{kmp__alloc_8c_af1de790fdc3ba84111ab8cd6730510bd}{bhead\_t})))
1336     \{
1337         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree} == 0);
1338         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(\hyperlink{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}{BH}((\textcolor{keywordtype}{char} *) b + b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize})->bb.bsize == 
      \hyperlink{kmp__alloc_8c_a7dcc8bddb70936db7d4f3f34ed635543}{ESent});
1339         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(\hyperlink{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}{BH}((\textcolor{keywordtype}{char} *) b + b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize})->bb.prevfree == b->
      \hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize});
1340 
1341         \textcolor{comment}{/*  Unlink the buffer from the free list  */}
1342         \hyperlink{kmp__alloc_8c_a2a12a9c925f14056c5bdc6c7726485cb}{\_\_kmp\_bget\_remove\_from\_freelist}( b );
1343 
1344         \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, (\textcolor{stringliteral}{"%%%%%% FREE( %p )\(\backslash\)n"}, (\textcolor{keywordtype}{void} *) b ) );
1345 
1346         (*thr->\hyperlink{structthr__data_ab94c9cee76c857baf0a3a3d887b47bd1}{relfcn})(b);
1347         thr->\hyperlink{structthr__data_ac9ff0cac89239d263184e77107c03b7d}{numprel}++;               \textcolor{comment}{/* Nr of expansion block releases */}
1348         thr->\hyperlink{structthr__data_ace2317a7c31b3b8ecb3b10ea1067fee0}{numpblk}--;               \textcolor{comment}{/* Total number of blocks */}
1349         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(thr->\hyperlink{structthr__data_ace2317a7c31b3b8ecb3b10ea1067fee0}{numpblk} == thr->\hyperlink{structthr__data_a5351a12df0ac848e4148dd2466a4026d}{numpget} - thr->
      \hyperlink{structthr__data_ac9ff0cac89239d263184e77107c03b7d}{numprel});
1350     \}
1351 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* BufStats */}\textcolor{preprocessor}{}
1352 \textcolor{preprocessor}{}
1353     \textcolor{comment}{/* Deallocate bget\_data */}
1354     \textcolor{keywordflow}{if} ( th->th.th\_local.bget\_data != NULL ) \{
1355         \hyperlink{kmp_8h_a052396231429341ba56a7c1ceacbaa2f}{\_\_kmp\_free}( th->th.th\_local.bget\_data );
1356         th->th.th\_local.bget\_data = NULL;
1357     \}; \textcolor{comment}{// if}
1358 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a9ef96955bf516ae561078adf0c75add4}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-kmp\-\_\-free\-\_\-fast\-\_\-memory@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-fast\-\_\-memory}}
\index{\-\_\-\-\_\-kmp\-\_\-free\-\_\-fast\-\_\-memory@{\-\_\-\-\_\-kmp\-\_\-free\-\_\-fast\-\_\-memory}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-free\-\_\-fast\-\_\-memory}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-free\-\_\-fast\-\_\-memory (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_a9ef96955bf516ae561078adf0c75add4}


Definition at line 2008 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-reap\-\_\-thread().


\begin{DoxyCode}
2009 \{
2010     \textcolor{comment}{// Suppose we use BGET underlying allocator, walk through its structures...}
2011     \textcolor{keywordtype}{int}          bin;
2012     \hyperlink{structthr__data}{thr\_data\_t} * thr = \hyperlink{kmp__alloc_8c_ab99069e0ca8b8f4334f3d952f14ea967}{get\_thr\_data}( th );
2013     \textcolor{keywordtype}{void}      ** lst = NULL;
2014 
2015     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}(5, ( \textcolor{stringliteral}{"\_\_kmp\_free\_fast\_memory: Called T#%d\(\backslash\)n"},
2016                    \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( th ) ) );
2017 
2018     \hyperlink{kmp__alloc_8c_a2051eee971259559ffd8406822786ab2}{\_\_kmp\_bget\_dequeue}( th );         \textcolor{comment}{// Release any queued buffers}
2019 
2020     \textcolor{comment}{// Dig through free lists and extract all allocated blocks}
2021     \textcolor{keywordflow}{for} ( bin = 0; bin < \hyperlink{kmp__alloc_8c_af312994da10c636eaa83074b49b44b0a}{MAX\_BGET\_BINS}; ++bin ) \{
2022         \hyperlink{structbfhead}{bfhead\_t} * b = thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ].\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink};
2023         \textcolor{keywordflow}{while} ( b != &thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ] ) \{
2024             \textcolor{keywordflow}{if} ( (\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a641b1866310f899813f98a52a287a32e}{bthr} & 1 ) \{   \textcolor{comment}{// if the buffer is an
       allocated address?}
2025                 *((\textcolor{keywordtype}{void}**)b) = lst;   \textcolor{comment}{// link the list (override bthr, but keep flink yet)}
2026                 lst = (\textcolor{keywordtype}{void}**)b;      \textcolor{comment}{// push b into lst}
2027             \}
2028             b = b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink};          \textcolor{comment}{// get next buffer}
2029         \}
2030     \}
2031     \textcolor{keywordflow}{while} ( lst != NULL ) \{
2032         \textcolor{keywordtype}{void} * \hyperlink{structshared__common_aa54da923f39ba340f472b4a62205b967}{next} = *lst;
2033         \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}(10, ( \textcolor{stringliteral}{"\_\_kmp\_free\_fast\_memory: freeing %p, next=%p th %p (%d)\(\backslash\)n"},
2034                       lst, next, th, \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( th ) ) );
2035         (*thr->\hyperlink{structthr__data_ab94c9cee76c857baf0a3a3d887b47bd1}{relfcn})(lst);
2036 \textcolor{preprocessor}{        #if BufStats}
2037 \textcolor{preprocessor}{}            \textcolor{comment}{// count blocks to prevent problems in \_\_kmp\_finalize\_bget()}
2038             thr->\hyperlink{structthr__data_ac9ff0cac89239d263184e77107c03b7d}{numprel}++;       \textcolor{comment}{/* Nr of expansion block releases */}
2039             thr->\hyperlink{structthr__data_ace2317a7c31b3b8ecb3b10ea1067fee0}{numpblk}--;       \textcolor{comment}{/* Total number of blocks */}
2040 \textcolor{preprocessor}{        #endif}
2041 \textcolor{preprocessor}{}        lst = (\textcolor{keywordtype}{void}**)next;
2042     \}
2043 
2044     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}(5, ( \textcolor{stringliteral}{"\_\_kmp\_free\_fast\_memory: Freed T#%d\(\backslash\)n"},
2045                   \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( th ) ) );
2046 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_adf0ede820c2a58e37d06987be170dde4}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-bget@{\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-bget}}
\index{\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-bget@{\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-bget}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-bget}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-initialize\-\_\-bget (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_adf0ede820c2a58e37d06987be170dde4}


Definition at line 1305 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-allocate\-\_\-thread(), and \-\_\-\-\_\-kmp\-\_\-register\-\_\-root().


\begin{DoxyCode}
1306 \{
1307     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{SizeQuant} >= \textcolor{keyword}{sizeof}( \textcolor{keywordtype}{void} * ) && (th != 0) );
1308 
1309     \hyperlink{kmp__alloc_8c_a4fa2d764a1fb227783e00a6a8d60bb46}{set\_thr\_data}( th );
1310 
1311     \hyperlink{kmp__alloc_8c_a5e152d4831a1e7143be739db589c9c3e}{bectl}( th, (\hyperlink{kmp__alloc_8c_a97451db29023098b5723ad1ba00f944f}{bget\_compact\_t}) 0, (\hyperlink{kmp__alloc_8c_a21f03e368c4e90d00ed20a2b01985ecd}{bget\_acquire\_t}) malloc, (
      \hyperlink{kmp__alloc_8c_ad26e5d39dca5e04fbcfb74a022e2fcdb}{bget\_release\_t}) free,
1312            (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) \hyperlink{kmp_8h_ac8b6597684f6c3c7f7092d622b644a09}{\_\_kmp\_malloc\_pool\_incr} );
1313 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a69fe87136a9efb3f397250ae7838f470}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-fast\-\_\-memory@{\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-fast\-\_\-memory}}
\index{\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-fast\-\_\-memory@{\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-fast\-\_\-memory}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{\-\_\-\-\_\-kmp\-\_\-initialize\-\_\-fast\-\_\-memory}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} \-\_\-\-\_\-kmp\-\_\-initialize\-\_\-fast\-\_\-memory (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{this\-\_\-thr}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_a69fe87136a9efb3f397250ae7838f470}


Definition at line 1998 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-allocate\-\_\-thread(), and \-\_\-\-\_\-kmp\-\_\-register\-\_\-root().


\begin{DoxyCode}
1999 \{
2000     \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}(10, ( \textcolor{stringliteral}{"\_\_kmp\_initialize\_fast\_memory: Called from th %p\(\backslash\)n"}, this\_thr ) );
2001 
2002     memset ( this\_thr->th.th\_free\_lists, 0, \hyperlink{kmp_8h_aa3c9e19ca57d52bdde58c0e26205d02d}{NUM\_LISTS} * \textcolor{keyword}{sizeof}( 
      \hyperlink{structkmp__free__list}{kmp\_free\_list\_t} ) );
2003 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_aae7687b0fc52108956d191aac6582a92}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bcheck@{bcheck}}
\index{bcheck@{bcheck}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bcheck}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} bcheck (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{{\bf bufsize} $\ast$}]{max\-\_\-free, }
\item[{{\bf bufsize} $\ast$}]{total\-\_\-free}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_aae7687b0fc52108956d191aac6582a92}


Definition at line 476 of file kmp\-\_\-alloc.\-c.



Referenced by kmpc\-\_\-get\-\_\-poolstat().


\begin{DoxyCode}
477 \{
478     \hyperlink{structthr__data}{thr\_data\_t} *thr = \hyperlink{kmp__alloc_8c_ab99069e0ca8b8f4334f3d952f14ea967}{get\_thr\_data}( th );
479     \textcolor{keywordtype}{int} bin;
480 
481     *total\_free = *max\_free = 0;
482 
483     \textcolor{keywordflow}{for} (bin = 0; bin < \hyperlink{kmp__alloc_8c_af312994da10c636eaa83074b49b44b0a}{MAX\_BGET\_BINS}; ++bin) \{
484         \hyperlink{structbfhead}{bfhead\_t} *b, *best;
485 
486         best = &thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ];
487         b = best->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink};
488 
489         \textcolor{keywordflow}{while} (b != &thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ]) \{
490             *total\_free += (b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} - \textcolor{keyword}{sizeof}( \hyperlink{kmp__alloc_8c_af1de790fdc3ba84111ab8cd6730510bd}{bhead\_t} ));
491             \textcolor{keywordflow}{if} ((best == &thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ]) || (b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} < best->
      \hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize}))
492                 best = b;
493 
494             \textcolor{comment}{/* Link to next buffer */}
495             b = b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink};
496         \}
497 
498         \textcolor{keywordflow}{if} (*max\_free < best->bh.bb.bsize)
499             *max\_free = best->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize};
500     \}
501 
502     \textcolor{keywordflow}{if} (*max\_free > (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize})\textcolor{keyword}{sizeof}( \hyperlink{kmp__alloc_8c_af1de790fdc3ba84111ab8cd6730510bd}{bhead\_t} ))
503         *max\_free -= \textcolor{keyword}{sizeof}( \hyperlink{kmp__alloc_8c_af1de790fdc3ba84111ab8cd6730510bd}{bhead\_t} );
504 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a5e152d4831a1e7143be739db589c9c3e}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bectl@{bectl}}
\index{bectl@{bectl}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bectl}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} bectl (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{{\bf bget\-\_\-compact\-\_\-t}}]{compact, }
\item[{{\bf bget\-\_\-acquire\-\_\-t}}]{acquire, }
\item[{{\bf bget\-\_\-release\-\_\-t}}]{release, }
\item[{{\bf bufsize}}]{pool\-\_\-incr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_a5e152d4831a1e7143be739db589c9c3e}


Definition at line 973 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-initialize\-\_\-bget(), and kmpc\-\_\-set\-\_\-poolsize().


\begin{DoxyCode}
974 \{
975     \hyperlink{structthr__data}{thr\_data\_t} *thr = \hyperlink{kmp__alloc_8c_ab99069e0ca8b8f4334f3d952f14ea967}{get\_thr\_data}( th );
976 
977     thr->\hyperlink{structthr__data_ac022ffa492a079f49040bd922cd9dcf8}{compfcn} = compact;
978     thr->\hyperlink{structthr__data_a56f7eab7df7b5d625e22cda6805f2b40}{acqfcn} = acquire;
979     thr->\hyperlink{structthr__data_ab94c9cee76c857baf0a3a3d887b47bd1}{relfcn} = release;
980     thr->\hyperlink{structthr__data_ad76a1f415abd6cbf1c4f9b2c091e3c21}{exp\_incr} = pool\_incr;
981 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a77abb6a46b7d952625f54d2d506dce69}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bfreed@{bfreed}}
\index{bfreed@{bfreed}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bfreed}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} bfreed (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_a77abb6a46b7d952625f54d2d506dce69}


Definition at line 1054 of file kmp\-\_\-alloc.\-c.



Referenced by kmpc\-\_\-poolprint().


\begin{DoxyCode}
1055 \{
1056     \textcolor{keywordtype}{int} bin = 0, \hyperlink{ittnotify__static_8h_a9da14338c9c3be6f21c41cf4ec79eaf1}{count} = 0;
1057     \textcolor{keywordtype}{int} gtid = \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( th );
1058     \hyperlink{structthr__data}{thr\_data\_t} *thr = \hyperlink{kmp__alloc_8c_ab99069e0ca8b8f4334f3d952f14ea967}{get\_thr\_data}( th );
1059 
1060 \textcolor{preprocessor}{#if BufStats}
1061 \textcolor{preprocessor}{}    \hyperlink{kmp__io_8c_adfa9239ad26934b69d751b190582b5a7}{\_\_kmp\_printf\_no\_lock}(\textcolor{stringliteral}{"\_\_kmp\_printpool: T#%d total=%"} KMP\_UINT64\_SPEC \textcolor{stringliteral}{" get=%"} 
      KMP\_INT64\_SPEC \textcolor{stringliteral}{" rel=%"} \(\backslash\)
1062            KMP\_INT64\_SPEC \textcolor{stringliteral}{" pblk=%"} KMP\_INT64\_SPEC \textcolor{stringliteral}{" pget=%"} KMP\_INT64\_SPEC \textcolor{stringliteral}{" prel=%"} KMP\_INT64\_SPEC \(\backslash\)
1063            \textcolor{stringliteral}{" dget=%"} KMP\_INT64\_SPEC \textcolor{stringliteral}{" drel=%"} KMP\_INT64\_SPEC \textcolor{stringliteral}{"\(\backslash\)n"},
1064            gtid, (kmp\_uint64) thr->\hyperlink{structthr__data_a190c144a686f291c888741d25b4f6547}{totalloc},
1065            (kmp\_int64) thr->\hyperlink{structthr__data_afefb9a334169efb3a1b64eee22f3e60c}{numget},  (kmp\_int64) thr->\hyperlink{structthr__data_a391d2806f8e5595fb66a01484c860bf0}{numrel},
1066            (kmp\_int64) thr->\hyperlink{structthr__data_ace2317a7c31b3b8ecb3b10ea1067fee0}{numpblk},
1067            (kmp\_int64) thr->\hyperlink{structthr__data_a5351a12df0ac848e4148dd2466a4026d}{numpget}, (kmp\_int64) thr->\hyperlink{structthr__data_ac9ff0cac89239d263184e77107c03b7d}{numprel},
1068            (kmp\_int64) thr->\hyperlink{structthr__data_a2306c5452a73e20dd817a16363162f62}{numdget}, (kmp\_int64) thr->\hyperlink{structthr__data_a8f43a52aba5a9b92da0da539dba756c1}{numdrel} );
1069 \textcolor{preprocessor}{#endif}
1070 \textcolor{preprocessor}{}
1071     \textcolor{keywordflow}{for} (bin = 0; bin < \hyperlink{kmp__alloc_8c_af312994da10c636eaa83074b49b44b0a}{MAX\_BGET\_BINS}; ++bin) \{
1072         \hyperlink{structbfhead}{bfhead\_t} *b;
1073 
1074         \textcolor{keywordflow}{for} (b = thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ].\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink}; b != &thr->
      \hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ]; b = b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink}) \{
1075             \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} bs = b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize};
1076 
1077             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink}->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink} == b );
1078             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink}->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink} == b );
1079             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( bs > 0 );
1080 
1081             \hyperlink{ittnotify__static_8h_a9da14338c9c3be6f21c41cf4ec79eaf1}{count} += 1;
1082 
1083             \hyperlink{kmp__io_8c_adfa9239ad26934b69d751b190582b5a7}{\_\_kmp\_printf\_no\_lock}(\textcolor{stringliteral}{"\_\_kmp\_printpool: T#%d Free block: 0x%p size %6ld
       bytes.\(\backslash\)n"}, gtid, b, (\textcolor{keywordtype}{long}) bs );
1084 \textcolor{preprocessor}{#ifdef FreeWipe}
1085 \textcolor{preprocessor}{}            \{
1086                 \textcolor{keywordtype}{char} *lerr = ((\textcolor{keywordtype}{char} *) b) + \textcolor{keyword}{sizeof}(\hyperlink{kmp__alloc_8c_abd11e50b08fcad0d4fbfdce33582213c}{bfhead\_t});
1087                 \textcolor{keywordflow}{if} ((bs > \textcolor{keyword}{sizeof}(\hyperlink{structbfhead}{bfhead\_t})) && ((*lerr != 0x55) || (memcmp(lerr, lerr + 1, (\textcolor{keywordtype}{size\_t})
       (bs - (\textcolor{keyword}{sizeof}(\hyperlink{structbfhead}{bfhead\_t}) + 1))) != 0))) \{
1088                     \hyperlink{kmp__io_8c_adfa9239ad26934b69d751b190582b5a7}{\_\_kmp\_printf\_no\_lock}( \textcolor{stringliteral}{"\_\_kmp\_printpool: T#%d     (Contents of above
       free block have been overstored.)\(\backslash\)n"}, gtid );
1089                 \}
1090             \}
1091 \textcolor{preprocessor}{#endif}
1092 \textcolor{preprocessor}{}        \}
1093     \}
1094 
1095     \textcolor{keywordflow}{if} (\hyperlink{ittnotify__static_8h_a9da14338c9c3be6f21c41cf4ec79eaf1}{count} == 0)
1096         \hyperlink{kmp__io_8c_adfa9239ad26934b69d751b190582b5a7}{\_\_kmp\_printf\_no\_lock}(\textcolor{stringliteral}{"\_\_kmp\_printpool: T#%d No free blocks\(\backslash\)n"}, gtid );
1097 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_ae0f1683e77919d466cf2ea6f7b00ba91}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bget@{bget}}
\index{bget@{bget}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bget}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} $\ast$ bget (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{{\bf bufsize}}]{size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_ae0f1683e77919d466cf2ea6f7b00ba91}


Definition at line 511 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-allocate(), \-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-malloc(), bgetr(), bgetz(), kmpc\-\_\-malloc(), and kmpc\-\_\-realloc().


\begin{DoxyCode}
512 \{
513     \hyperlink{structthr__data}{thr\_data\_t} *thr = \hyperlink{kmp__alloc_8c_ab99069e0ca8b8f4334f3d952f14ea967}{get\_thr\_data}( th );
514     \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} = requested\_size;
515     \hyperlink{structbfhead}{bfhead\_t} *b;
516     \textcolor{keywordtype}{void} *buf;
517     \textcolor{keywordtype}{int} compactseq = 0;
518     \textcolor{keywordtype}{int} use\_blink = 0;
519 \textcolor{comment}{/* For BestFit */}
520     \hyperlink{structbfhead}{bfhead\_t} *best;
521 
522     \textcolor{keywordflow}{if} ( size < 0 || size + \textcolor{keyword}{sizeof}( \hyperlink{unionbhead}{bhead\_t} ) > \hyperlink{kmp__alloc_8c_a85633b531a313eee6f1f31eeed4a12ea}{MaxSize} ) \{
523         \textcolor{keywordflow}{return} NULL;
524     \}; \textcolor{comment}{// if}
525 
526     \hyperlink{kmp__alloc_8c_a2051eee971259559ffd8406822786ab2}{\_\_kmp\_bget\_dequeue}( th );         \textcolor{comment}{/* Release any queued buffers */}
527 
528     \textcolor{keywordflow}{if} (size < (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize})\hyperlink{kmp__alloc_8c_a8a8beeffc163eabffc840e0d1ca7be0b}{SizeQ}) \{      \textcolor{comment}{/* Need at least room for the */}
529         size = \hyperlink{kmp__alloc_8c_a8a8beeffc163eabffc840e0d1ca7be0b}{SizeQ};                 \textcolor{comment}{/*    queue links.  */}
530     \}
531 \textcolor{preprocessor}{    #if defined( SizeQuant ) && ( SizeQuant > 1 )}
532 \textcolor{preprocessor}{}        size = (size + (\hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{SizeQuant} - 1)) & (~(\hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{SizeQuant} - 1));
533 \textcolor{preprocessor}{    #endif}
534 \textcolor{preprocessor}{}
535     size += \textcolor{keyword}{sizeof}(\hyperlink{kmp__alloc_8c_af1de790fdc3ba84111ab8cd6730510bd}{bhead\_t});     \textcolor{comment}{/* Add overhead in allocated buffer}
536 \textcolor{comment}{                                         to size required. */}
537     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( size >= 0 );
538     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( size % \hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{SizeQuant} == 0 );
539 
540     use\_blink = ( thr->\hyperlink{structthr__data_a790f977bb5c8b2b3409c1cf025c92f65}{mode} == \hyperlink{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a0cc8593912b5aa9bdac96f437b65e3ea}{bget\_mode\_lifo} );
541 
542     \textcolor{comment}{/* If a compact function was provided in the call to bectl(), wrap}
543 \textcolor{comment}{       a loop around the allocation process  to  allow  compaction  to}
544 \textcolor{comment}{       intervene in case we don't find a suitable buffer in the chain. */}
545 
546     \textcolor{keywordflow}{for} (;;) \{
547         \textcolor{keywordtype}{int} bin;
548 
549         \textcolor{keywordflow}{for} (bin = \hyperlink{kmp__alloc_8c_adf61a5be00012037243154c36d331eff}{bget\_get\_bin}( size ); bin < \hyperlink{kmp__alloc_8c_af312994da10c636eaa83074b49b44b0a}{MAX\_BGET\_BINS}; ++bin) \{
550             \textcolor{comment}{/* Link to next buffer */}
551             b = ( use\_blink ? thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ].\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink} : thr->
      \hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ].\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink} );
552 
553             \textcolor{keywordflow}{if} (thr->\hyperlink{structthr__data_a790f977bb5c8b2b3409c1cf025c92f65}{mode} == \hyperlink{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a0c883f0544468f73a8cc6606c2ac6b84}{bget\_mode\_best}) \{
554                 best = &thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ];
555 
556                 \textcolor{comment}{/* Scan the free list searching for the first buffer big enough}
557 \textcolor{comment}{                   to hold the requested size buffer. */}
558 
559                 \textcolor{keywordflow}{while} (b != &thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ]) \{
560                     \textcolor{keywordflow}{if} (b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} >= (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size}) \{
561                         \textcolor{keywordflow}{if} ((best == &thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ]) || (b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.
      \hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} < best->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize})) \{
562                             best = b;
563                         \}
564                     \}
565 
566                     \textcolor{comment}{/* Link to next buffer */}
567                     b = ( use\_blink ? b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink} : b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink} );
568                 \}
569                 b = best;
570             \}
571 
572             \textcolor{keywordflow}{while} (b != &thr->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ bin ]) \{
573                 \textcolor{keywordflow}{if} ((\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} >= (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) size) \{
574 
575                     \textcolor{comment}{/* Buffer  is big enough to satisfy  the request.  Allocate it}
576 \textcolor{comment}{                       to the caller.  We must decide whether the buffer is  large}
577 \textcolor{comment}{                       enough  to  split  into  the part given to the caller and a}
578 \textcolor{comment}{                       free buffer that remains on the free list, or  whether  the}
579 \textcolor{comment}{                       entire  buffer  should  be  removed  from the free list and}
580 \textcolor{comment}{                       given to the caller in its entirety.   We  only  split  the}
581 \textcolor{comment}{                       buffer if enough room remains for a header plus the minimum}
582 \textcolor{comment}{                       quantum of allocation. */}
583 
584                     \textcolor{keywordflow}{if} ((b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} - (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size}) > (
      \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize})(SizeQ + (\textcolor{keyword}{sizeof}(\hyperlink{kmp__alloc_8c_af1de790fdc3ba84111ab8cd6730510bd}{bhead\_t})))) \{
585                         \hyperlink{unionbhead}{bhead\_t} *ba, *bn;
586 
587                         ba = \hyperlink{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}{BH}(((\textcolor{keywordtype}{char} *) b) + (b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} - (
      \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) size));
588                         bn = \hyperlink{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}{BH}(((\textcolor{keywordtype}{char} *) ba) + size);
589 
590                         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(bn->\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree} == b->
      \hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize});
591 
592                         \textcolor{comment}{/* Subtract size from length of free block. */}
593                         b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} -= (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) size;
594 
595                         \textcolor{comment}{/* Link allocated buffer to the previous free buffer. */}
596                         ba->\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree} = b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize};
597 
598                         \textcolor{comment}{/* Plug negative size into user buffer. */}
599                         ba->\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} = -\hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size};
600 
601                         \textcolor{comment}{/* Mark this buffer as owned by this thread. */}
602                         \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(ba->\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a641b1866310f899813f98a52a287a32e}{bthr}, th);   \textcolor{comment}{// not an allocated address (do not mark
       it)}
603                         \textcolor{comment}{/* Mark buffer after this one not preceded by free block. */}
604                         bn->\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree} = 0;
605 
606                         \textcolor{comment}{/* unlink the buffer from the old freelist, and reinsert it into the new freelist 
      */}
607                         \hyperlink{kmp__alloc_8c_a2a12a9c925f14056c5bdc6c7726485cb}{\_\_kmp\_bget\_remove\_from\_freelist}( b );
608                         \hyperlink{kmp__alloc_8c_a6f80c5ae5feca086c056b4b9b0f8d30c}{\_\_kmp\_bget\_insert\_into\_freelist}( thr, b );
609 \textcolor{preprocessor}{#if BufStats}
610 \textcolor{preprocessor}{}                        thr->\hyperlink{structthr__data_a190c144a686f291c888741d25b4f6547}{totalloc} += (size\_t) size;
611                         thr->\hyperlink{structthr__data_afefb9a334169efb3a1b64eee22f3e60c}{numget}++;        \textcolor{comment}{/* Increment number of bget() calls */}
612 \textcolor{preprocessor}{#endif}
613 \textcolor{preprocessor}{}                        buf = (\textcolor{keywordtype}{void} *) ((((\textcolor{keywordtype}{char} *) ba) + \textcolor{keyword}{sizeof}(\hyperlink{kmp__alloc_8c_af1de790fdc3ba84111ab8cd6730510bd}{bhead\_t})));
614                         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( ((\textcolor{keywordtype}{size\_t})buf) % 
      \hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{SizeQuant} == 0 );
615                         \textcolor{keywordflow}{return} buf;
616                     \} \textcolor{keywordflow}{else} \{
617                         \hyperlink{unionbhead}{bhead\_t} *ba;
618 
619                         ba = \hyperlink{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}{BH}(((\textcolor{keywordtype}{char} *) b) + b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize});
620 
621                         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(ba->\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree} == b->
      \hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize});
622 
623                         \textcolor{comment}{/* The buffer isn't big enough to split.  Give  the  whole}
624 \textcolor{comment}{                           shebang to the caller and remove it from the free list. */}
625 
626                        \hyperlink{kmp__alloc_8c_a2a12a9c925f14056c5bdc6c7726485cb}{\_\_kmp\_bget\_remove\_from\_freelist}( b );
627 \textcolor{preprocessor}{#if BufStats}
628 \textcolor{preprocessor}{}                        thr->\hyperlink{structthr__data_a190c144a686f291c888741d25b4f6547}{totalloc} += (size\_t) b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize};
629                         thr->\hyperlink{structthr__data_afefb9a334169efb3a1b64eee22f3e60c}{numget}++;        \textcolor{comment}{/* Increment number of bget() calls */}
630 #endif
631                         \textcolor{comment}{/* Negate size to mark buffer allocated. */}
632                         b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} = -(b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize});
633 
634                         \textcolor{comment}{/* Mark this buffer as owned by this thread. */}
635                         \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(ba->\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a641b1866310f899813f98a52a287a32e}{bthr}, th);   \textcolor{comment}{// not an allocated address (do not mark
       it)}
636                         \textcolor{comment}{/* Zero the back pointer in the next buffer in memory}
637 \textcolor{comment}{                           to indicate that this buffer is allocated. */}
638                         ba->\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree} = 0;
639 
640                         \textcolor{comment}{/* Give user buffer starting at queue links. */}
641                         buf =  (\textcolor{keywordtype}{void} *) &(b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql});
642                         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( ((\textcolor{keywordtype}{size\_t})buf) % 
      \hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{SizeQuant} == 0 );
643                         \textcolor{keywordflow}{return} buf;
644                     \}
645                 \}
646 
647                 \textcolor{comment}{/* Link to next buffer */}
648                 b = ( use\_blink ? b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink} : b->\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink} );
649             \}
650         \}
651 
652         \textcolor{comment}{/* We failed to find a buffer.  If there's a compact  function}
653 \textcolor{comment}{           defined,  notify  it  of the size requested.  If it returns}
654 \textcolor{comment}{           TRUE, try the allocation again. */}
655 
656         \textcolor{keywordflow}{if} ((thr->\hyperlink{structthr__data_ac022ffa492a079f49040bd922cd9dcf8}{compfcn} == 0) || (!(*thr->\hyperlink{structthr__data_ac022ffa492a079f49040bd922cd9dcf8}{compfcn})(size, ++compactseq))) \{
657             \textcolor{keywordflow}{break};
658         \}
659     \}
660 
661     \textcolor{comment}{/* No buffer available with requested size free. */}
662 
663     \textcolor{comment}{/* Don't give up yet -- look in the reserve supply. */}
664 
665     \textcolor{keywordflow}{if} (thr->\hyperlink{structthr__data_a56f7eab7df7b5d625e22cda6805f2b40}{acqfcn} != 0) \{
666         \textcolor{keywordflow}{if} (size > (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) (thr->\hyperlink{structthr__data_ad76a1f415abd6cbf1c4f9b2c091e3c21}{exp\_incr} - \textcolor{keyword}{sizeof}(\hyperlink{kmp__alloc_8c_af1de790fdc3ba84111ab8cd6730510bd}{bhead\_t}))) \{
667 
668             \textcolor{comment}{/* Request  is  too  large  to  fit in a single expansion}
669 \textcolor{comment}{               block.  Try to satisy it by a direct buffer acquisition. */}
670 
671             \hyperlink{structbdhead}{bdhead\_t} *bdh;
672 
673             size += \textcolor{keyword}{sizeof}(\hyperlink{kmp__alloc_8c_a76704c34eb0e5bd1bc01a7635661213a}{bdhead\_t}) - \textcolor{keyword}{sizeof}(\hyperlink{unionbhead}{bhead\_t});
674 
675             \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, (\textcolor{stringliteral}{"%%%%%% MALLOC( %d )\(\backslash\)n"}, (\textcolor{keywordtype}{int}) size ) );
676 
677             \textcolor{comment}{/* richryan */}
678             bdh = \hyperlink{kmp__alloc_8c_a67a71fd38b2b8aaaa6e9da54bb652b7b}{BDH}((*thr->\hyperlink{structthr__data_a56f7eab7df7b5d625e22cda6805f2b40}{acqfcn})((\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) size));
679             \textcolor{keywordflow}{if} (bdh != NULL) \{
680 
681                 \textcolor{comment}{/*  Mark the buffer special by setting the size field}
682 \textcolor{comment}{                    of its header to zero.  */}
683                 bdh->\hyperlink{structbdhead_a18184e6403b513e03bfc8c3e91fb5aa4}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} = 0;
684 
685                 \textcolor{comment}{/* Mark this buffer as owned by this thread. */}
686                 \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}(bdh->\hyperlink{structbdhead_a18184e6403b513e03bfc8c3e91fb5aa4}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a641b1866310f899813f98a52a287a32e}{bthr}, th);  \textcolor{comment}{// don't mark buffer as allocated,}
687                                                \textcolor{comment}{// because direct buffer never goes to free list}
688                 bdh->\hyperlink{structbdhead_a18184e6403b513e03bfc8c3e91fb5aa4}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree} = 0;
689                 bdh->\hyperlink{structbdhead_aac93883268daeee61a9fc08d36a76147}{tsize} = \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size};
690 \textcolor{preprocessor}{#if BufStats}
691 \textcolor{preprocessor}{}                thr->\hyperlink{structthr__data_a190c144a686f291c888741d25b4f6547}{totalloc} += (size\_t) size;
692                 thr->\hyperlink{structthr__data_afefb9a334169efb3a1b64eee22f3e60c}{numget}++;        \textcolor{comment}{/* Increment number of bget() calls */}
693                 thr->\hyperlink{structthr__data_a2306c5452a73e20dd817a16363162f62}{numdget}++;       \textcolor{comment}{/* Direct bget() call count */}
694 \textcolor{preprocessor}{#endif}
695 \textcolor{preprocessor}{}                buf =  (\textcolor{keywordtype}{void} *) (bdh + 1);
696                 \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( ((\textcolor{keywordtype}{size\_t})buf) % \hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{SizeQuant} == 0 );
697                 \textcolor{keywordflow}{return} buf;
698             \}
699 
700         \} \textcolor{keywordflow}{else} \{
701 
702             \textcolor{comment}{/*  Try to obtain a new expansion block */}
703 
704             \textcolor{keywordtype}{void} *newpool;
705 
706             \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, (\textcolor{stringliteral}{"%%%%%% MALLOCB( %d )\(\backslash\)n"}, (\textcolor{keywordtype}{int}) thr->\hyperlink{structthr__data_ad76a1f415abd6cbf1c4f9b2c091e3c21}{exp\_incr} ) );
707 
708             \textcolor{comment}{/* richryan */}
709             newpool = (*thr->\hyperlink{structthr__data_a56f7eab7df7b5d625e22cda6805f2b40}{acqfcn})((\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) thr->\hyperlink{structthr__data_ad76a1f415abd6cbf1c4f9b2c091e3c21}{exp\_incr});
710             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( ((\textcolor{keywordtype}{size\_t})newpool) % \hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{SizeQuant} == 0 );
711             \textcolor{keywordflow}{if} (newpool != NULL) \{
712                 \hyperlink{kmp__alloc_8c_a0c8a7122de0a6bfb0a3f56a2b92c607d}{bpool}( th, newpool, thr->\hyperlink{structthr__data_ad76a1f415abd6cbf1c4f9b2c091e3c21}{exp\_incr});
713                 buf =  \hyperlink{kmp__alloc_8c_ae0f1683e77919d466cf2ea6f7b00ba91}{bget}( th, requested\_size);  \textcolor{comment}{/* This can't, I say, can't get into a loop. */}
714                 \textcolor{keywordflow}{return} buf;
715             \}
716         \}
717     \}
718 
719     \textcolor{comment}{/*  Still no buffer available */}
720 
721     \textcolor{keywordflow}{return} NULL;
722 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_adf61a5be00012037243154c36d331eff}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bget\-\_\-get\-\_\-bin@{bget\-\_\-get\-\_\-bin}}
\index{bget\-\_\-get\-\_\-bin@{bget\-\_\-get\-\_\-bin}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bget\-\_\-get\-\_\-bin}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf int} bget\-\_\-get\-\_\-bin (
\begin{DoxyParamCaption}
\item[{{\bf bufsize}}]{size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_adf61a5be00012037243154c36d331eff}


Definition at line 245 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-bget\-\_\-insert\-\_\-into\-\_\-freelist(), and bget().


\begin{DoxyCode}
246 \{
247     \textcolor{comment}{// binary chop bins}
248     \textcolor{keywordtype}{int} lo = 0, hi = \hyperlink{kmp__alloc_8c_af312994da10c636eaa83074b49b44b0a}{MAX\_BGET\_BINS} - 1;
249 
250     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} > 0 );
251 
252     \textcolor{keywordflow}{while} ( (hi - lo) > 1 ) \{
253         \textcolor{keywordtype}{int} mid = (lo + hi) >> 1;
254         \textcolor{keywordflow}{if} (\hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} < \hyperlink{kmp__alloc_8c_ac3c6b00e9fbae316fdd0c11f2b8d50b7}{bget\_bin\_size}[ mid ])
255             hi = mid - 1;
256         \textcolor{keywordflow}{else}
257             lo = mid;
258     \}
259 
260     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( (lo >= 0) && (lo < \hyperlink{kmp__alloc_8c_af312994da10c636eaa83074b49b44b0a}{MAX\_BGET\_BINS}) );
261 
262     \textcolor{keywordflow}{return} lo;
263 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_aba99d2a2a6154f7f8c1f957755bcbb48}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bgetr@{bgetr}}
\index{bgetr@{bgetr}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bgetr}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} $\ast$ bgetr (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{{\bf void} $\ast$}]{buffer, }
\item[{{\bf bufsize}}]{newsize}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_aba99d2a2a6154f7f8c1f957755bcbb48}


Definition at line 761 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-realloc(), and kmpc\-\_\-realloc().


\begin{DoxyCode}
762 \{
763     \textcolor{keywordtype}{void} *nbuf;
764     \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} osize;                    \textcolor{comment}{/* Old size of buffer */}
765     \hyperlink{unionbhead}{bhead\_t} *b;
766 
767     nbuf = \hyperlink{kmp__alloc_8c_ae0f1683e77919d466cf2ea6f7b00ba91}{bget}( th, \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} );
768     \textcolor{keywordflow}{if} ( nbuf == NULL ) \{ \textcolor{comment}{/* Acquire new buffer */}
769         \textcolor{keywordflow}{return} NULL;
770     \}
771     \textcolor{keywordflow}{if} ( buf == NULL ) \{
772         \textcolor{keywordflow}{return} nbuf;
773     \}
774     b = \hyperlink{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}{BH}(((\textcolor{keywordtype}{char} *) buf) - \textcolor{keyword}{sizeof}(\hyperlink{unionbhead}{bhead\_t}));
775     osize = -b->\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize};
776     \textcolor{keywordflow}{if} (osize == 0) \{
777         \textcolor{comment}{/*  Buffer acquired directly through acqfcn. */}
778         \hyperlink{structbdhead}{bdhead\_t} *bd;
779 
780         bd = \hyperlink{kmp__alloc_8c_a67a71fd38b2b8aaaa6e9da54bb652b7b}{BDH}(((\textcolor{keywordtype}{char} *) buf) - \textcolor{keyword}{sizeof}(\hyperlink{structbdhead}{bdhead\_t}));
781         osize = bd->\hyperlink{structbdhead_aac93883268daeee61a9fc08d36a76147}{tsize} - (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) \textcolor{keyword}{sizeof}(\hyperlink{structbdhead}{bdhead\_t});
782     \} \textcolor{keywordflow}{else} \{
783         osize -= \textcolor{keyword}{sizeof}(\hyperlink{kmp__alloc_8c_af1de790fdc3ba84111ab8cd6730510bd}{bhead\_t});
784     \};
785 
786     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(osize > 0);
787 
788     (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void}) \hyperlink{kmp__safe__c__api_8h_ab63a75e8bb537bb3ae55c05d0a3b7ca0}{KMP\_MEMCPY}((\textcolor{keywordtype}{char} *) nbuf, (\textcolor{keywordtype}{char} *) buf, \textcolor{comment}{/* Copy the data */}
789              (\textcolor{keywordtype}{size\_t}) ((\hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} < osize) ? \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} : osize));
790     \hyperlink{kmp__alloc_8c_abebcbe8d8488d54668527825b2663666}{brel}( th, buf );
791 
792     \textcolor{keywordflow}{return} nbuf;
793 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a9dd8baceae832aef6e56a510f40d7f2b}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bgetz@{bgetz}}
\index{bgetz@{bgetz}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bgetz}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} $\ast$ bgetz (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{{\bf bufsize}}]{size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_a9dd8baceae832aef6e56a510f40d7f2b}


Definition at line 729 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-calloc(), and kmpc\-\_\-calloc().


\begin{DoxyCode}
730 \{
731     \textcolor{keywordtype}{char} *buf = (\textcolor{keywordtype}{char} *) \hyperlink{kmp__alloc_8c_ae0f1683e77919d466cf2ea6f7b00ba91}{bget}( th, \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size});
732 
733     \textcolor{keywordflow}{if} (buf != NULL) \{
734         \hyperlink{unionbhead}{bhead\_t} *b;
735         \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} rsize;
736 
737         b = \hyperlink{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}{BH}(buf - \textcolor{keyword}{sizeof}(\hyperlink{unionbhead}{bhead\_t}));
738         rsize = -(b->\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize});
739         \textcolor{keywordflow}{if} (rsize == 0) \{
740             \hyperlink{structbdhead}{bdhead\_t} *bd;
741 
742             bd = \hyperlink{kmp__alloc_8c_a67a71fd38b2b8aaaa6e9da54bb652b7b}{BDH}(buf - \textcolor{keyword}{sizeof}(\hyperlink{structbdhead}{bdhead\_t}));
743             rsize = bd->\hyperlink{structbdhead_aac93883268daeee61a9fc08d36a76147}{tsize} - (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) \textcolor{keyword}{sizeof}(\hyperlink{structbdhead}{bdhead\_t});
744         \} \textcolor{keywordflow}{else} \{
745             rsize -= \textcolor{keyword}{sizeof}(\hyperlink{kmp__alloc_8c_af1de790fdc3ba84111ab8cd6730510bd}{bhead\_t});
746         \}
747 
748         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(rsize >= \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size});
749 
750         (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void}) memset(buf, 0, (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) rsize);
751     \}
752     \textcolor{keywordflow}{return} ((\textcolor{keywordtype}{void} *) buf);
753 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a0c8a7122de0a6bfb0a3f56a2b92c607d}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bpool@{bpool}}
\index{bpool@{bpool}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bpool}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} bpool (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{{\bf void} $\ast$}]{buffer, }
\item[{{\bf bufsize}}]{len}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_a0c8a7122de0a6bfb0a3f56a2b92c607d}


Definition at line 986 of file kmp\-\_\-alloc.\-c.



Referenced by bget().


\begin{DoxyCode}
987 \{
988 \textcolor{comment}{/*    int bin = 0; */}
989     \hyperlink{structthr__data}{thr\_data\_t} *thr = \hyperlink{kmp__alloc_8c_ab99069e0ca8b8f4334f3d952f14ea967}{get\_thr\_data}( th );
990     \hyperlink{structbfhead}{bfhead\_t} *b = \hyperlink{kmp__alloc_8c_af6ff720178dbca05767d51fd5c087228}{BFH}(buf);
991     \hyperlink{unionbhead}{bhead\_t} *bn;
992 
993     \hyperlink{kmp__alloc_8c_a2051eee971259559ffd8406822786ab2}{\_\_kmp\_bget\_dequeue}( th );         \textcolor{comment}{/* Release any queued buffers */}
994 
995 \textcolor{preprocessor}{#ifdef SizeQuant}
996 \textcolor{preprocessor}{}    \hyperlink{ittnotify__static_8h_a607b6bb4c1ebd6e828c6a54ec9bd1411}{len} &= ~(\hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{SizeQuant} - 1);
997 \textcolor{preprocessor}{#endif}
998 \textcolor{preprocessor}{}    \textcolor{keywordflow}{if} (thr->\hyperlink{structthr__data_a614e5671e1497475cd564343d2a1cd3f}{pool\_len} == 0) \{
999         thr->\hyperlink{structthr__data_a614e5671e1497475cd564343d2a1cd3f}{pool\_len} = \hyperlink{ittnotify__static_8h_a607b6bb4c1ebd6e828c6a54ec9bd1411}{len};
1000     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{ittnotify__static_8h_a607b6bb4c1ebd6e828c6a54ec9bd1411}{len} != thr->\hyperlink{structthr__data_a614e5671e1497475cd564343d2a1cd3f}{pool\_len}) \{
1001         thr->\hyperlink{structthr__data_a614e5671e1497475cd564343d2a1cd3f}{pool\_len} = -1;
1002     \}
1003 \textcolor{preprocessor}{#if BufStats}
1004 \textcolor{preprocessor}{}    thr->\hyperlink{structthr__data_a5351a12df0ac848e4148dd2466a4026d}{numpget}++;                   \textcolor{comment}{/* Number of block acquisitions */}
1005     thr->\hyperlink{structthr__data_ace2317a7c31b3b8ecb3b10ea1067fee0}{numpblk}++;                   \textcolor{comment}{/* Number of blocks total */}
1006     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(thr->\hyperlink{structthr__data_ace2317a7c31b3b8ecb3b10ea1067fee0}{numpblk} == thr->\hyperlink{structthr__data_a5351a12df0ac848e4148dd2466a4026d}{numpget} - thr->
      \hyperlink{structthr__data_ac9ff0cac89239d263184e77107c03b7d}{numprel});
1007 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* BufStats */}\textcolor{preprocessor}{}
1008 \textcolor{preprocessor}{}
1009     \textcolor{comment}{/* Since the block is initially occupied by a single free  buffer,}
1010 \textcolor{comment}{       it  had  better  not  be  (much) larger than the largest buffer}
1011 \textcolor{comment}{       whose size we can store in bhead.bb.bsize. */}
1012 
1013     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(\hyperlink{ittnotify__static_8h_a607b6bb4c1ebd6e828c6a54ec9bd1411}{len} - \textcolor{keyword}{sizeof}(\hyperlink{unionbhead}{bhead\_t}) <= -((
      \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) \hyperlink{kmp__alloc_8c_a7dcc8bddb70936db7d4f3f34ed635543}{ESent} + 1));
1014 
1015     \textcolor{comment}{/* Clear  the  backpointer at  the start of the block to indicate that}
1016 \textcolor{comment}{       there  is  no  free  block  prior  to  this   one.    That   blocks}
1017 \textcolor{comment}{       recombination when the first block in memory is released. */}
1018 
1019     b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree} = 0;
1020 
1021     \textcolor{comment}{/* Create a dummy allocated buffer at the end of the pool.  This dummy}
1022 \textcolor{comment}{       buffer is seen when a buffer at the end of the pool is released and}
1023 \textcolor{comment}{       blocks  recombination  of  the last buffer with the dummy buffer at}
1024 \textcolor{comment}{       the end.  The length in the dummy buffer  is  set  to  the  largest}
1025 \textcolor{comment}{       negative  number  to  denote  the  end  of  the pool for diagnostic}
1026 \textcolor{comment}{       routines (this specific value is  not  counted  on  by  the  actual}
1027 \textcolor{comment}{       allocation and release functions). */}
1028 
1029     \hyperlink{ittnotify__static_8h_a607b6bb4c1ebd6e828c6a54ec9bd1411}{len} -= \textcolor{keyword}{sizeof}(\hyperlink{kmp__alloc_8c_af1de790fdc3ba84111ab8cd6730510bd}{bhead\_t});
1030     b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} = (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) \hyperlink{ittnotify__static_8h_a607b6bb4c1ebd6e828c6a54ec9bd1411}{len};
1031     \textcolor{comment}{/* Set the owner of this buffer */}
1032     \hyperlink{kmp__os_8h_a0ab189f0527d57d1c1af19fa3d16067f}{TCW\_PTR}( b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a641b1866310f899813f98a52a287a32e}{bthr}, (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t}*)((
      \hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})th | 1) ); \textcolor{comment}{// mark the buffer as allocated address}
1033 
1034     \textcolor{comment}{/* Chain the new block to the free list. */}
1035     \hyperlink{kmp__alloc_8c_a6f80c5ae5feca086c056b4b9b0f8d30c}{\_\_kmp\_bget\_insert\_into\_freelist}( thr, b );
1036 
1037 \textcolor{preprocessor}{#ifdef FreeWipe}
1038 \textcolor{preprocessor}{}    (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void}) memset(((\textcolor{keywordtype}{char} *) b) + \textcolor{keyword}{sizeof}(\hyperlink{kmp__alloc_8c_abd11e50b08fcad0d4fbfdce33582213c}{bfhead\_t}), 0x55,
1039              (\textcolor{keywordtype}{size\_t}) (\hyperlink{ittnotify__static_8h_a607b6bb4c1ebd6e828c6a54ec9bd1411}{len} - \textcolor{keyword}{sizeof}(\hyperlink{kmp__alloc_8c_abd11e50b08fcad0d4fbfdce33582213c}{bfhead\_t})));
1040 \textcolor{preprocessor}{#endif}
1041 \textcolor{preprocessor}{}    bn = \hyperlink{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}{BH}(((\textcolor{keywordtype}{char} *) b) + \hyperlink{ittnotify__static_8h_a607b6bb4c1ebd6e828c6a54ec9bd1411}{len});
1042     bn->\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree} = (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) \hyperlink{ittnotify__static_8h_a607b6bb4c1ebd6e828c6a54ec9bd1411}{len};
1043     \textcolor{comment}{/* Definition of ESent assumes two's complement! */}
1044     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( (~0) == -1 && (bn != 0) );
1045 
1046     bn->\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} = \hyperlink{kmp__alloc_8c_a7dcc8bddb70936db7d4f3f34ed635543}{ESent};
1047 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_abebcbe8d8488d54668527825b2663666}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!brel@{brel}}
\index{brel@{brel}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{brel}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} brel (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th, }
\item[{{\bf void} $\ast$}]{buf}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_abebcbe8d8488d54668527825b2663666}


Definition at line 798 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-\-\_\-kmp\-\_\-fast\-\_\-free(), \-\_\-\-\_\-\-\_\-kmp\-\_\-thread\-\_\-free(), \-\_\-\-\_\-kmp\-\_\-bget\-\_\-dequeue(), bgetr(), kmpc\-\_\-free(), and kmpc\-\_\-realloc().


\begin{DoxyCode}
799 \{
800     \hyperlink{structthr__data}{thr\_data\_t} *thr = \hyperlink{kmp__alloc_8c_ab99069e0ca8b8f4334f3d952f14ea967}{get\_thr\_data}( th );
801     \hyperlink{structbfhead}{bfhead\_t} *b, *bn;
802     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *bth;
803 
804     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(buf != NULL);
805     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( ((\textcolor{keywordtype}{size\_t})buf) % \hyperlink{kmp__alloc_8c_a5c41333bbc87068897a3c879fa16fb85}{SizeQuant} == 0 );
806 
807     b = \hyperlink{kmp__alloc_8c_af6ff720178dbca05767d51fd5c087228}{BFH}(((\textcolor{keywordtype}{char} *) buf) - \textcolor{keyword}{sizeof}(\hyperlink{unionbhead}{bhead\_t}));
808 
809     \textcolor{keywordflow}{if} (b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} == 0) \{        \textcolor{comment}{/* Directly-acquired buffer? */}
810         \hyperlink{structbdhead}{bdhead\_t} *bdh;
811 
812         bdh = \hyperlink{kmp__alloc_8c_a67a71fd38b2b8aaaa6e9da54bb652b7b}{BDH}(((\textcolor{keywordtype}{char} *) buf) - \textcolor{keyword}{sizeof}(\hyperlink{structbdhead}{bdhead\_t}));
813         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree} == 0);
814 \textcolor{preprocessor}{#if BufStats}
815 \textcolor{preprocessor}{}        thr->\hyperlink{structthr__data_a190c144a686f291c888741d25b4f6547}{totalloc} -= (size\_t) bdh->\hyperlink{structbdhead_aac93883268daeee61a9fc08d36a76147}{tsize};
816         thr->\hyperlink{structthr__data_a8f43a52aba5a9b92da0da539dba756c1}{numdrel}++;               \textcolor{comment}{/* Number of direct releases */}
817         thr->\hyperlink{structthr__data_a391d2806f8e5595fb66a01484c860bf0}{numrel}++;                \textcolor{comment}{/* Increment number of brel() calls */}
818 #endif \textcolor{comment}{/* BufStats */}
819 #ifdef FreeWipe
820         (\textcolor{keywordtype}{void}) memset((\textcolor{keywordtype}{char} *) buf, 0x55,
821                  (\textcolor{keywordtype}{size\_t}) (bdh->\hyperlink{structbdhead_aac93883268daeee61a9fc08d36a76147}{tsize} - \textcolor{keyword}{sizeof}(\hyperlink{structbdhead}{bdhead\_t})));
822 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* FreeWipe */}\textcolor{preprocessor}{}
823 \textcolor{preprocessor}{}
824         \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, (\textcolor{stringliteral}{"%%%%%% FREE( %p )\(\backslash\)n"}, (\textcolor{keywordtype}{void} *) bdh ) );
825 
826         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( thr->\hyperlink{structthr__data_ab94c9cee76c857baf0a3a3d887b47bd1}{relfcn} != 0 );
827         (*thr->\hyperlink{structthr__data_ab94c9cee76c857baf0a3a3d887b47bd1}{relfcn})((\textcolor{keywordtype}{void} *) bdh);      \textcolor{comment}{/* Release it directly. */}
828         \textcolor{keywordflow}{return};
829     \}
830 
831     bth = (\hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *)( (\hyperlink{kmp__os_8h_aece5d2283ded002ee31aea0b51e13120}{kmp\_uintptr\_t})\hyperlink{kmp__os_8h_a6e40f65c18c7b47fb612607b9bf8fdfc}{TCR\_PTR}(b->
      \hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a641b1866310f899813f98a52a287a32e}{bthr}) & ~1 ); \textcolor{comment}{// clear possible mark before comparison}
832     \textcolor{keywordflow}{if} ( bth != th ) \{
833         \textcolor{comment}{/* Add this buffer to be released by the owning thread later */}
834         \hyperlink{kmp__alloc_8c_a2bf0c38164ca2a6de8b52558386141bc}{\_\_kmp\_bget\_enqueue}( bth, buf
835 #ifdef USE\_QUEUING\_LOCK\_FOR\_BGET
836                             , \hyperlink{kmp_8h_a31d799169fae2285dc2703faf7f7c258}{\_\_kmp\_gtid\_from\_thread}( th )
837 #endif
838         );
839         \textcolor{keywordflow}{return};
840     \}
841 
842     \textcolor{comment}{/* Buffer size must be negative, indicating that the buffer is}
843 \textcolor{comment}{       allocated. */}
844 
845     \textcolor{keywordflow}{if} (b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} >= 0) \{
846         bn = NULL;
847     \}
848     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} < 0);
849 
850     \textcolor{comment}{/*  Back pointer in next buffer must be zero, indicating the}
851 \textcolor{comment}{        same thing: */}
852 
853     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(\hyperlink{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}{BH}((\textcolor{keywordtype}{char} *) b - b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize})->bb.prevfree == 0);
854 
855 \textcolor{preprocessor}{#if BufStats}
856 \textcolor{preprocessor}{}    thr->\hyperlink{structthr__data_a391d2806f8e5595fb66a01484c860bf0}{numrel}++;                    \textcolor{comment}{/* Increment number of brel() calls */}
857     thr->\hyperlink{structthr__data_a190c144a686f291c888741d25b4f6547}{totalloc} += (size\_t) b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize};
858 #endif
859 
860     \textcolor{comment}{/* If the back link is nonzero, the previous buffer is free.  */}
861 
862     if (b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree} != 0) \{
863         \textcolor{comment}{/* The previous buffer is free.  Consolidate this buffer  with  it}
864 \textcolor{comment}{           by  adding  the  length  of  this  buffer  to the previous free}
865 \textcolor{comment}{           buffer.  Note that we subtract the size  in  the  buffer  being}
866 \textcolor{comment}{           released,  since  it's  negative to indicate that the buffer is}
867 \textcolor{comment}{           allocated. */}
868 
869         \textcolor{keyword}{register} \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} = b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize};
870 
871         \textcolor{comment}{/* Make the previous buffer the one we're working on. */}
872         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(\hyperlink{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}{BH}((\textcolor{keywordtype}{char} *) b - b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree})->bb.bsize == b->
      \hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree});
873         b = \hyperlink{kmp__alloc_8c_af6ff720178dbca05767d51fd5c087228}{BFH}(((\textcolor{keywordtype}{char} *) b) - b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree});
874         b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} -= \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size};
875 
876         \textcolor{comment}{/* unlink the buffer from the old freelist */}
877         \hyperlink{kmp__alloc_8c_a2a12a9c925f14056c5bdc6c7726485cb}{\_\_kmp\_bget\_remove\_from\_freelist}( b );
878     \}
879     \textcolor{keywordflow}{else} \{
880         \textcolor{comment}{/* The previous buffer isn't allocated.  Mark this buffer}
881 \textcolor{comment}{           size as positive (i.e. free) and fall through to place}
882 \textcolor{comment}{           the buffer on the free list as an isolated free block. */}
883 
884         b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} = -b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize};
885     \}
886 
887     \textcolor{comment}{/* insert buffer back onto a new freelist */}
888     \hyperlink{kmp__alloc_8c_a6f80c5ae5feca086c056b4b9b0f8d30c}{\_\_kmp\_bget\_insert\_into\_freelist}( thr, b );
889 
890 
891     \textcolor{comment}{/* Now we look at the next buffer in memory, located by advancing from}
892 \textcolor{comment}{       the  start  of  this  buffer  by its size, to see if that buffer is}
893 \textcolor{comment}{       free.  If it is, we combine  this  buffer  with  the  next  one  in}
894 \textcolor{comment}{       memory, dechaining the second buffer from the free list. */}
895 
896     bn =  \hyperlink{kmp__alloc_8c_af6ff720178dbca05767d51fd5c087228}{BFH}(((\textcolor{keywordtype}{char} *) b) + b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize});
897     \textcolor{keywordflow}{if} (bn->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} > 0) \{
898 
899         \textcolor{comment}{/* The buffer is free.  Remove it from the free list and add}
900 \textcolor{comment}{           its size to that of our buffer. */}
901 
902         \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(\hyperlink{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}{BH}((\textcolor{keywordtype}{char} *) bn + bn->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize})->bb.prevfree == bn->
      \hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize});
903 
904         \hyperlink{kmp__alloc_8c_a2a12a9c925f14056c5bdc6c7726485cb}{\_\_kmp\_bget\_remove\_from\_freelist}( bn );
905 
906         b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} += bn->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize};
907 
908         \textcolor{comment}{/* unlink the buffer from the old freelist, and reinsert it into the new freelist */}
909 
910         \hyperlink{kmp__alloc_8c_a2a12a9c925f14056c5bdc6c7726485cb}{\_\_kmp\_bget\_remove\_from\_freelist}( b );
911         \hyperlink{kmp__alloc_8c_a6f80c5ae5feca086c056b4b9b0f8d30c}{\_\_kmp\_bget\_insert\_into\_freelist}( thr, b );
912 
913         \textcolor{comment}{/* Finally,  advance  to   the  buffer  that   follows  the  newly}
914 \textcolor{comment}{           consolidated free block.  We must set its  backpointer  to  the}
915 \textcolor{comment}{           head  of  the  consolidated free block.  We know the next block}
916 \textcolor{comment}{           must be an allocated block because the process of recombination}
917 \textcolor{comment}{           guarantees  that  two  free  blocks will never be contiguous in}
918 \textcolor{comment}{           memory.  */}
919 
920         bn = \hyperlink{kmp__alloc_8c_af6ff720178dbca05767d51fd5c087228}{BFH}(((\textcolor{keywordtype}{char} *) b) + b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize});
921     \}
922 \textcolor{preprocessor}{#ifdef FreeWipe}
923 \textcolor{preprocessor}{}    (\hyperlink{ittnotify__static_8h_af941d56e55e3c5465135b60c4d6343ed}{void}) memset(((\textcolor{keywordtype}{char} *) b) + \textcolor{keyword}{sizeof}(\hyperlink{kmp__alloc_8c_abd11e50b08fcad0d4fbfdce33582213c}{bfhead\_t}), 0x55,
924             (\textcolor{keywordtype}{size\_t}) (b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} - \textcolor{keyword}{sizeof}(\hyperlink{kmp__alloc_8c_abd11e50b08fcad0d4fbfdce33582213c}{bfhead\_t})));
925 \textcolor{preprocessor}{#endif}
926 \textcolor{preprocessor}{}    \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(bn->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} < 0);
927 
928     \textcolor{comment}{/* The next buffer is allocated.  Set the backpointer in it  to  point}
929 \textcolor{comment}{       to this buffer; the previous free buffer in memory. */}
930 
931     bn->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree} = b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize};
932 
933     \textcolor{comment}{/*  If  a  block-release function is defined, and this free buffer}
934 \textcolor{comment}{        constitutes the entire block, release it.  Note that  pool\_len}
935 \textcolor{comment}{        is  defined  in  such a way that the test will fail unless all}
936 \textcolor{comment}{        pool blocks are the same size.  */}
937 
938     \textcolor{keywordflow}{if} (thr->\hyperlink{structthr__data_ab94c9cee76c857baf0a3a3d887b47bd1}{relfcn} != 0 &&
939         b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize} == (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize})(thr->\hyperlink{structthr__data_a614e5671e1497475cd564343d2a1cd3f}{pool\_len} - \textcolor{keyword}{sizeof}(
      \hyperlink{unionbhead}{bhead\_t})))
940     \{
941 \textcolor{preprocessor}{#if BufStats}
942 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} (thr->\hyperlink{structthr__data_ace2317a7c31b3b8ecb3b10ea1067fee0}{numpblk} != 1) \{        \textcolor{comment}{/* Do not release the last buffer until finalization time */}
943 \textcolor{preprocessor}{#endif}
944 \textcolor{preprocessor}{}
945             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a2d15b44cc33113af141a1ed4e66f3ad0}{prevfree} == 0);
946             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(\hyperlink{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}{BH}((\textcolor{keywordtype}{char} *) b + b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.
      \hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize})->bb.bsize == \hyperlink{kmp__alloc_8c_a7dcc8bddb70936db7d4f3f34ed635543}{ESent});
947             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(\hyperlink{kmp__alloc_8c_a71197de7b3957037a50d1cca18d03263}{BH}((\textcolor{keywordtype}{char} *) b + b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.
      \hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize})->bb.prevfree == b->\hyperlink{structbfhead_a75547156d52c89826f1e0d711014f77a}{bh}.\hyperlink{unionbhead_ab99fcbcc7514c17564d6e3fca349903a}{bb}.\hyperlink{structbhead2_a880c94691872eca4d73d3933c49a40cf}{bsize});
948 
949             \textcolor{comment}{/*  Unlink the buffer from the free list  */}
950             \hyperlink{kmp__alloc_8c_a2a12a9c925f14056c5bdc6c7726485cb}{\_\_kmp\_bget\_remove\_from\_freelist}( b );
951 
952             \hyperlink{kmp__debug_8h_a1094ea740e17fb9a92c845f6d08b3a10}{KE\_TRACE}( 10, (\textcolor{stringliteral}{"%%%%%% FREE( %p )\(\backslash\)n"}, (\textcolor{keywordtype}{void} *) b ) );
953 
954             (*thr->\hyperlink{structthr__data_ab94c9cee76c857baf0a3a3d887b47bd1}{relfcn})(b);
955 \textcolor{preprocessor}{#if BufStats}
956 \textcolor{preprocessor}{}            thr->\hyperlink{structthr__data_ac9ff0cac89239d263184e77107c03b7d}{numprel}++;               \textcolor{comment}{/* Nr of expansion block releases */}
957             thr->\hyperlink{structthr__data_ace2317a7c31b3b8ecb3b10ea1067fee0}{numpblk}--;               \textcolor{comment}{/* Total number of blocks */}
958             \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}(thr->\hyperlink{structthr__data_ace2317a7c31b3b8ecb3b10ea1067fee0}{numpblk} == thr->\hyperlink{structthr__data_a5351a12df0ac848e4148dd2466a4026d}{numpget} - thr->
      \hyperlink{structthr__data_ac9ff0cac89239d263184e77107c03b7d}{numprel});
959 
960             \textcolor{comment}{/* avoid leaving stale last\_pool pointer around if it is being dealloced */}
961             \textcolor{keywordflow}{if} (thr->\hyperlink{structthr__data_aac5ddbd2e9047f283da46c5ae55686fe}{last\_pool} == b) thr->\hyperlink{structthr__data_aac5ddbd2e9047f283da46c5ae55686fe}{last\_pool} = 0;
962         \}
963         \textcolor{keywordflow}{else} \{
964             thr->\hyperlink{structthr__data_aac5ddbd2e9047f283da46c5ae55686fe}{last\_pool} = b;
965         \}
966 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* BufStats */}\textcolor{preprocessor}{}
967 \textcolor{preprocessor}{}    \}
968 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_ab99069e0ca8b8f4334f3d952f14ea967}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!get\-\_\-thr\-\_\-data@{get\-\_\-thr\-\_\-data}}
\index{get\-\_\-thr\-\_\-data@{get\-\_\-thr\-\_\-data}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{get\-\_\-thr\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf thr\-\_\-data\-\_\-t}$\ast$ get\-\_\-thr\-\_\-data (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_ab99069e0ca8b8f4334f3d952f14ea967}


Definition at line 295 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-free\-\_\-fast\-\_\-memory(), bcheck(), bectl(), bfreed(), bget(), bpool(), brel(), kmpc\-\_\-get\-\_\-poolmode(), kmpc\-\_\-get\-\_\-poolsize(), and kmpc\-\_\-set\-\_\-poolmode().


\begin{DoxyCode}
296 \{
297     \hyperlink{structthr__data}{thr\_data\_t} *\hyperlink{ittnotify__static_8h_ae4b7aa9cddc8e1ade7c67ed7e338b18f}{data};
298 
299     data = (\hyperlink{structthr__data}{thr\_data\_t} *) th->th.th\_local.bget\_data;
300 
301     \hyperlink{kmp__debug_8h_ad766efc30e33e28634691088e80cdf08}{KMP\_DEBUG\_ASSERT}( data != 0 );
302 
303     \textcolor{keywordflow}{return} \hyperlink{ittnotify__static_8h_ae4b7aa9cddc8e1ade7c67ed7e338b18f}{data};
304 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_aaff1b5800d2d73bb4af47dcbfd195f47}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!kmpc\-\_\-calloc@{kmpc\-\_\-calloc}}
\index{kmpc\-\_\-calloc@{kmpc\-\_\-calloc}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{kmpc\-\_\-calloc}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}$\ast$ kmpc\-\_\-calloc (
\begin{DoxyParamCaption}
\item[{size\-\_\-t}]{nelem, }
\item[{size\-\_\-t}]{elsize}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_aaff1b5800d2d73bb4af47dcbfd195f47}


Definition at line 1436 of file kmp\-\_\-alloc.\-c.



Referenced by F\-T\-N\-\_\-\-C\-A\-L\-L\-O\-C().


\begin{DoxyCode}
1437 \{
1438     \textcolor{keywordtype}{void} * ptr;
1439         ptr = \hyperlink{kmp__alloc_8c_a9dd8baceae832aef6e56a510f40d7f2b}{bgetz}( \hyperlink{kmp_8h_ab5c65087a44197c3b69cd133df0d6f85}{\_\_kmp\_entry\_thread}(), (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) (nelem * elsize) );
1440 
1441     \textcolor{keywordflow}{return} ptr;
1442 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a2ef2b82a6d376c70d7bf35498207e0fc}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!kmpc\-\_\-free@{kmpc\-\_\-free}}
\index{kmpc\-\_\-free@{kmpc\-\_\-free}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{kmpc\-\_\-free}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} kmpc\-\_\-free (
\begin{DoxyParamCaption}
\item[{{\bf void} $\ast$}]{ptr}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_a2ef2b82a6d376c70d7bf35498207e0fc}


Definition at line 1467 of file kmp\-\_\-alloc.\-c.



Referenced by F\-T\-N\-\_\-\-D\-E\-S\-T\-R\-O\-Y\-\_\-\-A\-F\-F\-I\-N\-I\-T\-Y\-\_\-\-M\-A\-S\-K(), and F\-T\-N\-\_\-\-F\-R\-E\-E().


\begin{DoxyCode}
1468 \{
1469     \textcolor{keywordflow}{if} ( ! \hyperlink{kmp_8h_aee22cd19970207e05e9c86cc0a802f9c}{\_\_kmp\_init\_serial} ) \{
1470         \textcolor{keywordflow}{return};
1471     \}; \textcolor{comment}{// if}
1472     \textcolor{keywordflow}{if} ( ptr != NULL ) \{
1473             \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *th = \hyperlink{kmp_8h_a4d2754b28510af3652e72d5c2ad88c8f}{\_\_kmp\_get\_thread}();
1474             \hyperlink{kmp__alloc_8c_a2051eee971259559ffd8406822786ab2}{\_\_kmp\_bget\_dequeue}( th );         \textcolor{comment}{/* Release any queued buffers */}
1475             \hyperlink{kmp__alloc_8c_abebcbe8d8488d54668527825b2663666}{brel}( th, ptr );
1476     \};
1477 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_aeab82d477ff7bc5d00c52635f1a390f0}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!kmpc\-\_\-get\-\_\-poolmode@{kmpc\-\_\-get\-\_\-poolmode}}
\index{kmpc\-\_\-get\-\_\-poolmode@{kmpc\-\_\-get\-\_\-poolmode}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{kmpc\-\_\-get\-\_\-poolmode}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int} kmpc\-\_\-get\-\_\-poolmode (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_aeab82d477ff7bc5d00c52635f1a390f0}


Definition at line 1389 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
1390 \{
1391     \hyperlink{structthr__data}{thr\_data\_t} *\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p};
1392 
1393     p = \hyperlink{kmp__alloc_8c_ab99069e0ca8b8f4334f3d952f14ea967}{get\_thr\_data}( \hyperlink{kmp_8h_a4d2754b28510af3652e72d5c2ad88c8f}{\_\_kmp\_get\_thread}() );
1394 
1395     \textcolor{keywordflow}{return} p->\hyperlink{structthr__data_a790f977bb5c8b2b3409c1cf025c92f65}{mode};
1396 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a4151653ed23d78edfd7f70820855aeb0}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!kmpc\-\_\-get\-\_\-poolsize@{kmpc\-\_\-get\-\_\-poolsize}}
\index{kmpc\-\_\-get\-\_\-poolsize@{kmpc\-\_\-get\-\_\-poolsize}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{kmpc\-\_\-get\-\_\-poolsize}]{\setlength{\rightskip}{0pt plus 5cm}size\-\_\-t kmpc\-\_\-get\-\_\-poolsize (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_a4151653ed23d78edfd7f70820855aeb0}


Definition at line 1368 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
1369 \{
1370     \hyperlink{structthr__data}{thr\_data\_t} *\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p};
1371 
1372     p = \hyperlink{kmp__alloc_8c_ab99069e0ca8b8f4334f3d952f14ea967}{get\_thr\_data}( \hyperlink{kmp_8h_a4d2754b28510af3652e72d5c2ad88c8f}{\_\_kmp\_get\_thread}() );
1373 
1374     \textcolor{keywordflow}{return} p->\hyperlink{structthr__data_ad76a1f415abd6cbf1c4f9b2c091e3c21}{exp\_incr};
1375 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a5fbfa0989e8c9d41df603346a57058a6}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!kmpc\-\_\-get\-\_\-poolstat@{kmpc\-\_\-get\-\_\-poolstat}}
\index{kmpc\-\_\-get\-\_\-poolstat@{kmpc\-\_\-get\-\_\-poolstat}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{kmpc\-\_\-get\-\_\-poolstat}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} kmpc\-\_\-get\-\_\-poolstat (
\begin{DoxyParamCaption}
\item[{size\-\_\-t $\ast$}]{maxmem, }
\item[{size\-\_\-t $\ast$}]{allmem}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_a5fbfa0989e8c9d41df603346a57058a6}


Definition at line 1399 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
1400 \{
1401     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *th = \hyperlink{kmp_8h_a4d2754b28510af3652e72d5c2ad88c8f}{\_\_kmp\_get\_thread}();
1402     \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize} a, b;
1403 
1404     \hyperlink{kmp__alloc_8c_a2051eee971259559ffd8406822786ab2}{\_\_kmp\_bget\_dequeue}( th );         \textcolor{comment}{/* Release any queued buffers */}
1405 
1406     \hyperlink{kmp__alloc_8c_aae7687b0fc52108956d191aac6582a92}{bcheck}( th, &a, &b );
1407 
1408     *maxmem = a;
1409     *allmem = b;
1410 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_aaab12aaa8a587464c9490323fdbec216}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!kmpc\-\_\-malloc@{kmpc\-\_\-malloc}}
\index{kmpc\-\_\-malloc@{kmpc\-\_\-malloc}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{kmpc\-\_\-malloc}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}$\ast$ kmpc\-\_\-malloc (
\begin{DoxyParamCaption}
\item[{size\-\_\-t}]{size}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_aaab12aaa8a587464c9490323fdbec216}


Definition at line 1427 of file kmp\-\_\-alloc.\-c.



Referenced by F\-T\-N\-\_\-\-C\-R\-E\-A\-T\-E\-\_\-\-A\-F\-F\-I\-N\-I\-T\-Y\-\_\-\-M\-A\-S\-K(), and F\-T\-N\-\_\-\-M\-A\-L\-L\-O\-C().


\begin{DoxyCode}
1428 \{
1429     \textcolor{keywordtype}{void} * ptr;
1430         ptr = \hyperlink{kmp__alloc_8c_ae0f1683e77919d466cf2ea6f7b00ba91}{bget}( \hyperlink{kmp_8h_ab5c65087a44197c3b69cd133df0d6f85}{\_\_kmp\_entry\_thread}(), (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) 
      \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} );
1431 
1432     \textcolor{keywordflow}{return} ptr;
1433 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_aa45af19ce0fda88c36ba109457728495}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!kmpc\-\_\-poolprint@{kmpc\-\_\-poolprint}}
\index{kmpc\-\_\-poolprint@{kmpc\-\_\-poolprint}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{kmpc\-\_\-poolprint}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} kmpc\-\_\-poolprint (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_aa45af19ce0fda88c36ba109457728495}


Definition at line 1413 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
1414 \{
1415     \hyperlink{kmp_8h_a194859801fe16b326efe34501a37c30a}{kmp\_info\_t} *th = \hyperlink{kmp_8h_a4d2754b28510af3652e72d5c2ad88c8f}{\_\_kmp\_get\_thread}();
1416 
1417     \hyperlink{kmp__alloc_8c_a2051eee971259559ffd8406822786ab2}{\_\_kmp\_bget\_dequeue}( th );         \textcolor{comment}{/* Release any queued buffers */}
1418 
1419     \hyperlink{kmp__alloc_8c_a77abb6a46b7d952625f54d2d506dce69}{bfreed}( th );
1420 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a338e1287ffbce17edcfb69f1b15a5b7b}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!kmpc\-\_\-realloc@{kmpc\-\_\-realloc}}
\index{kmpc\-\_\-realloc@{kmpc\-\_\-realloc}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{kmpc\-\_\-realloc}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void}$\ast$ kmpc\-\_\-realloc (
\begin{DoxyParamCaption}
\item[{{\bf void} $\ast$}]{ptr, }
\item[{size\-\_\-t}]{size}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_a338e1287ffbce17edcfb69f1b15a5b7b}


Definition at line 1445 of file kmp\-\_\-alloc.\-c.



Referenced by F\-T\-N\-\_\-\-R\-E\-A\-L\-L\-O\-C().


\begin{DoxyCode}
1446 \{
1447     \textcolor{keywordtype}{void} * result = NULL;
1448 
1449         \textcolor{keywordflow}{if} ( ptr == NULL ) \{
1450             \textcolor{comment}{// If pointer is NULL, realloc behaves like malloc.}
1451             result = \hyperlink{kmp__alloc_8c_ae0f1683e77919d466cf2ea6f7b00ba91}{bget}( \hyperlink{kmp_8h_ab5c65087a44197c3b69cd133df0d6f85}{\_\_kmp\_entry\_thread}(), (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) 
      \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} );
1452         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} == 0 ) \{
1453             \textcolor{comment}{// If size is 0, realloc behaves like free.}
1454             \textcolor{comment}{// The thread must be registered by the call to kmpc\_malloc() or kmpc\_calloc() before.}
1455             \textcolor{comment}{// So it should be safe to call \_\_kmp\_get\_thread(), not \_\_kmp\_entry\_thread().}
1456             \hyperlink{kmp__alloc_8c_abebcbe8d8488d54668527825b2663666}{brel}( \hyperlink{kmp_8h_a4d2754b28510af3652e72d5c2ad88c8f}{\_\_kmp\_get\_thread}(), ptr );
1457         \} \textcolor{keywordflow}{else} \{
1458             result = \hyperlink{kmp__alloc_8c_aba99d2a2a6154f7f8c1f957755bcbb48}{bgetr}( \hyperlink{kmp_8h_ab5c65087a44197c3b69cd133df0d6f85}{\_\_kmp\_entry\_thread}(), ptr, (
      \hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} );
1459         \}; \textcolor{comment}{// if}
1460 
1461     \textcolor{keywordflow}{return} result;
1462 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_afbc4aacdb05f12b01ed7482fbd7a0a00}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!kmpc\-\_\-set\-\_\-poolmode@{kmpc\-\_\-set\-\_\-poolmode}}
\index{kmpc\-\_\-set\-\_\-poolmode@{kmpc\-\_\-set\-\_\-poolmode}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{kmpc\-\_\-set\-\_\-poolmode}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} kmpc\-\_\-set\-\_\-poolmode (
\begin{DoxyParamCaption}
\item[{{\bf int}}]{mode}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_afbc4aacdb05f12b01ed7482fbd7a0a00}


Definition at line 1378 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
1379 \{
1380     \hyperlink{structthr__data}{thr\_data\_t} *\hyperlink{ittnotify__static_8h_ab7caea589d3ca96f9f11c78f10bff578}{p};
1381 
1382     \textcolor{keywordflow}{if} (\hyperlink{ittnotify__static_8h_aaa96ee29dca0e28ad6edad4c36f62080}{mode} == \hyperlink{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a8432b2f804c3780ca534a4f56e0bf274}{bget\_mode\_fifo} || \hyperlink{ittnotify__static_8h_aaa96ee29dca0e28ad6edad4c36f62080}{mode} == \hyperlink{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a0cc8593912b5aa9bdac96f437b65e3ea}{bget\_mode\_lifo} || 
      \hyperlink{ittnotify__static_8h_aaa96ee29dca0e28ad6edad4c36f62080}{mode} == \hyperlink{kmp__alloc_8c_a847afd2013b1ea12c5cd7a6612e91981a0c883f0544468f73a8cc6606c2ac6b84}{bget\_mode\_best}) \{
1383         p = \hyperlink{kmp__alloc_8c_ab99069e0ca8b8f4334f3d952f14ea967}{get\_thr\_data}( \hyperlink{kmp_8h_a4d2754b28510af3652e72d5c2ad88c8f}{\_\_kmp\_get\_thread}() );
1384         p->\hyperlink{structthr__data_a790f977bb5c8b2b3409c1cf025c92f65}{mode} = (\hyperlink{kmp__alloc_8c_a625b1696056adee9c191ae4c8fc05f69}{bget\_mode\_t}) \hyperlink{ittnotify__static_8h_aaa96ee29dca0e28ad6edad4c36f62080}{mode};
1385     \}
1386 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a9c0855cf39dfbe2b8ed63020a99dcd90}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!kmpc\-\_\-set\-\_\-poolsize@{kmpc\-\_\-set\-\_\-poolsize}}
\index{kmpc\-\_\-set\-\_\-poolsize@{kmpc\-\_\-set\-\_\-poolsize}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{kmpc\-\_\-set\-\_\-poolsize}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} kmpc\-\_\-set\-\_\-poolsize (
\begin{DoxyParamCaption}
\item[{size\-\_\-t}]{size}
\end{DoxyParamCaption}
)}}\label{kmp__alloc_8c_a9c0855cf39dfbe2b8ed63020a99dcd90}


Definition at line 1361 of file kmp\-\_\-alloc.\-c.


\begin{DoxyCode}
1362 \{
1363     \hyperlink{kmp__alloc_8c_a5e152d4831a1e7143be739db589c9c3e}{bectl}( \hyperlink{kmp_8h_a4d2754b28510af3652e72d5c2ad88c8f}{\_\_kmp\_get\_thread}(), (\hyperlink{kmp__alloc_8c_a97451db29023098b5723ad1ba00f944f}{bget\_compact\_t}) 0, (
      \hyperlink{kmp__alloc_8c_a21f03e368c4e90d00ed20a2b01985ecd}{bget\_acquire\_t}) malloc,
1364            (\hyperlink{kmp__alloc_8c_ad26e5d39dca5e04fbcfb74a022e2fcdb}{bget\_release\_t}) free, (\hyperlink{kmp__alloc_8c_acb70eb20828ff76ed9200989f7dcd043}{bufsize}) \hyperlink{ittnotify__static_8h_a5a1daa0c1d342747e3884fa54fc64fb1}{size} );
1365 \}
\end{DoxyCode}
\hypertarget{kmp__alloc_8c_a4fa2d764a1fb227783e00a6a8d60bb46}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!set\-\_\-thr\-\_\-data@{set\-\_\-thr\-\_\-data}}
\index{set\-\_\-thr\-\_\-data@{set\-\_\-thr\-\_\-data}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{set\-\_\-thr\-\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} set\-\_\-thr\-\_\-data (
\begin{DoxyParamCaption}
\item[{{\bf kmp\-\_\-info\-\_\-t} $\ast$}]{th}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_a4fa2d764a1fb227783e00a6a8d60bb46}


Definition at line 266 of file kmp\-\_\-alloc.\-c.



Referenced by \-\_\-\-\_\-kmp\-\_\-initialize\-\_\-bget().


\begin{DoxyCode}
267 \{
268     \textcolor{keywordtype}{int} \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i};
269     \hyperlink{structthr__data}{thr\_data\_t} *\hyperlink{ittnotify__static_8h_ae4b7aa9cddc8e1ade7c67ed7e338b18f}{data};
270 
271     data =
272         (\hyperlink{structthr__data}{thr\_data\_t} *)(
273             ( ! th->th.th\_local.bget\_data ) ? \hyperlink{kmp_8h_aa6a69b47037dcffbfc5dba21a4a64d85}{\_\_kmp\_allocate}( \textcolor{keyword}{sizeof}( *data ) ) : th->th.
      th\_local.bget\_data
274         );
275 
276     memset( data, \textcolor{charliteral}{'\(\backslash\)0'}, \textcolor{keyword}{sizeof}( *data ) );
277 
278     \textcolor{keywordflow}{for} (i = 0; i < \hyperlink{kmp__alloc_8c_af312994da10c636eaa83074b49b44b0a}{MAX\_BGET\_BINS}; ++\hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i}) \{
279         data->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i} ].\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a97bd9feb245a055c2317d3cdcfbbb58f}{flink} = & data->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ 
      \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i} ];
280         data->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i} ].\hyperlink{structbfhead_adc2c1c9fc5b4081009c158da12064bfe}{ql}.\hyperlink{structqlinks_a81ba302b8b5399c915ec06e843f66842}{blink} = & data->\hyperlink{structthr__data_a1ebad8a4582b7e9d0ed15ca2f2448def}{freelist}[ 
      \hyperlink{kmp__stub_8c_a08582ce460e3d5e1cf0b7fea017d608e}{i} ];
281     \}
282 
283     th->th.th\_local.bget\_data = \hyperlink{ittnotify__static_8h_ae4b7aa9cddc8e1ade7c67ed7e338b18f}{data};
284     th->th.th\_local.bget\_list = 0;
285 \textcolor{preprocessor}{#if ! USE\_CMP\_XCHG\_FOR\_BGET}
286 \textcolor{preprocessor}{}\textcolor{preprocessor}{#ifdef USE\_QUEUING\_LOCK\_FOR\_BGET}
287 \textcolor{preprocessor}{}    \hyperlink{kmp__lock_8h_a44d857bfef49fda9213da11d71aae54e}{\_\_kmp\_init\_lock}( & th->th.th\_local.bget\_lock );
288 \textcolor{preprocessor}{#else}
289 \textcolor{preprocessor}{}    \hyperlink{kmp__lock_8h_ad0724dc0da849eb1ed970306cbf96e7b}{\_\_kmp\_init\_bootstrap\_lock}( & th->th.th\_local.bget\_lock );
290 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* USE\_LOCK\_FOR\_BGET */}\textcolor{preprocessor}{}
291 \textcolor{preprocessor}{}\textcolor{preprocessor}{#endif }\textcolor{comment}{/* ! USE\_CMP\_XCHG\_FOR\_BGET */}\textcolor{preprocessor}{}
292 \textcolor{preprocessor}{}\}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{kmp__alloc_8c_ac3c6b00e9fbae316fdd0c11f2b8d50b7}{\index{kmp\-\_\-alloc.\-c@{kmp\-\_\-alloc.\-c}!bget\-\_\-bin\-\_\-size@{bget\-\_\-bin\-\_\-size}}
\index{bget\-\_\-bin\-\_\-size@{bget\-\_\-bin\-\_\-size}!kmp_alloc.c@{kmp\-\_\-alloc.\-c}}
\subsubsection[{bget\-\_\-bin\-\_\-size}]{\setlength{\rightskip}{0pt plus 5cm}{\bf bufsize} bget\-\_\-bin\-\_\-size\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{kmp__alloc_8c_ac3c6b00e9fbae316fdd0c11f2b8d50b7}
{\bfseries Initial value\-:}
\begin{DoxyCode}
= \{
    0,

    1 << 7,    
    1 << 8,    
    1 << 9,    
    1 << 10,   
    1 << 11,   
    1 << 12,
    1 << 13,   
    1 << 14,
    1 << 15,   
    1 << 16,
    1 << 17,
    1 << 18,
    1 << 19,
    1 << 20,    
    1 << 21,    
    1 << 22,    
    1 << 23,    
    1 << 24,    
    1 << 25,    
\}
\end{DoxyCode}


Definition at line 124 of file kmp\-\_\-alloc.\-c.



Referenced by bget\-\_\-get\-\_\-bin().

